# Miscellaneous Japanese events (usually for Shinto rulers or Japonic Buddhists).
# by Silverswee(e)per

namespace = japan


##### Wako (Wokou) events - add cultural buildings + game rule + localization

# Low chance of a Yamato or Japanese island or coastal province swapping to Wako culture
province_event = {
	id = japan.406
	picture = GFX_evt_kraken
	border = GFX_event_normal_frame_war
	desc = EVTDESC_JAPAN_406
	
	trigger = {
		port = yes
		OR = {
			# In Japan or Korea
			region = world_japan
			region = custom_yezo
			region = world_japan_islands
			region = world_korea
		}
		OR = {
			culture = japanese
			culture = yamato
		}
		OR = {
			religion = shinto
			religion = buddhist
		}
	}
	
	mean_time_to_happen = {
		months = 1000
		
		# Is not an island or "island"
		modifier = {
			factor = 5
			any_neighbor_province = {
				count = 2
				is_land = yes
			}
		}
		
		# Is really not an island
		modifier = {
			factor = 10
			any_neighbor_province = {
				is_land = yes
				port = no
			}
		}
		modifier = {
			factor = 0.9
			any_neighbor_province = {
				culture = wako # More common if adjacent
			}
		}
	}
	
	option = {
		trigger = {
			owner = {
				NOT = {
					culture = wako
				}
			}
		}
		name = EVTOPTA_JAPAN_406 # Let's hope they behave...
		culture = wako
	}
	
	option = {
		trigger = {
			owner = {
				culture = wako
			}
		}
		name = EVTOPTB_JAPAN_406 # That's... good?
		culture = wako
	}
}

# Low chance of a Pirate Haven spawning in a Wako province
province_event = {
	id = japan.407
	picture = GFX_evt_kraken
	border = GFX_event_normal_frame_war
	desc = EVTDESC_JAPAN_407
	
	trigger = {
		port = yes
		OR = {
			# In Japan or Korea
			region = world_japan
			region = custom_yezo
			region = world_japan_islands
			region = world_korea
		}
		culture = wako
		OR = {
			religion = shinto
			religion = buddhist
		}
		NOT = {
			has_province_modifier = pirate_haven
		}
		owner = {
			NOR = {
				AND = {
					culture = wako
					independent = yes
				}
				top_liege = {
					culture = wako
				}
			}
		}
	}
	
	mean_time_to_happen = {
		months = 120
		
		# Is not an island or "island"
		modifier = {
			factor = 5
			any_neighbor_province = {
				count = 2
				is_land = yes
			}
		}
		
		# Is really not an island
		modifier = {
			factor = 10
			any_neighbor_province = {
				is_land = yes
				port = no
			}
		}
	}
	
	option = {
		name = EVTOPTA_JAPAN_407 # Let's hope they know not to raid my coasts!
		add_province_modifier = {
			modifier = pirate_haven
			duration = -1
		}
	}
}

# Pirate Haven modifier removed
province_event = {
	id = japan.408
	picture = GFX_evt_kraken
	border = GFX_event_normal_frame_war
	desc = EVTDESC_JAPAN_408
	
	trigger = {
		port = yes
		has_province_modifier = pirate_haven
	}
	
	mean_time_to_happen = {
		months = 240
		
		# Isn't a Wako province
		modifier = {
			factor = 0.1
			NAND = {
				culture = wako
				OR = {
					religion = shinto
					religion = buddhist
				}
			}
		}
		
		# Owner or liege is Wako
		modifier = {
			factor = 0.1
			owner = {
				OR = {
					culture = wako
					any_liege = {
						culture = wako
					}
				}
			}
		}
		
		# Owner has high stewardship
		modifier = {
			factor = 0.8
			owner = {
				stewardship = 12
			}
		}
		modifier = {
			factor = 0.8
			owner = {
				stewardship = 16
			}
		}
		modifier = {
			factor = 0.8
			owner = {
				stewardship = 20
			}
		}
		modifier = {
			factor = 0.8
			owner = {
				stewardship = 24
			}
		}
	}
	
	option = {
		trigger = {
			owner = {
				NOT = {
					culture = wako
				}
			}
		}
		name = EVTOPTA_JAPAN_408 # Good riddance!
		remove_province_modifier = pirate_haven
	}
	
	option = {
		trigger = {
			owner = {
				culture = wako
			}
		}
		name = EVTOPTB_JAPAN_408 # I can organize my own raids!
		remove_province_modifier = pirate_haven
	}
}

# Low chance of a Wako raid spawning in a province with a Pirate Haven
character_event = {
	id = japan.409
	picture = GFX_evt_kraken
	border = GFX_event_normal_frame_war
	desc = EVTDESC_JAPAN_409
	
	only_playable = yes
	
	has_dlc = "Horse Lords" # Raiding adventurers
		
	trigger = {
		always = no # Not working well
		any_demesne_province = {
			culture = wako
			has_province_modifier = pirate_haven
		}
	}
	
	mean_time_to_happen = {
		months = 120
	}
	
	immediate = {
		random_demesne_province = {
			limit = {
				culture = wako
				has_province_modifier = pirate_haven
			}
			save_event_target_as = wako_province
			random_list = {
				95 = {
					create_character = {
						random_traits = yes
						age = 25
						female = no
						dynasty = none
						culture = wako
						religion = shinto
						attributes = {
							martial = 5
						}
						trait = tough_soldier
					}
				}
				5 = {
					create_character = {
						random_traits = yes
						age = 25
						female = yes
						dynasty = none
						culture = wako
						religion = shinto
						trait = pirate
						attributes = {
							martial = 5
						}
						trait = tough_soldier
					}
				}
			}
			new_character = {
				if = {
					limit = {
						has_dlc = "Holy Fury"
					}
					add_trait = pirate
				}
				add_trait = adventurer
				# Pirate flavour
				random_list = {
					5 = {
						add_trait = one_legged
					}
					5 = {
						add_trait = one_eyed
					}
					5 = {
						add_trait = one_handed
					}
					5 = {
						add_trait = duelist
					}
					5 = {
						add_trait = scurvy
					}
					5 = {
						add_trait = drunkard
					}
					5 = {
						add_trait = hedonist
					}
					5 = {
						if = {
							limit = {
								is_female = yes
							}
							add_trait = seductress
						}
						else = {
							add_trait = seducer
						}
					}
					5 = {
						add_trait = falconer
					}
					5 = {
						add_trait = lustful
					}
					5 = {
						add_trait = greedy
					}
					5 = {
						add_trait = arbitrary
					}
					5 = {
						add_trait = deceitful
					}
					5 = {
						add_trait = envious
					}
					5 = {
						add_trait = brave
					}
					5 = {
						add_trait = cruel
					}
					5 = {
						add_trait = craven
					}
					5 = {
						add_trait = aggressive_leader
					}
					5 = {
						add_trait = inspiring_leader
					}
					5 = {
						add_trait = trickster
					}
				}
				random_list = {
					5 = {
						add_trait = one_legged
					}
					5 = {
						add_trait = one_eyed
					}
					5 = {
						add_trait = one_handed
					}
					5 = {
						add_trait = duelist
					}
					5 = {
						add_trait = scurvy
					}
					5 = {
						add_trait = drunkard
					}
					5 = {
						add_trait = hedonist
					}
					5 = {
						if = {
							limit = {
								is_female = yes
							}
							add_trait = seductress
						}
						else = {
							add_trait = seducer
						}
					}
					5 = {
						add_trait = falconer
					}
					5 = {
						add_trait = lustful
					}
					5 = {
						add_trait = greedy
					}
					5 = {
						add_trait = arbitrary
					}
					5 = {
						add_trait = deceitful
					}
					5 = {
						add_trait = envious
					}
					5 = {
						add_trait = brave
					}
					5 = {
						add_trait = cruel
					}
					5 = {
						add_trait = craven
					}
					5 = {
						add_trait = aggressive_leader
					}
					5 = {
						add_trait = inspiring_leader
					}
					5 = {
						add_trait = trickster
					}
				}
				random_list = {
					5 = {
						add_trait = one_legged
					}
					5 = {
						add_trait = one_eyed
					}
					5 = {
						add_trait = one_handed
					}
					5 = {
						add_trait = duelist
					}
					5 = {
						add_trait = scurvy
					}
					5 = {
						add_trait = drunkard
					}
					5 = {
						add_trait = hedonist
					}
					5 = {
						if = {
							limit = {
								is_female = yes
							}
							add_trait = seductress
						}
						else = {
							add_trait = seducer
						}
					}
					5 = {
						add_trait = falconer
					}
					5 = {
						add_trait = lustful
					}
					5 = {
						add_trait = greedy
					}
					5 = {
						add_trait = arbitrary
					}
					5 = {
						add_trait = deceitful
					}
					5 = {
						add_trait = envious
					}
					5 = {
						add_trait = brave
					}
					5 = {
						add_trait = cruel
					}
					5 = {
						add_trait = craven
					}
					5 = {
						add_trait = aggressive_leader
					}
					5 = {
						add_trait = inspiring_leader
					}
					5 = {
						add_trait = trickster
					}
				}
				save_event_target_as = wako_raider
				set_character_flag = raiding_adventurer
				set_defacto_liege = THIS
				create_title = {
					tier = DUKE
					landless = yes
					adventurer = yes
					culture = ROOT
					name = "PIRATE_RAIDERS"
					holder = THIS
					base_title = THIS
				}
				# Create a fleet
				spawn_unit = {
					province = event_target:wako_province
					home = event_target:wako_province
					owner = event_target:wako_raider
					troops = {
						light_infantry = { 250 250 }
						archers = { 250 250 }
						heavy_infantry = { 50 50 }
						pikemen = { 50 50 }
					}
					attrition = 0
					disband_on_peace = yes
					reinforces = yes
					is_looter = yes
					can_toggle_looting = no
					cannot_inherit = yes
					earmark = wako_raiders
				}
				spawn_fleet = {
					province = closest # closest sea zone
					owner = event_target:wako_raider
					troops = {
						galleys = { 10 10 }
					}
					cannot_inherit = yes
					earmark = wako_raiders
				}
				random = {
					chance = 25
					modifier = {
						factor = 2
						year = 1000
					}
					spawn_unit = {
						province = event_target:wako_province
						owner = event_target:wako_raider
						troops = {
							light_infantry = { 250 250 }
							archers = { 250 250 }
							heavy_infantry = { 50 50 }
							pikemen = { 50 50 }
						}
						attrition = 0
						disband_on_peace = yes
						reinforces = yes
						is_looter = yes
						can_toggle_looting = no
						cannot_inherit = yes
						earmark = wako_raiders
					}
					spawn_fleet = {
						province = closest # closest sea zone
						owner = event_target:wako_raider
						troops = {
							galleys = { 10 10 }
						}
						cannot_inherit = yes
						earmark = wako_raiders
					}
				}
				random = {
					chance = 5
					modifier = {
						factor = 2
						year = 1200
					}
					spawn_unit = {
						province = event_target:wako_province
						owner = event_target:wako_raider
						troops = {
							light_infantry = { 250 250 }
							archers = { 250 250 }
							heavy_infantry = { 50 50 }
							pikemen = { 50 50 }
						}
						attrition = 0
						disband_on_peace = yes
						reinforces = yes
						is_looter = yes
						can_toggle_looting = no
						cannot_inherit = yes
						earmark = wako_raiders
					}
					spawn_fleet = {
						province = closest # closest sea zone
						owner = event_target:wako_raider
						troops = {
							galleys = { 10 10 }
						}
						cannot_inherit = yes
						earmark = wako_raiders
					}
				}
				ROOT = {
					reverse_opinion = {
						who = event_target:wako_raider
						modifier = forbidden_raid_target
					}
					any_liege = {
						reverse_opinion = {
							who = event_target:wako_raider
							modifier = forbidden_raid_target
						}
					}
				}
				character_event = { id = japan.410 months = 120 random = 60 } # Stand down
			}
		}
	}
	
	option = {
		trigger = {
			NOT = {
				culture = wako
			}
		}
		name = EVTOPTA_JAPAN_409 # Be gone!
	}
	
	option = {
		trigger = {
			culture = wako
		}
		name = EVTOPTB_JAPAN_409 # I don't need them!
	}
}

# Raiders disband
character_event = {
	id = japan.410
	picture = GFX_evt_kraken
	border = GFX_event_normal_frame_war
	desc = EVTDESC_JAPAN_410
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_410 # I don't need them!
		
		any_demesne_title = {
			limit = {
				adventurer = yes
			}
			unsafe_destroy_landed_title = THIS
		}
	}
}



### Shinto-Buddhist conversion

# Shinto -> Buddhist
character_event = {
	id = japan.426
	hide_window = yes
	
	only_playable = yes
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			religion = shinto
			AND = {
				culture_group = japonic
				religion = buddhist
			}
		}
		any_courtier = {
			is_landed = no
			is_adult = yes
			is_inaccessible_or_incapable_trigger = no
			religion = shinto
			culture_group = japonic
			NOT = {
				any_dynasty_member = {
					religion = shinto
					OR = {
						controls_religion = yes
						has_character_flag = temporarily_japanese_imperial
					}
				}
			}
			NOR = {
				trait = zealous
				trait = proud
			}
			NOT = {
				has_character_flag = japanese_religion_switch
			}
			NOT = {
				trait = japanese_monastic_trait
			}
		}
	}
	
	immediate = {
		random_courtier = {
			limit = {
				is_landed = no
				is_adult = yes
				is_inaccessible_or_incapable_trigger = no
				religion = shinto
				culture_group = japonic
				NOT = {
					any_dynasty_member = {
						religion = shinto
						OR = {
							controls_religion = yes
							has_character_flag = temporarily_japanese_imperial
						}
					}
				}
				NOR = {
					trait = zealous
					trait = proud
				}
				NOT = {
					has_character_flag = japanese_religion_switch
				}
				NOT = {
					trait = japanese_monastic_trait
				}
			}
			preferred_limit = {
				OR = {
					trait = cynical
					trait = humble
					true_religion = shinto
				}
			}
			religion = buddhist
			set_character_flag = japanese_religion_switch
		}
	}
}

# Buddhist -> Shinto
character_event = {
	id = japan.427
	hide_window = yes
	
	only_playable = yes
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			religion = shinto
			AND = {
				culture_group = japonic
				religion = buddhist
			}
		}
		any_courtier = {
			is_landed = no
			is_adult = yes
			is_inaccessible_or_incapable_trigger = no
			religion = buddhist
			OR = {
				culture = japanese
				culture = yamato
				culture = wako
			}
			NOR = {
				trait = zealous
				trait = proud
			}
			NOT = {
				has_character_flag = japanese_religion_switch
			}
			NOT = {
				trait = japanese_monastic_trait
			}
			NOR = {
				trait = bhikkhu
				trait = bhikkhuni
			}
		}
	}
	
	immediate = {
		random_courtier = {
			limit = {
				is_landed = no
				is_adult = yes
				is_inaccessible_or_incapable_trigger = no
				religion = buddhist
				OR = {
					culture = japanese
					culture = yamato
					culture = wako
				}
				NOR = {
					trait = zealous
					trait = proud
				}
				NOT = {
					has_character_flag = japanese_religion_switch
				}
				NOT = {
					trait = japanese_monastic_trait
				}
				NOR = {
					trait = bhikkhu
					trait = bhikkhuni
				}
			}
	
			preferred_limit = {
				OR = {
					trait = cynical
					trait = humble
					true_religion = shinto
				}
			}
			religion = shinto
			set_character_flag = japanese_religion_switch
		}
	}
}

##### Kitsune events

### Start + side events for "fakes" + event selection

# Approached by a beautiful woman at night - do you let her stay at your court?
character_event = {
	id = japan.428
	desc = EVTDESC_JAPAN_428
	picture = GFX_evt_sleeping_town_hf
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	only_playable = yes
	
	min_age = 16
	only_capable = yes
	
	trigger = {
		# Would be attracted to her
		OR = {
			AND = {
				is_female = no
				NOT = {
					trait = homosexual
				}
			}
			AND = {
				is_female = yes
				trait = homosexual
			}
		}
		# We are in Japan, are Japonic, or are Shinto
		OR = {
			any_realm_province = {
				OR = {
					region = world_japan # Initial de jure
					region = world_japan_islands # Ryukyu
					region = custom_yezo # Hokkaido
				}
			}
			culture_group = japonic
			religion = shinto
		}
		NOT = {
			any_opinion_modifier_target = {
				has_opinion_modifier = {
					who = Root
					modifier = kitsune_opinion
				}
			}
		}
	}
	
	immediate = {
		if = {
			limit = {
				culture_group = japonic
			}
			create_character = {
				age = 16
				female = yes
				dynasty = none
				culture = ROOT
				religion = shinto
				health = 6
				fertility = 0.8
				attributes = {
					diplomacy = 6
					martial = 2
					stewardship = 1
					intrigue = 6 # Elusive shadow + Shinto add a lot...
					learning = 3
				}
				trait = elusive_shadow
				trait = fair
				trait = lustful
				trait = deceitful
				trait = shrewd
				trait = gregarious
				random_traits = no
			}
		}
		else = {
			create_character = {
				age = 16
				female = yes
				dynasty = none
				culture = japanese
				religion = shinto
				health = 6
				fertility = 0.8
				attributes = {
					diplomacy = 6
					martial = 2
					stewardship = 1
					intrigue = 6 # Elusive shadow + Shinto add a lot...
					learning = 3
				}
				trait = elusive_shadow
				trait = fair
				trait = lustful
				trait = deceitful
				trait = shrewd
				trait = gregarious
				random_traits = no
			}
		}
		new_character = {
			save_event_target_as = new_kitsune_or_not
			set_immune_to_pruning = yes
			set_character_flag = ai_flag_refuse_concubinage
			set_character_flag = ai_flag_refuse_marriage
			set_character_flag = ai_flag_refuse_conversion
			set_character_flag = no_court_invites
			
			# Initial setup of character type
			random_list = {
				1 = {
					modifier = {
						factor = 0
						has_game_rule = {
							name = supernatural_events
							value = off
						}
					}
					modifier = {
						factor = 0
						has_game_rule = {
							name = supernatural_events
							value = on
						}
						ai = yes
					}
					set_character_flag = kitsune_actual_kitsune
					random_list = {
						1 = {
							set_character_flag = kitsune_one_tail
							change_diplomacy = 1
							change_intrigue = 1
						}
						1 = {
							set_character_flag = kitsune_five_tails
							change_diplomacy = 5
							change_intrigue = 5
						}
						1 = {
							set_character_flag = kitsune_seven_tails
							change_diplomacy = 7
							change_intrigue = 7
						}
						1 = {
							set_character_flag = kitsune_nine_tails
							give_nickname = nick_of_the_nine_tails
							change_diplomacy = 9
							change_intrigue = 9
						}
					}
					add_trait = kitsune
					random_list = {
						1 = {
							add_trait = seductress
						}
						1 = {
							add_trait = schemer
						}
						1 = {
							add_trait = mystic
						}
						1 = {
							add_trait = socializer
						}
						1 = {
							add_trait = hedonist
						}
					}						
				}
				1 = {
					set_character_flag = kitsune_chastey_mcchasteface
					remove_trait = lustful
					add_trait = chaste
					random_list = {
						1 = {
							# Nothing
						}
						1 = {
							remove_trait = elusive_shadow
							add_trait = intricate_webweaver
						}
						1 = {
							remove_trait = elusive_shadow
							add_trait = flamboyant_schemer
						}
						1 = {
							remove_trait = elusive_shadow
							add_trait = amateurish_plotter
						}
					}
				}
				1 = {
					set_character_flag = kitsune_thief
					add_trait = greedy
				}
				1 = {
					set_character_flag = kitsune_yandere
					add_trait = wroth
					add_trait = lunatic
				}
				1 = {
					set_character_flag = kitsune_future_nun
					change_learning = 4
					change_diplomacy = -1
					change_intrigue = -2
				}
				1 = {
					set_character_flag = kitsune_ill_girl
					health = -3
				}
				1 = {
					set_character_flag = kitsune_generic_non_kitsune
				}
			}
			
			# Stat randomization
			random_list = {
				1 = {
					modifier = {
						factor = 0
						has_character_flag = kitsune_actual_kitsune
					}
					random_list = {
						1 = {
							change_diplomacy = 2
							change_intrigue = 2
						}
						1 = {
							change_diplomacy = 1
							change_intrigue = 1
						}
					}
				}
				1 = {
					modifier = {
						factor = 0
						has_character_flag = kitsune_chastey_mcchasteface
					}
					random_list = {
						1 = {
							change_diplomacy = -2
							change_intrigue = 2
						}
						1 = {
							change_diplomacy = -1
							change_intrigue = 1
						}
					}
				}
				1 = {
					modifier = {
						factor = 0
						has_character_flag = kitsune_thief
					}
					random_list = {
						1 = {
							change_diplomacy = 2
							change_intrigue = -2
						}
						1 = {
							change_diplomacy = 1
							change_intrigue = -1
						}
					}
				}
				1 = {
					modifier = {
						factor = 0
						has_character_flag = kitsune_yandere
					}
					random_list = {
						1 = {
							change_learning = 2
							change_martial = -2
						}
						1 = {
							change_learning = 1
							change_martial = -1
						}
					}
				}
				1 = {
					modifier = {
						factor = 0
						has_character_flag = kitsune_future_nun
					}
					random_list = {
						1 = {
							change_learning = -2
							change_martial = 2
						}
						1 = {
							change_learning = -1
							change_martial = 1
						}
					}
				}
				1 = {
					modifier = {
						factor = 0
						has_character_flag = kitsune_ill_girl
					}
					random_list = {
						1 = {
							health = 2
						}
						1 = {
							health = 1
						}
						1 = {
							health = -1
						}
						1 = {
							health = -2
						}
					}
				}
				1 = {
					change_stewardship = 2
				}
			}
			
			# Trait randomization
			random_list = {
				1 = {
					add_trait = lunatic
				}
				1 = {
					add_trait = possessed
				}
				1 = {
					add_trait = physician
				}
				1 = {
					add_trait = genius
				}
				1 = {
					modifier = {
						factor = 0
						has_character_flag = kitsune_ill_girl
					}
					add_trait = strong
				}
				1 = {
					modifier = {
						factor = 0
						has_character_flag = kitsune_actual_kitsune
					}
					add_trait = genius
					remove_trait = shrewd
				}
				1 = {
					modifier = {
						factor = 0
						has_character_flag = kitsune_actual_kitsune
					}
					add_trait = quick
					remove_trait = shrewd
				}
				1 = {
					modifier = {
						factor = 0
						has_character_flag = kitsune_actual_kitsune
					}
					add_trait = groomed
					remove_trait = fair
				}
				1 = {
					modifier = {
						factor = 0
						has_character_flag = kitsune_actual_kitsune
					}
					add_trait = hedonist
				}
				1 = {
					modifier = {
						factor = 0
						has_character_flag = kitsune_actual_kitsune
					}
					add_trait = schemer
				}
				1 = {
					modifier = {
						factor = 0
						has_character_flag = kitsune_actual_kitsune
					}
					add_trait = seductress
				}
				1 = {
					modifier = {
						factor = 0
						has_character_flag = kitsune_actual_kitsune
					}
					add_trait = mystic
				}
				1 = {
					modifier = {
						factor = 0
						has_character_flag = kitsune_actual_kitsune
					}
					add_trait = socializer
				}
				1 = {
					add_trait = poet
				}
				1 = {
					add_trait = temperate
				}
				1 = {
					add_trait = diligent
				}
				1 = {
					modifier = {
						factor = 0
						has_character_flag = kitsune_yandere
					}
					add_trait = kind
				}
				1 = {
					modifier = {
						factor = 0
						has_character_flag = kitsune_yandere
					}
					modifier = {
						factor = 0
						has_character_flag = kitsune_actual_kitsune
					}
					modifier = {
						factor = 0
						has_character_flag = kitsune_thief
					}
					add_trait = humble
				}
				1 = {
					modifier = {
						factor = 0
						has_character_flag = kitsune_future_nun
					}
					add_trait = envious
				}
				1 = {
					modifier = {
						factor = 0
						has_character_flag = kitsune_future_nun
					}
					modifier = {
						factor = 0
						has_character_flag = kitsune_ill_girl
					}
					add_trait = wroth
				}
				1 = {
					modifier = {
						factor = 0
						has_character_flag = kitsune_future_nun
					}
					add_trait = proud
				}
				1 = {
					modifier = {
						factor = 0
						has_character_flag = kitsune_future_nun
					}
					add_trait = ambitious
				}
				1 = {
					modifier = {
						factor = 0
						has_character_flag = kitsune_future_nun
					}
					add_trait = arbitrary
				}
				1 = {
					add_trait = brave
				}
				1 = {
					modifier = {
						factor = 0
						has_character_flag = kitsune_yandere
					}
					modifier = {
						factor = 0
						has_character_flag = kitsune_actual_kitsune
					}
					modifier = {
						factor = 0
						has_character_flag = kitsune_thief
					}
					add_trait = content
				}
				1 = {
					modifier = {
						factor = 0
						has_character_flag = kitsune_yandere
					}
					add_trait = craven
				}
				1 = {
					modifier = {
						factor = 0
						has_character_flag = kitsune_future_nun
					}
					modifier = {
						factor = 0
						has_character_flag = kitsune_ill_girl
					}
					add_trait = cruel
				}
				1 = {
					modifier = {
						factor = 0
						has_character_flag = kitsune_future_nun
					}
					add_trait = cynical
				}
				1 = {
					modifier = {
						factor = 0
						has_character_flag = kitsune_actual_kitsune
					}
					modifier = {
						factor = 0
						has_character_flag = kitsune_thief
					}
					add_trait = honest
				}
				1 = {
					modifier = {
						factor = 0
						has_character_flag = kitsune_actual_kitsune
					}
					modifier = {
						factor = 0
						has_character_flag = kitsune_thief
					}
					add_trait = just
				}
				1 = {
					add_trait = paranoid
				}
				1 = {
					modifier = {
						factor = 0
						has_character_flag = kitsune_actual_kitsune
					}
					modifier = {
						factor = 0
						has_character_flag = kitsune_yandere
					}
					add_trait = shy
				}
				1 = {
					modifier = {
						factor = 0
						has_character_flag = kitsune_actual_kitsune
					}
					modifier = {
						factor = 0
						has_character_flag = kitsune_thief
					}
					modifier = {
						factor = 0
						has_character_flag = kitsune_yandere
					}
					add_trait = trusting
				}
				1 = {
					modifier = {
						factor = 0
						has_character_flag = kitsune_future_nun
					}
					add_trait = zealous # Will convert religion...
				}
				1 = {
					add_trait = sympathy_pagans
				}
			}
			
			# Ensure attraction
			if = {
				limit = {
					ROOT = {
						is_female = yes
					}
				}
				add_trait = homosexual
			}
		}
	}
	
	option = {
		name = EVTOPTA_JAPAN_428 # Of course you can stay at my court!
		
		piety = 5
		
		event_target:new_kitsune_or_not = {
			opinion = {
				who = ROOT
				modifier = kitsune_opinion
				years = 1000
			}
			
			character_event = { id = japan.429 days = 30 random = 60 } # Time to become lovers
		}
	}
	
	option = {
		name = EVTOPTB_JAPAN_428 # Begone!
		
		piety = -5
		
		event_target:new_kitsune_or_not = {
			leave_court_and_die_effect = yes
		}
		
		ai_chance = {
			factor = 0
		}
	}
}

# Hidden event to check if she's become a wife or concubine; if so, become lovers right away if possible or skip this step otherwise
character_event = {
	id = japan.429
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				FROM = {
					is_alive = yes
				}
			}
			if = {
				limit = {
					is_inaccessible_or_incapable_trigger = no
					FROM = {
						is_inaccessible_or_incapable_trigger = no
					}
				}
				if = {
					limit = {
						ai = yes
						is_landed = no
					}
					if = {
						limit = {
							is_married = no
							is_consort = no
							FROM = {
								reverse_has_opinion_modifier = {
									who = ROOT
									modifier = kitsune_opinion
								}
								# Is attracted to her
								OR = {
									AND = {
										is_female = no
										NOT = {
											trait = homosexual
										}
									}
									AND = {
										is_female = yes
										trait = homosexual
									}
								}
								NOT = {
									any_lover = {
										character = ROOT
									}
								}
							}
						}
						FROM = {
							character_event = { id = japan.430 } # Pretty kitsune - become lovers?
						}
					}
					else_if = {
						limit = {
							OR = {
								any_spouse = {
									character = FROM
									# Is attracted to her
									OR = {
										AND = {
											is_female = no
											NOT = {
												trait = homosexual
											}
										}
										AND = {
											is_female = yes
											trait = homosexual
										}
									}
									NOT = {
										any_lover = {
											character = ROOT
										}
									}
								}
								any_consort = {
									character = FROM
									# Is attracted to her
									OR = {
										AND = {
											is_female = no
											NOT = {
												trait = homosexual
											}
										}
										AND = {
											is_female = yes
											trait = homosexual
										}
									}
									NOT = {
										any_lover = {
											character = ROOT
										}
									}
								}
							}
						}
						FROM = {
							character_event = { id = japan.434 } # Become lovers
						}
					}
					else = {
						character_event = { id = japan.437 } # Next event
					}
				}
			}
			else = {
				repeat_event = { id = japan.429 days = 30 random = 30 }
			}
		}
	}
}

# Possible kitsune really is pretty - take her as a lover?
character_event = {
	id = japan.430
	desc = EVTDESC_JAPAN_430
	picture = GFX_evt_garden
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_430 # Oh, yes!
		
		piety = -10
		
		if = {
			limit = {
				trait = celibate
			}
			remove_trait = celibate
		}
		if = {
			limit = {
				trait = chaste
			}
			remove_trait = chaste
		}
		
		if = {
			limit = {
				FROM = {
					has_character_flag = kitsune_chastey_mcchasteface
					NOT = {
						trait = lustful
					}
				}
			}
			character_event = { id = japan.431 days = 1 } # Chaste person leaves your court
		}
		else_if = {
			limit = {
				FROM = {
					NOR = {
						has_character_flag = kitsune_actual_kitsune
						has_character_flag = kitsune_thief
						has_character_flag = kitsune_yandere
					}
				}
				ROOT = {
					is_unattractive_trigger = yes
				}
			}
			character_event = { id = japan.431 days = 1 } # If they don't want to sleep with you for some other reason, attractiveness is a factor...
		}
		else = {
			hidden_tooltip = {
				FROM = {
					remove_trait = chaste
				}
			}
			if = {
				limit = {
					ROOT = {
						is_female = yes
					}
				}
				character_event = { id = japan.432 days = 1 } # Lovers
			}
			else = {
				character_event = { id = japan.433 days = 1 } # Lovers and possibly more
			}
		}
		
		ai_chance = {
			factor = 1
			modifier = {
				factor = 0
				OR = {
					trait = chaste
					trait = celibate
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_JAPAN_430 # Nope!
		
		piety = 10
		
		if = {
			limit = {
				trait = lustful
			}
			remove_trait = lustful
		}
		
		FROM = {
			character_event = { id = japan.435 days = 7 random = 7 } # Kitsune/other leaves court
		}
		
		ai_chance = {
			factor = 1
			modifier = {
				factor = 0
				NOR = {
					trait = chaste
					trait = celibate
				}
			}
		}
	}
}

# Not a kitsune - refused seduction and left
character_event = {
	id = japan.431
	desc = EVTDESC_JAPAN_431
	picture = GFX_evt_garden
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_431 # Really?
		
		prestige = -10
		
		FROMFROM = {
			leave_court_effect = yes
			clr_character_flag = ai_flag_refuse_concubinage
			clr_character_flag = ai_flag_refuse_marriage
			clr_character_flag = ai_flag_refuse_conversion
			clr_character_flag = no_court_invites
			remove_opinion = {
				who = ROOT
				modifier = kitsune_opinion
			}
		}
	}
}

# Lovers - you are a woman and thus you can't get further options
character_event = {
	id = japan.432
	desc = EVTDESC_JAPAN_432
	picture = GFX_evt_dark_love
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	immediate = {
		FROMFROM = {
			character_event = { id = japan.437 days = 30 random = 60 } # Next event
		}
	}
	
	option = {
		name = EVTOPTA_JAPAN_432 # That's great!
		
		add_lover = FROMFROM
		FROMFROM = {
			save_event_target_as = sex_partner
		}
		unprotected_sex_effect_event_target = yes
	}
}

# Lovers - become more?
character_event = {
	id = japan.433
	desc = EVTDESC_JAPAN_433
	picture = GFX_evt_dark_love
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	immediate = {
		FROMFROM = {
			character_event = { id = japan.437 days = 30 random = 60 } # Next event
		}
	}
	
	option = {
		name = EVTOPTA_JAPAN_433 # We'll just be lovers...
		
		add_lover = FROMFROM
		FROMFROM = {
			save_event_target_as = sex_partner
		}
		unprotected_sex_effect_event_target = yes
	}
	
	option = {
		trigger = {
			NOT = {
				has_religion_feature = religion_matriarchal
			}
			OR = {
				NOR = {
					religion_group = muslim
					has_religion_feature = religion_harems
					has_religion_feature = religion_feature_zun
					has_religion_feature = religion_feature_tengri
				}
				is_tribal = yes
				is_nomadic = yes
			}
			OR = {
				NOT = {
					num_of_consorts = 3
				}
				NAND = {
					government = eastern_imperial_government
					num_of_consorts = 10
				}
				government = japanese_imperial_government # We'll assume you don't have the full 100 consorts...
				government = chinese_imperial_government # We'll assume you don't have the full 100 consorts...
				government = divine_imperial_government # We'll assume you don't have the full 100 consorts...
			}
		}
		name = EVTOPTB_JAPAN_433 # I'l make her a concubine
		
		add_lover = FROMFROM
		FROMFROM = {
			save_event_target_as = sex_partner
		}
		unprotected_sex_effect_event_target = yes
		add_consort = FROMFROM
	}
	
	option = {
		trigger = {
			NOT = {
				has_religion_feature = religion_matriarchal
			}
			OR = {
				AND = {
					OR = {
						religion_group = muslim
						has_religion_feature = religion_harems
						has_religion_feature = religion_feature_zun
						has_religion_feature = religion_feature_tengri
					}
					is_tribal = no
					is_nomadic = no
					NOT = {
						num_of_spouses = 4
					}
				}
				is_married = no
			}
		}
		name = EVTOPTB_JAPAN_433 # I'l make her a concubine
		
		if = {
			limit = {
				is_betrothed = yes
			}
			break_betrothal = yes # Just to be sure...
		}
		add_lover = FROMFROM
		FROMFROM = {
			save_event_target_as = sex_partner
		}
		unprotected_sex_effect_event_target = yes
		add_spouse = FROMFROM
	}
}

# Already your spouse/concubine - become lovers
character_event = {
	id = japan.434
	desc = EVTDESC_JAPAN_434
	picture = GFX_evt_dark_love
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	immediate = {
		FROM = {
			character_event = { id = japan.437 days = 30 random = 60 } # Next event
		}
	}
	
	option = {
		name = EVTOPTA_JAPAN_434 # This must be love!
		
		add_lover = FROM
		FROMFROM = {
			save_event_target_as = sex_partner
		}
		unprotected_sex_effect_event_target = yes
	}
}

# Ping in case kitsune has become landed/married/etc.
character_event = {
	id = japan.435
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				ai = yes
				is_landed = no
				is_married = no
				is_consort = no
				NOT = {
					any_lover = {
						character = FROM
					}
				}
			}
			FROM = {
				character_event = { id = japan.436 } # Kitsune/other leaves court
			}
		}
	}
}

# Kitsune/other leaves court if not in some kind of intimate relationship
character_event = {
	id = japan.436
	desc = EVTDESC_JAPAN_436
	picture = GFX_evt_upsetting_letter
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_436 # I see...
		
		FROM = {
			leave_court_and_die_effect = yes
		}
	}
}

# See if the advice event needs to be fired
character_event = {
	id = japan.437
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				ai = yes
				is_landed = no
			}
			if = {
				limit = {
					any_opinion_modifier_target = {
						reverse_has_opinion_modifier = {
							who = ROOT
							modifier = kitsune_opinion
						}
						is_alive = yes
					}
				}
				if = {
					limit = {
						is_inaccessible_or_incapable_trigger = no
						any_opinion_modifier_target = {
							reverse_has_opinion_modifier = {
								who = ROOT
								modifier = kitsune_opinion
							}
							is_inaccessible_or_incapable_trigger = no
						}
					}
					random_list = {
						1 = {
							any_opinion_modifier_target = {
								limit = {
									reverse_has_opinion_modifier = {
										who = ROOT
										modifier = kitsune_opinion
									}
								}
								character_event = { id = japan.438 } # Advice
							}
						}
						1 = {
							modifier = {
								factor = 0
								has_character_flag = kitsune_thief
							}
							character_event = { id = japan.442 } # Next event
						}
					}
				}
				else = {
					repeat_event = { id = japan.437 days = 30 random = 30 }
				}
			}
		}
	}
}

# Possible kitsune really is smart - take her advice into consideration?
character_event = {
	id = japan.438
	desc = EVTDESC_JAPAN_438
	picture = GFX_evt_throne_room
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_438 # That seems like a good idea!
		
		if = {
			limit = {
				FROM = {
					has_character_flag = kitsune_thief
				}
			}
			character_event = { id = japan.439 days = 7 random = 7 } # Thief steals money and leaves
		}
		else = {
			character_event = { id = japan.440 days = 7 random = 7 } # Random thief caugt
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = paranoid
			}
		}
	}
	
	option = {
		name = EVTOPTB_JAPAN_438 # I don't think so!
		
		if = {
			limit = {
				FROM = {
					has_character_flag = kitsune_thief
					is_married = no
					is_consort = no
				}
			}
			character_event = { id = japan.441 days = 1 } # Would-be thief leaves
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = trusting
			}
		}
	}
}

# Not a kitsune - thief
character_event = {
	id = japan.439
	desc = EVTDESC_JAPAN_439
	picture = GFX_evt_emissary
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_439 # It was a setup!
		
		prestige = -25
		
		transfer_scaled_wealth = {
			from = ROOT
			to = FROMFROM
			value = 1
			min = 25
			max = 1000
		}
		
		FROMFROM = {
			if = {
				limit = {
					any_lover = {
						character = ROOT
					}
				}
				remove_lover = ROOT
			}
			leave_court_effect = yes
			clr_character_flag = ai_flag_refuse_concubinage
			clr_character_flag = ai_flag_refuse_marriage
			clr_character_flag = ai_flag_refuse_conversion
			clr_character_flag = no_court_invites
			remove_opinion = {
				who = ROOT
				modifier = kitsune_opinion
			}
			add_rival = ROOT
			reverse_opinion = {
				who = ROOT
				modifier = opinion_thief
			}
		}
	}
}

# Advice was good - random thief caught
character_event = {
	id = japan.440
	desc = EVTDESC_JAPAN_440
	picture = GFX_evt_catching_heretic
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	immediate = {
		FROMFROM = {
			character_event = { id = japan.442 days = 30 random = 60 } # Next event
		}
	}
	
	option = {
		name = EVTOPTA_JAPAN_440 # Her advice was good!
		
		prestige = 10
		
		FROMFROM = {
			prestige = 25
		}
	}
}

# Did not take advice into consideration - would-be thief leaves court and ends relationship if not married or a consort
character_event = {
	id = japan.441
	desc = EVTDESC_JAPAN_441
	picture = GFX_evt_upsetting_letter
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_441 # Really?
		
		prestige = -10
		
		FROMFROM = {
			if = {
				limit = {
					any_lover = {
						character = ROOT
					}
				}
				remove_lover = ROOT
			}
			leave_court_effect = yes
			clr_character_flag = ai_flag_refuse_concubinage
			clr_character_flag = ai_flag_refuse_marriage
			clr_character_flag = ai_flag_refuse_conversion
			clr_character_flag = no_court_invites
			remove_opinion = {
				who = ROOT
				modifier = kitsune_opinion
			}
		}
	}
}

# Ping to see if there's a possible yandere target; if not, skip to the next step
character_event = {
	id = japan.442
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				ai = yes
				is_landed = no
			}
			if = {
				limit = {
					any_opinion_modifier_target = {
						reverse_has_opinion_modifier = {
							who = ROOT
							modifier = kitsune_opinion
						}
						is_alive = yes
					}
				}
				if = {
					limit = {
						is_inaccessible_or_incapable_trigger = no
						any_opinion_modifier_target = {
							reverse_has_opinion_modifier = {
								who = ROOT
								modifier = kitsune_opinion
							}
							is_inaccessible_or_incapable_trigger = no
						}
					}
					random_list = {
						1 = {
							modifier = {
								factor = 0
								NOT = {
									has_character_flag = kitsune_yandere
								}
							}
							modifier = {
								factor = 0
								NOT = {
									any_opinion_modifier_target = {
										reverse_has_opinion_modifier = {
											who = ROOT
											modifier = kitsune_opinion
										}
										OR = {
											any_spouse = {
												NOT = {
													character = ROOT
												}
											}
											any_consort = {
												NOT = {
													character = ROOT
												}
											}
											any_lover = {
												NOT = {
													character = ROOT
												}
											}
										}
									}
								}
							}
							any_opinion_modifier_target = {
								limit = {
									reverse_has_opinion_modifier = {
										who = ROOT
										modifier = kitsune_opinion
									}
								}
								save_event_target_as = yandere_obsession
								character_event = { id = japan.443 } # Yandere does her thing
								any_spouse = {
									limit = {
										NOT = {
											character = ROOT
										}
									}
									character_event = { id = japan.444 } # Yandere does her thing
								}
								any_consort = {
									limit = {
										NOT = {
											character = ROOT
										}
									}
									character_event = { id = japan.444 } # Yandere does her thing
								}
								any_lover = {
									limit = {
										NOT = {
											character = ROOT
										}
									}
									character_event = { id = japan.444 } # Yandere does her thing
								}
							}
						}
						1 = {
							modifier = {
								factor = 0
								has_character_flag = kitsune_yandere
							}
							modifier = {
								factor = 0
								NOT = {
									any_opinion_modifier_target = {
										reverse_has_opinion_modifier = {
											who = ROOT
											modifier = kitsune_opinion
										}
										OR = {
											any_spouse = {
												NOT = {
													character = ROOT
												}
											}
											any_consort = {
												NOT = {
													character = ROOT
												}
											}
											any_lover = {
												NOT = {
													character = ROOT
												}
											}
										}
									}
								}
							}
							any_opinion_modifier_target = {
								limit = {
									reverse_has_opinion_modifier = {
										who = ROOT
										modifier = kitsune_opinion
									}
								}
								character_event = { id = japan.445 } # Rivalry
							}
						}
						1 = {
							modifier = {
								factor = 0
								has_character_flag = kitsune_yandere
							}
							character_event = { id = japan.447 } # Next event
						}
						1 = {
							modifier = {
								factor = 0
								NOT = {
									has_character_flag = kitsune_yandere
								}
							}
							repeat_event = { id = japan.442 days = 365 random = 365 } # Keep on yandere-ing!
						}
					}
				}
				else = {
					repeat_event = { id = japan.442 days = 30 random = 30 }
				}
			}
		}
	}
}

# Not a kitsune - yandere
character_event = {
	id = japan.443
	desc = EVTDESC_JAPAN_443
	picture = GFX_evt_staked_hf
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_443 # Off with her head!
		
		remove_lover = FROM
		FROM = {
			death = {
				death_reason = death_execution
				killer = ROOT
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				trait = arbitrary
			}
			modifier = {
				factor = 0.01
				trait = kind
			}
		}
	}
	
	option = {
		name = EVTOPTB_JAPAN_443 # Throw her in a cell!
		
		remove_lover = FROM
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				trait = arbitrary
			}
			modifier = {
				factor = 0.01
				trait = cruel
			}
		}
	}
	
	option = {
		name = EVTOPTC_JAPAN_443 # She's the only one for me!
	
		FROM = {
			if = {
				limit = {
					NOT = {
						any_lover = {
							character = ROOT
						}
					}
				}
				add_lover = ROOT
			}
			ROOT = {
				save_event_target_as = sex_partner
			}
			unprotected_sex_effect_event_target = yes
			character_event = { id = japan.442 days = 365 random = 365 } # Yandere must keep on yandere-ing!
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = just
			}
		}
	}
}

# Inform anyone killed by yandere
character_event = {
	id = japan.444
	desc = EVTDESC_JAPAN_444
	picture = GFX_evt_staked_hf
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_444 # No! Get away from me!
		
		hidden_tooltip = {
			save_event_target_as = target_victim
			FROM = { character_event = { id = 10 } } # Consequences of discovery
			clear_event_target = target_victim
		}
		death = {
			death_reason = death_murder
			killer = FROM
		}
	}
}

# Rivalry with your spouse/concubine/lover
character_event = {
	id = japan.445
	desc = EVTDESC_JAPAN_445
	picture = GFX_evt_quarrel
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	immediate = {
		random_list = {
			1 = {
				modifier = {
					factor = 0
					NOT = {
						any_spouse = {
							NOT = {
								character = FROM
							}
						}
					}
				}
				random_spouse = {
					limit = {
						NOT = {
							character = FROM
						}
					}
					save_event_target_as = kitsune_rival
					character_event = { id = japan.446 }
				}
			}
			1 = {
				modifier = {
					factor = 0
					NOT = {
						any_consort = {
							NOT = {
								character = FROM
							}
						}
					}
				}
				random_consort = {
					limit = {
						NOT = {
							character = FROM
						}
					}
					save_event_target_as = kitsune_rival
					character_event = { id = japan.446 }
				}
			}
			1 = {
				modifier = {
					factor = 0
					NOT = {
						any_lover = {
							NOT = {
								character = FROM
							}
						}
					}
				}
				random_lover = {
					limit = {
						NOT = {
							character = FROM
						}
					}
					save_event_target_as = kitsune_rival
					character_event = { id = japan.446 }
				}
			}
		}
	}
	
	option = {
		name = EVTOPTA_JAPAN_445 # I see...
	}
}

# Inform rival
character_event = {
	id = japan.446
	desc = EVTDESC_JAPAN_446
	picture = GFX_evt_quarrel
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_446 # I hate you too!
		
		add_rival = FROMFROM
	}
}

# Ping to see if Buddhist nun or ill girl option is on the table
character_event = {
	id = japan.447
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				ai = yes
				is_landed = no
			}
			if = {
				limit = {
					any_opinion_modifier_target = {
						reverse_has_opinion_modifier = {
							who = ROOT
							modifier = kitsune_opinion
						}
						is_alive = yes
					}
				}
				if = {
					limit = {
						is_inaccessible_or_incapable_trigger = no
						any_opinion_modifier_target = {
							reverse_has_opinion_modifier = {
								who = ROOT
								modifier = kitsune_opinion
							}
							is_inaccessible_or_incapable_trigger = no
						}
					}
					if = {
						limit = {
							has_character_flag = kitsune_future_nun
							NAND = {
								NOT = {
									true_religion = buddhist
								}
								trait = zealous
							}
						}
						any_opinion_modifier_target = {
							limit = {
								reverse_has_opinion_modifier = {
									who = ROOT
									modifier = kitsune_opinion
								}
							}
							character_event = { id = japan.448 } # Ask to become a nun
						}
					}
					else_if = {
						limit = {
							has_character_flag = kitsune_ill_girl
						}
						any_opinion_modifier_target = {
							limit = {
								reverse_has_opinion_modifier = {
									who = ROOT
									modifier = kitsune_opinion
								}
							}
							character_event = { id = japan.451 } # Ill girl is ill
						}
					}
					else = {
						character_event = { id = japan.453 }
					}
				}
				else = {
					repeat_event = { id = japan.447 days = 30 random = 30 }
				}
			}
		}
	}
}

# Not a kitsune - asks to become a Buddhist nun
character_event = {
	id = japan.448
	desc = EVTDESC_JAPAN_448
	picture = GFX_evt_emissary
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_448 # If that is your wish...
		
		if = {
			limit = {
				any_lover = {
					character = FROM
				}
			}
			remove_lover = FROM
		}
		
		FROM = {
			if = {
				limit = {
					is_married = yes
				}
				any_spouse = {
					remove_spouse = FROM
				}
			}
			if = {
				limit = {
					is_consort = yes
				}
				any_consort = {
					remove_consort = FROM
				}
			}
			if = {
				limit = {
					is_betrothed = yes
				}
				break_betrothal = yes
			}
			religion = buddhist
			add_trait = bhikkhuni
			clr_character_flag = ai_flag_refuse_concubinage
			clr_character_flag = ai_flag_refuse_marriage
			clr_character_flag = ai_flag_refuse_conversion
			clr_character_flag = no_court_invites
			remove_opinion = {
				who = ROOT
				modifier = kitsune_opinion
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = zealous
				NOT = {
					true_religion = buddhist
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_JAPAN_448 # I forbid it!
		
		if = {
			limit = {
				religion = buddhist
			}
			piety = -10
		}
		
		if = {
			limit = {
				FROM = {
					OR = {
						is_married = yes
						is_consort = yes
					}
				}
			}
			character_event = { id = japan.449 days = 7 random = 7 }
		}
		else = {
			character_event = { id = japan.450 days = 1 }
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				true_religion = buddhist
			}
			modifier = {
				factor = 0
				true_religion = buddhist
				trait = zealous
			}
		}
	}
}

# Refused to let her become a nun - stop being lovers
character_event = {
	id = japan.449
	desc = EVTDESC_JAPAN_449
	picture = GFX_evt_quarrel
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_449 # I see...
		
		remove_lover = FROMFROM
	}
}

# Refused to let her become a nun - would-be nun leaves court and ends relationship if not married or a consort
character_event = {
	id = japan.450
	desc = EVTDESC_JAPAN_450
	picture = GFX_evt_upsetting_letter
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_450 # I see...
		
		remove_lover = FROMFROM
		
		FROMFROM = {
			religion = buddhist
			add_trait = bhikkhuni
			leave_court_effect = yes
			clr_character_flag = ai_flag_refuse_concubinage
			clr_character_flag = ai_flag_refuse_marriage
			clr_character_flag = ai_flag_refuse_conversion
			clr_character_flag = no_court_invites
			remove_opinion = {
				who = ROOT
				modifier = kitsune_opinion
			}
		}
	}
}

# Not a kitsune - ill girl is ill
character_event = {
	id = japan.451
	desc = EVTDESC_JAPAN_451
	picture = GFX_evt_illness
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_451 # Poor thing!
		
		FROM = {
			if = {
				limit = {
					has_dlc = "Reapers"
				}
				random_list = {
					1 = {
						give_pneumonic_effect = yes
					}
					1 = {
						give_flu_effect = yes
					}
					1 = {
						give_food_poisoning_effect = yes
					}
				}
			}
			else = {
				add_trait = ill
			}
		}
		
		FROM = {
			character_event = { id = japan.452 days = 180 random = 180 }
		}
	}
}

# Hidden event for ill girl to become ill again
character_event = {
	id = japan.452
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				ai = yes
				is_landed = no
				is_ill = no
			}
			if = {
				limit = {
					FROM = {
						is_alive = yes
					}
				}
				if = {
					limit = {
						is_inaccessible_or_incapable_trigger = no
						FROM = {
							is_inaccessible_or_incapable_trigger = no
						}
					}
					FROM = {
						character_event = { id = japan.451 } # Ill girl is ill
					}
				}
				else = {
					repeat_event = { id = japan.452 days = 180 random = 180 }
				}
			}
		}
	}
}

# Let's see if we've actually got a kitsune and go to event selection if so
character_event = {
	id = japan.453
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				has_any_opinion_modifier = kitsune_opinion
				has_character_flag = kitsune_actual_kitsune
			}
			any_opinion_modifier_target = {
				limit = {
					reverse_has_opinion_modifier = {
						who = ROOT
						modifier = kitsune_opinion
					}
				}
				save_event_target_as = kitsune_target
			}
			character_event = { id = japan.454 } # Actual kitsune events
		}
	}
}

### Actual kitsune events

# Kitsune event selection
character_event = {
	id = japan.454
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		random_list = {
			1 = {
				modifier = {
					factor = 0
					has_character_flag = kitsune_nine_tails
				}
				character_event = { id = japan.455 } # Kitsune gets another tail
			}
			10 = {
				modifier = {
					factor = 0
					NAND = {
						trait = elusive_shadow
						trait = fair
						NOT = {
							trait = celibate
						}
						trait = lustful
						trait = deceitful
						trait = shrewd
						trait = gregarious
					}
				}
				character_event = { id = japan.456 } # Kitsune's traits change back
			}
			10 = {
				modifier = {
					factor = 0
					NOT = {
						any_lover = {
							event_target:kitsune_target = {
								NOT = {
									character = PREV
								}
							}
						}
					}
				}
				modifier = {
					factor = 0
					event_target:kitsune_target = {
						is_alive = no
					}
				}
				character_event = { id = japan.457 } # Kitsune discards irrlevant lovers
			}
			10 = {
				modifier = {
					factor = 0
					NOT = {
						event_target:kitsune_target = {
							is_inaccessible_or_incapable_trigger = no
							any_rival = {
								character = ROOT
							}
						}
					}
				}
				modifier = {
					factor = 0
					event_target:kitsune_target = {
						is_alive = no
					}
				}
				character_event = { id = japan.459 } # Kitsune stops being a rival of her target
			}
			10 = {
				modifier = {
					factor = 0
					NAND = {
						event_target:kitsune_target = {
							is_inaccessible_or_incapable_trigger = no
							NOT = {
								any_lover = {
									character = ROOT
								}
							}
							OR = {
								NOT = {
									trait = homosexual
								}
								is_female = yes
							}
						}
						ROOT = {
							OR = {
								NOT = {
									trait = homosexual
								}
								event_target:kitsune_target = {
									is_female = yes
								}
							}
						}
					}
				}
				modifier = {
					factor = 0
					event_target:kitsune_target = {
						is_alive = no
					}
				}
				character_event = { id = japan.461 } # Kitsune and target fall in love again
			}
			10 = {
				modifier = {
					factor = 0
					NOT = {
						event_target:kitsune_target = {
							OR = {
								any_spouse = {
									is_inaccessible_or_incapable_trigger = no
									NOT = {
										character = ROOT
									}
								}
								any_consort = {
									is_inaccessible_or_incapable_trigger = no
									NOT = {
										character = ROOT
									}
								}
								any_lover = {
									is_inaccessible_or_incapable_trigger = no
									NOT = {
										character = ROOT
									}
								}
							}
						}
					}
				}
				modifier = {
					factor = 0
					event_target:kitsune_target = {
						is_alive = no
					}
				}
				character_event = { id = japan.463 } # Kitsune removes "obstacles"
			}
			10 = {
				modifier = {
					factor = 0
					NOT = {
						event_target:kitsune_target = {
							is_inaccessible_or_incapable_trigger = no
							is_landed = yes
						}
					}
				}
				modifier = {
					factor = 0
					event_target:kitsune_target = {
						is_alive = no
					}
				}
				character_event = { id = japan.466 } # Kitsune impresses courtier
			}
			10 = {
				modifier = {
					factor = 0
					NOT = {
						event_target:kitsune_target = {
							is_inaccessible_or_incapable_trigger = no
							is_landed = yes
						}
					}
				}
				modifier = {
					factor = 0
					event_target:kitsune_target = {
						is_alive = no
					}
				}
				character_event = { id = japan.469 } # Kitsune slips up
			}
			10 = {
				modifier = {
					factor = 0
					NOT = {
						event_target:kitsune_target = {
							is_inaccessible_or_incapable_trigger = no
							is_landed = yes
						}
					}
				}
				modifier = {
					factor = 0
					NOT = {
						age = 40
					}
				}
				modifier = {
					factor = 10
					age = 80
				}
				modifier = {
					factor = 0
					event_target:kitsune_target = {
						is_alive = no
					}
				}
				event_target:kitsune_target = {
					character_event = { id = japan.482 } # Kitsune looks far too young
				}
			}
			10 = {
				modifier = {
					factor = 0
					NOT = {
						event_target:kitsune_target = {
							is_alive = yes
							is_inaccessible_or_incapable_trigger = no
						}
					}
				}
				modifier = {
					factor = 0
					event_target:kitsune_target = {
						is_alive = no
					}
				}
				character_event = { id = japan.489 } # Kitsune makes target ill
			}
			10 = {
				modifier = {
					factor = 0
					NOT = {
						any_child = {
							is_inaccessible_or_incapable_trigger = yes
							is_alive = yes
							is_adult = no
							NOT = {
								has_character_flag = kitsune_lesson
							}
						}
					}
				}
				character_event = { id = japan.491 } # Kitsune gives her child a lesson
			}
			10 = {
				character_event = { id = japan.493 } # Kitsune is visited by foxes
			}
			10 = {
				character_event = { id = japan.495 } # Kitsune visits someone's dreams
			}
			10 = {
				modifier = {
					factor = 0
					NOT = {
						event_target:kitsune_target = {
							is_alive = yes
							is_inaccessible_or_incapable_trigger = no
						}
					}
				}
				modifier = {
					factor = 0
					trait = celibate
				}
				modifier = {
					factor = 0
					event_target:kitsune_target = {
						is_alive = no
					}
				}
				character_event = { id = japan.497 } # Kitsune feeds on sex
			}
			10 = {
				modifier = {
					factor = 0
					NOT = {
						top_liege = {
							any_realm_lord = {
								is_theocracy = yes
								NOT = {
									any_rival = {
										character = ROOT
									}
								}
							}
						}
					}
				}
				character_event = { id = japan.499 } # Kitsune disliks priest
			}
			10 = {
				modifier = {
					factor = 0
					NOT = {
						top_liege = {
							any_realm_lord = {
								is_theocracy = yes
								any_rival = {
									character = ROOT
								}
							}
						}
					}
				}
				character_event = { id = japan.501 } # Kitsune kills priest
			}
			100 = {
				modifier = {
					factor = 0
					NOT = {
						prisoner = yes
					}
				}
				character_event = { id = japan.503 } # Kitsune escapes prison
			}
			100 = {}
		}
		repeat_event = { id = japan.454 days = 365 random = 365 }
	}
}

# Kitsune gets another tail
character_event = {
	id = japan.455
	desc = EVTDESC_JAPAN_455
	picture = GFX_evt_religious_exultation
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_455 # My power grows!
		
		if = {
			limit = {
				has_character_flag = kitsune_eight_tails
			}
			clr_character_flag = kitsune_eight_tails
			set_character_flag = kitsune_nine_tails
			if = {
				limit = {
					this_has_super_cool_nickname_trigger = no
				}
				give_nickname = nick_of_the_nine_tails
			}
		}
		else_if = {
			limit = {
				has_character_flag = kitsune_seven_tails
			}
			clr_character_flag = kitsune_seven_tails
			set_character_flag = kitsune_eight_tails
		}
		else_if = {
			limit = {
				has_character_flag = kitsune_six_tails
			}
			clr_character_flag = kitsune_six_tails
			set_character_flag = kitsune_seven_tails
		}
		else_if = {
			limit = {
				has_character_flag = kitsune_five_tails
			}
			clr_character_flag = kitsune_five_tails
			set_character_flag = kitsune_six_tails
		}
		else_if = {
			limit = {
				has_character_flag = kitsune_four_tails
			}
			clr_character_flag = kitsune_four_tails
			set_character_flag = kitsune_five_tails
		}
		else_if = {
			limit = {
				has_character_flag = kitsune_three_tails
			}
			clr_character_flag = kitsune_three_tails
			set_character_flag = kitsune_four_tails
		}
		else_if = {
			limit = {
				has_character_flag = kitsune_two_tails
			}
			clr_character_flag = kitsune_two_tails
			set_character_flag = kitsune_three_tails
		}
		else = {
			clr_character_flag = kitsune_one_tail
			set_character_flag = kitsune_two_tails
		}
		
		change_diplomacy = 1
		change_intrigue = 1
	}
}

# Kitsune becomes more kitsune-like if her traits have changed too much
character_event = {
	id = japan.456
	desc = EVTDESC_JAPAN_456
	picture = GFX_evt_dark_love
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_456 # My true nature cannot remain hidden!
		
		if = {
			limit = {
				NOT = {
					trait = elusive_shadow
				}
			}
			remove_education_effect = yes
			add_trait = elusive_shadow
		}
		
		remove_all_negative_congenital_traits_effect = yes
		
		if = {
			limit = {
				NOT = {
					trait = fair
				}
			}
			add_trait = fair
		}
		if = {
			limit = {
				NOT = {
					trait = celibate
				}
			}
			remove_trait = celibate
		}
		if = {
			limit = {
				NOT = {
					trait = lustful
				}
			}
			add_trait = lustful
		}
		if = {
			limit = {
				NOT = {
					trait = deceitful
				}
			}
			add_trait = deceitful
		}
		if = {
			limit = {
				NOT = {
					trait = shrewd
				}
			}
			add_trait = shrewd
		}
		if = {
			limit = {
				NOT = {
					trait = gregarious
				}
			}
			add_trait = gregarious
		}
	}
}

# Kitsune discards lovers that aren't her target
character_event = {
	id = japan.457
	desc = EVTDESC_JAPAN_457
	picture = GFX_evt_dark_love
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_457 # I need to remain focused!
		
		any_lover = {
			limit = {
				NOT = {
					reverse_has_opinion_modifier = {
						who = ROOT
						modifier = kitsune_opinion
					}
				}
			}
			remove_lover = ROOT
			character_event = { id = japan.458 }
		}
	}
}

# Lovers notified
character_event = {
	id = japan.458
	desc = EVTDESC_JAPAN_458
	picture = GFX_evt_upsetting_letter
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_458 # I see...
		
		remove_lover = FROM
	}
}

# If a rival with your target, lose that
character_event = {
	id = japan.459
	desc = EVTDESC_JAPAN_459
	picture = GFX_evt_dark_love
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_459 # I need to remain focused!
		
		any_rival = {
			limit = {
				reverse_has_opinion_modifier = {
					who = ROOT
					modifier = kitsune_opinion
				}
			}
			remove_rival = ROOT
			character_event = { id = japan.460 }
		}
	}
}

# Target notified
character_event = {
	id = japan.460
	desc = EVTDESC_JAPAN_460
	picture = GFX_evt_dark_love
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_460 # It was just a misunderstanding!
		
		remove_rival = FROM
	}
}

# If possible, become lovers with your target again
character_event = {
	id = japan.461
	desc = EVTDESC_JAPAN_461
	picture = GFX_evt_dark_love
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_461 # I need to remain focused!
		
		event_target:kitsune_target = {
			add_lover = ROOT
			character_event = { id = japan.462 }
		}
	}
}

# Target notified
character_event = {
	id = japan.462
	desc = EVTDESC_JAPAN_462
	picture = GFX_evt_dark_love
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_462 # It was just a misunderstanding!
		
		add_lover = FROM
	}
}

# Kitsune might arrange for an accident for a spouse/concubine/lover of their target
character_event = {
	id = japan.463
	desc = EVTDESC_JAPAN_463
	picture = GFX_evt_shadow
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	immediate = {
		event_target:kitsune_target = {
			random_list = {
				1 = {
					modifier = {
						factor = 0
						NOT = {
							any_spouse = {
								NOT = {
									character = ROOT
								}
							}
						}
					}
					random_spouse = {
						limit = {
							NOT = {
								character = ROOT
							}
						}
						save_event_target_as = kitsune_rival
					}
				}
				1 = {
					modifier = {
						factor = 0
						NOT = {
							any_consort = {
								NOT = {
									character = ROOT
								}
							}
						}
					}
					random_consort = {
						limit = {
							NOT = {
								character = ROOT
							}
						}
						save_event_target_as = kitsune_rival
					}
				}
				1 = {
					modifier = {
						factor = 0
						NOT = {
							any_lover = {
								NOT = {
									character = ROOT
								}
							}
						}
					}
					random_lover = {
						limit = {
							NOT = {
								character = ROOT
							}
						}
						save_event_target_as = kitsune_rival
					}
				}
			}
		}
	}
	
	option = {
		name = EVTOPTA_JAPAN_463 # Yes!
		
		event_target:kitsune_rival = {
			character_event = { id = japan.464 } # Inform victim
		}
		
		event_target:kitsune_target = {
			character_event = { id = japan.465 } # Inform target
		}
	}
	
	option = {
		name = EVTOPTB_JAPAN_463 # No!
		
		ai_chance = {
			factor = 0
		}
	}
}

# Victim dies
character_event = {
	id = japan.464
	desc = EVTDESC_JAPAN_464
	picture = GFX_evt_shadow
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_464 # You? No!
		
		death = {
			death_reason = death_murder_unknown
			killer = FROM
		}
	}
}

# Target notified
character_event = {
	id = japan.465
	desc = EVTDESC_JAPAN_465
	picture = GFX_evt_emissary
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_465 # Who could have done this...?
	}
}

# Kitsune impresses courtier
character_event = {
	id = japan.466
	desc = EVTDESC_JAPAN_466
	picture = GFX_evt_garden
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	immediate = {
		event_target:kitsune_target = {
			random_courtier_or_vassal = {
				limit = {
					is_inaccessible_or_incapable_trigger = no
				}
				save_event_target_as = kitsune_courtier
			}
		}
	}
	
	option = {
		name = EVTOPTA_JAPAN_466 # Great!
		
		prestige = 25
		
		event_target:kitsune_courtier = {
			character_event = { id = japan.467 }
		}
	}
}

# Courtier notified
character_event = {
	id = japan.467
	desc = EVTDESC_JAPAN_467
	picture = GFX_evt_garden
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_467 # She sure is well-spoken!
		
		event_target:kitsune_target = {
			character_event = { id = japan.468 }
		}
	}
}

# Target notified
character_event = {
	id = japan.468
	desc = EVTDESC_JAPAN_468
	picture = GFX_evt_garden
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_468 # That's good to hear!
	}
}

# Kitsune makes courtier suspicious
character_event = {
	id = japan.469
	desc = EVTDESC_JAPAN_469
	picture = GFX_evt_garden
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	immediate = {
		event_target:kitsune_target = {
			random_courtier_or_vassal = {
				limit = {
					is_inaccessible_or_incapable_trigger = no
					NOR = {
						any_spouse = {
							character = ROOT
						}
						any_consort = {
							character = ROOT
						}
						any_lover = {
							character = ROOT
						}
					}
				}
				preferred_limit = {
					intrigue = 20
				}
				preferred_limit = {
					trait = mystic
				}
				preferred_limit = {
					is_smart_trigger = yes
				}
				save_event_target_as = kitsune_courtier
			}
		}
	}
	
	option = {
		name = EVTOPTA_JAPAN_469 # I was perhaps a bit careless...
		
		prestige = -10
		
		event_target:kitsune_courtier = {
			character_event = { id = japan.470 } # Informed that kitsune is suspicious
		}
	}
}

# Kitsune is suspicious - inform target?
character_event = {
	id = japan.470
	desc = EVTDESC_JAPAN_470
	picture = GFX_evt_garden
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	
	option = {
		name = EVTOPTA_JAPAN_470 # Yes!
		
		FROM = {
			event_target:kitsune_target = {
				character_event = { id = japan.471 } # Inform target
			}
		}
		
		add_rival = FROM
	}
	
	option = {
		name = EVTOPTB_JAPAN_463 # No!
		
		ai_chance = {
			factor = 0
		}
	}
}

# Target notified - might ignore or confront
character_event = {
	id = japan.471
	desc = EVTDESC_JAPAN_471
	picture = GFX_evt_emissary
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	
	option = {
		name = EVTOPTA_JAPAN_471 # I don't believe you!
		
		FROM = {
			character_event = { id = japan.472 days = 1 }
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = paranoid
			}
		}
	}
	
	option = {
		name = EVTOPTB_JAPAN_471 # I will confront her!
		
		FROMFROM = {
			character_event = { id = japan.473 days = 1 }
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = trusting
			}
		}
	}
}

# Inform courtier that they were ignored
character_event = {
	id = japan.472
	desc = EVTDESC_JAPAN_472
	picture = GFX_evt_upsetting_letter
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_472 # I see...
		
		prestige = -25
	}
}

# Kitsune confronted - charm target?
character_event = {
	id = japan.473
	desc = EVTDESC_JAPAN_473
	picture = GFX_evt_quarrel
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	
	option = {
		name = EVTOPTA_JAPAN_473 # This is no longer funny!
		
		FROM = {
			character_event = { id = japan.474 days = 1 }
		}
		
		leave_court_and_die_effect = yes
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				FROM = {
					trait = trusting
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_JAPAN_473 # Time to turn on the charm!
		
		random_list = {
			50 = {
				modifier = {
					factor = 256
					has_character_flag = kitsune_nine_tails
				}
				modifier = {
					factor = 128
					has_character_flag = kitsune_eight_tails
				}
				modifier = {
					factor = 64
					has_character_flag = kitsune_seven_tails
				}
				modifier = {
					factor = 32
					has_character_flag = kitsune_six_tails
				}
				modifier = {
					factor = 16
					has_character_flag = kitsune_five_tails
				}
				modifier = {
					factor = 8
					has_character_flag = kitsune_four_tails
				}
				modifier = {
					factor = 4
					has_character_flag = kitsune_three_tails
				}
				modifier = {
					factor = 2
					has_character_flag = kitsune_two_tails
				}
				modifier = {
					factor = 2
					intrigue = 40
				}
				modifier = {
					factor = 2
					intrigue = 36
				}
				modifier = {
					factor = 2
					intrigue = 32
				}
				modifier = {
					factor = 2
					intrigue = 28
				}
				modifier = {
					factor = 2
					intrigue = 24
				}
				modifier = {
					factor = 2
					intrigue = 20
				}
				modifier = {
					factor = 2
					intrigue = 12
				}
				character_event = { id = japan.476 days = 1 } # Target charmed
			}
			50 = {
				modifier = {
					factor = 2
					FROM = {
						intrigue = 40
					}
				}
				modifier = {
					factor = 2
					FROM = {
						intrigue = 36
					}
				}
				modifier = {
					factor = 2
					FROM = {
						intrigue = 32
					}
				}
				modifier = {
					factor = 2
					FROM = {
						intrigue = 28
					}
				}
				modifier = {
					factor = 2
					FROM = {
						intrigue = 24
					}
				}
				modifier = {
					factor = 2
					FROM = {
						intrigue = 20
					}
				}
				modifier = {
					factor = 2
					FROM = {
						intrigue = 16
					}
				}
				character_event = { id = japan.479 days = 1 } # Target not charmed
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = honest
			}
		}
	}
}

# Kitsune elected to flee - inform target
character_event = {
	id = japan.474
	desc = EVTDESC_JAPAN_474
	picture = GFX_evt_quarrel
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_474 # She *was* a kitsune!
		
		FROMFROMFROM = {
			character_event = { id = japan.475 }
		}
		
		prestige = -10
	}
}

# Inform courtier that they've been vindicated
character_event = {
	id = japan.475
	desc = EVTDESC_JAPAN_475
	picture = GFX_evt_emissary
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_475 # Told you!
		
		prestige = 25
	}
}

# Target charmed
character_event = {
	id = japan.476
	desc = EVTDESC_JAPAN_476
	picture = GFX_evt_dark_love
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_476 # Child's play!
		
		prestige = 25
		
		FROMFROM = {
			character_event = { id = japan.477 }
		}
	}
}

# Inform target
character_event = {
	id = japan.477
	desc = EVTDESC_JAPAN_477
	picture = GFX_evt_dark_love
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_477 # She's the most trustworthiest human ever!
		
		prestige = -10
		
		FROMFROMFROMFROM = {
			character_event = { id = japan.478 }
		}
	}
}

# Inform suspicious courtier that they've been discredited
character_event = {
	id = japan.478
	desc = EVTDESC_JAPAN_478
	picture = GFX_evt_upsetting_letter
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_478 # I see...
		
		prestige = -25
	}
}

# Target not charmed - time to flee!
character_event = {
	id = japan.479
	desc = EVTDESC_JAPAN_479
	picture = GFX_evt_quarrel
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	
	option = {
		name = EVTOPTA_JAPAN_479 # This is no longer funny!
		
		FROMFROM = {
			character_event = { id = japan.480 }
		}
		
		leave_court_and_die_effect = yes
	}
}

# Inform target
character_event = {
	id = japan.480
	desc = EVTDESC_JAPAN_480
	picture = GFX_evt_quarrel
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_480 # She *was* a kitsune!
		
		FROMFROMFROM = {
			character_event = { id = japan.481 }
		}
		
		prestige = -10
	}
}

# Inform courtier that they've been vindicated
character_event = {
	id = japan.481
	desc = EVTDESC_JAPAN_481
	picture = GFX_evt_emissary
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_481 # Told you!
		
		prestige = 25
	}
}

# Kitsune is old but doesn't look like it - confront her?
character_event = {
	id = japan.482
	desc = EVTDESC_JAPAN_482
	picture = GFX_evt_garden
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	
	option = {
		name = EVTOPTA_JAPAN_482 # I'm imagining things...
		
		prestige = -10
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = paranoid
			}
		}
	}
	
	option = {
		name = EVTOPTB_JAPAN_482 # I will confront her!
		
		FROM = {
			character_event = { id = japan.483 days = 1 }
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = trusting
			}
		}
	}
}

# Confronted - charm target?
character_event = {
	id = japan.483
	desc = EVTDESC_JAPAN_483
	picture = GFX_evt_quarrel
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	
	option = {
		name = EVTOPTA_JAPAN_483 # This is no longer funny!
		
		FROM = {
			character_event = { id = japan.484 days = 1 }
		}
		
		leave_court_and_die_effect = yes
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				FROM = {
					trait = trusting
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_JAPAN_483 # Time to turn on the charm!
		
		random_list = {
			50 = {
				modifier = {
					factor = 256
					has_character_flag = kitsune_nine_tails
				}
				modifier = {
					factor = 128
					has_character_flag = kitsune_eight_tails
				}
				modifier = {
					factor = 64
					has_character_flag = kitsune_seven_tails
				}
				modifier = {
					factor = 32
					has_character_flag = kitsune_six_tails
				}
				modifier = {
					factor = 16
					has_character_flag = kitsune_five_tails
				}
				modifier = {
					factor = 8
					has_character_flag = kitsune_four_tails
				}
				modifier = {
					factor = 4
					has_character_flag = kitsune_three_tails
				}
				modifier = {
					factor = 2
					has_character_flag = kitsune_two_tails
				}
				modifier = {
					factor = 2
					intrigue = 40
				}
				modifier = {
					factor = 2
					intrigue = 36
				}
				modifier = {
					factor = 2
					intrigue = 32
				}
				modifier = {
					factor = 2
					intrigue = 28
				}
				modifier = {
					factor = 2
					intrigue = 24
				}
				modifier = {
					factor = 2
					intrigue = 20
				}
				modifier = {
					factor = 2
					intrigue = 12
				}
				character_event = { id = japan.485 days = 1 } # Target charmed
			}
			50 = {
				modifier = {
					factor = 2
					FROM = {
						intrigue = 40
					}
				}
				modifier = {
					factor = 2
					FROM = {
						intrigue = 36
					}
				}
				modifier = {
					factor = 2
					FROM = {
						intrigue = 32
					}
				}
				modifier = {
					factor = 2
					FROM = {
						intrigue = 28
					}
				}
				modifier = {
					factor = 2
					FROM = {
						intrigue = 24
					}
				}
				modifier = {
					factor = 2
					FROM = {
						intrigue = 20
					}
				}
				modifier = {
					factor = 2
					FROM = {
						intrigue = 16
					}
				}
				character_event = { id = japan.487 days = 1 } # Target not charmed
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = honest
			}
		}
	}
}

# Kitsune fled - inform target
character_event = {
	id = japan.484
	desc = EVTDESC_JAPAN_484
	picture = GFX_evt_quarrel
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_484 # She *was* a kitsune!
		
		prestige = 25
	}
}

# Target charmed
character_event = {
	id = japan.485
	desc = EVTDESC_JAPAN_485
	picture = GFX_evt_dark_love
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_485 # Child's play!
		
		prestige = 25
		
		FROMFROM = {
			character_event = { id = japan.486 }
		}
	}
}

# Inform target
character_event = {
	id = japan.486
	desc = EVTDESC_JAPAN_486
	picture = GFX_evt_dark_love
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_486 # She's the most trustworthiest human ever!
		
		prestige = -25
	}
}

# Target not charmed - time to flee!
character_event = {
	id = japan.487
	desc = EVTDESC_JAPAN_487
	picture = GFX_evt_quarrel
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	
	option = {
		name = EVTOPTA_JAPAN_487 # This is no longer funny!
		
		FROMFROM = {
			character_event = { id = japan.488 }
		}
		
		leave_court_and_die_effect = yes
	}
}

# Inform target
character_event = {
	id = japan.488
	desc = EVTDESC_JAPAN_488
	picture = GFX_evt_quarrel
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_488 # She *was* a kitsune!
		
		prestige = 25
	}
}

# Curse target to be ill?
character_event = {
	id = japan.489
	desc = EVTDESC_JAPAN_489
	picture = GFX_evt_dark_love
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_489 # Yes!
		
		event_target:kitsune_target = {
			character_event = { id = japan.490 } # Inform target
		}
	}
	
	option = {
		name = EVTOPTB_JAPAN_489 # No!
		
		ai_chance = {
			factor = 0
		}
	}
}

# Target becomes ill
character_event = {
	id = japan.490
	desc = EVTDESC_JAPAN_490
	picture = GFX_evt_illness
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_490 # I don't feel so good...
		
		if = {
			limit = {
				has_dlc = "Reapers"
			}
			random_list = {
				1 = {
					give_pneumonic_effect = yes
				}
				1 = {
					give_flu_effect = yes
				}
				1 = {
					give_food_poisoning_effect = yes
				}
			}
		}
		else = {
			add_trait = ill
		}
	}
}

# Kitsune teaches her child a few tricks
character_event = {
	id = japan.491
	desc = EVTDESC_JAPAN_491
	picture = GFX_evt_garden
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	immediate = {
		random_child = {
			limit = {
				is_inaccessible_or_incapable_trigger = yes
				is_alive = yes
				is_adult = no
				NOT = {
					has_character_flag = kitsune_lesson
				}
			}
			preferred_limit = {
				is_female = yes
			}
			set_character_flag = kitsune_lesson
			save_event_target_as = kitsune_lesson_target
		}
	}
	
	option = {
		name = EVTOPTA_JAPAN_491 # Mother knows best!
		
		event_target:kitsune_lesson_target = {
			character_event = { id = japan.492 } # Inform target
		}
	}
}

# Child informed
character_event = {
	id = japan.492
	desc = EVTDESC_JAPAN_492
	picture = GFX_evt_garden
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_492 # What a strange lesson...
		
		change_diplomacy = 1
		change_intrigue = 1
	}
}

# Kitsune is visited by foxes
character_event = {
	id = japan.493
	desc = EVTDESC_JAPAN_493
	picture = GFX_evt_garden
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_493 # Hello, my furry friends!
		
		event_target:kitsune_target = {
			character_event = { id = japan.494 } # Inform target
		}
	}
}

# Target informed of fox visit
character_event = {
	id = japan.494
	desc = EVTDESC_JAPAN_494
	picture = GFX_evt_garden
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_494 # How odd...
	}
}

# Kitsune visits someone's dreams
character_event = {
	id = japan.495
	desc = EVTDESC_JAPAN_495
	picture = GFX_evt_sleeping_town_hf
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	immediate = {
		top_liege = {
			random_realm_lord = {
				limit = {
					is_playable = yes
					is_adult = yes
					is_inaccessible_or_incapable_trigger = no
				}
				save_event_target_as = kitsune_dream_target
			}
		}
	}
	
	option = {
		name = EVTOPTA_JAPAN_495 # I will pay them a visit!
		
		prestige = 25
		
		event_target:kitsune_dream_target = {
			character_event = { id = japan.496 } # Inform target
		}
	}
}

# Dreamer informed
character_event = {
	id = japan.496
	desc = EVTDESC_JAPAN_496
	picture = GFX_evt_dark_love
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_496 # How odd...
	}
}

# Kitsune feeds by having sex
character_event = {
	id = japan.497
	desc = EVTDESC_JAPAN_497
	picture = GFX_evt_dark_love
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_497 # Time to feed!
		
		add_character_modifier = {
			modifier = invigorating_love
			months = 12
		}
		
		event_target:kitsune_target = {
			character_event = { id = japan.498 } # Inform target
		}
	}
}

# Target informed
character_event = {
	id = japan.498
	desc = EVTDESC_JAPAN_498
	picture = GFX_evt_dark_love
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_498 # That was... exhausting...
		
		if = {
			limit = {
				trait = celibate
			}
			remove_trait = celibate
		}
		
		unprotected_sex_effect = yes
		
		add_character_modifier = {
			modifier = fierce_lovemaking
			months = 12
		}
	}
}

# Develops hatred of (preferably Buddhist) priest
character_event = {
	id = japan.499
	desc = EVTDESC_JAPAN_499
	picture = GFX_evt_bishop
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	immediate = {
		top_liege = {
			random_realm_lord = {
				limit = {
					is_theocracy = yes
					NOT = {
						any_rival = {
							character = ROOT
						}
					}
				}
				preferred_limit = {
					religion = buddhist
				}
				save_event_target_as = kitsune_priest
			}
		}
	}
	
	option = {
		name = EVTOPTA_JAPAN_499 # Such a turbulent priest...
		
		add_rival = event_target:kitsune_priest
		
		event_target:kitsune_target = {
			character_event = { id = japan.500 } # Inform target
		}
	}
}

# Target informed
character_event = {
	id = japan.500
	desc = EVTDESC_JAPAN_500
	picture = GFX_evt_bishop
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_500 # I see...
	}
}

# Gets rid of (preferably Buddhist) rival priest
character_event = {
	id = japan.501
	desc = EVTDESC_JAPAN_501
	picture = GFX_evt_shadow
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	immediate = {
		top_liege = {
			random_realm_lord = {
				limit = {
					is_theocracy = yes
					any_rival = {
						character = ROOT
					}
				}
				preferred_limit = {
					religion = buddhist
				}
				save_event_target_as = kitsune_priest
			}
		}
	}
	
	option = {
		name = EVTOPTA_JAPAN_501 # Such a turbulent priest...
		
		event_target:kitsune_priest = {
			death = {
				death_reason = death_murder_unknown
			}
		}
		
		event_target:kitsune_target = {
			character_event = { id = japan.502 } # Inform target
		}
	}
}

# Target informed
character_event = {
	id = japan.502
	desc = EVTDESC_JAPAN_502
	picture = GFX_evt_shadow
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_502 # I see...
	}
}

# Imprisoned kitsune escapes
character_event = {
	id = japan.503
	desc = EVTDESC_JAPAN_503
	picture = GFX_evt_hiding_from_pursuers
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_503 # This puny cell can't hold me!
		
		prestige = 25
		
		imprison = no
		
		host = {
			character_event = { id = japan.504 } # Inform jailor
		}
		
		event_target:kitsune_target = {
			character_event = { id = japan.505 } # Inform target
		}
	}
}

# Jailor informed
character_event = {
	id = japan.504
	desc = EVTDESC_JAPAN_504
	picture = GFX_evt_hiding_from_pursuers
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_504 # I see...
	}
}

# Target informed
character_event = {
	id = japan.505
	desc = EVTDESC_JAPAN_505
	picture = GFX_evt_hiding_from_pursuers
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_505 # That's great!
	}
}

### Daughter of kitsune

# on_adulthood - daughter of kitsune might discover that she's a kitsune
character_event = {
	id = japan.506
	hide_window = yes
	
	is_triggered_only = yes
	
	only_women = yes
	
	trigger = {
		OR = {
			mother_even_if_dead = {
				trait = kitsune
			}
			mother = {
				has_character_flag = recessive_kitsune
			}
		}
	}
	
	immediate = {
		random_list = {
			98 = {} # Not kitsune
			1 = {
				health = 2
				set_character_flag = recessive_kitsune # Small chance of skipping a generation
			}
			1 = {
				health = 2
				character_event = {	id = japan.507 } # Kitsune
			}
		}
	}
}

# Kitsune's daughter is kitsune
character_event = {
	id = japan.507
	desc = EVTDESC_JAPAN_507
	picture = GFX_evt_dark_love
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_507 # My true nature cannot remain hidden!
		
		prestige = 25
		
		set_character_flag = kitsune_one_tail
		change_diplomacy = 1
		change_intrigue = 1
		
		add_trait = kitsune
		
		if = {
			limit = {
				NOT = {
					trait = elusive_shadow
				}
			}
			remove_education_effect = yes
			add_trait = elusive_shadow
		}
		
		remove_all_negative_congenital_traits_effect = yes
		
		if = {
			limit = {
				NOT = {
					trait = fair
				}
			}
			add_trait = fair
		}
		if = {
			limit = {
				NOT = {
					trait = celibate
				}
			}
			remove_trait = celibate
		}
		if = {
			limit = {
				NOT = {
					trait = lustful
				}
			}
			add_trait = lustful
		}
		if = {
			limit = {
				NOT = {
					trait = deceitful
				}
			}
			add_trait = deceitful
		}
		if = {
			limit = {
				NOT = {
					trait = shrewd
				}
			}
			add_trait = shrewd
		}
		if = {
			limit = {
				NOT = {
					trait = gregarious
				}
			}
			add_trait = gregarious
		}
		
		character_event = { id = japan.508 days = 365 random = 180 }
	}
}

# Kitsune daughter event selection - subset of mother's events
character_event = {
	id = japan.508
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				num_of_lovers = 1
			}
			random_lover = {
				preferred_limit = {
					any_spouse = {
						character = ROOT
					}
				}
				preferred_limit = {
					any_consort = {
						character = ROOT
					}
				}
				save_event_target_as = kitsune_target
			}
		}
		else_if = {
			limit = {
				is_married = yes
			}
			spouse = {
				save_event_target_as = kitsune_target
			}
		}
		else_if = {
			limit = {
				is_consort = yes
			}
			random_consort = {
				save_event_target_as = kitsune_target
			}
		}
		random_list = {
			1 = {
				modifier = {
					factor = 0
					has_character_flag = kitsune_nine_tails
				}
				character_event = { id = japan.455 } # Kitsune gets another tail
			}
			1 = { # Less likely; we don't want the player to get their traits changed frequently if this is a player...
				modifier = {
					factor = 0
					NAND = {
						trait = elusive_shadow
						trait = fair
						NOT = {
							trait = celibate
						}
						trait = lustful
						trait = deceitful
						trait = shrewd
						trait = gregarious
					}
				}
				character_event = { id = japan.456 } # Kitsune's traits change back
			}
			10 = {
				modifier = {
					factor = 0
					NOT = {
						event_target:kitsune_target = {
							OR = {
								any_spouse = {
									is_inaccessible_or_incapable_trigger = no
									NOT = {
										character = ROOT
									}
								}
								any_consort = {
									is_inaccessible_or_incapable_trigger = no
									NOT = {
										character = ROOT
									}
								}
								any_lover = {
									is_inaccessible_or_incapable_trigger = no
									NOT = {
										character = ROOT
									}
								}
							}
						}
					}
				}
				modifier = {
					factor = 0
					event_target:kitsune_target = {
						is_alive = no
					}
				}
				character_event = { id = japan.463 } # Kitsune removes "obstacles"
			}
			10 = {
				modifier = {
					factor = 0
					NOT = {
						event_target:kitsune_target = {
							is_inaccessible_or_incapable_trigger = no
							is_landed = yes
						}
					}
				}
				modifier = {
					factor = 0
					event_target:kitsune_target = {
						is_alive = no
					}
				}
				character_event = { id = japan.466 } # Kitsune impresses courtier
			}
			# Can't get the slip-up event; that'd kill us...
			# Can't get the "too young" event; that'd kill us
			10 = {
				modifier = {
					factor = 0
					NOT = {
						event_target:kitsune_target = {
							is_ill = no
							is_alive = yes
							is_inaccessible_or_incapable_trigger = no
						}
					}
				}
				modifier = {
					factor = 0
					event_target:kitsune_target = {
						is_alive = no
					}
				}
				character_event = { id = japan.489 } # Kitsune makes target ill
			}
			10 = {
				modifier = {
					factor = 0
					NOT = {
						any_child = {
							is_inaccessible_or_incapable_trigger = yes
							is_alive = yes
							is_adult = no
							NOT = {
								has_character_flag = kitsune_lesson
							}
						}
					}
				}
				character_event = { id = japan.491 } # Kitsune gives her child a lesson
			}
			10 = {
				character_event = { id = japan.493 } # Kitsune is visited by foxes
			}
			10 = {
				character_event = { id = japan.495 } # Kitsune visits someone's dreams
			}
			10 = {
				modifier = {
					factor = 0
					NOT = {
						event_target:kitsune_target = {
							is_alive = yes
							is_inaccessible_or_incapable_trigger = no
						}
					}
				}
				modifier = {
					factor = 0
					trait = celibate
				}
				modifier = {
					factor = 0
					event_target:kitsune_target = {
						is_alive = no
					}
				}
				character_event = { id = japan.497 } # Kitsune feeds on sex
			}
			10 = {
				modifier = {
					factor = 0
					NOT = {
						top_liege = {
							any_realm_lord = {
								is_theocracy = yes
								NOT = {
									any_rival = {
										character = ROOT
									}
								}
							}
						}
					}
				}
				character_event = { id = japan.499 } # Kitsune disliks priest
			}
			10 = {
				modifier = {
					factor = 0
					NOT = {
						top_liege = {
							any_realm_lord = {
								is_theocracy = yes
								any_rival = {
									character = ROOT
								}
							}
						}
					}
				}
				character_event = { id = japan.501 } # Kitsune kills priest
			}
			100 = {
				modifier = {
					factor = 0
					NOT = {
						prisoner = yes
					}
				}
				character_event = { id = japan.503 } # Kitsune escapes prison
			}
			100 = {}
		}
		repeat_event = { id = japan.508 days = 365 random = 365 }
	}
}

##### The Moon Princess (Kaguya-hime/Breony Freitnor)

# Hidden first event
character_event = {
	id = japan.509
	hide_window = yes
	
	is_triggered_only = yes
	
	religion = catholic
	only_rulers = yes
	
	trigger = {
		controls_religion = yes
		NOT = {
			has_global_flag = get_medieval
		}
		year = 1337
		NOT = {
			has_game_rule = {
				name = supernatural_events # Sufficiently advanced technology and all that...
				value = off
			}
		}
	}
	
	immediate = {
		set_global_flag = get_medieval
		2485 = {
			province_event = { id = japan.510 days = 3650 random = 7300 }
		}
	}
}

# And hidden second event
province_event = {
	id = japan.510
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				has_game_rule = {
					name = supernatural_events # Sufficiently advanced technology and all that...
					value = unrestricted
				}
			}
			any_playable_ruler = {
				limit = {
					any_realm_province = {
						OR = {
							region = world_japan
							region = world_japan_islands
							region = custom_yezo
						}
					}
				}
				character_event = { id = japan.511 } # Actual event
			}
		}
		else = {
			any_player = {
				limit = {
					any_realm_province = {
						OR = {
							region = world_japan
							region = world_japan_islands
							region = custom_yezo
						}
					}
				}
				character_event = { id = japan.511 } # Actual event
			}
		}
	}
}

# Hear of a strange woman with strange hair - investigate?
character_event = {
	id = japan.511
	desc = EVTDESC_JAPAN_511
	picture = GFX_evt_emissary
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_511 # I'll go speak to her
		
		character_event = { id = japan.512 days = 15 random = 15 } # The meeting
		
		ai_chance = {
			factor = 1
		}
	}
	
	option = {
		name = EVTOPTB_JAPAN_511 # Nah!
		
		ai_chance = {
			factor = 100
		}
	}
}

# Meeting the pink-haired woman
character_event = {
	id = japan.512
	desc = EVTDESC_JAPAN_512
	picture = GFX_evt_garden
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_512 # Let me know if you need anything!
		
		random_list = {
			50 = {
				character_event = { id = japan.513 days = 180 random = 180 } # She leaves
			}
			50 = {
				modifier = {
					factor = 0.1
					ai = yes
				}
				character_event = { id = japan.514 days = 180 random = 180 } # She wants help
			}
		}
	}
	
	option = {
		name = EVTOPTB_JAPAN_512 # Well, I don't care...
	}
}

# Pink-haired woman leaves
character_event = {
	id = japan.513
	desc = EVTDESC_JAPAN_513
	picture = GFX_evt_emissary
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_513 # Well, that's that...
	}
}

# Supplies requested
character_event = {
	id = japan.514
	desc = EVTDESC_JAPAN_514
	picture = GFX_evt_garden
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_514 # I can spare the money
		
		wealth = -1000
		
		random_list = {
			50 = {
				character_event = { id = japan.515 days = 180 random = 180 } # It didn't work!
			}
			50 = {
				modifier = {
					factor = 0.1
					ai = yes
				}
				character_event = { id = japan.516 days = 180 random = 180 } # It worked!
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = greedy
			}
		}
	}
	
	option = {
		name = EVTOPTB_JAPAN_514 # I don't think so!
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = charitable
				wealth = 1000
			}
		}
	}
}

# It didn't work out
character_event = {
	id = japan.515
	desc = EVTDESC_JAPAN_515
	picture = GFX_evt_garden
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_515 # Well, that's that...
	}
}

# It worked out - have a reward!
character_event = {
	id = japan.516
	desc = EVTDESC_JAPAN_516
	picture = GFX_evt_garden
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_516 # This will be useful!
		
		culture_techpoints = 1000
		economy_techpoints = 1000
		military_techpoints = 1000
	}
}







##### Foreigners on your Shores

### Arrival + event selection

# Foreigners arrive
character_event = {
	id = japan.520
	desc = EVTDESC_JAPAN_520
	picture = GFX_evt_kraken
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	only_playable = yes
	min_age = 16
	
	trigger = {
		is_inaccessible_or_incapable_trigger = no
		# You're "Japanese enough"
		OR = {
			religion = shinto
			AND = {
				culture_group = japonic
				religion = buddhist
			}
		}
		
		# You have a port in Japan
		any_realm_province = {
			port = yes
			OR = {
				region = world_japan
				region = world_japan_islands
				region = custom_yezo
			}
		}
		
		# There's a foreign province the foreigner can come from
		any_independent_ruler = {
			NOR = {
				character = ROOT
				any_realm_lord = {
					character = ROOT
				}
			}
			any_realm_province = {
				port = yes
				can_naval_path_to = c_ise # Doesn't matter which province we pick...
				NOR = { # More interesting to use this instead of the normal check
					religion = shinto
					culture_group = japonic
					religion = buddhist
				}
				NOR = {
					region = world_japan
					region = world_japan_islands
					region = custom_yezo
				}
			}
		}
	}
	
	immediate = {
		# Select the province where the foreigner arrived
		random_realm_province = {
			limit = {
				port = yes
				OR = {
					region = world_japan
					region = world_japan_islands
					region = custom_yezo
				}
			}
			save_event_target_as = foreigner_landfall_province
		}
		
		# Select the province the foreigner came from
		random_independent_ruler = {
			limit = {
				NOR = {
					character = ROOT
					any_realm_lord = {
						character = ROOT
					}
				}
				any_realm_province = {
					port = yes
					can_naval_path_to = c_ise # Doesn't matter which province we pick...
					NOR = { # More interesting to use this instead of the normal check
						religion = shinto
						culture_group = japonic
						religion = buddhist
					}
					NOR = {
						region = world_japan
						region = world_japan_islands
						region = custom_yezo
					}
				}
			}
			random_realm_province = {
				limit = {
					port = yes
					can_naval_path_to = c_ise # Doesn't matter which province we pick...
					NOR = { # More interesting to use this instead of the normal check
						religion = shinto
						culture_group = japonic
						religion = buddhist
					}
					NOR = {
						region = world_japan
						region = world_japan_islands
						region = custom_yezo
					}
				}
				# Some preferences regarding religion/culture
				preferred_limit = {
					OR = {
						religion_group = christian
						religion_group = jewish_group
						religion_group = muslim
						religion = hindu
					}
					NOR = {
						culture_group = paleosiberian
						culture_group = altaic
						culture_group = chinese_group
						culture_group = koreanic
					}
				}
				preferred_limit = {
					OR = {
						religion_group = christian
						religion_group = jewish_group
						religion_group = muslim
						religion = hindu
					}
				}
				preferred_limit = {
					NOR = {
						culture_group = paleosiberian
						culture_group = altaic
						culture_group = chinese_group
						culture_group = koreanic
					}
				}
				save_event_target_as = foreigner_origin_province
			}
		}
		
		# Create the foreigner
		random_list = {
			50 = {
				create_character = {
					age = 25
					female = no
					dynasty = random
					culture = event_target:foreigner_origin_province
					religion = event_target:foreigner_origin_province
					attributes = {
						diplomacy = 4
						martial = 4
						stewardship = 4
						intrigue = 4
						learning = 4
					}
					random_traits = no
				}
			}
			50 = {
				create_character = {
					age = 25
					female = yes
					dynasty = random
					culture = event_target:foreigner_origin_province
					religion = event_target:foreigner_origin_province
					attributes = {
						diplomacy = 4
						martial = 4
						stewardship = 4
						intrigue = 4
						learning = 4
					}
					random_traits = no
				}
			}
		}
		new_character = {
			save_event_target_as = foreigner_in_japan
			set_character_flag = ai_flag_refuse_concubinage
			set_character_flag = ai_flag_refuse_marriage
			set_character_flag = ai_flag_refuse_conversion
			set_character_flag = no_court_invites
			if = {
				limit = {
					religion = hindu
				}
				add_trait = kshatriya
			}
			
			# Randomize the actual foreigner we get
			random_list = {
				1 = {
					set_character_flag = foreigner_is_warrior
					# Stats
					change_diplomacy = 1
					change_martial = 4
					change_stewardship = 1
					change_intrigue = -3
					change_learning = -3
					
					# Education
					random_list = {
						40 = {
							add_trait = brilliant_strategist
						}
						30 = {
							add_trait = skilled_tactician
						}
						20 = {
							add_trait = tough_soldier
						}
						10 = {
							add_trait = misguided_warrior
						}
					}
					
					# Some guaranteed traits
					add_trait = brave
					add_trait = strong
					add_trait = ambitious
					add_random_commander_trait_effect = yes
					add_one_duel_experience_modifier = yes
					random_list = {
						1 = {
							add_trait = duelist
						}
						1 = {
							add_trait = strategist
						}
					}
					
					# And some possible random extras
					random_list = {
						1 = {
							add_trait = lefthanded
						}
						1 = {
							add_trait = ugly
						}
						1 = {
							add_trait = giant
						}
						1 = {
							add_trait = poet
						}
						1 = {
							add_trait = shrewd
						}
						1 = {
							add_trait = wroth
						}
						1 = {
							add_trait = patient
						}
						1 = {
							add_trait = chaste
						}
						1 = {
							add_trait = envious
						}
						1 = {
							add_trait = proud
						}
						1 = {
							add_trait = arbitrary
						}
						1 = {
							add_trait = cruel
						}
						1 = {
							add_trait = deceitful
						}
						1 = {
							add_trait = just
						}
						1 = {
							add_trait = zealous
						}
						1 = {
							add_trait = wounded
						}
						1 = {
							add_maimed_trait_effect = yes
						}
						1 = {
							add_random_commander_trait_effect = yes
						}
						1 = {
							add_one_duel_experience_modifier = yes
						}
					}
				}
				1 = {
					set_character_flag = foreigner_is_scholar
					# Stats
					change_diplomacy = 1
					change_martial = 2
					change_stewardship = 1
					change_intrigue = -3
					change_learning = -1
					
					# Education
					random_list = {
						40 = {
							add_trait = mastermind_theologian
						}
						30 = {
							add_trait = scholarly_theologian
						}
						20 = {
							add_trait = martial_cleric
						}
						10 = {
							add_trait = detached_priest
						}
					}
					
					# Some guaranteed traits
					add_trait = diligent
					add_trait = patient
					add_trait = shy
					random_list = {
						1 = {
							add_trait = scholar
						}
						1 = {
							add_trait = mystic
						}
					}
					
					# And some possible random extras
					random_list = {
						1 = {
							add_trait = weak
						}
						1 = {
							add_trait = fair
						}
						1 = {
							add_trait = poet
						}
						1 = {
							add_trait = celibate
						}
						1 = {
							add_trait = chaste
						}
						1 = {
							add_trait = humble
						}
						1 = {
							add_trait = proud
						}
						1 = {
							add_trait = envious
						}
						1 = {
							add_trait = erudite
						}
						1 = {
							add_trait = craven
						}
						1 = {
							add_trait = trusting
						}
					}
				}
				1 = {
					set_character_flag = foreigner_is_zealot
					# Stats
					change_diplomacy = -1
					change_martial = 2
					change_stewardship = -2
					change_intrigue = -2
					change_learning = 3
					
					# Education
					random_list = {
						40 = {
							add_trait = mastermind_theologian
						}
						30 = {
							add_trait = scholarly_theologian
						}
						20 = {
							add_trait = martial_cleric
						}
						10 = {
							add_trait = detached_priest
						}
					}
					
					# Some guaranteed traits
					add_trait = zealous
					add_trait = erudite
					add_trait = ambitious
					random_list = {
						1 = {
							add_trait = scholar
						}
						1 = {
							add_trait = theologian
						}
					}
					
					# And some possible random extras
					random_list = {
						1 = {
							add_trait = genius
						}
						1 = {
							add_trait = weak
						}
						1 = {
							add_trait = groomed
						}
						1 = {
							add_trait = celibate
						}
						1 = {
							add_trait = poet
						}
						1 = {
							add_trait = chaste
						}
						1 = {
							add_trait = temperate
						}
						1 = {
							add_trait = charitable
						}
						1 = {
							add_trait = diligent
						}
						1 = {
							add_trait = patient
						}
						1 = {
							add_trait = kind
						}
						1 = {
							add_trait = humble
						}
						1 = {
							add_trait = lustful
						}
						1 = {
							add_trait = greedy
						}
						1 = {
							add_trait = wroth
						}
						1 = {
							add_trait = envious
						}
						1 = {
							add_trait = proud
						}
						1 = {
							add_trait = arbitrary
						}
						1 = {
							add_trait = brave
						}
						1 = {
							add_trait = cruel
						}
						1 = {
							add_trait = deceitful
						}
						1 = {
							add_trait = gregarious
						}
						1 = {
							add_trait = honest
						}
						1 = {
							add_trait = just
						}
						1 = {
							add_trait = paranoid
						}
						1 = {
							add_trait = stubborn
						}
						1 = {
							add_random_commander_trait_effect = yes
						}
					}
				}
				1 = {
					set_character_flag = foreigner_is_spy
					# Stats
					change_diplomacy = 1
					change_martial = -1
					change_stewardship = -3
					change_intrigue = 4
					change_learning = -1
					
					# Education
					random_list = {
						40 = {
							add_trait = elusive_shadow
						}
						30 = {
							add_trait = intricate_webweaver
						}
						20 = {
							add_trait = flamboyant_schemer
						}
						10 = {
							add_trait = amateurish_plotter
						}
					}
					
					# Some guaranteed traits
					add_trait = deceitful
					add_trait = paranoid
					add_trait = quick
					random_list = {
						1 = {
							add_trait = schemer
						}
						1 = {
							add_trait = socializer
						}
					}
					
					# And some possible random extras
					random_list = {
						1 = {
							add_trait = lunatic
						}
						1 = {
							add_trait = fair
						}
						1 = {
							add_trait = lefthanded
						}
						1 = {
							add_trait = patient
						}
						1 = {
							add_trait = diligent
						}
						1 = {
							remove_trait = quick
							add_trait = genius
						}
						1 = {
							add_trait = greedy
						}
						1 = {
							add_trait = envious
						}
						1 = {
							add_trait = ambitious
						}
						1 = {
							add_trait = brave
						}
						1 = {
							add_trait = craven
						}
						1 = {
							add_trait = content
						}
						1 = {
							add_trait = cynical
						}
						1 = {
							add_trait = gregarious
						}
						1 = {
							add_trait = shy
						}
					}
				}
				1 = {
					set_character_flag = foreigner_is_thief
					# Stats
					change_diplomacy = 2
					change_martial = -3
					change_stewardship = 1
					change_intrigue = 3
					change_learning = -3
					
					# Education
					random_list = {
						40 = {
							add_trait = elusive_shadow
						}
						30 = {
							add_trait = intricate_webweaver
						}
						20 = {
							add_trait = flamboyant_schemer
						}
						10 = {
							add_trait = amateurish_plotter
						}
					}
					
					# Some guaranteed traits
					add_trait = ambitious
					add_trait = greedy
					add_trait = craven
					random_list = {
						1 = {
							add_trait = schemer
						}
						1 = {
							add_trait = architect
						}
					}
					
					# And some possible random extras
					random_list = {
						1 = {
							add_trait = genius
						}
						1 = {
							add_trait = quick
						}
						1 = {
							add_trait = diligent
						}
						1 = {
							add_trait = patient
						}
						1 = {
							add_trait = envious
						}
						1 = {
							add_trait = arbitrary
						}
						1 = {
							add_trait = cynical
						}
						1 = {
							add_trait = paranoid
						}
						1 = {
							add_trait = shy
						}
					}
				}
				1 = {
					set_character_flag = foreigner_is_seducer
					# Stats
					change_diplomacy = 3
					change_martial = -2
					change_stewardship = -2
					change_intrigue = 4
					change_learning = -3
					
					# Education
					random_list = {
						40 = {
							add_trait = elusive_shadow
						}
						30 = {
							add_trait = intricate_webweaver
						}
						20 = {
							add_trait = flamboyant_schemer
						}
						10 = {
							add_trait = amateurish_plotter
						}
						40 = {
							add_trait = grey_eminence
						}
						30 = {
							add_trait = charismatic_negotiator
						}
						20 = {
							add_trait = underhanded_rogue
						}
						10 = {
							add_trait = naive_appeaser
						}
					}
					
					# Some guaranteed traits
					add_trait = lustful
					add_trait = deceitful
					add_trait = fair
					random_list = {
						1 = {
							add_trait = hedonist
						}
						1 = {
							modifier = {
								factor = 0
								is_female = yes
							}
							add_trait = seducer
						}
						1 = {
							modifier = {
								factor = 0
								is_female = no
							}
							add_trait = seductress
						}
						1 = {
							add_trait = socializer
						}
					}
					
					# And some possible random extras
					random_list = {
						1 = {
							add_trait = genius
						}
						1 = {
							add_trait = quick
						}
						1 = {
							add_trait = strong
						}
						1 = {
							add_trait = poet
						}
						1 = {
							add_trait = patient
						}
						1 = {
							add_trait = envious
						}
						1 = {
							add_trait = proud
						}
						1 = {
							add_trait = ambitious
						}
						1 = {
							add_trait = brave
						}
						1 = {
							add_trait = craven
						}
						1 = {
							add_trait = cynical
						}
						1 = {
							add_trait = gregarious
						}
						1 = {
							add_trait = paranoid
						}
					}
				}
				1 = {
					set_character_flag = foreigner_is_merchant
					# Stats
					change_diplomacy = 2
					change_martial = -2
					change_stewardship = 4
					change_intrigue = -2
					change_learning = -2
					
					# Education
					random_list = {
						40 = {
							add_trait = midas_touched
						}
						30 = {
							add_trait = fortune_builder
						}
						20 = {
							add_trait = thrifty_clerk
						}
						10 = {
							add_trait = indulgent_wastrel
						}
						40 = {
							add_trait = grey_eminence
						}
						30 = {
							add_trait = charismatic_negotiator
						}
						20 = {
							add_trait = underhanded_rogue
						}
						10 = {
							add_trait = naive_appeaser
						}
					}
					
					# Some guaranteed traits
					add_trait = greedy
					add_trait = gregarious
					add_trait = cynical
					random_list = {
						1 = {
							add_trait = socializer
						}
						1 = {
							add_trait = administrator
						}
					}
					
					# And some possible random extras
					random_list = {
						1 = {
							add_trait = drunkard
						}
						1 = {
							add_trait = quick
						}
						1 = {
							add_trait = genius
						}
						1 = {
							add_trait = ugly
						}
						1 = {
							add_trait = is_fat
						}
						1 = {
							add_trait = diligent
						}
						1 = {
							add_trait = temperate
						}
						1 = {
							add_trait = humble
						}
						1 = {
							add_trait = gluttonous
						}
						1 = {
							add_trait = slothful
						}
						1 = {
							add_trait = envious
						}
						1 = {
							add_trait = proud
						}
						1 = {
							add_trait = ambitious
						}
						1 = {
							add_trait = arbitrary
						}
						1 = {
							add_trait = brave
						}
						1 = {
							add_trait = content
						}
						1 = {
							add_trait = craven
						}
						1 = {
							add_trait = deceitful
						}
						1 = {
							add_trait = honest
						}
						1 = {
							add_trait = just
						}
						1 = {
							add_trait = stubborn
						}
					}
				}
				1 = {
					set_character_flag = foreigner_is_troublemaker
					# Stats
					change_diplomacy = -2
					change_martial = 3
					change_stewardship = -2
					change_intrigue = 3
					change_learning = -2
					
					# Education
					random_list = {
						40 = {
							add_trait = skilled_tactician
						}
						30 = {
							add_trait = intricate_webweaver
						}
						20 = {
							add_trait = tough_soldier
						}
						10 = {
							add_trait = flamboyant_schemer
						}
					}
					
					# Some guaranteed traits
					add_trait = arbitrary
					add_trait = wroth
					add_trait = envious
					random_list = {
						1 = {
							add_trait = schemer
						}
						1 = {
							add_trait = mystic
						}
						1 = {
							add_trait = duelist
						}
						1 = {
							add_trait = hedonist
						}
					}
					
					# And some possible random extras
					random_list = {
						1 = {
							add_trait = shrewd
						}
						1 = {
							add_trait = lunatic
						}
						1 = {
							add_trait = lustful
						}
						1 = {
							add_trait = greedy
						}
						1 = {
							add_trait = proud
						}
						1 = {
							add_trait = ambitious
						}
						1 = {
							add_trait = brave
						}
						1 = {
							add_trait = cruel
						}
						1 = {
							add_trait = cynical
						}
						1 = {
							add_trait = deceitful
						}
						1 = {
							add_trait = gregarious
						}
						1 = {
							add_trait = paranoid
						}
						1 = {
							add_trait = zealous
						}
					}
				}
				1 = {
					set_character_flag = foreigner_is_fool
					# Stats
					change_diplomacy = -2
					change_martial = -2
					change_stewardship = -2
					change_intrigue = -2
					change_learning = -2
					
					# Education
					random_list = {
						20 = {
							add_trait = naive_appeaser
						}
						20 = {
							add_trait = misguided_warrior
						}
						20 = {
							add_trait = indulgent_wastrel
						}
						20 = {
							add_trait = amateurish_plotter
						}
						20 = {
							add_trait = detached_priest
						}
					}
					
					# Some guaranteed traits
					add_trait = slothful
					add_trait = content
					add_trait = honest
					
					# And some possible random extras
					random_list = {
						1 = {
							add_trait = drunkard
						}
						1 = {
							add_trait = slow
						}
						1 = {
							add_trait = imbecile
						}
						1 = {
							add_trait = uncouth
						}
						1 = {
							add_trait = temperate
						}
						1 = {
							add_trait = kind
						}
						1 = {
							add_trait = humble
						}
						1 = {
							add_trait = gluttonous
						}
						1 = {
							add_trait = craven
						}
						1 = {
							add_trait = just
						}
						1 = {
							add_trait = shy
						}
						1 = {
							add_trait = trusting
						}
					}
				}
				1 = {
					set_character_flag = foreigner_is_crazy
					# Stats
					change_diplomacy = -1
					change_martial = -1
					change_stewardship = -1
					change_intrigue = -1
					change_learning = -1
					
					# Education
					random_list = {
						20 = {
							add_trait = grey_eminence
						}
						20 = {
							add_trait = brilliant_strategist
						}
						20 = {
							add_trait = midas_touched
						}
						20 = {
							add_trait = elusive_shadow
						}
						20 = {
							add_trait = mastermind_theologian
						}
					}
					
					# Some guaranteed traits
					random_list = {
						1 = {
							add_trait = lunatic
						}
						1 = {
							add_trait = possessed
						}
						1 = {
							add_trait = lunatic
							add_trait = possessed
						}
					}
					add_trait = arbitrary
					random_list = {
						1 = {
							add_trait = impaler
						}
						1 = {
							add_trait = mystic
						}
					}
					
					# And some possible random extras
					random_list = {
						1 = {
							add_trait = is_malnourished
						}
						1 = {
							add_trait = genius
						}
						1 = {
							add_trait = quick
						}
						1 = {
							add_trait = stutter
						}
						1 = {
							add_trait = lisp
						}
						1 = {
							add_trait = weak
						}
						1 = {
							add_trait = lefthanded
						}
						1 = {
							add_trait = poet
						}
						1 = {
							add_trait = diligent
						}
						1 = {
							add_trait = patient
						}
						1 = {
							add_trait = groomed
						}
						1 = {
							add_trait = humble
						}
						1 = {
							add_trait = lustful
						}
						1 = {
							add_trait = greedy
						}
						1 = {
							add_trait = wroth
						}
						1 = {
							add_trait = envious
						}
						1 = {
							add_trait = proud
						}
						1 = {
							add_trait = ambitious
						}
						1 = {
							add_trait = brave
						}
						1 = {
							add_trait = craven
						}
						1 = {
							add_trait = cruel
						}
						1 = {
							add_trait = cynical
						}
						1 = {
							add_trait = deceitful
						}
						1 = {
							add_trait = paranoid
						}
						1 = {
							add_trait = shy
						}
						1 = {
							add_trait = stubborn
						}
						1 = {
							add_trait = zealous
						}
					}
				}
			}
			
			# Small chance of homosexual foreigner
			random = {
				chance = 10
				add_trait = homosexual
			}
			
			# Randomize age a bit
			random_list = {
				1 = {
					add_age = 10
				}
				1 = {
					add_age = 9
				}
				1 = {
					add_age = 8
				}
				1 = {
					add_age = 7
				}
				1 = {
					add_age = 6
				}
				1 = {
					add_age = 5
				}
				1 = {
					add_age = 4
				}
				1 = {
					add_age = 3
				}
				1 = {
					add_age = 2
				}
				1 = {
					add_age = 1
				}
				1 = {
					# No change
				}
				1 = {
					add_age = -1
				}
				1 = {
					add_age = -2
				}
				1 = {
					add_age = -3
				}
				1 = {
					add_age = -4
				}
				1 = {
					add_age = -5
				}
				1 = {
					add_age = -6
				}
				1 = {
					add_age = -7
				}
				1 = {
					add_age = -8
				}
				1 = {
					add_age = -9
				}
			}
			
			# Small chance of PCS boost
			random_list = {
				10 = {
					modifier = {
						factor = 0.1
						has_character_flag = foreigner_is_warrior
					}
					# Nothing
				}
				1 = {
					add_one_duel_experience_modifier = yes
				}
				1 = {
					add_one_duel_experience_modifier = yes
					add_one_duel_experience_modifier = yes
				}
				1 = {
					add_one_duel_experience_modifier = yes
					add_one_duel_experience_modifier = yes
					add_one_duel_experience_modifier = yes
				}
				1 = {
					add_one_duel_experience_modifier = yes
					add_one_duel_experience_modifier = yes
					add_one_duel_experience_modifier = yes
					add_one_duel_experience_modifier = yes
				}
				1 = {
					add_one_duel_experience_modifier = yes
					add_one_duel_experience_modifier = yes
					add_one_duel_experience_modifier = yes
					add_one_duel_experience_modifier = yes
					add_one_duel_experience_modifier = yes
				}
			}
		}
	}
	
	option = {
		name = EVTOPTA_JAPAN_520 # Kill the foreigner!
		
		event_target:foreigner_in_japan = {
			death = {
				death_reason = death_execution
				killer = ROOT
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = kind
			}
			modifier = {
				factor = 0.1
				trait = humble
			}
		}
	}
	
	option = {
		name = EVTOPTB_JAPAN_520 # Accept the 
		
		save_event_target_as = foreigners_host
		event_target:foreigner_in_japan = {
			character_event = { id = japan.521 days = 180 random = 180 }
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = cruel
			}
			modifier = {
				factor = 0.1
				trait = proud
			}
		}
	}
}

# Event selection
character_event = {
	id = japan.521
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		ai = yes
		is_ruler = no
		event_target:foreigners_host = {
			is_alive = yes
		}
	}
	
	immediate = {
		if = {
			limit = {
				is_inaccessible_or_incapable_trigger = no
				event_target:foreigners_host = {
					is_inaccessible_or_incapable_trigger = no
					is_landed = yes
				}
			}
			random_list = {
				1 = {
					modifier = {
						factor = 0
						num_of_friends = 5
					}
					modifier = {
						factor = 10
						has_education_diplomacy_trigger = yes
					}
					# Foreigner makes a friend
					character_event = { id = japan.522 }
				}
				1 = {
					modifier = {
						factor = 0
						num_of_rivals = 5
					}
					modifier = {
						factor = 10
						OR = {
							has_character_flag = foreigner_is_warrior
							has_character_flag = foreigner_is_zealot
							has_character_flag = foreigner_is_troublemaker
							has_character_flag = foreigner_is_fool
						}
					}
					# Foreigner makes a rival
					character_event = { id = japan.525 }
				}
				1 = {
					modifier = {
						factor = 0
						NOT = {
							has_dlc = "Holy Fury"
						}
					}
					modifier = {
						factor = 0
						event_target:foreigners_host = {
							NOR = {
								religion = shinto
								AND = {
									culture_group = japonic
									religion = buddhist
								}
								religion = ryukyuan_pagan
								religion = ryukyuan_pagan_reformed
							}
						}
					}
					modifier = {
						factor = 0
						society_member_of = warriors_of_the_rising_sun
					}
					modifier = {
						factor = 0.5
						NOT = {
							martial = 15
						}
					}
					modifier = {
						factor = 0
						NOT = {
							martial = 10
						}
					}
					modifier = {
						factor = 0
						NOT = {
							combat_rating = 20
						}
					}
					modifier = {
						factor = 0.1
						NOT = {
							combat_rating = 40
						}
					}
					modifier = {
						factor = 10
						has_character_flag = foreigner_is_warrior
					}
					modifier = {
						factor = 5
						trait = brave
					}
					modifier = {
						factor = 5
						has_education_martial_trigger = yes
					}
					modifier = {
						factor = 0.5
						is_female = yes
					}
					modifier = {
						factor = 0
						trait = craven
					}
					# Foreigner wants to join the WotRS
					event_target:foreigners_host = {
						character_event = { id = japan.528 }
					}
				}
				1 = {
					modifier = {
						factor = 0.1
						trait = craven
					}
					modifier = {
						factor = 0.1
						NOT = {
							has_character_flag = foreigner_is_warrior
						}
					}
					modifier = {
						factor = 0.1
						has_education_martial_trigger = no
					}
					modifier = {
						factor = 0
						NOT = {
							combat_rating = 20
						}
					}
					# Foreigner fights bandits
					character_event = { id = japan.532 }
				}
				1 = {
					modifier = {
						factor = 10
						OR = {
							has_character_flag = foreigner_is_warrior
							has_character_flag = foreigner_is_troublemaker
							has_character_flag = foreigner_is_fool
							has_character_flag = foreigner_is_crazy
						}
					}
					modifier = {
						factor = 0
						trait = kind
					}
					modifier = {
						factor = 0.1
						trait = craven
					}
					modifier = {
						factor = 0.1
						NOT = {
							combat_rating = 20
						}
					}
					modifier = {
						factor = 0.5
						has_education_martial_trigger = no
					}
					# Foreigner in bar brawl
					character_event = { id = japan.542 }
				}
				1 = {
					modifier = {
						factor = 10
						has_character_flag = foreigner_is_warrior
					}
					modifier = {
						factor = 0
						NOT = {
							combat_rating = 20
						}
					}
					modifier = {
						factor = 0.1
						NOT = {
							combat_rating = 40
						}
					}
					modifier = {
						factor = 0.1
						has_education_martial_trigger = no
					}
					# Foreigner teaches someone fighting tricks
					character_event = { id = japan.547 }
				}
				1 = {
					modifier = {
						factor = 10
						OR = {
							has_character_flag = foreigner_is_warrior
							has_character_flag = foreigner_is_zealot
							has_character_flag = foreigner_is_troublemaker
							has_character_flag = foreigner_is_crazy
						}
					}
					modifier = {
						factor = 10
						trait = proud
					}
					modifier = {
						factor = 0.1
						trait = humble
					}
					modifier = {
						factor = 0.1
						trait = gregarious
					}
					modifier = {
						factor = 0.1
						trait = kind
					}
					# Foreigner insults peasants
					character_event = { id = japan.550 }
				}
				1 = {
					modifier = {
						factor = 0.1
						has_education_learning_trigger = no
					}
					modifier = {
						factor = 10
						trait = scholar
					}
					modifier = {
						factor = 0
						NOT = {
							learning = 15
						}
					}
					# Foreigner shares insights
					character_event = { id = japan.552 }
				}
				1 = {
					modifier = {
						factor = 0.1
						has_education_learning_trigger = no
					}
					modifier = {
						factor = 10
						trait = scholar
					}
					modifier = {
						factor = 10
						has_character_flag = foreigner_is_scholar
					}
					# Foreigner teaches someone something
					character_event = { id = japan.553 }
				}
				1 = {
					modifier = {
						factor = 0.1
						has_character_flag = foreigner_wrote_book
					}
					modifier = {
						factor = 0.1
						has_education_learning_trigger = no
					}
					modifier = {
						factor = 10
						trait = scholar
					}
					modifier = {
						factor = 0.1
						NOT = {
							learning = 15
						}
					}
					modifier = {
						factor = 10
						has_character_flag = foreigner_is_scholar
					}
					# Foreigner writes book
					character_event = { id = japan.556 }
				}
				1 = {
					modifier = {
						factor = 0
						has_education_learning_trigger = no
					}
					modifier = {
						factor = 0
						NOT = {
							trait = zealous
						}
					}
					modifier = {
						factor = 0
						NOT = {
							learning = 10
						}
					}
					modifier = {
						factor = 0.25
						NOT = {
							diplomacy = 10
						}
					}
					modifier = {
						factor = 0.1
						NOR = {
							has_character_flag = foreigner_is_zealot
							has_character_flag = foreigner_is_troublemaker
							has_character_flag = foreigner_is_crazy
						}
					}
					modifier = {
						factor = 0
						NOT = {
							event_target:foreigners_host = {
								any_courtier = {
									is_landed = no
									is_inaccessible_or_incapable_trigger = no
									NOR = {
										religion = ROOT
										has_character_flag = ai_flag_refuse_conversion
										trait = zealous
									}
								}
							}
						}
					}
					# Foreigner converts courtier
					character_event = { id = japan.560 }
				}
				1 = {
					modifier = {
						factor = 0
						has_education_learning_trigger = no
					}
					modifier = {
						factor = 0
						NOT = {
							trait = zealous
						}
					}
					modifier = {
						factor = 0
						NOT = {
							learning = 15
						}
					}
					modifier = {
						factor = 0.1
						NOR = {
							has_character_flag = foreigner_is_zealot
							has_character_flag = foreigner_is_troublemaker
							has_character_flag = foreigner_is_crazy
						}
					}
					modifier = {
						factor = 0
						NOT = {
							event_target:foreigners_host = {
								any_realm_province = {
									NOT = {
										religion = ROOT
									}
								}
							}
						}
					}
					# Foreigner converts courtier
					event_target:foreigners_host = {
						character_event = { id = japan.562 }
					}
				}
				1 = {
					modifier = {
						factor = 0
						NOT = {
							intrigue = 15
						}
					}
					modifier = {
						factor = 0.1
						has_education_intrigue_trigger = no
					}
					modifier = {
						factor = 0.1
						NOT = {
							has_character_flag = foreigner_is_spy
						}
					}
					modifier = {
						factor = 0
						NOT = {
							event_target:foreigners_host = {
								any_courtier_or_vassal = {
									is_inaccessible_or_incapable_trigger = no
									NOR = {
										any_friend = {
											character = ROOT
										}
										any_lover = {
											character = ROOT
										}
									}
									has_plot = yes
									NOT = {
										plot_is_known_by = event_target:foreigners_host
									}
								}
							}
						}
					}
					# Foreigner detects plot
					character_event = { id = japan.563 }
				}
				1 = {
					modifier = {
						factor = 0.1
						has_education_intrigue_trigger = no
					}
					modifier = {
						factor = 0
						trait = honest
					}
					modifier = {
						factor = 0
						trait = just
					}
					modifier = {
						factor = 10
						trait = greedy
					}
					modifier = {
						factor = 0.1
						NOT = {
							intrigue = 10
						}
					}
					modifier = {
						factor = 0
						NOR = {
							has_character_flag = foreigner_is_thief
							has_character_flag = foreigner_is_troublemaker
						}
					}
					# Foreigner steals from courtier
					character_event = { id = japan.566 }
				}
				1 = {
					modifier = {
						factor = 0.1
						has_education_intrigue_trigger = no
					}
					modifier = {
						factor = 0
						trait = honest
					}
					modifier = {
						factor = 0
						trait = just
					}
					modifier = {
						factor = 10
						trait = greedy
					}
					modifier = {
						factor = 0.1
						NOT = {
							intrigue = 10
						}
					}
					modifier = {
						factor = 0
						NOR = {
							has_character_flag = foreigner_is_thief
							has_character_flag = foreigner_is_troublemaker
						}
					}
					# Foreigner steals from vassal
					character_event = { id = japan.570 }
				}
				1 = {
					modifier = {
						factor = 0.1
						NOR = {
							has_education_intrigue_trigger = yes
							has_education_diplomacy_trigger = yes
						}
					}
					modifier = {
						factor = 0
						trait = celibate
					}
					modifier = {
						factor = 0
						trait = chaste
					}
					modifier = {
						factor = 0.1
						NOR = {
							intrigue = 10
							diplomacy = 10
						}
					}
					modifier = {
						factor = 5
						trait = lustful
					}
					modifier = {
						factor = 5
						OR = {
							trait = seducer
							trait = seductress
						}
					}
					modifier = {
						factor = 0
						NOR = {
							has_character_flag = foreigner_is_seducer
							has_character_flag = foreigner_is_troublemaker
						}
					}
					modifier = {
						factor = 0
						NOT = {
							event_target:foreigners_host = {
								any_courtier = {
									is_landed = no
									is_inaccessible_or_incapable_trigger = no
									is_adult = yes
									NOR = {
										any_rival = {
											character = ROOT
										}
										any_lover = {
											character = ROOT
										}
									}
									OR = {
										AND = {
											is_female = no
											NOT = {
												trait = homosexual
											}
											ROOT = {
												is_female = yes
												NOT = {
													trait = homosexual
												}
											}
										}
										AND = {
											is_female = yes
											NOT = {
												trait = homosexual
											}
											ROOT = {
												is_female = no
												NOT = {
													trait = homosexual
												}
											}
										}
										AND = {
											is_female = no
											trait = homosexual
											ROOT = {
												is_female = no
												trait = homosexual
											}
										}
										AND = {
											is_female = yes
											trait = homosexual
											ROOT = {
												is_female = yes
												trait = homosexual
											}
										}
									}
								}
							}
						}
					}
					# Foreigner attempts seduction of courtier
					character_event = { id = japan.576 }
				}
				1 = {
					modifier = {
						factor = 0.1
						NOR = {
							has_education_intrigue_trigger = yes
							has_education_diplomacy_trigger = yes
						}
					}
					modifier = {
						factor = 0
						trait = celibate
					}
					modifier = {
						factor = 0
						trait = chaste
					}
					modifier = {
						factor = 0.1
						NOR = {
							intrigue = 10
							diplomacy = 10
						}
					}
					modifier = {
						factor = 5
						trait = lustful
					}
					modifier = {
						factor = 5
						OR = {
							trait = seducer
							trait = seductress
						}
					}
					modifier = {
						factor = 0
						NOR = {
							has_character_flag = foreigner_is_seducer
							has_character_flag = foreigner_is_troublemaker
						}
					}
					modifier = {
						factor = 0
						NOR = {
							event_target:foreigners_host = {
								any_realm_lord = {
									is_inaccessible_or_incapable_trigger = no
									is_adult = yes
									NOR = {
										any_rival = {
											character = ROOT
										}
										any_lover = {
											character = ROOT
										}
									}
									OR = {
										AND = {
											is_female = no
											NOT = {
												trait = homosexual
											}
											ROOT = {
												is_female = yes
												NOT = {
													trait = homosexual
												}
											}
										}
										AND = {
											is_female = yes
											NOT = {
												trait = homosexual
											}
											ROOT = {
												is_female = no
												NOT = {
													trait = homosexual
												}
											}
										}
										AND = {
											is_female = no
											trait = homosexual
											ROOT = {
												is_female = no
												trait = homosexual
											}
										}
										AND = {
											is_female = yes
											trait = homosexual
											ROOT = {
												is_female = yes
												trait = homosexual
											}
										}
									}
								}
							}
							event_target:foreigners_host = {
								is_inaccessible_or_incapable_trigger = no
								is_adult = yes
								NOR = {
									any_rival = {
										character = ROOT
									}
									any_lover = {
										character = ROOT
									}
								}
								OR = {
									AND = {
										is_female = no
										NOT = {
											trait = homosexual
										}
										ROOT = {
											is_female = yes
											NOT = {
												trait = homosexual
											}
										}
									}
									AND = {
										is_female = yes
										NOT = {
											trait = homosexual
										}
										ROOT = {
											is_female = no
											NOT = {
												trait = homosexual
											}
										}
									}
									AND = {
										is_female = no
										trait = homosexual
										ROOT = {
											is_female = no
											trait = homosexual
										}
									}
									AND = {
										is_female = yes
										trait = homosexual
										ROOT = {
											is_female = yes
											trait = homosexual
										}
									}
								}
							}
						}
					}
					# Foreigner attempts seduction of ruler
					character_event = { id = japan.580 }
				}
				1 = {
					modifier = {
						factor = 0
						NOT = {
							has_dlc = "Reapers"
						}
					}
					modifier = {
						factor = 0
						NOT = {
							has_education_stewardship_trigger = yes
						}
					}
					modifier = {
						factor = 0.1
						NOT = {
							stewardship = 15
						}
					}
					modifier = {
						factor = 0.1
						NOT = {
							has_character_flag = foreigner_is_merchant
						}
					}
					# Foreigner improves local prosperity
					event_target:foreigners_host = {
						character_event = { id = japan.586 }
					}
				}
				1 = {
					modifier = {
						factor = 0.1
						NOR = {
							has_character_flag = foreigner_is_zealot
							has_character_flag = foreigner_is_troublemaker
							has_character_flag = foreigner_is_fool
							has_character_flag = foreigner_is_crazy
						}
					}
					modifier = {
						factor = 0.1
						diplomacy = 15
					}
					modifier = {
						factor = 0
						trait = gregarious
					}
					modifier = {
						factor = 0
						event_target:foreigners_host = {
							NOT = {
								any_courtier = {
									is_landed = no
									is_inaccessible_or_incapable_trigger = no
								}
							}
						}
					}
					# Foreigner upsets courtier
					character_event = { id = japan.587 }
				}
				1 = {
					modifier = {
						factor = 0.1
						NOR = {
							has_character_flag = foreigner_is_zealot
							has_character_flag = foreigner_is_troublemaker
							has_character_flag = foreigner_is_fool
							has_character_flag = foreigner_is_crazy
						}
					}
					modifier = {
						factor = 0.1
						diplomacy = 15
					}
					modifier = {
						factor = 0
						trait = gregarious
					}
					modifier = {
						factor = 0
						event_target:foreigners_host = {
							NOT = {
								any_realm_lord = {
									is_inaccessible_or_incapable_trigger = no
								}
							}
						}
					}
					# Foreigner upsets vassal
					character_event = { id = japan.590 }
				}
				1 = {
					modifier = {
						factor = 0.1
						NOR = {
							has_character_flag = foreigner_is_zealot
							has_character_flag = foreigner_is_troublemaker
							has_character_flag = foreigner_is_fool
							has_character_flag = foreigner_is_crazy
						}
					}
					modifier = {
						factor = 0.1
						diplomacy = 15
					}
					modifier = {
						factor = 0
						trait = gregarious
					}
					# Foreigner upsets host
					event_target:foreigners_host = {
						character_event = { id = japan.593 }
					}
				}
				1 = {
					modifier = {
						factor = 0.1
						NOR = {
							has_character_flag = foreigner_is_troublemaker
							has_character_flag = foreigner_is_fool
							has_character_flag = foreigner_is_crazy
						}
					}
					modifier = {
						factor = 0.1
						OR = {
							diplomacy = 15
							martial = 15
							stewardship = 15
							intrigue = 15
							learning = 15
						}
					}
					# Foreigner is useless
					event_target:foreigners_host = {
						character_event = { id = japan.594 }
					}
				}
				1 = {
					modifier = {
						factor = 0.1
						NOR = {
							has_character_flag = foreigner_is_troublemaker
							has_character_flag = foreigner_is_crazy
						}
					}
					modifier = {
						factor = 0
						NOR = {
							trait = lunatic
							trait = possessed
						}
					}
					# Foreigner is crazy - attempts murder
					character_event = { id = japan.595 }
				}
				1 = {
					modifier = {
						factor = 0.1
						NOR = {
							has_character_flag = foreigner_is_troublemaker
							has_character_flag = foreigner_is_crazy
						}
					}
					modifier = {
						factor = 0
						NOR = {
							trait = lunatic
							trait = possessed
						}
					}
					# Foreigner is crazy - picks up completely random religion or culture
					character_event = { id = japan.600 }
				}
				1 = {
					modifier = {
						factor = 0
						has_character_flag = foreigner_is_zealot
					}
					modifier = {
						factor = 0
						trait = zealous
					}
					modifier = {
						factor = 10
						trait = sympathy_indian
					}
					modifier = {
						factor = 10
						trait = cynical
					}
					modifier = {
						factor = 0
						event_target:foreigners_host = {
							OR = {
								religion = ROOT
								NOR = {
									religion = shinto
									religion = buddhist
								}
							}
						}
					}
					# Foreigner converts religion
					character_event = { id = japan.602 }
				}
				1 = {
					modifier = {
						factor = 0
						has_character_flag = foreigner_is_zealot
					}
					modifier = {
						factor = 0
						trait = proud
					}
					modifier = {
						factor = 10
						trait = humble
					}
					modifier = {
						factor = 0
						event_target:foreigners_host = {
							OR = {
								culture = ROOT
								NOT = {
									culture_group = japonic
								}
							}
						}
					}
					# Foreigner converts culture
					character_event = { id = japan.603 }
				}
				1 = {
					modifier = {
						factor = 0
						is_married = yes
					}
					modifier = {
						factor = 0
						trait = celibate
					}
					modifier = {
						factor = 0
						trait = homosexual # Can't marry someone appropriate...
					}
					modifier = {
						factor = 0.1
						num_of_lovers = 2
					}
					modifier = {
						factor = 0.1
						has_character_flag = foreigner_is_seducer
					}
					# Foreigner wishes to marry
					character_event = { id = japan.604 }
				}
				10 = {} # Nothing
			}
		}
		repeat_event = { id = japan.521 days = 365 random = 365 }
	}
}

### Foreigner makes a friend

# Foreigner made a friend
character_event = {
	id = japan.522
	desc = EVTDESC_JAPAN_522
	picture = GFX_evt_garden
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	immediate = {
		random_list = {
			50 = {
				modifier = {
					factor = 0
					event_target:foreigners_host = {
						OR = {
							any_friend = {
								character = ROOT
							}
							any_lover = {
								character = ROOT
							}
							any_rival = {
								character = ROOT
							}
						}
					}
				}
				event_target:foreigners_host = {
					save_event_target_as = foreigners_target
				}
			}
			50 = {
				modifier = {
					factor = 0
					NOT = {
						event_target:foreigners_host = {
							is_inaccessible_or_incapable_trigger = no
							NOR = {
								any_friend = {
									character = ROOT
								}
								any_lover = {
									character = ROOT
								}
								any_rival = {
									character = ROOT
								}
							}
						}
					}
				}
				event_target:foreigners_host = {
					random_courtier_or_vassal = {
						limit = {
							is_inaccessible_or_incapable_trigger = no
							NOR = {
								any_friend = {
									character = ROOT
								}
								any_lover = {
									character = ROOT
								}
								any_rival = {
									character = ROOT
								}
							}
						}
						save_event_target_as = foreigners_target
					}
				}
			}
		}
	}
	
	option = {
		name = EVTOPTA_JAPAN_522 # Best friends forever!
		
		event_target:foreigners_target = {
			add_friend = ROOT
			character_event = { id = japan.523 } # Inform friend
			if = {
				limit = {
					NOT = {
						event_target:foreigners_host = {
							character = PREV
						}
					}
				}
				event_target:foreigners_host = {
					character_event = { id = japan.524 } # Inform host
				}
			}
		}
	}
}

# Inform new friend
character_event = {
	id = japan.523
	desc = EVTDESC_JAPAN_523
	picture = GFX_evt_garden
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_523 # Best friends forever!
		add_friend = FROM
	}
}

# Inform host (if not friend)
character_event = {
	id = japan.524
	desc = EVTDESC_JAPAN_524
	picture = GFX_evt_garden
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_524 # Sounds good!
	}
}

### Foreigner makes a rival

# Foreigner made a rival
character_event = {
	id = japan.525
	desc = EVTDESC_JAPAN_525
	picture = GFX_evt_scandal
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	immediate = {
		event_target:foreigners_host = {
			random_courtier_or_vassal = {
				limit = {
					is_inaccessible_or_incapable_trigger = no
					NOR = {
						any_friend = {
							character = ROOT
						}
						any_lover = {
							character = ROOT
						}
						any_rival = {
							character = ROOT
						}
					}
				}
				save_event_target_as = foreigners_target
			}
		}
	}
	
	option = {
		name = EVTOPTA_JAPAN_525 # I hate them!
		
		event_target:foreigners_target = {
			add_rival = ROOT
			character_event = { id = japan.526 } # Inform rival
		}
		event_target:foreigners_host = {
			character_event = { id = japan.527 } # Inform host
		}
	}
}

# Inform new rival
character_event = {
	id = japan.526
	desc = EVTDESC_JAPAN_526
	picture = GFX_evt_scandal
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_526 # I hate FROM!
		add_rival = FROM
	}
}

# Inform host
character_event = {
	id = japan.527
	desc = EVTDESC_JAPAN_527
	picture = GFX_evt_scandal
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_527 # I see...
	}
}

### Foreigner wants to join the WotRS

# Foreigner makes request
character_event = {
	id = japan.528
	desc = EVTDESC_JAPAN_528
	picture = GFX_evt_china_expansionist
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_528 # Very well; I'll make introductions!
		
		if = {
			limit = {
				society_member_of = warriors_of_the_rising_sun
			}
			change_society_currency = -100
		}
		else = {
			if = {
				limit = {
					OR = {
						religion = shinto
						AND = {
							culture_group = japonic
							religion = buddhist
						}
					}
				}
				prestige = -100
			}
			else = {
				prestige = -250
			}
		}
		
		FROM = {
			character_event = { id = japan.529 }
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				any_rival = {
					character = FROM
				}
			}
			modifier = {
				factor = 0.1
				FROM = {
					is_female = yes
				}
				is_female = no
				NOR = {
					any_friend = {
						character = FROM
					}
					any_lover = {
						character = FROM
					}
				}
			}
			modifier = {
				factor = 0.1
				NOT = {
					opinion = {
						who = FROM
						value = 25
					}
				}
			}
			modifier = {
				factor = 0
				NOT = {
					opinion = {
						who = FROM
						value = -25
					}
				}
			}
			modifier = { # The other option is better!
				factor = 0
				society_member_of = warriors_of_the_rising_sun
				society_rank >= 2
			}
		}
	}
	
	option = {
		trigger = {
			society_member_of = warriors_of_the_rising_sun
			society_rank >= 2
		}
		
		name = EVTOPTB_JAPAN_528 # Very well; I'll train you myself!
		
		FROM = {
			character_event = { id = japan.530 }
			character_event = { id = soh.2732 } # Inform other students
		}
		
		if = {
			limit = {
				has_quest = quest_rising_sun_get_student
			}
			character_event = { id = soh.2606 }
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				any_rival = {
					character = FROM
				}
			}
			modifier = {
				factor = 10
				has_quest = quest_rising_sun_get_student
			}
			modifier = {
				factor = 0.1
				FROM = {
					is_female = yes
				}
				is_female = no
				NOR = {
					any_friend = {
						character = FROM
					}
					any_lover = {
						character = FROM
					}
				}
			}
			modifier = {
				factor = 0.1
				NOT = {
					opinion = {
						who = FROM
						value = 25
					}
				}
			}
			modifier = {
				factor = 0
				NOT = {
					opinion = {
						who = FROM
						value = -25
					}
				}
			}
		}
	}
	
	option = {
		name = EVTOPTC_JAPAN_528 # You, a WotRS? Ha!
		
		add_rival = FROM
		
		FROM = {
			character_event = { id = japan.531 }
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				opinion = {
					who = FROM
					value = -25
				}
			}
			modifier = {
				factor = 0
				opinion = {
					who = FROM
					value = 25
				}
			}
			modifier = {
				factor = 0.1
				FROM = {
					is_female = no
				}
			}
			modifier = {
				factor = 0.1
				FROM = {
					has_education_martial_trigger = yes
				}
			}
			modifier = {
				factor = 0
				OR = {
					any_friend = {
						character = FROM
					}
					any_lover = {
						character = FROM
					}
				}
			}
			modifier = {
				factor = 100
				any_rival = {
					character = FROM
				}
			}
		}
	}
}

# Request accepted
character_event = {
	id = japan.529
	desc = EVTDESC_JAPAN_529
	picture = GFX_evt_china_expansionist
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_529 # Just as planned!
		
		if = {
			limit = {
				is_in_society = yes
			}
			leave_society = yes
		}
		set_character_flag = special_rising_sun_character # Ignores religion
		join_society = warriors_of_the_rising_sun
	}
}
		
# Request accepted - FROM is mentor
character_event = {
	id = japan.530
	desc = EVTDESC_JAPAN_530
	picture = GFX_evt_china_expansionist
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_530 # That's more than I expected!
		
		if = {
			limit = {
				is_in_society = yes
			}
			leave_society = yes
		}
		set_character_flag = special_rising_sun_character # Ignores religion
		join_society = warriors_of_the_rising_sun
		
		# Mentor stuff
		opinion = {
			who = FROM
			modifier = opinion_rising_sun_student
		}
		reverse_opinion = {
			who = FROM
			modifier = opinion_rising_sun_mentor
		}
		hidden_tooltip = {
			set_variable = {
				which = rising_sun_student
				value = 0
			}
		}
		character_event = { id = soh.2738 days = 60 random = 60} # Select an event to send TODO: Proper ID
	}
}

# Request refused
character_event = {
	id = japan.531
	desc = EVTDESC_JAPAN_531
	picture = GFX_evt_china_expansionist
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_531 # "Not good enough"?
		
		add_rival = FROM
	}
}

### Foreigner fights bandits

# Bandits are upon you - fight or flee?
character_event = {
	id = japan.532
	desc = EVTDESC_JAPAN_532
	picture = GFX_evt_bandits
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_532 # I will fight!
		
		prestige = 10
		
		random_list = {
			25 = {
				modifier = {
					factor = 0
					NOT = {
						combat_rating = 20
					}
				}
				modifier = {
					factor = 10
					combat_rating = 40
				}
				character_event = { id = japan.533 days = 1 } # You win
			}
			25 = {
				modifier = {
					factor = 0.1
					combat_rating = 20
				}
				character_event = { id = japan.535 days = 1 } # You got wounded
			}
			25 = {
				modifier = {
					factor = 0.1
					combat_rating = 20
				}
				modifier = {
					factor = 0
					combat_rating = 40
				}
				character_event = { id = japan.537 days = 1 } # You got maimed
			}
			25 = {
				modifier = {
					factor = 0.1
					combat_rating = 20
				}
				modifier = {
					factor = 0
					combat_rating = 40
				}
				character_event = { id = japan.539 days = 1 } # You died
			}
		}
		
		if = {
			limit = {
				trait = craven
			}
			remove_trait = craven
		}
		else = {
			add_trait = brave
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = craven
			}
		}
	}
	
	option = {
		name = EVTOPTB_JAPAN_532 # I will flee!
		
		prestige = -25
		
		event_target:foreigners_host = {
			character_event = { id = japan.541 days = 1 } # Foreigner is cowardly
		}
		
		if = {
			limit = {
				trait = brave
			}
			remove_trait = brave
		}
		else = {
			add_trait = craven
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = brave
			}
		}
	}
}

# Foreigner won
character_event = {
	id = japan.533
	desc = EVTDESC_JAPAN_533
	picture = GFX_evt_bandits
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_533 # Good riddance!
		
		prestige = 25
		
		event_target:foreigners_host = {
			character_event = { id = japan.534 } # Inform host
		}
	}
}

# Inform host - clean victory
character_event = {
	id = japan.534
	desc = EVTDESC_JAPAN_534
	picture = GFX_evt_bandits
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_534 # I see...
	}
}

# Foreigner won but got injured
character_event = {
	id = japan.535
	desc = EVTDESC_JAPAN_535
	picture = GFX_evt_bandits
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_535 # Good riddance!
		
		prestige = 10
		
		add_trait = wounded
		
		event_target:foreigners_host = {
			character_event = { id = japan.536 } # Inform host
		}
	}
}

# Inform host - injured
character_event = {
	id = japan.536
	desc = EVTDESC_JAPAN_536
	picture = GFX_evt_bandits
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_536 # I see...
	}
}

# Foreigner won but got maimed
character_event = {
	id = japan.537
	desc = EVTDESC_JAPAN_537
	picture = GFX_evt_bandits
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_537 # Good riddance!
		
		prestige = -10
		
		add_maimed_trait_effect = yes
		
		event_target:foreigners_host = {
			character_event = { id = japan.538 } # Inform host
		}
	}
}

# Inform host - maimed
character_event = {
	id = japan.538
	desc = EVTDESC_JAPAN_538
	picture = GFX_evt_bandits
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_538 # I see...
	}
}

# Foreigner killed
character_event = {
	id = japan.539
	desc = EVTDESC_JAPAN_539
	picture = GFX_evt_bloody_man
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_539 # This cannot be!
		
		prestige = -25
		
		death = {
			death_reason = death_battle
		}
		
		event_target:foreigners_host = {
			character_event = { id = japan.540 } # Inform host
		}
	}
}

# Inform host - killed
character_event = {
	id = japan.540
	desc = EVTDESC_JAPAN_540
	picture = GFX_evt_bloody_man
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_540 # I see...
	}
}

# Inform host - foreigner fled
character_event = {
	id = japan.541
	desc = EVTDESC_JAPAN_541
	picture = GFX_evt_emissary
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_541 # I see...
	}
}

### Foreigner in bar brawl

# Brawl time
character_event = {
	id = japan.542
	desc = EVTDESC_JAPAN_542
	picture = GFX_evt_brothel
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_542 # Bar brawl! Yay!
		
		random_list = {
			33 = {
				modifier = {
					factor = 0
					NOT = {
						combat_rating = 20
					}
				}
				character_event = { id = japan.543 }
			}
			34 = {
				modifier = {
					factor = 0
					combat_rating = 40
				}
				character_event = { id = japan.544 }
			}
			33 = {
				modifier = {
					factor = 0
					combat_rating = 20
				}
				character_event = { id = japan.545 }
			}
		}
		
		event_target:foreigners_host = {
			character_event = { id = japan.546 } # Inform host
		}
	}
}

# It goes well
character_event = {
	id = japan.543
	desc = EVTDESC_JAPAN_543
	picture = GFX_evt_brothel
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_543 # Haha!
		
		prestige = 10
	}
}

# Injured
character_event = {
	id = japan.544
	desc = EVTDESC_JAPAN_544
	picture = GFX_evt_brothel
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_544 # Ha!
		
		add_trait = wounded
	}
}

# Maimed
character_event = {
	id = japan.545
	desc = EVTDESC_JAPAN_545
	picture = GFX_evt_brothel
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_545 # Ow!
		
		prestige = -10
		
		add_maimed_trait_effect = yes
	}
}

# Inform host - foreigner is brawling
character_event = {
	id = japan.546
	desc = EVTDESC_JAPAN_546
	picture = GFX_evt_brothel
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_546 # I don't know...
		
		prestige = -5
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				OR = {
					trait = arbitrary
					trait = cruel
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_JAPAN_546 # Throw FROM in a cell!
		
		FROM = {
			imprison = ROOT
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = just
			}
		}
	}
	
	option = {
		name = EVTOPTC_JAPAN_546 # Off with FROM's head!
		
		FROM = {
			death = {
				death_reason = death_execution
				killer = ROOT
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = kind
			}
		}
	}
}

### Foreigner teaches someone fighting tricks

# Teach someone
character_event = {
	id = japan.547
	desc = EVTDESC_JAPAN_547
	picture = GFX_evt_dueling_knights_hf
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	immediate = {
		event_target:foreigners_host = {
			random_courtier_or_vassal = {
				limit = {
					is_inaccessible_or_incapable_trigger = no
					NOT = {
						any_rival = {
							character = ROOT
						}
					}
					combat_rating_diff = {
						character = ROOT
						value <= -5
					}
				}
				preferred_limit = {
					OR = {
						any_friend = {
							character = ROOT
						}
						any_lover = {
							character = ROOT
						}
					}
				}
				save_event_target_as = foreigners_target
			}
		}
	}
	
	option = {
		name = EVTOPTA_JAPAN_547 # I have some tricks to teach!
		
		event_target:foreigners_target = {
			character_event = { id = japan.548 } # Target approached
		}
	}
}

# Target approached
character_event = {
	id = japan.548
	desc = EVTDESC_JAPAN_548
	picture = GFX_evt_dueling_knights_hf
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_548 # Sure!
		
		add_one_duel_experience_modifier = yes
		
		prestige = -10
		FROM = {
			prestige = 10
		}
		
		event_target:foreigners_host = {
			character_event = { id = japan.549 }
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				trait = proud
			}
			modifier = {
				factor = 0.1
				trait = slothful
			}
		}
	}
	
	option = {
		name = EVTOPTB_JAPAN_548 # No!
		
		FROM = {
			prestige = -10
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				trait = humble
			}
			modifier = {
				factor = 0.1
				trait = diligent
			}
		}
	}
}

# Inform host
character_event = {
	id = japan.549
	desc = EVTDESC_JAPAN_549
	picture = GFX_evt_dueling_knights_hf
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_549 # I see...
	}
}

### Foreigner insults peasants

# Foreigner insults peasants
character_event = {
	id = japan.550
	desc = EVTDESC_JAPAN_550
	picture = GFX_evt_noble_haughty_talking_to_peasants
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	immediate = {
		event_target:foreigners_host = {
			random_realm_province = {
				save_event_target_as = foreigners_target_province
			}
		}
	}
	
	option = {
		name = EVTOPTA_JAPAN_550 # Good-for-nothing peasants!
		
		event_target:foreigners_host = {
			character_event = { id = japan.551 }
		}
	}
}

# Inform host
character_event = {
	id = japan.551
	desc = EVTDESC_JAPAN_551
	picture = GFX_evt_noble_haughty_talking_to_peasants
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_551 # Curses!
		
		prestige = -10
		
		event_target:foreigners_target_province = {
			add_province_modifier = {
				name = peasant_unrest
				years = 10
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				OR = {
					trait = arbitrary
					trait = cruel
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_JAPAN_551 # Throw FROM in a cell!
		
		FROM = {
			imprison = ROOT
		}
		
		event_target:foreigners_target_province = {
			add_province_modifier = {
				name = peasant_unrest
				years = 10
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = just
			}
		}
	}
	
	option = {
		name = EVTOPTC_JAPAN_551 # Off with FROM's head!
		
		FROM = {
			death = {
				death_reason = death_execution
				killer = ROOT
			}
		}
		
		event_target:foreigners_target_province = {
			add_province_modifier = {
				name = peasant_unrest
				years = 10
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = kind
			}
		}
	}
}

### Foreigner shares insights

# Foreigner gives host insights
character_event = {
	id = japan.552
	desc = EVTDESC_JAPAN_552
	picture = GFX_evt_china_invades
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_552 # Great!
		
		culture_techpoints = 15
		economy_techpoints = 15
		military_techpoints = 15
	}
}

### Foreigner teaches someone something

# Foreigner teaches someone something
character_event = {
	id = japan.553
	desc = EVTDESC_JAPAN_553
	picture = GFX_evt_china_invades
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	immediate = {
		event_target:foreigners_host = {
			random_courtier_or_vassal = {
				limit = {
					is_inaccessible_or_incapable_trigger = no
					NOT = {
						any_rival = {
							character = ROOT
						}
					}
					combat_rating_diff = {
						character = ROOT
						value <= -5
					}
				}
				preferred_limit = {
					OR = {
						any_friend = {
							character = ROOT
						}
						any_lover = {
							character = ROOT
						}
					}
				}
				save_event_target_as = foreigners_target
			}
		}
	}
	
	option = {
		name = EVTOPTA_JAPAN_553 # I have some knowledge to share!
		
		event_target:foreigners_target = {
			character_event = { id = japan.554 } # Target approached
		}
	}
}

# Inform target
character_event = {
	id = japan.554
	desc = EVTDESC_JAPAN_554
	picture = GFX_evt_china_invades
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_554 # Sure!
		
		prestige = -10
		
		random_list = {
			20 = {
				modifier = {
					factor = 2
					FROM = {
						diplomacy = 20
					}
				}
				modifier = {
					factor = 0
					FROM = {
						NOT = {
							diplomacy = 5
						}
					}
				}
				change_diplomacy = 1
			}
			20 = {
				modifier = {
					factor = 2
					FROM = {
						martial = 20
					}
				}
				modifier = {
					factor = 0
					FROM = {
						NOT = {
							martial = 5
						}
					}
				}
				change_martial = 1
			}
			20 = {
				modifier = {
					factor = 2
					FROM = {
						stewardship = 20
					}
				}
				modifier = {
					factor = 0
					FROM = {
						NOT = {
							stewardship = 5
						}
					}
				}
				change_stewardship = 1
			}
			20 = {
				modifier = {
					factor = 2
					FROM = {
						intrigue = 20
					}
				}
				modifier = {
					factor = 0
					FROM = {
						NOT = {
							intrigue = 5
						}
					}
				}
				change_intrigue = 1
			}
			20 = {
				modifier = {
					factor = 2
					FROM = {
						learning = 20
					}
				}
				modifier = {
					factor = 0
					FROM = {
						NOT = {
							learning = 5
						}
					}
				}
				change_learning = 1
			}
		}
		
		FROM = {
			prestige = 10
		}
		
		event_target:foreigners_host = {
			character_event = { id = japan.555 }
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				trait = proud
			}
			modifier = {
				factor = 0.1
				trait = slothful
			}
		}
	}
	
	option = {
		name = EVTOPTB_JAPAN_554 # No!
		
		FROM = {
			prestige = -10
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				trait = humble
			}
			modifier = {
				factor = 0.1
				trait = diligent
			}
		}
	}
}

# Inform host (if not target)
character_event = {
	id = japan.555
	desc = EVTDESC_JAPAN_555
	picture = GFX_evt_china_invades
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_555 # I see...
	}
}

### Foreigner writes book

# Foreigner writes book
character_event = {
	id = japan.556
	desc = EVTDESC_JAPAN_556
	picture = GFX_evt_garden
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_556 # I dedicate this to my host!
		
		set_character_flag = foreigner_wrote_book
		
		random_list = {
			20 = {
				modifier = {
					factor = 0.1
					has_education_diplomacy_trigger = no
				}
				modifier = {
					factor = 0.1
					OR = {
						has_character_flag = wrote_a_beginners_guide_to_isolationism
						has_character_flag = wrote_keeping_your_head
						has_character_flag = wrote_the_tale_of_dynasty
					}
				}
				random_list = {
					50 = {
						modifier = {
							factor = 0
							diplomacy = 20
						}
						add_artifact = a_beginners_guide_to_isolationism
						set_character_flag = wrote_a_beginners_guide_to_isolationism
						set_character_flag = foreigner_wrote_bad_book
						new_artifact = {
							save_event_target_as = foreigners_book
						}
					}
					25 = {
						add_artifact = keeping_your_head
						set_character_flag = wrote_keeping_your_head
						set_character_flag = foreigner_wrote_average_book
						new_artifact = {
							save_event_target_as = foreigners_book
						}
					}
					15 = {
						modifier = {
							factor = 0
							NOT = {
								diplomacy = 10
							}
						}
						add_artifact = the_tale_of_dynasty
						set_character_flag = wrote_the_tale_of_dynasty
						set_character_flag = foreigner_wrote_good_book
						new_artifact = {
							set_name = "the_tale_of_dynasty_foreigners_host"
							set_description = "the_tale_of_dynasty_foreigners_host_desc"
							save_event_target_as = foreigners_book
						}
					}
				}
			}
			20 = {
				modifier = {
					factor = 0.1
					has_education_martial_trigger = no
				}
				modifier = {
					factor = 0.1
					OR = {
						has_character_flag = wrote_they_have_curved_swords
						has_character_flag = wrote_katanas_are_just_better
						has_character_flag = wrote_warriors_of_the_rising_sun
					}
				}
				random_list = {
					50 = {
						modifier = {
							factor = 0
							martial = 20
						}
						add_artifact = they_have_curved_swords
						set_character_flag = wrote_they_have_curved_swords
						set_character_flag = foreigner_wrote_bad_book
						new_artifact = {
							save_event_target_as = foreigners_book
						}
					}
					25 = {
						add_artifact = katanas_are_just_better
						set_character_flag = wrote_katanas_are_just_better
						set_character_flag = foreigner_wrote_average_book
						new_artifact = {
							save_event_target_as = foreigners_book
						}
					}
					15 = {
						modifier = {
							factor = 0
							NOT = {
								martial = 10
							}
						}
						add_artifact = the_warriors_of_the_rising_sun
						set_character_flag = wrote_warriors_of_the_rising_sun
						set_character_flag = foreigner_wrote_good_book
						new_artifact = {
							save_event_target_as = foreigners_book
						}
					}
				}
			}
			20 = {
				modifier = {
					factor = 0.1
					has_education_stewardship_trigger = no
				}
				modifier = {
					factor = 0.1
					OR = {
						has_character_flag = wrote_cherry_blossoms_are_pretty
						has_character_flag = wrote_bureaucracy_for_dummies
						has_character_flag = wrote_the_provinces_of_realm
					}
				}
				random_list = {
					50 = {
						modifier = {
							factor = 0
							stewardship = 20
						}
						add_artifact = cherry_blossoms_are_pretty
						set_character_flag = wrote_cherry_blossoms_are_pretty
						set_character_flag = foreigner_wrote_bad_book
						new_artifact = {
							save_event_target_as = foreigners_book
						}
					}
					25 = {
						add_artifact = bureaucracy_for_dummies
						set_character_flag = wrote_bureaucracy_for_dummies
						set_character_flag = foreigner_wrote_average_book
						new_artifact = {
							save_event_target_as = foreigners_book
						}
					}
					15 = {
						modifier = {
							factor = 0
							NOT = {
								stewardship = 10
							}
						}
						add_artifact = the_provinces_of_realm
						set_character_flag = wrote_the_provinces_of_realm
						set_character_flag = foreigner_wrote_good_book
						new_artifact = {
							set_name = "the_provinces_of_realm_foreigners_host"
							set_description = "the_provinces_of_realm_foreigners_host_desc"
							save_event_target_as = foreigners_book
						}
					}
				}
			}
			20 = {
				modifier = {
					factor = 0.1
					has_education_intrigue_trigger = no
				}
				modifier = {
					factor = 0.1
					OR = {
						has_character_flag = wrote_highly_visible_ninja
						has_character_flag = wrote_how_to_wall_climb
						has_character_flag = wrote_conservation_of_ninjutsu
					}
				}
				random_list = {
					50 = {
						modifier = {
							factor = 0
							intrigue = 20
						}
						add_artifact = highly_visible_ninja
						set_character_flag = wrote_highly_visible_ninja
						set_character_flag = foreigner_wrote_bad_book
						new_artifact = {
							save_event_target_as = foreigners_book
						}
					}
					25 = {
						add_artifact = how_to_wall_climb
						set_character_flag = wrote_how_to_wall_climb
						set_character_flag = foreigner_wrote_average_book
						new_artifact = {
							save_event_target_as = foreigners_book
						}
					}
					15 = {
						modifier = {
							factor = 0
							NOT = {
								intrigue = 10
							}
						}
						add_artifact = conservation_of_ninjutsu
						set_character_flag = wrote_conservation_of_ninjutsu
						set_character_flag = foreigner_wrote_good_book
						new_artifact = {
							save_event_target_as = foreigners_book
						}
					}
				}
			}
			20 = {
				modifier = {
					factor = 0.1
					has_education_learning_trigger = no
				}
				modifier = {
					factor = 0.1
					OR = {
						has_character_flag = wrote_how_to_haiku
						has_character_flag = wrote_hiragana_katakana_and_kanji
						has_character_flag = wrote_the_location_history_of_realm
					}
				}
				random_list = {
					50 = {
						modifier = {
							factor = 0
							intrigue = 20
						}
						add_artifact = how_to_haiku
						set_character_flag = wrote_how_to_haiku
						set_character_flag = foreigner_wrote_bad_book
						new_artifact = {
							save_event_target_as = foreigners_book
						}
					}
					25 = {
						add_artifact = hiragana_katakana_and_kanji
						set_character_flag = wrote_hiragana_katakana_and_kanji
						set_character_flag = foreigner_wrote_average_book
						new_artifact = {
							save_event_target_as = foreigners_book
						}
					}
					15 = {
						modifier = {
							factor = 0
							NOT = {
								intrigue = 10
							}
						}
						add_artifact = the_location_history_of_realm
						set_character_flag = wrote_the_location_history_of_realm
						set_character_flag = foreigner_wrote_good_book
						new_artifact = {
							set_name = "the_location_history_of_realm_foreigners_host"
							set_description = "the_location_history_of_realm_foreigners_host_desc"
							save_event_target_as = the_location_history_of_realm
						}
					}
				}
			}
		}
		
		if = {
			limit = {
				has_character_flag = foreigner_wrote_bad_book
			}
			clr_character_flag = foreigner_wrote_bad_book
			event_target:foreigners_host = {
				character_event = { id = japan.557 } # Inform host
			}
		}
		else_if = {
			limit = {
				has_character_flag = foreigner_wrote_average_book
			}
			clr_character_flag = foreigner_wrote_average_book
			event_target:foreigners_host = {
				character_event = { id = japan.558 } # Inform host
			}
		}
		else_if = {
			limit = {
				has_character_flag = foreigner_wrote_good_book
			}
			clr_character_flag = foreigner_wrote_good_book
			event_target:foreigners_host = {
				character_event = { id = japan.559 } # Inform host
			}
		}
	}
}

# Host gets book - poor book
character_event = {
	id = japan.557
	desc = EVTDESC_JAPAN_557
	picture = GFX_evt_emissary
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_557 # I accept this gift!
		
		FROM = {
			prestige = 25
		}
		
		event_target:foreigners_book = {
			transfer_artifact = {
				from = FROM
				to = ROOT
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				NOT = {
					trait = humble
				}
			}
			modifier = {
				factor = 0.1
				trait = charitable
			}
		}
	}
	
	option = {
		name = EVTOPTB_JAPAN_557 # Keep it!
		
		event_target:foreigners_book = {
			transfer_artifact = {
				from = FROM
				to = ROOT
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				trait = humble
			}
			modifier = {
				factor = 0.1
				NOT = {
					trait = charitable
				}
			}
		}
	}
}

# Host gets book - decent book
character_event = {
	id = japan.558
	desc = EVTDESC_JAPAN_558
	picture = GFX_evt_emissary
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_558 # I accept this gift!
		
		FROM = {
			prestige = 50
		}
		
		event_target:foreigners_book = {
			transfer_artifact = {
				from = FROM
				to = ROOT
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				trait = charitable
			}
		}
	}
	
	option = {
		name = EVTOPTB_JAPAN_558 # Keep it!
		
		event_target:foreigners_book = {
			transfer_artifact = {
				from = FROM
				to = ROOT
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				NOT = {
					trait = charitable
				}
			}
		}
	}
}

# Host gets book - great book
character_event = {
	id = japan.559
	desc = EVTDESC_JAPAN_559
	picture = GFX_evt_emissary
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_559 # I accept this gift!
		
		FROM = {
			prestige = 100
		}
		
		event_target:foreigners_book = {
			transfer_artifact = {
				from = FROM
				to = ROOT
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				trait = humble
			}
			modifier = {
				factor = 0.1
				trait = charitable
			}
		}
	}
	
	option = {
		name = EVTOPTB_JAPAN_559 # Keep it!
		
		event_target:foreigners_book = {
			transfer_artifact = {
				from = FROM
				to = ROOT
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				trait = proud
			}
			modifier = {
				factor = 0.1
				NOT = {
					trait = charitable
				}
			}
		}
	}
}

### Foreigner converts courtier

# Foreigner picks a target
character_event = {
	id = japan.560
	desc = EVTDESC_JAPAN_560
	picture = GFX_evt_religious_exultation
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	immediate = {
		event_target:foreigners_host = {
			random_courtier = {
				limit = {
					is_landed = no
					is_inaccessible_or_incapable_trigger = no
					NOR = {
						religion = ROOT
						has_character_flag = ai_flag_refuse_conversion
						trait = zealous
					}
				}
				save_event_target_as = foreigners_target
			}
		}
		FROM = {
			piety = 25
		}
	}
	
	option = {
		name = EVTOPTA_JAPAN_560 # Convert now!
		
		event_target:foreigners_target = {
			religion = ROOT
		}
		event_target:foreigners_host = {
			character_event = { id = japan.561 } # Inform the host
		}
	}
}

# Inform host
character_event = {
	id = japan.561
	desc = EVTDESC_JAPAN_561
	picture = GFX_evt_garden
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			religion = FROM
		}
		name = EVTOPTA_JAPAN_561 # Great!
	}
	
	option = {
		trigger = {
			NOT = {
				religion = FROM
			}
		}
		name = EVTOPTB_JAPAN_561 # I see...
		
		prestige = -10
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				OR = {
					trait = zealous
					trait = cruel
				}
			}
		}
	}
	
	option = {
		trigger = {
			NOT = {
				religion = FROM
			}
		}
		name = EVTOPTC_JAPAN_561 # Throw FROM in a cell!
		
		FROM = {
			imprison = ROOT
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = cynical
			}
		}
	}
	
	option = {
		trigger = {
			NOT = {
				religion = FROM
			}
		}
		name = EVTOPTD_JAPAN_561 # Off with FROM's head!
		
		FROM = {
			death = {
				death_reason = death_execution
				killer = ROOT
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = kind
			}
		}
	}
}

### Foreigner converts province

# Inform host
character_event = {
	id = japan.562
	desc = EVTDESC_JAPAN_562
	picture = GFX_evt_religious_exultation
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	immediate = {
		random_realm_province = {
			limit = {
				NOT = {
					religion = FROM
				}
			}
			save_event_target_as = foreigners_target_province
		}
		FROM = {
			piety = 25
		}
	}
	
	option = {
		trigger = {
			religion = FROM
		}
		name = EVTOPTA_JAPAN_562 # Great!
		
		event_target:foreigners_target_province = {
			religion = FROM
		}
	}
	
	option = {
		trigger = {
			NOT = {
				religion = FROM
			}
		}
		name = EVTOPTB_JAPAN_562 # I see...
		
		piety = -25
		
		event_target:foreigners_target_province = {
			religion = FROM
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				OR = {
					trait = zealous
					trait = cruel
				}
			}
		}
	}
	
	option = {
		trigger = {
			NOT = {
				religion = FROM
			}
		}
		name = EVTOPTC_JAPAN_562 # Throw FROM in a cell!
		
		FROM = {
			imprison = ROOT
		}
		
		event_target:foreigners_target_province = {
			religion = FROM
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = cynical
			}
		}
	}
	
	option = {
		trigger = {
			NOT = {
				religion = FROM
			}
		}
		
		name = EVTOPTD_JAPAN_562 # Off with FROM's head!
		
		event_target:foreigners_target_province = {
			religion = FROM
		}
		
		FROM = {
			death = {
				death_reason = death_execution
				killer = ROOT
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = kind
			}
		}
	}
}

### Foreigner detects plot

# Plot discovered
character_event = {
	id = japan.563
	desc = EVTDESC_JAPAN_563
	picture = GFX_evt_shadow
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	immediate = {
		event_target:foreigners_host = {
			random_courtier_or_vassal = {
				limit = {
					is_inaccessible_or_incapable_trigger = no
					NOR = {
						any_friend = {
							character = ROOT
						}
						any_lover = {
							character = ROOT
						}
					}
					has_plot = yes
					NOT = {
						plot_is_known_by = event_target:foreigners_host
					}
				}
				preferred_limit = {
					any_rival = {
						character = ROOT
					}
					any_rival = {
						character =  event_target:foreigners_host
					}
				}
				preferred_limit = {
					any_rival = {
						character = ROOT
					}
				}
				preferred_limit = {
					any_rival = {
						character = event_target:foreigners_host
					}
				}
				save_event_target_as = foreigners_target
			}
		}
	}
	
	option = {
		name = EVTOPTA_JAPAN_563 # I know what you plan!
		
		event_target:foreigners_target = {
			reveal_plot = ROOT
			character_event = { id = japan.564 } # Inform the plotter
		}
		event_target:foreigners_host = {
			character_event = { id = japan.565 } # Inform the host
		}
	}
}

# Inform discovered plotter
character_event = {
	id = japan.564
	desc = EVTDESC_JAPAN_564
	picture = GFX_evt_shadow
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_564 # Curses!
		
		prestige = -25
	}
}

# Inform host
character_event = {
	id = japan.565
	desc = EVTDESC_JAPAN_565
	picture = GFX_evt_shadow
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_565 # I see...
		
		event_target:foreigners_target = {
			reveal_plot = ROOT
		}
	}
}

### Foreigner steals from courtier

# Foreigner picks target
character_event = {
	id = japan.566
	desc = EVTDESC_JAPAN_566
	picture = GFX_evt_shadow
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	immediate = {
		event_target:foreigners_host = {
			random_courtier = {
				limit = {
					is_landed = no
					is_inaccessible_or_incapable_trigger = no
					NOR = {
						any_friend = {
							character = ROOT
						}
						any_lover = {
							character = ROOT
						}
					}
				}
				preferred_limit = {
					any_rival = {
						character = ROOT
					}
				}
				save_event_target_as = foreigners_target
			}
		}
	}
	
	option = {
		name = EVTOPTA_JAPAN_566 # Such pretty baubles!
		
		random_list = {
			50 = {
				modifier = {
					factor = 0
					attribute_diff = {
						character = event_target:foreigners_target
						attribute = intrigue
						value <= -10
					}
				}
				modifier = {
					factor = 0.1
					attribute_diff = {
						character = event_target:foreigners_target
						attribute = intrigue
						value <= -1
					}
				}
				# It goes well
				character_event = { id = japan.567 days = 1 }
			}
			50 = {
				modifier = {
					factor = 0
					attribute_diff = {
						character = event_target:foreigners_target
						attribute = intrigue
						value >= 10
					}
				}
				modifier = {
					factor = 0.1
					attribute_diff = {
						character = event_target:foreigners_target
						attribute = intrigue
						value >= 1
					}
				}
				# It goes poorly
				character_event = { id = japan.568 days = 1 }
			}
		}
	}
}

# It goes well
character_event = {
	id = japan.567
	desc = EVTDESC_JAPAN_567
	picture = GFX_evt_shadow
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_567 # Great!
		
		wealth = 25
		
		event_target:foreigners_target = {
			wealth = -25
		}
	}
}

# It goes poorly
character_event = {
	id = japan.568
	desc = EVTDESC_JAPAN_568
	picture = GFX_evt_shadow
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_568 # Curses
		
		prestige = -10
		
		event_target:foreigners_target = {
			add_rival = ROOT
		}
		event_target:foreigners_host = {
			character_event = { id = japan.569 } # Inform host
		}
	}
}

# Infrom host if it went poorly
character_event = {
	id = japan.569
	desc = EVTDESC_JAPAN_569
	picture = GFX_evt_shadow
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	option = {
		name = EVTOPTA_JAPAN_569 # I don't know...
		
		prestige = -5
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				OR = {
					trait = just
					trait = cruel
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_JAPAN_569 # Throw FROM in a cell!
		
		FROM = {
			imprison = ROOT
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = arbitrary
			}
		}
	}
	
	option = {
		name = EVTOPTC_JAPAN_569 # Off with FROM's head!
		
		FROM = {
			death = {
				death_reason = death_execution
				killer = ROOT
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = kind
			}
		}
	}
}

### Foreigner steals from vassal

# Foreigner picks target
character_event = {
	id = japan.570
	desc = EVTDESC_JAPAN_570
	picture = GFX_evt_shadow
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	immediate = {
		event_target:foreigners_host = {
			random_realm_lord = {
				limit = {
					is_inaccessible_or_incapable_trigger = no
					NOR = {
						any_friend = {
							character = ROOT
						}
						any_lover = {
							character = ROOT
						}
					}
				}
				preferred_limit = {
					any_rival = {
						character = ROOT
					}
				}
				save_event_target_as = foreigners_target
			}
		}
	}
	
	option = {
		name = EVTOPTA_JAPAN_570 # Such pretty baubles!
		
		random_list = {
			50 = {
				modifier = {
					factor = 0
					attribute_diff = {
						character = event_target:foreigners_target
						attribute = intrigue
						value <= -10
					}
				}
				modifier = {
					factor = 0.1
					attribute_diff = {
						character = event_target:foreigners_target
						attribute = intrigue
						value <= -1
					}
				}
				# It goes well
				character_event = { id = japan.571 days = 1 }
			}
			50 = {
				modifier = {
					factor = 0
					attribute_diff = {
						character = event_target:foreigners_target
						attribute = intrigue
						value >= 10
					}
				}
				modifier = {
					factor = 0.1
					attribute_diff = {
						character = event_target:foreigners_target
						attribute = intrigue
						value >= 1
					}
				}
				# It goes poorly
				character_event = { id = japan.573 days = 1 }
			}
		}
	}
}

# It goes well
character_event = {
	id = japan.571
	desc = EVTDESC_JAPAN_571
	picture = GFX_evt_shadow
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_571 # Great!
		
		wealth = 50
		
		event_target:foreigners_target = {
			character_event = { id = japan.572 } # Inform target
		}
	}
}

# Inform vassal - money is missing
character_event = {
	id = japan.572
	desc = EVTDESC_JAPAN_572
	picture = GFX_evt_shadow
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_572 # Who did this?
		
		wealth = -50
	}
}

# It goes poorly - imprisoned
character_event = {
	id = japan.573
	desc = EVTDESC_JAPAN_573
	picture = GFX_evt_shadow
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_571 # Great!
		
		prestige = -25
		
		imprison = event_target:foreigners_target
		
		event_target:foreigners_target = {
			add_rival = ROOT
			character_event = { id = japan.574 } # Inform target
		}
	}
}

# Inform vassal - foreigner was imprisoned
character_event = {
	id = japan.574
	desc = EVTDESC_JAPAN_574
	picture = GFX_evt_shadow
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_574 # Thievery will not go unpunished!
		
		add_rival = FROM
		
		event_target:foreigners_host = {
			character_event = { id = japan.575 } # Inform host
		}
	}
}

# Infrom host if it went poorly
character_event = {
	id = japan.575
	desc = EVTDESC_JAPAN_575
	picture = GFX_evt_shadow
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_575 # I see...
	}
}

### Foreigner attempts seduction of courtier

# Foreigner picks target
character_event = {
	id = japan.576
	desc = EVTDESC_JAPAN_576
	picture = GFX_evt_garden
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	immediate = {
		event_target:foreigners_host = {
			random_courtier = {
				limit = {
					is_landed = no
					is_inaccessible_or_incapable_trigger = no
					is_adult = yes
					NOR = {
						any_rival = {
							character = ROOT
						}
						any_lover = {
							character = ROOT
						}
					}
					OR = {
						AND = {
							is_female = no
							NOT = {
								trait = homosexual
							}
							ROOT = {
								is_female = yes
								NOT = {
									trait = homosexual
								}
							}
						}
						AND = {
							is_female = yes
							NOT = {
								trait = homosexual
							}
							ROOT = {
								is_female = no
								NOT = {
									trait = homosexual
								}
							}
						}
						AND = {
							is_female = no
							trait = homosexual
							ROOT = {
								is_female = no
								trait = homosexual
							}
						}
						AND = {
							is_female = yes
							trait = homosexual
							ROOT = {
								is_female = yes
								trait = homosexual
							}
						}
					}
				}
				preferred_limit = {
					is_attractive_trigger = yes
				}
				save_event_target_as = foreigners_target
			}
		}
	}
	
	option = {
		name = EVTOPTA_JAPAN_576 # Yes!
		
		event_target:foreigners_target = {
			character_event = { id = japan.577 days = 1 } # Other party approached
		}
		
		piety = -10
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = chaste
			}
			modifier = {
				factor = 0
				trait = celibate
			}
			modifier = {
				factor = 0
				is_ascetic_trigger = yes
				NOT = {
					trait = lustful
				}
			}
			modifier = {
				factor = 0.1
				event_target:foreigners_target = {
					is_unattractive_trigger = yes
				}
			}
			modifier = {
				factor = 5
				event_target:foreigners_target = {
					is_attractive_trigger = yes
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_JAPAN_576 # I don't think so!
		
		piety = 10
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = lustful
			}
			modifier = {
				factor = 0
				OR = {
					trait = seducer
					trait = seductress
				}
			}
		}
	}
}

# Target approached
character_event = {
	id = japan.577
	desc = EVTDESC_JAPAN_577
	picture = GFX_evt_garden
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_577 # Yes!
		FROM = {
			save_event_target_as = sex_partner
		}
		unprotected_sex_effect_event_target = yes
		
		FROM = {
			character_event = { id = japan.579 } # Tumbling
		}
		
		piety = -10
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = chaste
			}
			modifier = {
				factor = 0
				trait = celibate
			}
			modifier = {
				factor = 0
				is_ascetic_trigger = yes
				NOT = {
					trait = lustful
				}
			}
			modifier = {
				factor = 0.1
				FROM = {
					is_unattractive_trigger = yes
				}
			}
			modifier = {
				factor = 5
				FROM = {
					is_attractive_trigger = yes
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_JAPAN_577 # I don't think so!
		
		FROM = {
			character_event = { id = japan.578 } # Shot down
		}
		
		piety = 10
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = lustful
			}
			modifier = {
				factor = 0
				OR = {
					trait = seducer
					trait = seductress
				}
			}
		}
	}
}

# Target turned down foreigner
character_event = {
	id = japan.578
	desc = EVTDESC_JAPAN_578
	picture = GFX_evt_garden
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_578 # I see...
	}
}

# Target accepted - lovers?
character_event = {
	id = japan.579
	desc = EVTDESC_JAPAN_579
	picture = GFX_evt_lovers
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_579 # Yes!
		
		add_lover = FROM
	}
	
	option = {
		name = EVTOPTB_JAPAN_579 # No!
	}
}

### Foreigner attempts seduction of ruler

# Foreigner picks target
character_event = {
	id = japan.580
	desc = EVTDESC_JAPAN_580
	picture = GFX_evt_garden
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	immediate = {
		random_list = {
			50 = {
				modifier = {
					factor = 0
					NOT = {
						event_target:foreigners_host = {
							any_realm_lord = {
								is_inaccessible_or_incapable_trigger = no
								is_adult = yes
								NOR = {
									any_rival = {
										character = ROOT
									}
									any_lover = {
										character = ROOT
									}
								}
								OR = {
									AND = {
										is_female = no
										NOT = {
											trait = homosexual
										}
										ROOT = {
											is_female = yes
											NOT = {
												trait = homosexual
											}
										}
									}
									AND = {
										is_female = yes
										NOT = {
											trait = homosexual
										}
										ROOT = {
											is_female = no
											NOT = {
												trait = homosexual
											}
										}
									}
									AND = {
										is_female = no
										trait = homosexual
										ROOT = {
											is_female = no
											trait = homosexual
										}
									}
									AND = {
										is_female = yes
										trait = homosexual
										ROOT = {
											is_female = yes
											trait = homosexual
										}
									}
								}
							}
						}
					}
				}
				event_target:foreigners_host = {
					random_courtier = {
						limit = {
							is_landed = no
							is_inaccessible_or_incapable_trigger = no
							is_adult = yes
							NOR = {
								any_rival = {
									character = ROOT
								}
								any_lover = {
									character = ROOT
								}
							}
							OR = {
								AND = {
									is_female = no
									NOT = {
										trait = homosexual
									}
									ROOT = {
										is_female = yes
										NOT = {
											trait = homosexual
										}
									}
								}
								AND = {
									is_female = yes
									NOT = {
										trait = homosexual
									}
									ROOT = {
										is_female = no
										NOT = {
											trait = homosexual
										}
									}
								}
								AND = {
									is_female = no
									trait = homosexual
									ROOT = {
										is_female = no
										trait = homosexual
									}
								}
								AND = {
									is_female = yes
									trait = homosexual
									ROOT = {
										is_female = yes
										trait = homosexual
									}
								}
							}
						}
						preferred_limit = {
							is_attractive_trigger = yes
						}
						save_event_target_as = foreigners_target
					}
				}
			}
			50 = {
				modifier = {
					factor = 0
					NOT = {
						event_target:foreigners_host = {
							is_inaccessible_or_incapable_trigger = no
							is_adult = yes
							NOR = {
								any_rival = {
									character = ROOT
								}
								any_lover = {
									character = ROOT
								}
							}
							OR = {
								AND = {
									is_female = no
									NOT = {
										trait = homosexual
									}
									ROOT = {
										is_female = yes
										NOT = {
											trait = homosexual
										}
									}
								}
								AND = {
									is_female = yes
									NOT = {
										trait = homosexual
									}
									ROOT = {
										is_female = no
										NOT = {
											trait = homosexual
										}
									}
								}
								AND = {
									is_female = no
									trait = homosexual
									ROOT = {
										is_female = no
										trait = homosexual
									}
								}
								AND = {
									is_female = yes
									trait = homosexual
									ROOT = {
										is_female = yes
										trait = homosexual
									}
								}
							}
						}
					}
				}
				event_target:foreigners_host = {
					save_event_target_as = foreigners_target
				}
			}
		}
	}
	
	option = {
		name = EVTOPTA_JAPAN_580 # Yes!
		
		event_target:foreigners_target = {
			character_event = { id = japan.581 days = 1 } # Other party approached
		}
		
		piety = -10
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = chaste
			}
			modifier = {
				factor = 0
				trait = celibate
			}
			modifier = {
				factor = 0
				is_ascetic_trigger = yes
				NOT = {
					trait = lustful
				}
			}
			modifier = {
				factor = 0.1
				event_target:foreigners_target = {
					is_unattractive_trigger = yes
				}
			}
			modifier = {
				factor = 5
				event_target:foreigners_target = {
					is_attractive_trigger = yes
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_JAPAN_580 # I don't think so!
		
		piety = 10
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = lustful
			}
			modifier = {
				factor = 0
				OR = {
					trait = seducer
					trait = seductress
				}
			}
		}
	}
}

# Target approached
character_event = {
	id = japan.581
	desc = EVTDESC_JAPAN_581
	picture = GFX_evt_garden
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_581 # Yes!
		FROM = {
			save_event_target_as = sex_partner
		}
		unprotected_sex_effect_event_target = yes
		
		FROM = {
			character_event = { id = japan.583 } # Tumbling
		}
		
		piety = -10
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = chaste
			}
			modifier = {
				factor = 0
				trait = celibate
			}
			modifier = {
				factor = 0
				is_ascetic_trigger = yes
				NOT = {
					trait = lustful
				}
			}
			modifier = {
				factor = 0.1
				FROM = {
					is_unattractive_trigger = yes
				}
			}
			modifier = {
				factor = 5
				FROM = {
					is_attractive_trigger = yes
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_JAPAN_581 # I don't think so!
		
		FROM = {
			character_event = { id = japan.582 } # Shot down
		}
		
		piety = 10
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = lustful
			}
			modifier = {
				factor = 0
				OR = {
					trait = seducer
					trait = seductress
				}
			}
		}
	}
}

# Target turned down foreigner
character_event = {
	id = japan.582
	desc = EVTDESC_JAPAN_582
	picture = GFX_evt_garden
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_582 # I see...
	}
}

# Target accepted - lovers?
character_event = {
	id = japan.583
	desc = EVTDESC_JAPAN_583
	picture = GFX_evt_lovers
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_583 # Yes!
		
		add_lover = FROM
		
		FROM = {
			character_event = { id = japan.584 days = 1 } # Inform FROM
		}
	}
	
	option = {
		name = EVTOPTB_JAPAN_583 # No!
		
		FROM = {
			character_event = { id = japan.585 days = 1 } # Inform FROM
		}
	}
}

# Lovers
character_event = {
	id = japan.584
	desc = EVTDESC_JAPAN_584
	picture = GFX_evt_lovers
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_584 # That's great!
		
		add_lover = FROM
	}
}

# Not lovers
character_event = {
	id = japan.585
	desc = EVTDESC_JAPAN_585
	picture = GFX_evt_lovers
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_585 # I see...
	}
}

### Foreigner improves local prosperity

# Prosperity improves
character_event = {
	id = japan.586
	desc = EVTDESC_JAPAN_586
	picture = GFX_evt_prospering_province
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	immediate = {
		random_realm_province = {
			save_event_target_as = foreigners_target_province
		}
	}
	
	option = {
		name = EVTOPTA_JAPAN_586 # That's nice!
		
		event_target:foreigners_target_province = {
			hidden_tooltip = {
				change_variable = { which = prosperity_value value = 6 }
			}
		}
	}
}

### Foreigner upsets courtier

# Pick someone to upset
character_event = {
	id = japan.587
	desc = EVTDESC_JAPAN_587
	picture = GFX_evt_scandal
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	immediate = {
		event_target:foreigners_host = {
			random_courtier = {
				limit = {
					is_landed = no
					is_inaccessible_or_incapable_trigger = no
				}
				preferred_limit = {
					NOR = {
						any_friend = {
							character = ROOT
						}
						any_lover = {
							character = ROOT
						}
					}
				}
				save_event_target_as = foreigners_target
			}
		}
	}
	
	option = {
		name = EVTOPTA_JAPAN_587 # Oops!
		
		prestige = -10
		
		event_target:foreigners_target = {
			character_event = { id = japan.588 } # Inform target
		}
	}
}

# Courtier gets upset
character_event = {
	id = japan.588
	desc = EVTDESC_JAPAN_588
	picture = GFX_evt_scandal
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_588 # How rude!
		
		opinion = {
			who = FROM
			modifier = opinion_dislike
		}
		
		event_target:foreigners_host = {
			character_event = { id = japan.589 } # Inform host
		}
	}
}

# Inform host
character_event = {
	id = japan.589
	desc = EVTDESC_JAPAN_589
	picture = GFX_evt_scandal
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_589 # I don't know...
		
		prestige = -5
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				OR = {
					trait = arbitrary
					trait = cruel
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_JAPAN_589 # Throw FROM in a cell!
		
		FROM = {
			imprison = ROOT
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = just
			}
		}
	}
	
	option = {
		name = EVTOPTC_JAPAN_589 # Off with FROM's head!
		
		FROM = {
			death = {
				death_reason = death_execution
				killer = ROOT
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = kind
			}
		}
	}
}

### Foreigner upsets vassal

# Pick someone to upset
character_event = {
	id = japan.590
	desc = EVTDESC_JAPAN_590
	picture = GFX_evt_scandal
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	immediate = {
		event_target:foreigners_host = {
			random_realm_lord = {
				limit = {
					is_inaccessible_or_incapable_trigger = no
				}
				preferred_limit = {
					NOR = {
						any_friend = {
							character = ROOT
						}
						any_lover = {
							character = ROOT
						}
					}
				}
				save_event_target_as = foreigners_target
			}
		}
	}
	
	option = {
		name = EVTOPTA_JAPAN_590 # Oops!
		
		prestige = -10
		
		event_target:foreigners_target = {
			character_event = { id = japan.591 } # Inform target
		}
	}
}

# Vassal gets upset
character_event = {
	id = japan.591
	desc = EVTDESC_JAPAN_591
	picture = GFX_evt_scandal
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_591 # How rude!
		
		opinion = {
			who = FROM
			modifier = opinion_dislike
		}
		
		event_target:foreigners_host = {
			character_event = { id = japan.592 } # Inform host
		}
	}
}

# Inform host
character_event = {
	id = japan.592
	desc = EVTDESC_JAPAN_592
	picture = GFX_evt_scandal
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_592 # I don't know...
		
		prestige = -5
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				OR = {
					trait = arbitrary
					trait = cruel
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_JAPAN_592 # Throw FROM in a cell!
		
		FROM = {
			imprison = ROOT
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = just
			}
		}
	}
	
	option = {
		name = EVTOPTC_JAPAN_592 # Off with FROM's head!
		
		FROM = {
			death = {
				death_reason = death_execution
				killer = ROOT
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = kind
			}
		}
	}
}

### Foreigner upsets host

# Host is insulted
character_event = {
	id = japan.593
	desc = EVTDESC_JAPAN_593
	picture = GFX_evt_scandal
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_593 # How rude!
		
		prestige = -10
		
		opinion = {
			who = FROM
			modifier = opinion_dislike
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				OR = {
					trait = arbitrary
					trait = proud
					trait = cruel
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_JAPAN_593 # Throw FROM in a cell!
		
		FROM = {
			imprison = ROOT
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = just
				NOT = {
					trait = proud
				}
			}
			modifier = {
				factor = 0.01
				trait = just
			}
		}
	}
	
	option = {
		name = EVTOPTC_JAPAN_593 # Off with FROM's head!
		
		FROM = {
			death = {
				death_reason = death_execution
				killer = ROOT
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = kind
				NOT = {
					trait = proud
				}
			}
			modifier = {
				factor = 0.01
				trait = kind
			}
		}
	}
}

### Foreigner is useless

# Foreigner is useless - inform host
character_event = {
	id = japan.594
	desc = EVTDESC_JAPAN_594
	picture = GFX_evt_scandal
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_594 # I see...
		
		prestige = -10
	}
}

### Foreigner is crazy - attempts murder

# Foreigner picks target
character_event = {
	id = japan.595
	desc = EVTDESC_JAPAN_595
	picture = GFX_evt_shadow
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	immediate = {
		event_target:foreigners_host = {
			random_courtier = {
				limit = {
					is_inaccessible_or_incapable_trigger = no
					is_landed = no
				}
				# The foreigner is crazy, so no preferences!
				save_event_target_as = foreigners_target
			}
		}
	}
	
	option = {
		name = EVTOPTA_JAPAN_595 # The voices' command is clear!
		
		random_list = {
			50 = {
				modifier = {
					factor = 0
					attribute_diff = {
						character = event_target:foreigners_target
						attribute = intrigue
						value <= -10
					}
				}
				modifier = {
					factor = 0.1
					attribute_diff = {
						character = event_target:foreigners_target
						attribute = intrigue
						value <= -1
					}
				}
				# It goes well
				character_event = { id = japan.596 days = 1 }
			}
			50 = {
				modifier = {
					factor = 0
					attribute_diff = {
						character = event_target:foreigners_target
						attribute = intrigue
						value >= 10
					}
				}
				modifier = {
					factor = 0.1
					attribute_diff = {
						character = event_target:foreigners_target
						attribute = intrigue
						value >= 1
					}
				}
				# It goes poorly
				character_event = { id = japan.598 days = 1 }
			}
		}
	}
}

# Murder attempt succeeds
character_event = {
	id = japan.596
	desc = EVTDESC_JAPAN_596
	picture = GFX_evt_shadow
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_596 # Do not want!
		
		event_target:foreigners_host = {
			character_event = { id = japan.597 } # Inform host
		}
		
		hidden_tooltip = {
			save_event_target_as = target_victim
			FROM = { character_event = { id = 10 } } # Consequences of discovery
			clear_event_target = target_victim
		}
		death = {
			death_reason = death_murder
			killer = FROM
		}
	}
}

# Infrom host
character_event = {
	id = japan.597
	desc = EVTDESC_JAPAN_597
	picture = GFX_evt_shadow
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_597 # I don't know...
		
		prestige = -25
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				OR = {
					trait = just
					trait = cruel
					any_close_relative = {
						character = FROM
					}
					any_spouse_even_if_dead = {
						character = FROM
					}
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_JAPAN_597 # Throw FROM in a cell!
		
		FROM = {
			imprison = ROOT
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = arbitrary
				NOR = {
					any_close_relative = {
						character = FROM
					}
					any_spouse_even_if_dead = {
						character = FROM
					}
				}
			}
			modifier = {
				factor = 0.01
				trait = arbitrary
			}
		}
	}
	
	option = {
		name = EVTOPTC_JAPAN_597 # Off with FROM's head!
		
		FROM = {
			death = {
				death_reason = death_execution
				killer = ROOT
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = kind
				NOR = {
					any_close_relative = {
						character = FROM
					}
					any_spouse_even_if_dead = {
						character = FROM
					}
				}
			}
			modifier = {
				factor = 0.01
				trait = kind
			}
		}
	}
}

# Murder attempt fails
character_event = {
	id = japan.598
	desc = EVTDESC_JAPAN_598
	picture = GFX_evt_shadow
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_598 # I got away!
		
		event_target:foreigners_host = {
			character_event = { id = japan.599 } # Inform host
		}
		
		add_rival = FROM
	}
}

# Inform host
character_event = {
	id = japan.599
	desc = EVTDESC_JAPAN_599
	picture = GFX_evt_shadow
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_599 # I don't know...
		
		prestige = -25
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				OR = {
					trait = just
					trait = cruel
					any_close_relative = {
						character = FROM
					}
					any_spouse_even_if_dead = {
						character = FROM
					}
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_JAPAN_599 # Throw FROM in a cell!
		
		FROM = {
			imprison = ROOT
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = arbitrary
				NOR = {
					any_close_relative = {
						character = FROM
					}
					any_spouse_even_if_dead = {
						character = FROM
					}
				}
			}
			modifier = {
				factor = 0.01
				trait = arbitrary
			}
		}
	}
	
	option = {
		name = EVTOPTC_JAPAN_599 # Off with FROM's head!
		
		FROM = {
			death = {
				death_reason = death_execution
				killer = ROOT
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = kind
				NOR = {
					any_close_relative = {
						character = FROM
					}
					any_spouse_even_if_dead = {
						character = FROM
					}
				}
			}
			modifier = {
				factor = 0.01
				trait = kind
			}
		}
	}
}

### Foreigner is crazy - picks up completely random religion or culture

# Foreigner picks up random religion or culture
character_event = {
	id = japan.600
	desc = EVTDESC_JAPAN_600
	picture = GFX_evt_religious_exultation
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	immediate = {
		random_independent_ruler = {
			limit = {
				any_realm_province = {
					NOR = {
						religion = ROOT
						culture = ROOT
					}
				}
			}
			random_realm_province = {
				limit = {
					NOR = {
						religion = ROOT
						culture = ROOT
					}
				}
				save_event_target_as = foreigners_target_province
			}
		}
	}
	
	option = {
		name = EVTOPTA_JAPAN_600 # New day, new me!
		
		religion = event_target:foreigners_target_province
		culture = event_target:foreigners_target_province
		
		event_target:foreigners_host = {
			character_event = { id = japan.601 } # Inform host
		}
	}
}

# Inform host
character_event = {
	id = japan.601
	desc = EVTDESC_JAPAN_601
	picture = GFX_evt_religious_exultation
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_601 # I see...
	}
}

### Foreigner converts religion

# Inform host
character_event = {
	id = japan.602
	desc = EVTDESC_JAPAN_602
	picture = GFX_evt_religious_exultation
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_602 # That's great!
		
		FROM = {
			religion = ROOT
		}
		
		piety = 10
	}
}

### Foreigner converts culture

# Inform host
character_event = {
	id = japan.603
	desc = EVTDESC_JAPAN_603
	picture = GFX_evt_religious_exultation
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_603 # That's great!
		
		FROM = {
			culture = ROOT
		}
		
		prestige = 10
	}
}

### Foreigner wishes to marry

# Check to see if there's a preferred spouse
character_event = {
	id = japan.604
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				event_target:foreigners_host = {
					any_courtier = {
						is_landed = no
						is_inaccessible_or_incapable_trigger = no
						is_married = no
						is_consort = no
						num_of_consorts = 0
						any_lover = {
							character = ROOT
						}
						is_betrothed = no
						is_ascetic_trigger = no
						# In case something odd has happened
						NOT = {
							trait = homosexual
						}
						is_opposite_sex = ROOT
					}
				}
			}
			event_target:foreigners_host = {
				random_courtier = {
					limit = {
						is_landed = no
						is_inaccessible_or_incapable_trigger = no
						is_married = no
						is_consort = no
						num_of_consorts = 0
						any_lover = {
							character = ROOT
						}
						is_betrothed = no
						is_ascetic_trigger = no
						# In case something odd has happened
						NOT = {
							trait = homosexual
						}
						is_opposite_sex = ROOT
					}
					preferred_limit = {
						NOT = {
							num_of_lovers = 2
						}
					}
					save_event_target_as = foreigners_choice
				}
				character_event = { id = japan.605 } # Host approached about marriage
			}
		}
		else_if = {
			limit = {
				event_target:foreigners_host = {
					any_courtier = {
						is_adult = yes
						is_landed = no
						is_inaccessible_or_incapable_trigger = no
						is_married = no
						is_consort = no
						num_of_consorts = 0
						any_friend = {
							character = ROOT
						}
						is_betrothed = no
						is_ascetic_trigger = no
						# In case something odd has happened
						NOT = {
							trait = homosexual
						}
						is_opposite_sex = ROOT
					}
				}
			}
			event_target:foreigners_host = {
				random_courtier = {
					limit = {
						is_adult = yes
						is_landed = no
						is_inaccessible_or_incapable_trigger = no
						is_married = no
						is_consort = no
						num_of_consorts = 0
						any_friend = {
							character = ROOT
						}
						is_betrothed = no
						is_ascetic_trigger = no
						# In case something odd has happened
						NOT = {
							trait = homosexual
						}
						is_opposite_sex = ROOT
					}
					preferred_limit = {
						NOT = {
							num_of_lovers = 1
						}
					}
					save_event_target_as = foreigners_choice
				}
				character_event = { id = japan.605 } # Host approached about marriage
			}
		}
		else = {
			character_event = { id = japan.606 } # Host approached about marriage
		}
	}
}

# Request is made - has a preference
character_event = {
	id = japan.605
	desc = EVTDESC_JAPAN_605
	picture = GFX_evt_emissary
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	immediate = {
		# Figure out a dynastic option
		if = {
			limit = {
				event_target:foreigners_choice = {
					NOT = {
						dynasty = ROOT
					}
				}
			}
			random_courtier = {
				limit = {
					dynasty = ROOT
					is_adult = yes
					is_landed = no
					is_inaccessible_or_incapable_trigger = no
					is_married = no
					is_consort = no
					num_of_consorts = 0
					NOT = {
						any_rival = {
							character = FROM
						}
					}
					is_betrothed = no
					is_ascetic_trigger = no
					# In case something odd has happened
					NOT = {
						trait = homosexual
					}
					is_opposite_sex = ROOT
				}
				preferred_limit = {
					any_lover = {
						character = FROM
					}
				}
				preferred_limit = {
					any_friend = {
						character = FROM
					}
				}
				preferred_limit = {
					NOT = {
						num_of_lovers = 1
					}
				}
				save_event_target_as = dynastic_choice
			}
		}
	}
	
	option = {
		name = EVTOPTA_JAPAN_605 # Sure!
		
		if = {
			limit = {
				FROM = {
					is_female = no
				}
			}
			FROM = {
				add_spouse = event_target:foreigners_choice
			}
		}
		else = {
			FROM = {
				add_spouse_matrilineal = event_target:foreigners_choice
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				trait = humble
			}
			modifier = {
				factor = 0
				trait = proud
			}
			modifier = {
				factor = 0
				any_rival = {
					character = FROM
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_JAPAN_605 # I have a better choice; my kins(wo)man!
		
		if = {
			limit = {
				FROM = {
					is_female = no
				}
			}
			FROM = {
				add_spouse = event_target:dynastic_choice
			}
		}
		else = {
			FROM = {
				add_spouse_matrilineal = event_target:dynastic_choice
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				NOT = {
					trait = humble
				}
			}
			modifier = {
				factor = 0
				any_rival = {
					character = FROM
				}
			}
		}
	}
	
	option = {
		name = EVTOPTC_JAPAN_605 # I can find a commoner for you...
		
		if = {
			limit = {
				FROM = {
					is_female = no
				}
			}
			create_character = {
				age = 25
				female = yes
				dynasty = none
				culture = ROOT
				religion = ROOT
				random_traits = yes
			}
			new_character = {
				add_spouse = FROM
			}
		}
		else = {
			create_character = {
				age = 25
				female = no
				dynasty = none
				culture = ROOT
				religion = ROOT
				random_traits = yes
			}
			new_character = {
				add_spouse_matrilineal = FROM
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.01
				NOT = {
					trait = proud
				}
			}
			modifier = {
				factor = 0
				any_rival = {
					character = FROM
				}
			}
		}
	}
	
	option = {
		name = EVTOPTD_JAPAN_605 # You don't deserve a spouse!
		
		add_rival = FROM
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				NOR = {
					trait = cruel
					any_rival = {
						character = FROM
					}
				}
			}
		}
	}
}

# Request is made - general
character_event = {
	id = japan.606
	desc = EVTDESC_JAPAN_606
	picture = GFX_evt_emissary
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	immediate = {
		# Figure out a non-dynastic option
		random_courtier = {
			limit = {
				NOT = {
					dynasty = ROOT
				}
				is_adult = yes
				is_landed = no
				is_inaccessible_or_incapable_trigger = no
				is_married = no
				is_consort = no
				num_of_consorts = 0
				NOT = {
					any_rival = {
						character = FROM
					}
				}
				is_betrothed = no
				is_ascetic_trigger = no
				# In case something odd has happened
				NOT = {
					trait = homosexual
				}
				is_opposite_sex = ROOT
			}
			preferred_limit = {
				any_lover = {
					character = FROM
				}
			}
			preferred_limit = {
				any_friend = {
					character = FROM
				}
			}
			preferred_limit = {
				NOT = {
					num_of_lovers = 1
				}
			}
			save_event_target_as = non_dynastic_choice
		}
		
		# Figure out a dynastic option
		random_courtier = {
			limit = {
				dynasty = ROOT
				is_adult = yes
				is_landed = no
				is_inaccessible_or_incapable_trigger = no
				is_married = no
				is_consort = no
				num_of_consorts = 0
				NOT = {
					any_rival = {
						character = FROM
					}
				}
				is_betrothed = no
				is_ascetic_trigger = no
				# In case something odd has happened
				NOT = {
					trait = homosexual
				}
				is_opposite_sex = ROOT
			}
			preferred_limit = {
				any_lover = {
					character = FROM
				}
			}
			preferred_limit = {
				any_friend = {
					character = FROM
				}
			}
			preferred_limit = {
				NOT = {
					num_of_lovers = 1
				}
			}
			save_event_target_as = dynastic_choice
		}
	}
	
	option = {
		name = EVTOPTA_JAPAN_606 # I have a non-dynastic choice in mind!
		
		if = {
			limit = {
				FROM = {
					is_female = no
				}
			}
			FROM = {
				add_spouse = event_target:non_dynastic_choice
			}
		}
		else = {
			FROM = {
				add_spouse_matrilineal = event_target:non_dynastic_choice
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				trait = humble
			}
			modifier = {
				factor = 0
				trait = proud
			}
			modifier = {
				factor = 0
				any_rival = {
					character = FROM
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_JAPAN_606 # I have a kins(wo)man in mind!
		
		if = {
			limit = {
				FROM = {
					is_female = no
				}
			}
			FROM = {
				add_spouse = event_target:dynastic_choice
			}
		}
		else = {
			FROM = {
				add_spouse_matrilineal = event_target:dynastic_choice
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				NOT = {
					trait = humble
				}
			}
			modifier = {
				factor = 0
				any_rival = {
					character = FROM
				}
			}
		}
	}
	
	option = {
		name = EVTOPTC_JAPAN_606 # I can find a commoner for you...
		
		if = {
			limit = {
				FROM = {
					is_female = no
				}
			}
			create_character = {
				age = 25
				female = yes
				dynasty = none
				culture = ROOT
				religion = ROOT
				random_traits = yes
			}
			new_character = {
				add_spouse = FROM
			}
		}
		else = {
			create_character = {
				age = 25
				female = no
				dynasty = none
				culture = ROOT
				religion = ROOT
				random_traits = yes
			}
			new_character = {
				add_spouse_matrilineal = FROM
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.01
				NOT = {
					trait = proud
				}
			}
			modifier = {
				factor = 0
				any_rival = {
					character = FROM
				}
			}
		}
	}
	
	option = {
		name = EVTOPTD_JAPAN_606 # You don't deserve a spouse!
		
		add_rival = FROM
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				NOR = {
					trait = cruel
					any_rival = {
						character = FROM
					}
				}
			}
		}
	}
}




# Buddhism appears from "nowhere"
province_event = {
	id = japan.2
	desc = EVTDESC_JAPAN_2
	picture = GFX_evt_burning_house
	border = GFX_event_normal_frame_religion
	
	trigger = {
		religion = shinto
	}
	
	mean_time_to_happen = {
		months = 1200
		modifier = {
			factor = 2.0
			religion_authority = 0.6
		}
		modifier = {
			factor = 2.0
			religion_authority = 0.8
		}
		modifier = {
			factor = 2
			has_game_rule = {
				name = religious_conversion
				value = slower
			}
		}
		modifier = {
			factor = 0.75
			NOT = { religion_authority = 0.2 }
		}
		modifier = {
			factor = 0.75
			NOT = { religion_authority = 0.4 }
		}
	}
	
	immediate = {
		religion = buddhist
		add_province_modifier = {
			name = religious_unrest
			duration = 730
		}
	}
	
	option = {
		name = {
			text = EVTOPTA_JAPAN_2
			trigger = {
				owner = {
					NOR = {
						religion = shinto
						religion = ROOT
					}
				}
			}
		}
		name = {
			text = EVTOPTB_JAPAN_2
			trigger = { owner = { religion = ROOT } }
		}
		name = {
			text = EVTOPTC_JAPAN_2
			trigger = { owner = { religion = shinto } }
		}
		if = {
			limit = { 
				ruler = { religion = shinto }
			}
			ruler = { piety = -10 }
		}
		# News spread
		hidden_tooltip = {
			owner = {
				top_liege = {
					if = {
						limit = {
							NOT = { character = PREV }
						}
						character_event = { id = japan.3 days = 2 }
					}
					any_vassal = {
						limit = {
							OR = {
								is_parent_religion = ROOT
								religion = ROOT
							}
						}
						character_event = { id = japan.3 days = 2 }
					}
				}
			}
		}
	}
}

# News spread in realm
character_event = {
	id = japan.3
	desc = EVTDESC_JAPAN_3
	picture = GFX_evt_heretic
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_3
		trigger = {
			NOR = {
				religion = shinto
				religion = FROM
			}
		}
	}
	option = {
		name = EVTOPTB_JAPAN_3
		trigger = {
			religion = FROM
		}
	}
	option = {
		name = EVTOPTC_JAPAN_3
		trigger = {
			religion = shinto
		}
	}
}

# Random religion appears from "nowehere"
province_event = {
	id = japan.4
	desc = EVTDESC_JAPAN_4
	picture = GFX_evt_burning_house
	border = GFX_event_normal_frame_religion
		
	trigger = {
		religion = shinto
		any_neighbor_province = {
			OR = {
				AND = {
					has_owner = yes
					NOR = {
						religion = shinto
						religion_group = pagan_group
						religion = jain # Shouldn't spread to silly places!
						religion = buddhist # Has its own event
					}
				}
				AND = {
					is_land = no
					any_neighbor_province = {
						OR = {
							AND = {
								has_owner = yes
								NOR = {
									religion = shinto
									religion_group = pagan_group
									religion = jain # Shouldn't spread to silly places!
									religion = buddhist # Has its own event
								}
							}
							AND = {
								is_land = no
								any_neighbor_province = {
									NOR = {
										religion = shinto
										religion_group = pagan_group
										religion = jain # Shouldn't spread to silly places!
										religion = buddhist # Has its own event
									}
								}
							}
						}
					}
				}
			}
		}
	}
	
	mean_time_to_happen = {
		months = 9600
		modifier = {
			factor = 2.0
			religion_authority = 0.6
		}
		modifier = {
			factor = 2.0
			religion_authority = 0.8
		}
		modifier = {
			factor = 2
			has_game_rule = {
				name = religious_conversion
				value = slower
			}
		}
		modifier = {
			factor = 0.75
			NOT = { religion_authority = 0.2 }
		}
		modifier = {
			factor = 0.75
			NOT = { religion_authority = 0.4 }
		}
	}
	
	immediate = {
		random_list = {
			34 = {
				modifier = {
					factor = 0
					NOT = {
						any_neighbor_province = {
							has_owner = yes
							NOR = {
								religion = shinto
								religion_group = pagan_group
								religion = jain # Shouldn't spread to silly places!
								religion = buddhist # Has its own event
							}
						}
					}
				}
				random_neighbor_province = {
					limit = {
						has_owner = yes
						NOR = {
							religion = shinto
							religion_group = pagan_group
							religion = jain # Shouldn't spread to silly places!
							religion = buddhist # Has its own event
						}
					}
					ROOT = {
						religion = PREV
					}
				}
			}
			33 = {
				modifier = {
					factor = 0
					NOT = {
						any_neighbor_province = {
							is_land = no
							any_neighbor_province = {
								has_owner = yes
								NOR = {
									religion = shinto
									religion_group = pagan_group
									religion = jain # Shouldn't spread to silly places!
									religion = buddhist # Has its own event
								}
							}
						}
					}
				}
				random_neighbor_province = {
					limit = {
						is_land = no
					}
					random_neighbor_province = {
						limit = {
							has_owner = yes
							NOR = {
								religion = shinto
								religion_group = pagan_group
								religion = jain # Shouldn't spread to silly places!
								religion = buddhist # Has its own event
							}
						}
						ROOT = {
							religion = PREV
						}
					}
				}
			}
			33 = {
				modifier = {
					factor = 0
					NOT = {
						any_neighbor_province = {
							is_land = no
							any_neighbor_province = {
								is_land = no
								any_neighbor_province = {
									has_owner = yes
									NOR = {
										religion = shinto
										religion_group = pagan_group
										religion = jain # Shouldn't spread to silly places!
										religion = buddhist # Has its own event
									}
								}
							}
						}
					}
				}
				random_neighbor_province = {
					limit = {
						is_land = no
					}
					random_neighbor_province = {
						limit = {
							is_land = no
						}
						random_neighbor_province = {
							limit = {
								has_owner = yes
								NOR = {
									religion = shinto
									religion_group = pagan_group
									religion = jain # Shouldn't spread to silly places!
									religion = buddhist # Has its own event
								}
							}
							ROOT = {
								religion = PREV
							}
						}
					}
				}
			}
		}
		add_province_modifier = {
			name = religious_unrest
			duration = 730
		}
	}
	
	option = {
		name = {
			text = EVTOPTA_JAPAN_4
			trigger = {
				owner = {
					NOR = {
						religion = shinto
						religion = ROOT
					}
				}
			}
		}
		name = {
			text = EVTOPTB_JAPAN_4
			trigger = { owner = { religion = ROOT } }
		}
		name = {
			text = EVTOPTC_JAPAN_4
			trigger = { owner = { religion = shinto } }
		}
		if = {
			limit = { 
				ruler = { religion = shinto }
			}
			ruler = { piety = -10 }
		}
		# News spread
		hidden_tooltip = {
			owner = {
				top_liege = {
					if = {
						limit = {
							NOT = { character = PREV }
						}
						character_event = { id = japan.5 days = 2 }
					}
					any_vassal = {
						limit = {
							OR = {
								is_parent_religion = ROOT
								religion = ROOT
							}
						}
						character_event = { id = japan.5 days = 2 }
					}
				}
			}
		}
	}
}

# News spread in realm
character_event = {
	id = japan.5
	desc = EVTDESC_JAPAN_5
	picture = GFX_evt_heretic
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_JAPAN_5
		trigger = {
			NOR = {
				religion = shinto
				religion = FROM
			}
		}
	}
	option = {
		name = EVTOPTB_JAPAN_5
		trigger = {
			religion = FROM
		}
	}
	option = {
		name = EVTOPTC_JAPAN_5
		trigger = {
			religion = shinto
		}
	}
}