# Still a bit WIP - could use simplification as the current version is costly from a performance standpoint when it is evaluated

calculate_current_mandate_of_heaven_effect = {
	log = "Calculating new Mandate of Heaven level for [Root.GetTitledName]"
	
	if = {
		limit = {
			has_game_rule = {
				name = mandate_of_heaven
				value = enabled
			}
		}
		calculate_personal_mandate_of_heaven_effect = yes
		calculate_realm_health_mandate_of_heaven_effect = yes 
		calculate_misc_mandate_of_heaven_effect = yes
		
		log = "Time for multiplication and division!"
		
		# Try to make it harder to get very high/very low Mandate
		if = {
			limit = {
				has_character_modifier = mandate_of_heaven_5
			}
			if = {
				limit = {
					check_variable = {
						which = personal_mandate_of_heaven
						value = 0
					}
				}
				divide_variable = {
					which = personal_mandate_of_heaven
					value = 2
				}
			}
			else = {
				multiply_variable = {
					which = personal_mandate_of_heaven
					value = 2
				}
			}
			if = {
				limit = {
					check_variable = {
						which = realm_mandate_of_heaven
						value = 0
					}
				}
				divide_variable = {
					which = realm_mandate_of_heaven
					value = 2
				}
			}
			else = {
				multiply_variable = {
					which = realm_mandate_of_heaven
					value = 2
				}
			}
			if = {
				limit = {
					check_variable = {
						which = misc_mandate_of_heaven
						value = 0
					}
				}
				divide_variable = {
					which = misc_mandate_of_heaven
					value = 2
				}
			}
			else = {
				multiply_variable = {
					which = misc_mandate_of_heaven
					value = 2
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = mandate_of_heaven_4
			}
			if = {
				limit = {
					check_variable = {
						which = personal_mandate_of_heaven
						value = 0
					}
				}
				divide_variable = {
					which = personal_mandate_of_heaven
					value = 1.2
				}
			}
			else = {
				multiply_variable = {
					which = personal_mandate_of_heaven
					value = 1.2
				}
			}
			if = {
				limit = {
					check_variable = {
						which = realm_mandate_of_heaven
						value = 0
					}
				}
				divide_variable = {
					which = realm_mandate_of_heaven
					value = 1.2
				}
			}
			else = {
				multiply_variable = {
					which = realm_mandate_of_heaven
					value = 1.2
				}
			}
			if = {
				limit = {
					check_variable = {
						which = misc_mandate_of_heaven
						value = 0
					}
				}
				divide_variable = {
					which = misc_mandate_of_heaven
					value = 1.2
				}
			}
			else = {
				multiply_variable = {
					which = misc_mandate_of_heaven
					value = 1.2
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = mandate_of_heaven_2
			}
			if = {
				limit = {
					check_variable = {
						which = personal_mandate_of_heaven
						value = 0
					}
				}
				multiply_variable = {
					which = personal_mandate_of_heaven
					value = 1.2
				}
			}
			else = {
				divide_variable = {
					which = personal_mandate_of_heaven
					value = 1.2
				}
			}
			if = {
				limit = {
					check_variable = {
						which = realm_mandate_of_heaven
						value = 0
					}
				}
				multiply_variable = {
					which = realm_mandate_of_heaven
					value = 1.2
				}
			}
			else = {
				divide_variable = {
					which = realm_mandate_of_heaven
					value = 1.2
				}
			}
			if = {
				limit = {
					check_variable = {
						which = misc_mandate_of_heaven
						value = 0
					}
				}
				multiply_variable = {
					which = misc_mandate_of_heaven
					value = 1.2
				}
			}
			else = {
				divide_variable = {
					which = misc_mandate_of_heaven
					value = 1.2
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = mandate_of_heaven_1
			}
			if = {
				limit = {
					check_variable = {
						which = personal_mandate_of_heaven
						value = 0
					}
				}
				multiply_variable = {
					which = personal_mandate_of_heaven
					value = 2
				}
			}
			else = {
				divide_variable = {
					which = personal_mandate_of_heaven
					value = 2
				}
			}
			if = {
				limit = {
					check_variable = {
						which = realm_mandate_of_heaven
						value = 0
					}
				}
				multiply_variable = {
					which = realm_mandate_of_heaven
					value = 2
				}
			}
			else = {
				divide_variable = {
					which = realm_mandate_of_heaven
					value = 2
				}
			}
			if = {
				limit = {
					check_variable = {
						which = misc_mandate_of_heaven
						value = 0
					}
				}
				multiply_variable = {
					which = misc_mandate_of_heaven
					value = 2
				}
			}
			else = {
				divide_variable = {
					which = misc_mandate_of_heaven
					value = 2
				}
			}
		}
		
		log = "MANDATE OF HEAVEN: All calculations are done! Personal: [Root.personal_mandate_of_heaven.GetValue], Realm: [Root.realm_mandate_of_heaven.GetValue], Misc: [Root.misc_mandate_of_heaven.GetValue]!"
		
		# Save the last MoH values so that a positive/negative trend can be tracked
		set_variable = {
			which = mandate_of_heaven
			value = 0
		}
		change_variable = {
			which = mandate_of_heaven
			which = personal_mandate_of_heaven
		}
		change_variable = {
			which = mandate_of_heaven
			which = realm_mandate_of_heaven
		}
		change_variable = {
			which = mandate_of_heaven
			which = misc_mandate_of_heaven
		}
		set_variable = {
			which = old_mandate_of_heaven_4
			which = old_mandate_of_heaven_3
		}
		divide_variable = {
			which = old_mandate_of_heaven_4
			value = 5
		}
		set_variable = {
			which = old_mandate_of_heaven_3
			which = old_mandate_of_heaven_2
		}
		divide_variable = {
			which = old_mandate_of_heaven_3
			value = 5
		}
		set_variable = {
			which = old_mandate_of_heaven_2
			which = old_mandate_of_heaven
		}
		divide_variable = {
			which = old_mandate_of_heaven_2
			value = 2
		}
		set_variable = {
			which = old_mandate_of_heaven
			which = mandate_of_heaven
		}
		divide_variable = {
			which = old_mandate_of_heaven
			value = 2
		}
		set_variable = {
			which = stored_mandate_change
			value = 0
		}
	}
}

# Personal factors such as prestige, traits, owning the Heirloom Seal of the Realm, having a proper bloodline, etc.
calculate_personal_mandate_of_heaven_effect = {
	set_variable = {
		which = personal_mandate_of_heaven
		value = 0
	}
	
	log = "Calculating Personal Mandate!"
	
	### Traits
	# Education
	if = {
		limit = {
			OR = {
				# Poor education
				trait = naive_appeaser
				trait = misguided_warrior
				trait = indulgent_wastrel
				trait = amateurish_plotter
				trait = detached_priest
			}
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	else_if = {
		limit = {
			OR = {
				trait = underhanded_rogue
				trait = tough_soldier
				trait = thrifty_clerk
				trait = flamboyant_schemer
				trait = martial_cleric
			}
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 50
		}
	}
	else_if = {
		limit = {
			OR = {
				# Good education in relevant category
				trait = charismatic_negotiator
				trait = skilled_tactician
				trait = fortune_builder
				trait = intricate_webweaver
				trait = scholarly_theologian
			}
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	else_if = {
		limit = {
			OR = {
				trait = grey_eminence
				trait = brilliant_strategist
				trait = midas_touched
				trait = elusive_shadow
				trait = mastermind_theologian
			}
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}

	log = "MANDATE OF HEAVEN: Personal Mandate after education traits is [Root.personal_mandate_of_heaven.GetValue]!"

	# Childhood
	if = {
		limit = {
			trait = affectionate # Diplomatic
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 25
		}
	}
	if = {
		limit = {
			trait = playful # Disorderly
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -25
		}
	}
	if = {
		limit = {
			trait = haughty # China sees itself as better than others
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 25
		}
	}
	if = {
		limit = {
			trait = rowdy # Disorderly
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = conscientious # Orderly
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			trait = fussy # China likes adhering to detailed rules
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 25
		}
	}
	if = {
		limit = {
			trait = brooding # China likes pondering things
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 25
		}
	}
	if = {
		limit = {
			trait = indolent # Unwilling to mentally exert themself
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -25
		}
	}
	if = {
		limit = {
			trait = willful # China is very particular about what it likes
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			trait = curious # Might become scholarly
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			trait = idolizer # Easily impressed
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = timid # China isn't timid
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -50
		}
	}

	log = "MANDATE OF HEAVEN: Personal Mandate after childhood traits is [Root.personal_mandate_of_heaven.GetValue]!"

	# Health, diseases, symptoms, maimed
	if = {
		limit = {
			trait = depressed # Ruling China is supposed to feel good; something must be wrong with China if the EoC doesn't!
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			trait = drunkard # Gives in to excess
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			trait = immortal # Taoists might seek immortality, and if the EoC succeeds they must be great!
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 1000
		}
	}
	if = {
		limit = {
			trait = incapable # The ruler of China should be capable
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -1000
		}
	}
	if = {
		limit = {
			trait = infirm # The ruler of China shouldn't be infirm
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			trait = lunatic # The ruler of China shouldn't be a lunatic
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			trait = possessed # The ruler of China shouldn't be possessed
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			trait = physician # Being well known as a learned person is good
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 500
		}
	}
	if = {
		limit = {
			trait = has_aztec_disease # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = has_typhus # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = cancer # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = has_tuberculosis # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = dancing_plague # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			trait = dysentery # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = flu # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			trait = food_poisoning # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			trait = gout # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			trait = syphilitic # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = ill # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = leper # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = has_measles # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = pneumonic # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = rabies # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = scurvy # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = sickly # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			trait = has_small_pox # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = has_bubonic_plague # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			trait = abdominal_pain # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = chest_pain # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -25
		}
	}
	if = {
		limit = {
			trait = cough # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -25
		}
	}
	if = {
		limit = {
			trait = cramps # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -25
		}
	}
	if = {
		limit = {
			trait = diarrhea # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -25
		}
	}
	if = {
		limit = {
			trait = fatigue # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -25
		}
	}
	if = {
		limit = {
			trait = fever # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -25
		}
	}
	if = {
		limit = {
			trait = headache # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -25
		}
	}
	if = {
		limit = {
			trait = infection # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -25
		}
	}
	if = {
		limit = {
			trait = malaise # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -25
		}
	}
	if = {
		limit = {
			trait = rash # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -25
		}
	}
	if = {
		limit = {
			trait = vomiting # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -25
		}
	}
	if = {
		limit = {
			trait = disfigured # The ruler of China shouldn't be horribly disfigued
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			trait = mangled # The ruler of China shouldn't be mangled
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = one_eyed # The ruler of China shouldn't be missing an eye
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			trait = one_handed # The ruler of China shouldn't be missing a hand
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			trait = one_legged # The ruler of China shouldn't be missing a leg
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			trait = severely_injured # The ruler of China shouldn't be badly injured
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}

	log = "MANDATE OF HEAVEN: Personal Mandate after health traits is [Root.personal_mandate_of_heaven.GetValue]!"

	# Birth traits, genetic traits
	if = {
		limit = {
			trait = bastard # The ruler of China should not be a bastard
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			trait = born_in_the_purple # Having other imperial claims isn't bad
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			trait = child_of_consort # Children of consorts are slightly penalized
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = child_of_consort_male # Children of consorts are slightly penalized
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100 # Greater, because China is patriarchal
		}
	}
	if = {
		limit = {
			trait = legit_bastard # The ruler of China should not be a bastard, even if legitimized
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = fair # If they look good, they are probably a good ruler
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			trait = genius # Being smart is good
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 500
		}
	}
	if = {
		limit = {
			trait = quick # Being smart is good
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			trait = strong # Being strong is slightly good
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			trait = clubfooted # It would be better not to be clubfooted
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = dwarf # Won't be taken as seriously
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = harelip # Noticeable and bad
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			trait = hunchback # Noticeable and bad
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			trait = imbecile # The EoC should be smart
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			trait = inbred # The EoC shouldn't be inbred
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			trait = lisp # Slight negative
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = slow # THe EoC should be smart
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = stutter # Slightly bad
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = ugly # Noticeable and bad
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			trait = weak # It is better not to be weak
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = giant # Imposing
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			trait = lefthanded # Used to be stigmatized
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}

	log = "MANDATE OF HEAVEN: Personal Mandate after genetic traits is [Root.personal_mandate_of_heaven.GetValue]!"

	# Non-inheritable
	if = {
		limit = {
			trait = robust # Slightly good
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			trait = sturdy # Slightly good
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			trait = feeble # Slightly bad
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = shrewd # The EoC should be smart
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			trait = dull # The EoC should be smart
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = groomed # Looking good is good
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 25
		}
	}
	if = {
		limit = {
			trait = uncouth # Looking bad is bad
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -25
		}
	}

	log = "MANDATE OF HEAVEN: Personal Mandate after non-inheritable traits is [Root.personal_mandate_of_heaven.GetValue]!"

	# Lifestyles (and old lifestyles)
	if = {
		limit = {
			trait = administrator # Good ruler
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 500
		}
	}
	if = {
		limit = {
			trait = architect # Good ruler
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			trait = gamer # Probably smart
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			trait = gardener # Good ruler
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			trait = hedonist # Gives in to excess
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			trait = impaler # Cruel
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			trait = schemer # Probably smart
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			trait = seducer # Gives in to excess
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			trait = seductress # Gives in to excess
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			trait = mystic # Ritualistic
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 500
		}
	}
	if = {
		limit = {
			trait = scholar # Learned
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 500
		}
	}
	if = {
		limit = {
			trait = socializer # Diplomatic
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 500
		}
	}
	if = {
		limit = {
			trait = strategist # Probably smart
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 500
		}
	}
	if = {
		limit = {
			trait = theologian # Ritualistic
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			trait = celibate # Does not give in to excess
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 500
		}
	}
	if = {
		limit = {
			trait = poet # Probably smart
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}

	log = "MANDATE OF HEAVEN: Personal Mandate after lifestyle traits is [Root.personal_mandate_of_heaven.GetValue]!"

	# Personality (sins, virtues, others)
	if = {
		limit = {
			trait = chaste # Doesn't give in to excess
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			trait = temperate # Doesn't give in to excess
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			trait = charitable # Good
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			trait = diligent # Works hard
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			trait = patient # Calm
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			trait = kind # Good
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			trait = humble # China is not humble!
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = lustful # Gives in to excess
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			trait = gluttonous # Gives in to excess
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			trait = greedy # Gives in to excess
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			trait = slothful # Does not work hard
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = wroth # China shouldn't be wroth
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			trait = envious # China is obviously the best; why is the EoC envious of someone?
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = proud # Ruling China is obviously something to be proud of!
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			trait = ambitious # Goal-oriented
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			trait = arbitrary # China should follow its own laws!
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = brave # Good
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			trait = craven # China shouldn't be scared!
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			trait = cruel # China shouldn't be barbaric!
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			trait = cynical # Don't have a negative view of things!
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			trait = deceitful # Crafty
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			trait = erudite # Learned
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			trait = gregarious # Well-spoken
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			trait = honest # Keeping your word is good
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			trait = just # China is obviously just
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			trait = paranoid # Everyone isn't out to get you!
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = shy # China shouldn't be shy!
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = stubborn # China knows what China wants, and China expects what China wants!
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			trait = trusting # China isn't foolhardy
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			trait = zealous # Traditionalist
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}

	log = "MANDATE OF HEAVEN: Personal Mandate after personality traits is [Root.personal_mandate_of_heaven.GetValue]!"

	# Religious traits
	if = {
		limit = {
			trait = sympathy_christendom # China is Cosmopolitan
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			trait = sympathy_indian # China is Cosmopolitan, and the Eastern religions are closely related
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			trait = sympathy_islam # China is Cosmopolitan
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			trait = sympathy_judaism # China is Cosmopolitan
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			trait = sympathy_pagans # China is Cosmopolitan
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			trait = sympathy_zoroastrianism # China is Cosmopolitan
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			trait = pagan_branch_1 # China is Cosmopolitan
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	else_if = {
		limit = {
			trait = pagan_branch_2 # China is Cosmopolitan
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	else_if = {
		limit = {
			trait = pagan_branch_3 # Some xenophobia might be warranted
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	else_if = {
		limit = {
			trait = pagan_branch_4 # Focusing on family is nice
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}

	log = "MANDATE OF HEAVEN: Personal Mandate after religious traits is [Root.personal_mandate_of_heaven.GetValue]!"

	# Raiding traits
	if = {
		limit = {
			trait = viking # China shouldn't be barbaric!
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = pirate # China shouldn't be barbaric!
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = ravager # China shouldn't be barbaric!
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			trait = seaking # China shouldn't be barbaric!
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -1000
		}
	}
	if = {
		limit = {
			trait = sea_queen # China shouldn't be barbaric!
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -1000
		}
	}

	log = "MANDATE OF HEAVEN: Personal Mandate after raiding traits is [Root.personal_mandate_of_heaven.GetValue]!"

	# Kinslayer traits
	if = {
		limit = {
			trait = tribal_kinslayer # The EoC shouldn't be a kinslayer
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	else_if = {
		limit = {
			trait = dynastic_kinslayer # The EoC shouldn't be a kinslayer
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	else_if = {
		limit = {
			trait = familial_kinslayer # The EoC shouldn't be a kinslayer
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -500
		}
	}
	else_if = {
		limit = {
			trait = kinslayer # The EoC shouldn't be a kinslayer
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -1000
		}
	}

	log = "MANDATE OF HEAVEN: Personal Mandate after kinslayer traits is [Root.personal_mandate_of_heaven.GetValue]!"

	# Special traits
	if = {
		limit = {
			trait = adventurer # China shouldn't be barbaric!
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = augustus # Possesses another imperial claim
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			trait = blinded # The EoC shouldn't be blinded
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = cannibal_trait # China shouldn't be barbaric!
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -1000
		}
	}
	if = {
		limit = {
			trait = cat # China shouldn't be ruled by a cat, even though cats obviously are superior to mere humans!
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -1000
		}
	}
	if = {
		limit = {
			trait = excommunicated # China shouldn't be excommunicated (and it shouldn't ever happen)!
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -1000
		}
	}
	if = {
		limit = {
			trait = gladiator # China shouldn't be barbaric!
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = heresiarch # The EoC shouldn't be a heretic!
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = horse # China shouldn't be ruled by a horse!
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -1000
		}
	}
	if = {
		limit = {
			trait = in_hiding # The EoC shouldn't hide!
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = lovers_pox # Sleeping around!
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	# Peasant leaders are fine; see Ming!
	if = {
		limit = {
			trait = varangian # China shouldn't be barbaric!
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}

	log = "MANDATE OF HEAVEN: Personal Mandate after special traits is [Root.personal_mandate_of_heaven.GetValue]!"
	
	### Stats
	# Diplomacy
	export_to_variable = {
		which = moh_stats
		value = diplomacy
	}
	multiply_variable = {
		which = moh_stats
		value = 25
	}
	change_variable = {
		which = personal_mandate_of_heaven
		which = moh_stats
	}
	# Martial
	export_to_variable = {
		which = moh_stats
		value = martial
	}
	multiply_variable = {
		which = moh_stats
		value = 25
	}
	change_variable = {
		which = personal_mandate_of_heaven
		which = moh_stats
	}
	# Stewardship
	export_to_variable = {
		which = moh_stats
		value = stewardship
	}
	multiply_variable = {
		which = moh_stats
		value = 25
	}
	change_variable = {
		which = personal_mandate_of_heaven
		which = moh_stats
	}
	# Intrigue
	export_to_variable = {
		which = moh_stats
		value = intrigue
	}
	multiply_variable = {
		which = moh_stats
		value = 25
	}
	change_variable = {
		which = personal_mandate_of_heaven
		which = moh_stats
	}
	# Learning
	export_to_variable = {
		which = moh_stats
		value = learning
	}
	multiply_variable = {
		which = moh_stats
		value = 25
	}
	change_variable = {
		which = personal_mandate_of_heaven
		which = moh_stats
	}
	
	log = "MANDATE OF HEAVEN: Personal Mandate after stats is [Root.personal_mandate_of_heaven.GetValue]!"
	
	
	# Culture
	if = {
		limit = {
			NOT = {
				has_chinese_or_historical_culture_for_chinese_imperial_trigger = yes
			}
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -500
		}
	}
	else_if = {
		limit = {
			NOT = {
				culture_group = chinese_group # China should ideally be Chinese
			}
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	else_if = {
		limit = {
			culture = han # China should ideally be Han
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 500
		}
	}
	if = {
		limit = {
			OR = { # Preferred
				religion = taoist
				religion = confucian
			}
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 500
		}
	}
	else_if = {
		limit = {
			NOR = { # Preferred religions, even if others are allowd
				religion = taoist
				religion = confucian
				religion = buddhist
				religion = chinese_pagan
				religion = chinese_pagan_reformed
				# TODO: New religions?
			}
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	
	log = "MANDATE OF HEAVEN: Personal Mandate after culture and religion is [Root.personal_mandate_of_heaven.GetValue]!"
	
	# Artefacts
	if = {
		limit = {
			has_artifact = heirloom_seal_of_the_realm
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 1000
		}
	}
	
	log = "MANDATE OF HEAVEN: Mandate after Heirloom Seal of the Realm check is [Root.personal_mandate_of_heaven.GetValue]!"
	
	# Character modifiers
	if = {
		limit = {
			has_character_modifier = the_dungeon
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -500
		}
	}
	else_if = {
		limit = {
			has_character_modifier = the_oubliette
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -1000
		}
	}
	else_if = {
		limit = {
			has_character_modifier = house_arrest
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = truce_breaker
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -1000
		}
	}
	if = {
		limit = {
			has_character_modifier = negative_money
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = the_merciful
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = the_bountiful
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = illumination
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = aspiring_poet
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = sweet_temptation
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = stay_strong
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = unrighteous_spouse
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = offended_moneylenders
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = diplomacy_advice
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = martial_advice
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = stewardship_advice
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = intrigue_advice
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = learning_advice
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = for_the_sake_of_love
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = chaste_learning
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = imprison_lawbreakers
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = kill_lawbreakers
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = modifier_witch
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = tortured_witch
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = spy_imprison
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = the_pompous
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = the_pitiful
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = the_judger
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = mod_ashamed
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = the_greedy
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = evil_rumours
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = slothful_ruler
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = the_cruel
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = the_alchemist
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = brazen_bull
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = master_impaler
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = chaste_learning
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = the_ruthless
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = gambler
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = whoremaster
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = proving_bravery
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = speaking_in_tounges
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = modifier_outfoxed
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = broken_spirit
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -1000
		}
	}
	if = {
		limit = {
			has_character_modifier = crushed_revolt
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = crushed_major_revolt
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 500
		}
	}
	if = {
		limit = {
			has_character_modifier = demon_child_non_pagan
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			has_character_modifier = suspected_demon_spawn
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			has_character_modifier = suspected_witch
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			has_character_modifier = known_witch
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -1000
		}
	}
	if = {
		limit = {
			has_character_modifier = incestuous_adulterer
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -1000
		}
	}
	if = {
		limit = {
			has_character_modifier = incestuous_adulteress
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -1000
		}
	}
	if = {
		limit = {
			has_character_modifier = adulterer
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = adulteress
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = known_sodomite
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = known_sodomite_pagan
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = cradle_robber
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = wol_patriarch_1
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = wol_patriarch_2
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = wol_matriarch_1
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = wol_matriarch_2
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = wol_seducer_1
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = wol_seducer_2
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = wol_court_tomcat
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = wol_court_vixen
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = wol_respected_ruler
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = wol_legendary_wisdom
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = minor_disease_herpes
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = cannibal
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -1000
		}
	}
	if = {
		limit = {
			has_character_modifier = vicious_rumors
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = vicious_rumors_2
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			has_character_modifier = unfaithful_rumors
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = known_murderer
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			has_character_modifier = studying_the_stars
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = heliocentrist_scholar
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = weird_scholar
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = the_necronomicon
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = ancient_wisdom
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = merciless
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = apprentice_boardgamer
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = religious_studies
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = religious_philosopher
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = disloyal_peasantry
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			has_character_modifier = out_of_patience
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = groomed_to_perfection
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 500
		}
	}
	if = {
		limit = {
			has_character_modifier = commoners_abandoned
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = alliance_breaker
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -1000
		}
	}
	if = {
		limit = {
			has_character_modifier = broken_non_aggression_pact_char_modifier
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -1000
		}
	}
	if = {
		limit = {
			has_character_modifier = crazy_cannibal
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -1000
		}
	}
	if = {
		limit = {
			has_character_modifier = taking_it_easy
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = skull_trophy
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = skull_trophies
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			has_character_modifier = graverobber
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			has_character_modifier = severe_illness
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = bedridden_illness
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = astounding_visions
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = uplifting_visions
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = frightening_visions
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = withdrawal_symptoms
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = foolish_behavior
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = corrupting_magic_minor
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = corrupting_magic_major
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			has_character_modifier = patron_of_the_arts
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = preserver_of_poetry
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = published_poet
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = popular_ruler
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = under_suspicion
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = highly_suspect
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			has_character_modifier = played_strategy_game
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = discussed_scripture
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = discussed_realm_management
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = caught_red_handed
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = caught_stealing_artifact_penance
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = mediator
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = apathetic
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = cheap_laboratory
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = normal_laboratory
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = good_laboratory
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = great_laboratory
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = best_laboratory
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 500
		}
	}
	if = {
		limit = {
			has_character_modifier = good_battle_omen
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = bad_battle_omen
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = good_relationship_omen
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = bad_relationship_omen
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = good_power_omen
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = bad_power_omen
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = fulfilled_vision_great
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = fulfilled_vision_ok
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = fulfilled_vision_bad
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = fulfilled_vision_worst
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = stargazer
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = theoretical_alchemist
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = experimenting_alchemist
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = alchemy_good_ste_bonus
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = alchemy_ste_bonus
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = alchemy_ste_penalty
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = alchemy_bad_ste_penalty
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = astrology_good_dip_bonus
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = astrology_dip_bonus
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = astrology_dip_penalty
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = astrology_bad_dip_penalty
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = open_mind_good_lea_bonus
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = open_mind_lea_bonus
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = open_mind_lea_penalty
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = open_mind_bad_lea_penalty
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = hidden_truth_good_int_bonus
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = hidden_truth_int_bonus
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = hidden_truth_int_penalty
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = hidden_truth_bad_int_penalty
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = divine_summoning_failed
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -51000
		}
	}
	if = {
		limit = {
			has_character_modifier = divine_summoning_succeeded
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = theory_paper_heavy_investment
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = brilliant_insight
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = debater
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = horoscope_outcome_artist
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = horoscope_outcome_scatterbrain
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = horoscope_outcome_brute
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = horoscope_outcome_arrogant
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = horoscope_outcome_jittery
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = astronomical_insights_1
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 50
		}
	}
	else_if = {
		limit = {
			has_character_modifier = astronomical_insights_2
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	else_if = {
		limit = {
			has_character_modifier = astronomical_insights_3
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	else_if = {
		limit = {
			has_character_modifier = astronomical_insights_4
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 500
		}
	}
	if = {
		limit = {
			has_character_modifier = neglected_accounting
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = failed_to_predict_star_fall
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = published_theorem
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = tarnished_reputation
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = diplomatic_insight
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = martial_insight
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = intrigue_insight
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = learning_insight
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = stewardship_insight
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = accused_apostate
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			has_character_modifier = jd_master_engineer
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250		}
	}
	if = {
		limit = {
			has_character_modifier = jd_administrator
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = employing_jd_administrator
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 500
		}
	}
	if = {
		limit = {
			has_character_modifier = employing_jd_administrator_golden_age
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 1000
		}
	}
	if = {
		limit = {
			has_character_modifier = jd_strategist
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = impressive_treasury
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = cowardly_infanticide
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			has_character_modifier = munificent_modifier
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = jolly_matron_modifier
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = jolly_patriarch_modifier
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = tireless_worker
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = emptied_library
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			has_character_modifier = hitting_the_books
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = antagonize_slandering_vassals
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = antagonize_slandering_relatives
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			has_character_modifier = luxurious_crown_modifier
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = popular_modifier
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = divination_crit_success
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 500
		}
	}
	else_if = {
		limit = {
			has_character_modifier = divination_success
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	else_if = {
		limit = {
			has_character_modifier = divination_failure
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	else_if = {
		limit = {
			has_character_modifier = divination_crit_failure
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			has_character_modifier = callous
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = intimidated_plotters
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = well_spoken
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = confused_by_diplomacy
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = jumbling_words
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = confused_by_warfare
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = unrespected_general
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = well_governed
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = confused_by_governing
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = good_image
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = bad_image
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = unpopular_image
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = well_written
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = terrible_writer
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = strange_mind
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = clever_planner
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = inspiring_presence
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = motivated_ruler
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = bad_image
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = charismatic_leader
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = demon_horns
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = astrology_very_good_omen
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	else_if = {
		limit = {
			has_character_modifier = astrology_good_omen
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	else_if = {
		limit = {
			has_character_modifier = astrology_ambiguous_omen
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	else_if = {
		limit = {
			has_character_modifier = astrology_bad_omen
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	else_if = {
		limit = {
			has_character_modifier = astrology_very_bad_omen
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			has_character_modifier = cannibal_haruspicy_sacrifice
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -1000
		}
	}
	if = {
		limit = {
			has_character_modifier = intrigue_def_haruspicy_sacrifice
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = intrigue_att_haruspicy_sacrifice
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = stewardship_haruspicy_sacrifice
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = exploring_local_culture
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = well_versed_in_local_culture
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = cowardly_ruler
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = forging_legend_revisiting_laws_1
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	else_if = {
		limit = {
			has_character_modifier = forging_legend_revisiting_laws_2
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = forging_legend_peasant_disobedience_1
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	else_if = {
		limit = {
			has_character_modifier = forging_legend_peasant_disobedience_2
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = forging_legend_family_dedication_1
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	else_if = {
		limit = {
			has_character_modifier = forging_legend_family_dedication_2
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	else_if = {
		limit = {
			has_character_modifier = forging_legend_family_dedication_3
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = forging_legend_religious_squabble_1
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	else_if = {
		limit = {
			has_character_modifier = forging_legend_religious_squabble_2
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = forging_legend_searching_philosophers_1
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	else_if = {
		limit = {
			has_character_modifier = forging_legend_searching_philosophers_2
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	else_if = {
		limit = {
			has_character_modifier = forging_legend_searching_philosophers_3
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = forging_legend_building_infrastructure_1
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 50
		}
	}
	else_if = {
		limit = {
			has_character_modifier = forging_legend_building_infrastructure_2
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	else_if= {
		limit = {
			has_character_modifier = forging_legend_building_infrastructure_3
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = forging_legend_building_zealotry_1
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	else_if = {
		limit = {
			has_character_modifier = forging_legend_building_zealotry_2
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = forging_legend_censoring_arts_1
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	else_if = {
		limit = {
			has_character_modifier = forging_legend_censoring_arts_2
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	else_if= {
		limit = {
			has_character_modifier = forging_legend_censoring_arts_3
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = forging_legend_martial_law_1
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	else_if = {
		limit = {
			has_character_modifier = forging_legend_martial_law_2
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = crucible_weapon_very_bad_omen
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = crucible_weapon_caught_heretic
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			has_character_modifier = superstitious_ruler
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = naive_host
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = generous_host
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = calculating_host
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = ruthless_host
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = caught_with_forgery
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			has_character_modifier = ate_beating_heart
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -1000
		}
	}
	if = {
		limit = {
			has_character_modifier = weak_leader_modifier
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = strong_leader_modifier
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = plundering_leader_modifier
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -500
		}
	}
	
	log = "MANDATE OF HEAVEN: Personal Mandate after various character modifiers is [Root.personal_mandate_of_heaven.GetValue]!"
	
	### Prestige and piety
	export_to_variable = {
		which = moh_stats
		value = prestige
	}
	multiply_variable = {
		which = moh_stats
		factor = 0.1
	}
	change_variable = {
		which = personal_mandate_of_heaven
		which = moh_stats
	}
	export_to_variable = {
		which = moh_stats
		value = piety
	}
	multiply_variable = {
		which = moh_stats
		factor = 0.1
	}
	change_variable = {
		which = personal_mandate_of_heaven
		which = moh_stats
	}
	
	log = "MANDATE OF HEAVEN: Personal Mandate after prestige and piety is is [Root.personal_mandate_of_heaven.GetValue]!"
	
	if = {
		limit = {
			NOT = {
				any_owned_bloodline = { # Related by blood to the founder of a Chinese dynasty
					has_bloodline_flag = real_chinese_imperial_bloodline
					bloodline_is_active_for = ROOT
				}
			}
		}
		if = {
			limit = {
				NOT = {
					any_owned_bloodline = { # Related by blood to the founder of a pretender dynasty (and not currently the EoC)
						has_bloodline_flag = pretender_chinese_imperial_bloodline
						bloodline_is_active_for = ROOT
					}
				}
			}
			if = {
				limit = {
					has_landed_title = e_china
				}
				change_variable = {
					which = personal_mandate_of_heaven
					value = -500
				}
			}
			else = {
				change_variable = {
					which = personal_mandate_of_heaven
					value = -250
				}
			}
		}
		else = {
			if = {
				limit = {
					has_landed_title = e_china
				}
				change_variable = {
					which = personal_mandate_of_heaven
					value = -250
				}
			}
			else = {
				change_variable = {
					which = personal_mandate_of_heaven
					value = -100
				}
			}
		}
	}
	
	log = "MANDATE OF HEAVEN: Personal Mandate after bloodlines is [Root.personal_mandate_of_heaven.GetValue]!"
	
	if = {
		limit = {
			NOT = {
				age = 4 # Just a child
			}
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -500
		}
	}
	else_if = {
		limit = {
			NOT = {
				age = 10 # Just a child
			}
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	else_if = {
		limit = {
			NOT = {
				age = 16 # Just a child
			}
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			is_female = yes
			primary_title = {
				has_law = status_of_women_0 # Sexism
			}
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -1000
		}
	}
	else_if = {
		limit = {
			is_female = yes
			primary_title = {
				has_law = status_of_women_1 # Sexism
			}
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -500
		}
	}
	else_if = {
		limit = {
			is_female = yes
			primary_title = {
				has_law = status_of_women_2 # Sexism
			}
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -250
		}
	}
	else_if = {
		limit = {
			is_female = yes
			primary_title = {
				has_law = status_of_women_3 # Sexism
			}
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -100
		}
	}
	
	log = "MANDATE OF HEAVEN: Personal Mandate after sexism and ageism is [Root.personal_mandate_of_heaven.GetValue]!"
	
	if = {
		limit = {
			has_character_modifier = dragon_boon_rulership
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = 1000
		}
	}
	
	if = {
		limit = {
			has_character_modifier = unworthy_of_dragon_boon
		}
		change_variable = {
			which = personal_mandate_of_heaven
			value = -1000
		}
	}
	
	log = "MANDATE OF HEAVEN: Personal Mandate after dragon boon modifiers is [Root.personal_mandate_of_heaven.GetValue]!"
}

# Prosperity, disease outbreaks, province modifiers, control of China/de jure, etc.
calculate_realm_health_mandate_of_heaven_effect = {
	set_variable = {
		which = realm_mandate_of_heaven
		value = 0
	}
	
	log = "Calculating Realm Mandate!"
	
	if = {
		limit = {
			has_landed_title = e_china # Free MoH boost due to holding China...
		}
		change_variable = {
			which = realm_mandate_of_heaven
			value = 1000
		}
	}
	if = {
		limit = {
			primary_title = {
				has_law = eunuch_law_1
			}
		}
		change_variable = {
			which = realm_mandate_of_heaven
			value = -100
		}
	}
	else_if = {
		limit = {
			primary_title = {
				has_law = eunuch_law_2
			}
		}
		change_variable = {
			which = realm_mandate_of_heaven
			value = -250
		}
	}
	else_if = {
		limit = {
			primary_title = {
				has_law = eunuch_law_3
			}
		}
		change_variable = {
			which = realm_mandate_of_heaven
			value = -500
		}
	}
	else_if = {
		limit = {
			primary_title = {
				has_law = eunuch_law_4
			}
		}
		change_variable = {
			which = realm_mandate_of_heaven
			value = -1000
		}
	}
	if = {
		limit = {
			primary_title = {
				has_law = grand_chancellor_law_1
			}
		}
		change_variable = {
			which = realm_mandate_of_heaven
			value = -250
		}
	}
	else_if = {
		limit = {
			primary_title = {
				has_law = grand_chancellor_law_2
			}
		}
		change_variable = {
			which = realm_mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			primary_title = {
				has_law = ci_courtier_law_1
			}
		}
		change_variable = {
			which = realm_mandate_of_heaven
			value = -50
		}
	}
	else_if = {
		limit = {
			primary_title = {
				has_law = ci_courtier_law_2
			}
		}
		change_variable = {
			which = realm_mandate_of_heaven
			value = -125
		}
	}
	else_if = {
		limit = {
			primary_title = {
				has_law = ci_courtier_law_3
			}
		}
		change_variable = {
			which = realm_mandate_of_heaven
			value = -250
		}
	}
	else_if = {
		limit = {
			primary_title = {
				has_law = ci_courtier_law_4
			}
		}
		change_variable = {
			which = realm_mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			primary_title = {
				has_law = ci_vassal_law_1
			}
		}
		change_variable = {
			which = realm_mandate_of_heaven
			value = -100
		}
	}
	else_if = {
		limit = {
			primary_title = {
				has_law = ci_vassal_law_2
			}
		}
		change_variable = {
			which = realm_mandate_of_heaven
			value = -250
		}
	}
	else_if = {
		limit = {
			primary_title = {
				has_law = ci_vassal_law_3
			}
		}
		change_variable = {
			which = realm_mandate_of_heaven
			value = -500
		}
	}
	else_if = {
		limit = {
			primary_title = {
				has_law = ci_vassal_law_4
			}
		}
		change_variable = {
			which = realm_mandate_of_heaven
			value = -1000
		}
	}
	
	log = "MANDATE OF HEAVEN: Realm Mandate after laws is [Root.realm_mandate_of_heaven.GetValue]!"

	any_realm_province = {
		if = {
			limit = {
				NOT = {
					any_province_holding = {
						OR = {
							holding_type = castle
							holding_type = city
						}
					}
				}
			}
			ROOT = { # It is bad for China to hold a lot of uncivilized land!
				change_variable = {
					which = realm_mandate_of_heaven
					value = -25
				}
			}
		}
		log = "MANDATE OF HEAVEN: Realm Mandate after deduction from uncivilized provinces is [Root.realm_mandate_of_heaven.GetValue]!"
	
		# Diseased, Depopulated, or Prospering provinces in the realm
		if = {
			limit = {
				has_epidemic = yes
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -25
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = depopulated_3
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -25
				}
			}
		}
		else_if = {
			limit = {
				has_province_modifier = depopulated_2
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -10
				}
			}
		}
		else_if = {
			limit = {
				has_province_modifier = depopulated_1
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -5
				}
			}
		}
		else_if = {
			limit = {
				has_province_modifier = prosperity_modifier_1
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 5
				}
			}
		}
		else_if = {
			limit = {
				has_province_modifier = prosperity_modifier_2
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 10
				}
			}
		}
		else_if = {
			limit = {
				has_province_modifier = prosperity_modifier_3
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 25
				}
			}
		}
		
		log = "MANDATE OF HEAVEN: Realm Mandate after epidemcis, prosperity, and depopulation is [Root.realm_mandate_of_heaven.GetValue]!"
		
		any_province_holding = {
			limit = {
				NOT = {
					holding_type = tribal
				}
			}
			ROOT = { # Having a larger realm is good
				change_variable = {
					which = realm_mandate_of_heaven
					value = 1
				}
			}
		}
		
		any_neighbor_province = {
			limit = {
				has_owner = yes
				owner = {
					top_liege = {
						NOR = {
							character = ROOT
							suzerain = {
								character = ROOT
							}
						}
					}
				}
			}
			if = {
				limit = {
					owner = {
						top_liege = {
							OR = {
								# Uncivilized government
								is_nomadic = yes
								is_tribal = yes
								# Uncivilized pagan
								religion = pagan
								religion = norse_pagan
								religion = baltic_pagan
								religion = slavic_pagan
								religion = finnish_pagan
								religion = tengri_pagan
								religion = west_african_pagan
								religion = ainu_pagan
								religion = melanesian_pagan
								religion = dayak_pagan
								religion = aztec
								religion = aztec_reformed
								religion = inca_religion
								religion = inca_religion_reformed
								# TODO: New religions
							}
						}
					}
				}
				ROOT = { # Having an unsecured border is bad
					change_variable = {
						which = realm_mandate_of_heaven
						value = -25
					}
				}
			}
			else = {
				ROOT = { # Having an unsecured border is bad
					change_variable = {
						which = realm_mandate_of_heaven
						value = -10
					}
				}
			}
		}
		if = {
			limit = {
				has_wonder = yes
			}
			if = {
				limit = {
					wonder = {
						is_damaged = no
					}
				}
				ROOT = {
					change_variable = {
						which = realm_mandate_of_heaven
						value = 50
					}
				}
				
				# TODO: Possibly award a different amount of Mandate for different kinds of wonders?
				
				# Stage
				if = {
					limit = {
						wonder = {
							wonder_stage = 4
						}
					}
					ROOT = {
						change_variable = {
							which = realm_mandate_of_heaven
							value = 25
						}
					}
				}
				else_if = {
					limit = {
						wonder = {
							wonder_stage = 3
						}
					}
					ROOT = {
						change_variable = {
							which = realm_mandate_of_heaven
							value = 10
						}
					}
				}
				if = {
					limit = {
						wonder = {
							wonder_stage = 2
						}
					}
					ROOT = {
						change_variable = {
							which = realm_mandate_of_heaven
							value = 5
						}
					}
				}
			}
		}
	}
	
	if = {
		limit = {
			NOT = {
				realm_size = 50
			}
		}
		change_variable = {
			which = realm_mandate_of_heaven
			value = -1000
		}
	}
	else_if = {
		limit = {
			NOT = {
				realm_size = 100
			}
		}
		change_variable = {
			which = realm_mandate_of_heaven
			value = -500
		}
	}
	else_if = {
		limit = {
			NOT = {
				realm_size = 200
			}
		}
		change_variable = {
			which = realm_mandate_of_heaven
			value = -250
		}
	}
	else_if = {
		limit = {
			NOT = {
				realm_size = 300
			}
		}
		change_variable = {
			which = realm_mandate_of_heaven
			value = 100
		}
	}
	# 400 breaks even
	else_if = {
		limit = {
			realm_size = 500
			NOT = {
				realm_size = 600
			}
		}
		change_variable = {
			which = realm_mandate_of_heaven
			value = 100
		}
	}
	else_if = {
		limit = {
			realm_size = 600
			NOT = {
				realm_size = 700
			}
		}
		change_variable = {
			which = realm_mandate_of_heaven
			value = 250
		}
	}
	else_if = {
		limit = {
			realm_size = 700
			NOT = {
				realm_size = 800
			}
		}
		change_variable = {
			which = realm_mandate_of_heaven
			value = 500
		}
	}
	else = {
		change_variable = {
			which = realm_mandate_of_heaven
			value = 1000
		}
	}
	
	log = "MANDATE OF HEAVEN: Realm Mandate after realm size, border security, holding density, and wonders is [Root.realm_mandate_of_heaven.GetValue]!"
	
	# All province modifiers go here!
	# Changed to any_demesne_province since any_realm_province becomes very costly very quickly
	# Also multiplied previous values by 10 to make it more impactful despite fewer provinces being checked
	any_demesne_province = {
		if = {
			limit = {
				has_province_modifier = nomad_agitation # Should be impossible if there's a castle or city, but...
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -250
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = master_builder
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = sabotaged_building
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -50
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = great_inventor
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = secret_mil_invention
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 50
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = slothful_ruler
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = missing_reinforcements
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -50
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = recent_revolt
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = religious_tension
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = force_converting
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = heretic_stronghold
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = high_taxes
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -50
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = incompetent_rule
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = thieves_guild
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = smugglers_ring
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -50
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = highway_robber_band
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = excessive_bureaucracy # China likes bureaucracy!
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = thugs_rampant
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = neglected_development
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = peasants_protected
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = merchants_unhappy
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -50
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = temple_corruption
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = local_death_cult
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = trade_route
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 50
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = stone_quarry
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 50
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = caravan_raiders
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = caravan_guards
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 50
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = chinese_embargo
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -50
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = trade_governor
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = surge_of_traders
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 50
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = construction_accident
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -25
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = peasants_scorned
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = peasant_unrest
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -250
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = religious_unrest
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -250
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = cultural_unrest
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -250
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = minor_pagan_border_raids
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = major_pagan_border_raids
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -250
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = restricted_peasant_access
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -50
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = troops_increases
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 25
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = steward_revoltrisk
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = arbitrary_steward
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = just_steward
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = intelligent_steward
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = marshal_improves_capital
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = prima_noctae
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = friendly_innovations
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = extra_tax_kind
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -50
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = extra_tax
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = seize_church_assets
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -50
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = architect_improvements
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 50
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = active_inquisition
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = theological_dialogue
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = carpenters_guild
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 50
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = outlawed_guild
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -25
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = sold_off_land
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = artisan_workshop
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 50
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = rampaging_nomads
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -250
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = burnt_the_land
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -250
				}
			}
		}
		if = {
			limit = {
				any_province_holding = {
					has_holding_modifier = recently_burnt_the_land
				}
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -250
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = recently_burnt_the_land_not_owner
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -250
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = recent_county_uprising
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = marauding_pirates
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = peasants_subdued
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 50
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = commoners_abandoned
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = peasant_crisis
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -250
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = peasant_pleased_witch_hunt
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 50
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = epidemic_blame_1
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = epidemic_blame_2
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -250
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = hunting_dead
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = ordered_our_prophet_executed
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -250
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = merchant_harbor_province
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 50
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = scholar_foundation_province
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = great_library_province
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 250
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = center_of_worship_province
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 250
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = logging_company_province
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 50
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = ore_mine_province
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 50
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = messenger_stations
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = harvest_festivals
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = inspired_peasantry
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = new_roads
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = new_shrines
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = regimental_ground_province
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = damaged_hospital
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = blessed_lands
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 50
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = holy_monument
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 50
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = ancestral_monument
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 50
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = trade_district_fire
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -50
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = desecrated_temple
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = rumors_of_witchcraft
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = sabotaged_buildings
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -50
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = sabotaged_defences
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = sabotaged_unrest
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -250
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = blast_furnace
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 50
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = great_mill
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 50
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = proud_hunters_spirit
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 25
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = jd_paper_mill
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 250
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = jd_fireworks_guild
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 250
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = jd_dry_docks
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 250
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = jd_administrative_outpost
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 250
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = jd_blast_furnace
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 250
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = reprimanded_merchants
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -50
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = radhanite_favor
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 50
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = radhanite_favor_big
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = coronation_improved_trade
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 50
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = coronation_peasants_happy
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = zealots_running_amok
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = tomb_of_a_saint
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 50
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = pillaged_tomb_of_a_saint
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -50
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = monk_society_help
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 50
				}
			}
		}
		if = {
			limit = {
				OR = {
					has_province_modifier = capital_thrall_workers_01
					has_province_modifier = capital_thrall_workers_02
					has_province_modifier = capital_thrall_workers_03
				}
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -50
				}
			}
		}
		else_if = {
			limit = {
				OR = {
					has_province_modifier = capital_thrall_workers_04
					has_province_modifier = capital_thrall_workers_05
					has_province_modifier = capital_thrall_workers_06
				}
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = stewardship_haruspicy_sacrifice
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = negative_haruspicy_sacrifice
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = bloodthirsty_mass_sacrifice_province_1
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -100
				}
			}
		}
		else_if = {
			limit = {
				has_province_modifier = bloodthirsty_mass_sacrifice_province_2
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -250
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = bloodthirsty_flower_war_province
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -250
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = mass_baptism_capital_traders
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 50
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = mass_baptism_capital_missionaries
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -25
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = mass_baptism_capital_builders
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 50
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = left_for_shepherds_crusade
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -25
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = shepherds_chaos
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = shepherds_settled
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -50
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = africa_light_rain
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 25
				}
			}
		}
		else_if = {
			limit = {
				has_province_modifier = africa_heavy_rain
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 50
				}
			}
		}
		else_if = {
			limit = {
				has_province_modifier = africa_drought_risk
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -50
				}
			}
		}
		else_if = {
			limit = {
				has_province_modifier = africa_drought
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = local_relief_efforts_food
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 50
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = improved_irrigation
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 50
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = focused_traders
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 50
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = water_watch_1
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 25
				}
			}
		}
		else_if = {
			limit = {
				has_province_modifier = water_watch_2
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 50
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = depleted_gold_mine
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -25
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = large_gold_inflation
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -50
				}
			}
		}
		else_if = {
			limit = {
				has_province_modifier = small_gold_inflation
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -25
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = soldiers_fixed_gold_inflation
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -50
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = religious_tolerance
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 50
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = sufi_market
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 50
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = peasants_happy
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = 100
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = dragons_lair
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -1000
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = burninated_province
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -1000
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = pirate_haven
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -100
				}
			}
		}
	}
	
	log = "MANDATE OF HEAVEN: Realm Mandate after misc. province modifiers is [Root.realm_mandate_of_heaven.GetValue]!"
	
	# Having non-viceroyalties means you're more feudal, and being more feudal is bad
	any_vassal = {
		any_demesne_title = {
			limit = {
				real_tier = king
				controls_religion = no
				is_vice_royalty = no
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -250
				}
			}
		}
		any_demesne_title = {
			limit = {
				real_tier = duke
				controls_religion = no
				is_vice_royalty = no
			}
			ROOT = {
				change_variable = {
					which = realm_mandate_of_heaven
					value = -50
				}
			}
		}
	}
	
	log = "MANDATE OF HEAVEN: Realm Mandate after non-viceroyalties is [Root.realm_mandate_of_heaven.GetValue]!"
}

# Stored Mandate change, past trend, various other factors such as existence of pretenders, etc.
calculate_misc_mandate_of_heaven_effect = {
	set_variable = {
		which = misc_mandate_of_heaven
		value = 0
	}
	
	log = "Calculating Misc. Mandate!"
	
	# Past trend - if no value exists, it is assumed to have been good
	if = {
		limit = {
			is_variable_equal = {
				which = old_mandate_of_heaven
				value = 0
			}
		}
		set_variable = {
			which = old_mandate_of_heaven
			value = 1000
		}
		set_variable = {
			which = old_mandate_of_heaven_2
			value = 500
		}
		set_variable = {
			which = old_mandate_of_heaven_3
			value = 250
		}
		set_variable = {
			which = old_mandate_of_heaven_4
			value = 100
		}
	}
	change_variable = {
		which = misc_mandate_of_heaven
		which = old_mandate_of_heaven
	}
	change_variable = {
		which = misc_mandate_of_heaven
		which = old_mandate_of_heaven_2
	}
	change_variable = {
		which = misc_mandate_of_heaven
		which = old_mandate_of_heaven_3
	}
	change_variable = {
		which = misc_mandate_of_heaven
		which = old_mandate_of_heaven_4
	}

	log = "MANDATE OF HEAVEN: Misc. Mandate after past trend is is [Root.misc_mandate_of_heaven.GetValue]!"
	
	
	# Current Mandate level
	if = {
		limit = {
			has_character_modifier = mandate_of_heaven_5
		}
		change_variable = {
			which = misc_mandate_of_heaven
			value = 1000
		}
	}
	else_if = {
		limit = {
			has_character_modifier = mandate_of_heaven_4
		}
		change_variable = {
			which = misc_mandate_of_heaven
			value = 500
		}
	}
	# Average is average
	else_if = {
		limit = {
			has_character_modifier = mandate_of_heaven_2
		}
		change_variable = {
			which = misc_mandate_of_heaven
			value = -500
		}
	}
	else_if = {
		limit = {
			has_character_modifier = mandate_of_heaven_1
		}
		change_variable = {
			which = misc_mandate_of_heaven
			value = -1000
		}
	}

	log = "MANDATE OF HEAVEN: Misc. Mandate after current Mandate level is [Root.misc_mandate_of_heaven.GetValue]!"
	
	# Stored yearly change from various places
	change_variable = {
		which = misc_mandate_of_heaven
		which = stored_mandate_change
	}
	log = "MANDATE OF HEAVEN: [Root.GetTitledName]'s stored Mandate of Heaven value is [Root.stored_mandate_change.GetValue]!"

	log = "MANDATE OF HEAVEN: Misc. Mandate after stored value is [Root.misc_mandate_of_heaven.GetValue]!"

	# Penalties for pretenders
	any_independent_ruler = {
		limit = {
			NOT = {
				character = ROOT
			}
			primary_title = {
				has_title_flag = pretender_chinese_empire
			}
		}
		if = {
			limit = {
				ROOT = {
					has_landed_title = e_china
				}
			}
			ROOT = {
				change_variable = {
					which = misc_mandate_of_heaven
					value = -500
				}
			}
		}
		else = { # Pretenders care less about there being other pretenders
			ROOT = {
				change_variable = {
					which = misc_mandate_of_heaven
					value = -250
				}
			}
		}
	}
	
	log = "MANDATE OF HEAVEN: Misc. Mandate after pretenders is [Root.misc_mandate_of_heaven.GetValue]!"
	
	# Grace modifiers
	if = {
		limit = {
			has_landed_title = e_china
		}
		if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_1
			}
			ROOT = {
				change_variable = {
					which = misc_mandate_of_heaven
					value = -50
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_2
			}
			ROOT = {
				change_variable = {
					which = misc_mandate_of_heaven
					value = -100
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_3
			}
			ROOT = {
				change_variable = {
					which = misc_mandate_of_heaven
					value = -150
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_4
			}
			ROOT = {
				change_variable = {
					which = misc_mandate_of_heaven
					value = -200
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_5
			}
			ROOT = {
				change_variable = {
					which = misc_mandate_of_heaven
					value = -250
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_6
			}
			ROOT = {
				change_variable = {
					which = misc_mandate_of_heaven
					value = -300
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_7
			}
			ROOT = {
				change_variable = {
					which = misc_mandate_of_heaven
					value = -350
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_8
			}
			ROOT = {
				change_variable = {
					which = misc_mandate_of_heaven
					value = -400
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_9
			}
			ROOT = {
				change_variable = {
					which = misc_mandate_of_heaven
					value = -450
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_10
			}
			ROOT = {
				change_variable = {
					which = misc_mandate_of_heaven
					value = -500
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_11
			}
			ROOT = {
				change_variable = {
					which = misc_mandate_of_heaven
					value = -550
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_12
			}
			ROOT = {
				change_variable = {
					which = misc_mandate_of_heaven
					value = -600
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_13
			}
			ROOT = {
				change_variable = {
					which = misc_mandate_of_heaven
					value = -650
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_14
			}
			ROOT = {
				change_variable = {
					which = misc_mandate_of_heaven
					value = -700
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_15
			}
			ROOT = {
				change_variable = {
					which = misc_mandate_of_heaven
					value = -750
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_16
			}
			ROOT = {
				change_variable = {
					which = misc_mandate_of_heaven
					value = -800
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_17
			}
			ROOT = {
				change_variable = {
					which = misc_mandate_of_heaven
					value = -850
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_18
			}
			ROOT = {
				change_variable = {
					which = misc_mandate_of_heaven
					value = -900
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_19
			}
			ROOT = {
				change_variable = {
					which = misc_mandate_of_heaven
					value = -950
				}
			}
		}
	}
	
	log = "MANDATE OF HEAVEN: Misc. Mandate after Tribute/Boon modifiers is [Root.misc_mandate_of_heaven.GetValue]!"
	
	# Tributaries
	any_tributary = {
		if = {
			limit = {
				is_tributary = {
					type = chinese_client_state
				}
			}
			if = {
				limit = {
					tier = emperor
				}
				ROOT = {
					change_variable = {
						which = misc_mandate_of_heaven
						value = 2500
					}
				}
			}
			else_if = {
				limit = {
					tier = king
				}
				ROOT = {
					change_variable = {
						which = misc_mandate_of_heaven
						value = 1000
					}
				}
			}
			else_if = {
				limit = {
					tier = duke
				}
				ROOT = {
					change_variable = {
						which = misc_mandate_of_heaven
						value = 500
					}
				}
			}
			else = {
				ROOT = {
					change_variable = {
						which = misc_mandate_of_heaven
						value = 250
					}
				}
			}
		}
		else_if= {
			limit = {
				is_tributary = {
					type = chinese_protectorate
				}
			}
			if = {
				limit = {
					tier = emperor
				}
				ROOT = {
					change_variable = {
						which = misc_mandate_of_heaven
						value = 1000
					}
				}
			}
			else_if = {
				limit = {
					tier = king
				}
				ROOT = {
					change_variable = {
						which = misc_mandate_of_heaven
						value = 500
					}
				}
			}
			else_if = {
				limit = {
					tier = duke
				}
				ROOT = {
					change_variable = {
						which = misc_mandate_of_heaven
						value = 250
					}
				}
			}
			else = {
				ROOT = {
					change_variable = {
						which = misc_mandate_of_heaven
						value = 100
					}
				}
			}
		}
		else_if= {
			limit = {
				is_tributary = {
					type = chinese_imperial_tributary
				}
			}
			if = {
				limit = {
					tier = emperor
				}
				ROOT = {
					change_variable = {
						which = misc_mandate_of_heaven
						value = 500
					}
				}
			}
			else_if = {
				limit = {
					tier = king
				}
				ROOT = {
					change_variable = {
						which = misc_mandate_of_heaven
						value = 250
					}
				}
			}
			else_if = {
				limit = {
					tier = duke
				}
				ROOT = {
					change_variable = {
						which = misc_mandate_of_heaven
						value = 100
					}
				}
			}
			else = {
				ROOT = {
					change_variable = {
						which = misc_mandate_of_heaven
						value = 50
					}
				}
			}
		}
		else = {
			# Peripheral Tributaries and misc. types
			if = {
				limit = {
					tier = emperor
				}
				ROOT = {
					change_variable = {
						which = misc_mandate_of_heaven
						value = 250
					}
				}
			}
			else_if = {
				limit = {
					tier = king
				}
				ROOT = {
					change_variable = {
						which = misc_mandate_of_heaven
						value = 100
					}
				}
			}
			else_if = {
				limit = {
					tier = duke
				}
				ROOT = {
					change_variable = {
						which = misc_mandate_of_heaven
						value = 50
					}
				}
			}
			else = {
				ROOT = {
					change_variable = {
						which = misc_mandate_of_heaven
						value = 10
					}
				}
			}
		}
	}
	if = {	
		limit = {
			is_tributary = yes
			suzerain = {
				government = chinese_imperial_government
			}
		}
		suzerain = {
			change_variable = stored_mandate_change
			value = 1000
		}
		change_variable = {
			which = misc_mandate_of_heaven
			value = -1000
		}
	}
	else_if = {
		limit = {
			is_tributary = yes
		}
		change_variable = {
			which = misc_mandate_of_heaven
			value = -500
		}
	}
	
	log = "MANDATE OF HEAVEN: Misc. Mandate after tributaries is [Root.misc_mandate_of_heaven.GetValue]!"
	
	# Misc
	if = {
		limit = {
			any_war = { # China should not be under attack
				defender = {
					character = ROOT
				}
			}
		}
		any_war = { # China should not be under attack
			limit = {
				defender = {
					character = ROOT
				}
			}
			ROOT = {
				change_variable = {
					which = misc_mandate_of_heaven
					value = -500
				}
			}
		}
	}
	if = {
		limit = {
			any_war = { # In a civil war
				defender = {
					character = ROOT
				}
				attacker = {
					liege_before_war = {
						character = ROOT
					}
				}
			}
		}
		any_war = { # In a civil war
			limit = {
				defender = {
					character = ROOT
				}
				attacker = {
					liege_before_war = {
						character = ROOT
					}
				}
			}
			ROOT = {
				change_variable = {
					which = misc_mandate_of_heaven
					value = -1000
				}
			}
		}
	}
	if = {
		limit = {
			any_realm_lord = { # Vassals fighting each other is not a good sign
				any_war = {
					attacker = {
						top_liege = {
							character = ROOT
						}
					}
					defender = {
						top_liege = {
							character = ROOT
						}
					}
				}
			}
		}
		any_realm_lord = {
			limit = {
				any_war = {
					attacker = {
						top_liege = {
							character = ROOT
						}
					}
					defender = {
						top_liege = {
							character = ROOT
						}
					}
				}
			}
			ROOT = {
				change_variable = {
					which = misc_mandate_of_heaven
					value = -100
				}
			}
		}
	}
	
	log = "MANDATE OF HEAVEN: Misc. Mandate after peace checks is [Root.misc_mandate_of_heaven.GetValue]!"
}

potentially_change_current_mandate_of_heaven_level_effect = {
	# The Mandate of Heaven will tend to move towards average, though not too harshly
	
	clr_character_flag = new_mandate_of_heaven_5
	clr_character_flag = new_mandate_of_heaven_4
	clr_character_flag = new_mandate_of_heaven_3
	clr_character_flag = new_mandate_of_heaven_2
	clr_character_flag = new_mandate_of_heaven_1
	clr_character_flag = mandate_changed_bad
	clr_character_flag = mandate_changed_good
	
	if = {
		limit = {
			has_game_rule = {
				name = mandate_of_heaven
				value = enabled
			}
		}
		if = {
			limit = {
				has_character_modifier = mandate_of_heaven_5
			}
			random_list = {
				75 = {
					# Personal
					modifier = {
						factor = 1.02
						check_variable = {
							which = personal_mandate_of_heaven
							value = 1000
						}
					}
					modifier = {
						factor = 1.02
						check_variable = {
							which = personal_mandate_of_heaven
							value = 1500
						}
					}
					modifier = {
						factor = 1.02
						check_variable = {
							which = personal_mandate_of_heaven
							value = 2000
						}
					}
					modifier = {
						factor = 1.02
						check_variable = {
							which = personal_mandate_of_heaven
							value = 2500
						}
					}
					modifier = {
						factor = 1.02
						check_variable = {
							which = personal_mandate_of_heaven
							value = 3000
						}
					}
					modifier = {
						factor = 1.02
						check_variable = {
							which = personal_mandate_of_heaven
							value = 3500
						}
					}
					modifier = {
						factor = 1.02
						check_variable = {
							which = personal_mandate_of_heaven
							value = 4000
						}
					}
					modifier = {
						factor = 1.02
						check_variable = {
							which = personal_mandate_of_heaven
							value = 4500
						}
					}
					modifier = {
						factor = 1.02
						check_variable = {
							which = personal_mandate_of_heaven
							value = 5000
						}
					}
					modifier = {
						factor = 0
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = 0
							}
						}
					}
					# Realm
					modifier = {
						factor = 1.02
						check_variable = {
							which = realm_mandate_of_heaven
							value = 1000
						}
					}
					modifier = {
						factor = 1.02
						check_variable = {
							which = realm_mandate_of_heaven
							value = 1500
						}
					}
					modifier = {
						factor = 1.02
						check_variable = {
							which = realm_mandate_of_heaven
							value = 2000
						}
					}
					modifier = {
						factor = 1.02
						check_variable = {
							which = realm_mandate_of_heaven
							value = 2500
						}
					}
					modifier = {
						factor = 1.02
						check_variable = {
							which = realm_mandate_of_heaven
							value = 3000
						}
					}
					modifier = {
						factor = 1.02
						check_variable = {
							which = realm_mandate_of_heaven
							value = 3500
						}
					}
					modifier = {
						factor = 1.02
						check_variable = {
							which = realm_mandate_of_heaven
							value = 4000
						}
					}
					modifier = {
						factor = 1.02
						check_variable = {
							which = realm_mandate_of_heaven
							value = 4500
						}
					}
					modifier = {
						factor = 1.02
						check_variable = {
							which = realm_mandate_of_heaven
							value = 5000
						}
					}
					modifier = {
						factor = 0
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = 0
							}
						}
					}
					# Misc
					modifier = {
						factor = 1.02
						check_variable = {
							which = misc_mandate_of_heaven
							value = 1000
						}
					}
					modifier = {
						factor = 1.02
						check_variable = {
							which = misc_mandate_of_heaven
							value = 1500
						}
					}
					modifier = {
						factor = 1.02
						check_variable = {
							which = misc_mandate_of_heaven
							value = 2000
						}
					}
					modifier = {
						factor = 1.02
						check_variable = {
							which = misc_mandate_of_heaven
							value = 2500
						}
					}
					modifier = {
						factor = 1.02
						check_variable = {
							which = misc_mandate_of_heaven
							value = 3000
						}
					}
					modifier = {
						factor = 1.02
						check_variable = {
							which = misc_mandate_of_heaven
							value = 3500
						}
					}
					modifier = {
						factor = 1.02
						check_variable = {
							which = misc_mandate_of_heaven
							value = 4000
						}
					}
					modifier = {
						factor = 1.02
						check_variable = {
							which = misc_mandate_of_heaven
							value = 4500
						}
					}
					modifier = {
						factor = 1.02
						check_variable = {
							which = misc_mandate_of_heaven
							value = 5000
						}
					}
					modifier = {
						factor = 0
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = 0
							}
						}
					}
					# Other
					modifier = { # A pretender will never have their Mandate unquestioned
						factor = 0
						primary_title = {
							has_title_flag = pretender_chinese_empire
						}
					}
					modifier = { # If there's a pretender, the Mandate of Heaven will not remain unquestioned for most rulers
						factor = 0.1
						any_independent_ruler = {
							primary_title = {
								has_title_flag = pretender_chinese_empire
							}
						}
						has_landed_title = e_china
						NOT = {
							has_character_flag = new_chinese_imperial_dynasty # A new dynasty in China can be unquestioned for a while, even with a pretender around
						}
					}
					set_character_flag = new_mandate_of_heaven_5
					modifier = {
						factor = 0
						is_adult = no # China deserves better than a child on the throne!
					}
					modifier = {
						factor = 0
						has_regent = yes # Not has_actual_regency_trigger!
					}
				}
				25 = {
					# Personal
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = 500
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = 0
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -500
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -1000
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -1500
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -2000
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -2500
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -3000
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -3500
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -4000
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -4500
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -5000
							}
						}
					}
					modifier = {
						factor = 0.01
						check_variable = {
							which = personal_mandate_of_heaven
							value = 1000
						}
					}
					# Realm
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = 500
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = 0
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -500
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -1000
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -1500
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -2000
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -2500
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -3000
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -3500
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -4000
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -4500
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -5000
							}
						}
					}
					modifier = {
						factor = 0.01
						check_variable = {
							which = realm_mandate_of_heaven
							value = 1000
						}
					}
					# Misc
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = 500
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = 0
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -500
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -1000
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -1500
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -2000
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -2500
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -3000
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -3500
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -4000
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -4500
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -5000
							}
						}
					}
					modifier = {
						factor = 0.01
						check_variable = {
							which = misc_mandate_of_heaven
							value = 1000
						}
					}
					set_character_flag = new_mandate_of_heaven_4
					set_character_flag = mandate_changed_bad
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = mandate_of_heaven_4
			}
			random_list = {
				15 = {
					# Law blocker
					modifier = {
						factor = 0
						primary_title = {
							OR = {
								has_law = eunuch_law_2
								has_law = eunuch_law_3
								has_law = eunuch_law_4
								has_law = grand_chancellor_law_1
								has_law = grand_chancellor_law_2
								has_law = ci_vassal_law_2
								has_law = ci_vassal_law_3
								has_law = ci_vassal_law_4
								has_law = ci_vassal_law_2
								has_law = ci_vassal_law_3
								has_law = ci_vassal_law_4
							}
						}
					}
					# Personal
					modifier = {
						factor = 1.02
						check_variable = {
							which = personal_mandate_of_heaven
							value = 1000
						}
					}
					modifier = {
						factor = 1.02
						check_variable = {
							which = personal_mandate_of_heaven
							value = 1500
						}
					}
					modifier = {
						factor = 1.02
						check_variable = {
							which = personal_mandate_of_heaven
							value = 2000
						}
					}
					modifier = {
						factor = 1.02
						check_variable = {
							which = personal_mandate_of_heaven
							value = 2500
						}
					}
					modifier = {
						factor = 1.02
						check_variable = {
							which = personal_mandate_of_heaven
							value = 3000
						}
					}
					modifier = {
						factor = 1.02
						check_variable = {
							which = personal_mandate_of_heaven
							value = 3500
						}
					}
					modifier = {
						factor = 1.02
						check_variable = {
							which = personal_mandate_of_heaven
							value = 4000
						}
					}
					modifier = {
						factor = 1.02
						check_variable = {
							which = personal_mandate_of_heaven
							value = 4500
						}
					}
					modifier = {
						factor = 1.02
						check_variable = {
							which = personal_mandate_of_heaven
							value = 5000
						}
					}
					modifier = {
						factor = 0
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = 0
							}
						}
					}
					# Realm
					modifier = {
						factor = 1.02
						check_variable = {
							which = realm_mandate_of_heaven
							value = 1000
						}
					}
					modifier = {
						factor = 1.02
						check_variable = {
							which = realm_mandate_of_heaven
							value = 1500
						}
					}
					modifier = {
						factor = 1.02
						check_variable = {
							which = realm_mandate_of_heaven
							value = 2000
						}
					}
					modifier = {
						factor = 1.02
						check_variable = {
							which = realm_mandate_of_heaven
							value = 2500
						}
					}
					modifier = {
						factor = 1.02
						check_variable = {
							which = realm_mandate_of_heaven
							value = 3000
						}
					}
					modifier = {
						factor = 1.02
						check_variable = {
							which = realm_mandate_of_heaven
							value = 3500
						}
					}
					modifier = {
						factor = 1.02
						check_variable = {
							which = realm_mandate_of_heaven
							value = 4000
						}
					}
					modifier = {
						factor = 1.02
						check_variable = {
							which = realm_mandate_of_heaven
							value = 4500
						}
					}
					modifier = {
						factor = 1.02
						check_variable = {
							which = realm_mandate_of_heaven
							value = 5000
						}
					}
					modifier = {
						factor = 0
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = 0
							}
						}
					}
					# Misc
					modifier = {
						factor = 1.02
						check_variable = {
							which = misc_mandate_of_heaven
							value = 1000
						}
					}
					modifier = {
						factor = 1.02
						check_variable = {
							which = misc_mandate_of_heaven
							value = 1500
						}
					}
					modifier = {
						factor = 1.02
						check_variable = {
							which = misc_mandate_of_heaven
							value = 2000
						}
					}
					modifier = {
						factor = 1.02
						check_variable = {
							which = misc_mandate_of_heaven
							value = 2500
						}
					}
					modifier = {
						factor = 1.02
						check_variable = {
							which = misc_mandate_of_heaven
							value = 3000
						}
					}
					modifier = {
						factor = 1.02
						check_variable = {
							which = misc_mandate_of_heaven
							value = 3500
						}
					}
					modifier = {
						factor = 1.02
						check_variable = {
							which = misc_mandate_of_heaven
							value = 4000
						}
					}
					modifier = {
						factor = 1.02
						check_variable = {
							which = misc_mandate_of_heaven
							value = 4500
						}
					}
					modifier = {
						factor = 1.02
						check_variable = {
							which = misc_mandate_of_heaven
							value = 5000
						}
					}
					modifier = {
						factor = 0
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = 0
							}
						}
					}
					# Other
					modifier = { # A pretender will never have their Mandate unquestioned
						factor = 0
						primary_title = {
							has_title_flag = pretender_chinese_empire
						}
					}
					modifier = { # If there's a pretender, the Mandate of Heaven will not remain unquestioned for most rulers
						factor = 0.1
						any_independent_ruler = {
							primary_title = {
								has_title_flag = pretender_chinese_empire
							}
						}
						has_landed_title = e_china
						NOT = {
							has_character_flag = new_chinese_imperial_dynasty # A new dynasty in China can be unquestioned for a while, even with a pretender around
						}
					}
					modifier = {
						factor = 0.1
						has_character_modifier = recent_mandate_change_good
					}
					set_character_flag = new_mandate_of_heaven_5
					set_character_flag = mandate_changed_good
					modifier = {
						factor = 0
						is_adult = no # China deserves better than a child on the throne!
					}
					modifier = {
						factor = 0
						has_regent = yes # Not has_actual_regency_trigger!
					}
				}
				60 = {
					# If the MoH is very good in at least one category, you're likely to go up
					modifier = {
						factor = 0.8
						check_variable = {
							which = personal_mandate_of_heaven
							value = 5000
						}
					}
					modifier = {
						factor = 0.8
						check_variable = {
							which = realm_mandate_of_heaven
							value = 5000
						}
					}
					modifier = {
						factor = 0.8
						check_variable = {
							which = misc_mandate_of_heaven
							value = 5000
						}
					}
					modifier = {
						factor = 0.8
						check_variable = {
							which = personal_mandate_of_heaven
							value = 2500
						}
					}
					modifier = {
						factor = 0.8
						check_variable = {
							which = realm_mandate_of_heaven
							value = 2500
						}
					}
					modifier = {
						factor = 0.8
						check_variable = {
							which = misc_mandate_of_heaven
							value = 2500
						}
					}
					# If the MoH is poor in at least one category, you're likely to drop
					modifier = {
						factor = 0.9
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = 500
							}
						}
					}
					modifier = {
						factor = 0.9
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = 500
							}
						}
					}
					modifier = {
						factor = 0.9
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = 500
							}
						}
					}
					modifier = {
						factor = 0.9
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = 0
							}
						}
					}
					modifier = {
						factor = 0.9
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = 0
							}
						}
					}
					modifier = {
						factor = 0.9
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = 0
							}
						}
					}
					modifier = {
						factor = 0.5
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -500
							}
						}
					}
					modifier = {
						factor = 0.5
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -500
							}
						}
					}
					modifier = {
						factor = 0.5
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -500
							}
						}
					}
					set_character_flag = new_mandate_of_heaven_4
				}
				25 = {
					# Personal
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = 500
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = 0
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -500
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -1000
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -1500
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -2000
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -2500
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -3000
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -3500
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -4000
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -4500
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -5000
							}
						}
					}
					modifier = {
						factor = 0.01
						check_variable = {
							which = personal_mandate_of_heaven
							value = 1000
						}
					}
					# Realm
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = 500
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = 0
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -500
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -1000
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -1500
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -2000
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -2500
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -3000
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -3500
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -4000
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -4500
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -5000
							}
						}
					}
					modifier = {
						factor = 0.01
						check_variable = {
							which = realm_mandate_of_heaven
							value = 1000
						}
					}
					# Misc
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = 500
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = 0
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -500
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -1000
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -1500
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -2000
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -2500
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -3000
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -3500
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -4000
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -4500
							}
						}
					}
					modifier = {
						factor = 1.06
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -5000
							}
						}
					}
					modifier = {
						factor = 0.01
						check_variable = {
							which = misc_mandate_of_heaven
							value = 1000
						}
					}
					# Other
					modifier = {
						factor = 0.5
						has_landed_title = e_china
					}
					modifier = {
						factor = 0.1
						has_character_modifier = recent_mandate_change_bad
					}
					set_character_flag = new_mandate_of_heaven_3
					set_character_flag = mandate_changed_bad
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = mandate_of_heaven_3
			}
			random_list = {
				10 = {
					# Law blocker
					modifier = {
						factor = 0
						primary_title = {
							OR = {
								has_law = eunuch_law_3
								has_law = eunuch_law_4
								has_law = grand_chancellor_law_2
								has_law = ci_vassal_law_3
								has_law = ci_vassal_law_4
								has_law = ci_vassal_law_3
								has_law = ci_vassal_law_4
							}
						}
					}
					# Personal
					modifier = {
						factor = 1.03
						check_variable = {
							which = personal_mandate_of_heaven
							value = 1000
						}
					}
					modifier = {
						factor = 1.03
						check_variable = {
							which = personal_mandate_of_heaven
							value = 1500
						}
					}
					modifier = {
						factor = 1.03
						check_variable = {
							which = personal_mandate_of_heaven
							value = 2000
						}
					}
					modifier = {
						factor = 1.03
						check_variable = {
							which = personal_mandate_of_heaven
							value = 2500
						}
					}
					modifier = {
						factor = 1.03
						check_variable = {
							which = personal_mandate_of_heaven
							value = 3000
						}
					}
					modifier = {
						factor = 1.03
						check_variable = {
							which = personal_mandate_of_heaven
							value = 3500
						}
					}
					modifier = {
						factor = 1.03
						check_variable = {
							which = personal_mandate_of_heaven
							value = 4000
						}
					}
					modifier = {
						factor = 1.03
						check_variable = {
							which = personal_mandate_of_heaven
							value = 4500
						}
					}
					modifier = {
						factor = 1.03
						check_variable = {
							which = personal_mandate_of_heaven
							value = 5000
						}
					}
					modifier = {
						factor = 0
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = 0
							}
						}
					}
					# Realm
					modifier = {
						factor = 1.03
						check_variable = {
							which = realm_mandate_of_heaven
							value = 1000
						}
					}
					modifier = {
						factor = 1.03
						check_variable = {
							which = realm_mandate_of_heaven
							value = 1500
						}
					}
					modifier = {
						factor = 1.03
						check_variable = {
							which = realm_mandate_of_heaven
							value = 2000
						}
					}
					modifier = {
						factor = 1.03
						check_variable = {
							which = realm_mandate_of_heaven
							value = 2500
						}
					}
					modifier = {
						factor = 1.03
						check_variable = {
							which = realm_mandate_of_heaven
							value = 3000
						}
					}
					modifier = {
						factor = 1.03
						check_variable = {
							which = realm_mandate_of_heaven
							value = 3500
						}
					}
					modifier = {
						factor = 1.03
						check_variable = {
							which = realm_mandate_of_heaven
							value = 4000
						}
					}
					modifier = {
						factor = 1.03
						check_variable = {
							which = realm_mandate_of_heaven
							value = 4500
						}
					}
					modifier = {
						factor = 1.03
						check_variable = {
							which = realm_mandate_of_heaven
							value = 5000
						}
					}
					modifier = {
						factor = 0
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = 0
							}
						}
					}
					# Misc
					modifier = {
						factor = 1.03
						check_variable = {
							which = misc_mandate_of_heaven
							value = 1000
						}
					}
					modifier = {
						factor = 1.03
						check_variable = {
							which = misc_mandate_of_heaven
							value = 1500
						}
					}
					modifier = {
						factor = 1.03
						check_variable = {
							which = misc_mandate_of_heaven
							value = 2000
						}
					}
					modifier = {
						factor = 1.03
						check_variable = {
							which = misc_mandate_of_heaven
							value = 2500
						}
					}
					modifier = {
						factor = 1.03
						check_variable = {
							which = misc_mandate_of_heaven
							value = 3000
						}
					}
					modifier = {
						factor = 1.03
						check_variable = {
							which = misc_mandate_of_heaven
							value = 3500
						}
					}
					modifier = {
						factor = 1.03
						check_variable = {
							which = misc_mandate_of_heaven
							value = 4000
						}
					}
					modifier = {
						factor = 1.03
						check_variable = {
							which = misc_mandate_of_heaven
							value = 4500
						}
					}
					modifier = {
						factor = 1.03
						check_variable = {
							which = misc_mandate_of_heaven
							value = 5000
						}
					}
					modifier = {
						factor = 0
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = 0
							}
						}
					}
					# Other
					modifier = { # It is harder to have a good Mandate level if you don't rule china
						factor = 0.5
						NOT = {
							has_landed_title = e_china
						}
					}
					modifier = {
						factor = 0.1
						has_character_modifier = recent_mandate_change_good
					}
					set_character_flag = new_mandate_of_heaven_4
					set_character_flag = mandate_changed_good
				}
				80 = {
					# If the MoH is very good in at least one category, you're likely to go up
					modifier = {
						factor = 0.9
						check_variable = {
							which = personal_mandate_of_heaven
							value = 5000
						}
					}
					modifier = {
						factor = 0.9
						check_variable = {
							which = realm_mandate_of_heaven
							value = 5000
						}
					}
					modifier = {
						factor = 0.9
						check_variable = {
							which = misc_mandate_of_heaven
							value = 5000
						}
					}
					modifier = {
						factor = 0.9
						check_variable = {
							which = personal_mandate_of_heaven
							value = 2500
						}
					}
					modifier = {
						factor = 0.9
						check_variable = {
							which = realm_mandate_of_heaven
							value = 2500
						}
					}
					modifier = {
						factor = 0.9
						check_variable = {
							which = misc_mandate_of_heaven
							value = 2500
						}
					}
					# If the MoH is poor in at least one category, you're likely to drop
					modifier = {
						factor = 0.9
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = 500
							}
						}
					}
					modifier = {
						factor = 0.9
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = 500
							}
						}
					}
					modifier = {
						factor = 0.9
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = 500
							}
						}
					}
					modifier = {
						factor = 0.9
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = 0
							}
						}
					}
					modifier = {
						factor = 0.9
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = 0
							}
						}
					}
					modifier = {
						factor = 0.9
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = 0
							}
						}
					}
					modifier = {
						factor = 0.5
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -500
							}
						}
					}
					modifier = {
						factor = 0.5
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -500
							}
						}
					}
					modifier = {
						factor = 0.5
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -500
							}
						}
					}
					set_character_flag = new_mandate_of_heaven_3
				}
				10 = {
					# Personal
					modifier = {
						factor = 1.03
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = 500
							}
						}
					}
					modifier = {
						factor = 1.03
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = 0
							}
						}
					}
					modifier = {
						factor = 1.03
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -500
							}
						}
					}
					modifier = {
						factor = 1.03
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -1000
							}
						}
					}
					modifier = {
						factor = 1.03
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -1500
							}
						}
					}
					modifier = {
						factor = 1.03
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -2000
							}
						}
					}
					modifier = {
						factor = 1.03
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -2500
							}
						}
					}
					modifier = {
						factor = 1.03
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -3000
							}
						}
					}
					modifier = {
						factor = 1.03
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -3500
							}
						}
					}
					modifier = {
						factor = 1.03
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -4000
							}
						}
					}
					modifier = {
						factor = 1.03
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -4500
							}
						}
					}
					modifier = {
						factor = 1.03
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -5000
							}
						}
					}
					modifier = {
						factor = 0.01
						check_variable = {
							which = personal_mandate_of_heaven
							value = 1000
						}
					}
					# Realm
					modifier = {
						factor = 1.03
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = 500
							}
						}
					}
					modifier = {
						factor = 1.03
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = 0
							}
						}
					}
					modifier = {
						factor = 1.03
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -500
							}
						}
					}
					modifier = {
						factor = 1.03
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -1000
							}
						}
					}
					modifier = {
						factor = 1.03
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -1500
							}
						}
					}
					modifier = {
						factor = 1.03
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -2000
							}
						}
					}
					modifier = {
						factor = 1.03
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -2500
							}
						}
					}
					modifier = {
						factor = 1.03
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -3000
							}
						}
					}
					modifier = {
						factor = 1.03
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -3500
							}
						}
					}
					modifier = {
						factor = 1.03
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -4000
							}
						}
					}
					modifier = {
						factor = 1.03
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -4500
							}
						}
					}
					modifier = {
						factor = 1.03
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -5000
							}
						}
					}
					modifier = {
						factor = 0.01
						check_variable = {
							which = realm_mandate_of_heaven
							value = 1000
						}
					}
					# Misc
					modifier = {
						factor = 1.03
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = 500
							}
						}
					}
					modifier = {
						factor = 1.03
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = 0
							}
						}
					}
					modifier = {
						factor = 1.03
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -500
							}
						}
					}
					modifier = {
						factor = 1.03
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -1000
							}
						}
					}
					modifier = {
						factor = 1.03
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -1500
							}
						}
					}
					modifier = {
						factor = 1.03
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -2000
							}
						}
					}
					modifier = {
						factor = 1.03
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -2500
							}
						}
					}
					modifier = {
						factor = 1.03
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -3000
							}
						}
					}
					modifier = {
						factor = 1.03
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -3500
							}
						}
					}
					modifier = {
						factor = 1.03
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -4000
							}
						}
					}
					modifier = {
						factor = 1.03
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -4500
							}
						}
					}
					modifier = {
						factor = 1.03
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -5000
							}
						}
					}
					modifier = {
						factor = 0.01
						check_variable = {
							which = misc_mandate_of_heaven
							value = 1000
						}
					}
					set_character_flag = new_mandate_of_heaven_2
					set_character_flag = mandate_changed_bad
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = mandate_of_heaven_2
			}
			random_list = {
				25 = {
					# Law blocker
					modifier = {
						factor = 0
						primary_title = {
							OR = {
								has_law = eunuch_law_4
								has_law = ci_vassal_law_4
								has_law = ci_vassal_law_4
							}
						}
					}
					# Personal
					modifier = {
						factor = 1.06
						check_variable = {
							which = personal_mandate_of_heaven
							value = 1000
						}
					}
					modifier = {
						factor = 1.06
						check_variable = {
							which = personal_mandate_of_heaven
							value = 1500
						}
					}
					modifier = {
						factor = 1.06
						check_variable = {
							which = personal_mandate_of_heaven
							value = 2000
						}
					}
					modifier = {
						factor = 1.06
						check_variable = {
							which = personal_mandate_of_heaven
							value = 2500
						}
					}
					modifier = {
						factor = 1.06
						check_variable = {
							which = personal_mandate_of_heaven
							value = 3000
						}
					}
					modifier = {
						factor = 1.06
						check_variable = {
							which = personal_mandate_of_heaven
							value = 3500
						}
					}
					modifier = {
						factor = 1.06
						check_variable = {
							which = personal_mandate_of_heaven
							value = 4000
						}
					}
					modifier = {
						factor = 1.06
						check_variable = {
							which = personal_mandate_of_heaven
							value = 4500
						}
					}
					modifier = {
						factor = 1.06
						check_variable = {
							which = personal_mandate_of_heaven
							value = 5000
						}
					}
					modifier = {
						factor = 0.1
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = 0
							}
						}
					}
					# Realm
					modifier = {
						factor = 1.06
						check_variable = {
							which = realm_mandate_of_heaven
							value = 1000
						}
					}
					modifier = {
						factor = 1.06
						check_variable = {
							which = realm_mandate_of_heaven
							value = 1500
						}
					}
					modifier = {
						factor = 1.06
						check_variable = {
							which = realm_mandate_of_heaven
							value = 2000
						}
					}
					modifier = {
						factor = 1.06
						check_variable = {
							which = realm_mandate_of_heaven
							value = 2500
						}
					}
					modifier = {
						factor = 1.06
						check_variable = {
							which = realm_mandate_of_heaven
							value = 3000
						}
					}
					modifier = {
						factor = 1.06
						check_variable = {
							which = realm_mandate_of_heaven
							value = 3500
						}
					}
					modifier = {
						factor = 1.06
						check_variable = {
							which = realm_mandate_of_heaven
							value = 4000
						}
					}
					modifier = {
						factor = 1.06
						check_variable = {
							which = realm_mandate_of_heaven
							value = 4500
						}
					}
					modifier = {
						factor = 1.06
						check_variable = {
							which = realm_mandate_of_heaven
							value = 5000
						}
					}
					modifier = {
						factor = 0.1
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = 0
							}
						}
					}
					# Misc
					modifier = {
						factor = 1.06
						check_variable = {
							which = misc_mandate_of_heaven
							value = 1000
						}
					}
					modifier = {
						factor = 1.06
						check_variable = {
							which = misc_mandate_of_heaven
							value = 1500
						}
					}
					modifier = {
						factor = 1.06
						check_variable = {
							which = misc_mandate_of_heaven
							value = 2000
						}
					}
					modifier = {
						factor = 1.06
						check_variable = {
							which = misc_mandate_of_heaven
							value = 2500
						}
					}
					modifier = {
						factor = 1.06
						check_variable = {
							which = misc_mandate_of_heaven
							value = 3000
						}
					}
					modifier = {
						factor = 1.06
						check_variable = {
							which = misc_mandate_of_heaven
							value = 3500
						}
					}
					modifier = {
						factor = 1.06
						check_variable = {
							which = misc_mandate_of_heaven
							value = 4000
						}
					}
					modifier = {
						factor = 1.06
						check_variable = {
							which = misc_mandate_of_heaven
							value = 4500
						}
					}
					modifier = {
						factor = 1.06
						check_variable = {
							which = misc_mandate_of_heaven
							value = 5000
						}
					}
					modifier = {
						factor = 0.1
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = 0
							}
						}
					}
					# Other
					modifier = { # It is hard to have a good Mandate level if you don't rule China
						factor = 0.75
						NOT = {
							has_landed_title = e_china
						}
					}
					modifier = {
						factor = 0.1
						has_character_modifier = recent_mandate_change_good
					}
					set_character_flag = new_mandate_of_heaven_3
					set_character_flag = mandate_changed_good
				}
				60 = {
					# If the MoH is very good in at least one category, you're likely to go up
					modifier = {
						factor = 0.9
						check_variable = {
							which = personal_mandate_of_heaven
							value = 5000
						}
					}
					modifier = {
						factor = 0.9
						check_variable = {
							which = realm_mandate_of_heaven
							value = 5000
						}
					}
					modifier = {
						factor = 0.9
						check_variable = {
							which = misc_mandate_of_heaven
							value = 5000
						}
					}
					modifier = {
						factor = 0.9
						check_variable = {
							which = personal_mandate_of_heaven
							value = 2500
						}
					}
					modifier = {
						factor = 0.9
						check_variable = {
							which = realm_mandate_of_heaven
							value = 2500
						}
					}
					modifier = {
						factor = 0.9
						check_variable = {
							which = misc_mandate_of_heaven
							value = 2500
						}
					}
					# If the MoH is poor in at least one category, you're likely to drop
					modifier = {
						factor = 0.8
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = 500
							}
						}
					}
					modifier = {
						factor = 0.8
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = 500
							}
						}
					}
					modifier = {
						factor = 0.8
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = 500
							}
						}
					}
					modifier = {
						factor = 0.8
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = 0
							}
						}
					}
					modifier = {
						factor = 0.8
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = 0
							}
						}
					}
					modifier = {
						factor = 0.8
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = 0
							}
						}
					}
					modifier = {
						factor = 0.8
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -500
							}
						}
					}
					modifier = {
						factor = 0.8
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -500
							}
						}
					}
					modifier = {
						factor = 0.8
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -500
							}
						}
					}
					set_character_flag = new_mandate_of_heaven_2
				}
				15 = {
					# Personal
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = 500
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = 0
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -500
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -1000
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -1500
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -2000
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -2500
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -3000
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -3500
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -4000
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -4500
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -5000
							}
						}
					}
					modifier = {
						factor = 0.01
						check_variable = {
							which = personal_mandate_of_heaven
							value = 1000
						}
					}
					# Realm
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = 500
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = 0
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -500
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -1000
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -1500
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -2000
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -2500
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -3000
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -3500
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -4000
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -4500
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -5000
							}
						}
					}
					modifier = {
						factor = 0.01
						check_variable = {
							which = realm_mandate_of_heaven
							value = 1000
						}
					}
					# Misc
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = 500
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = 0
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -500
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -1000
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -1500
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -2000
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -2500
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -3000
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -3500
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -4000
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -4500
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -5000
							}
						}
					}
					modifier = {
						factor = 0.01
						check_variable = {
							which = misc_mandate_of_heaven
							value = 1000
						}
					}
					# Other
					modifier = {
						factor = 0.5
						has_landed_title = e_china
					}
					modifier = {
						factor = 0.1
						has_character_modifier = recent_mandate_change_bad
					}
					set_character_flag = new_mandate_of_heaven_1
					set_character_flag = mandate_changed_bad
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = mandate_of_heaven_1
			}
			random_list = {
				25 = {
					# Personal
					modifier = {
						factor = 1.06
						check_variable = {
							which = personal_mandate_of_heaven
							value = 1000
						}
					}
					modifier = {
						factor = 1.06
						check_variable = {
							which = personal_mandate_of_heaven
							value = 1500
						}
					}
					modifier = {
						factor = 1.06
						check_variable = {
							which = personal_mandate_of_heaven
							value = 2000
						}
					}
					modifier = {
						factor = 1.06
						check_variable = {
							which = personal_mandate_of_heaven
							value = 2500
						}
					}
					modifier = {
						factor = 1.06
						check_variable = {
							which = personal_mandate_of_heaven
							value = 3000
						}
					}
					modifier = {
						factor = 1.06
						check_variable = {
							which = personal_mandate_of_heaven
							value = 3500
						}
					}
					modifier = {
						factor = 1.06
						check_variable = {
							which = personal_mandate_of_heaven
							value = 4000
						}
					}
					modifier = {
						factor = 1.06
						check_variable = {
							which = personal_mandate_of_heaven
							value = 4500
						}
					}
					modifier = {
						factor = 1.06
						check_variable = {
							which = personal_mandate_of_heaven
							value = 5000
						}
					}
					modifier = {
						factor = 0.1
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = 0
							}
						}
					}
					# Realm
					modifier = {
						factor = 1.06
						check_variable = {
							which = realm_mandate_of_heaven
							value = 1000
						}
					}
					modifier = {
						factor = 1.06
						check_variable = {
							which = realm_mandate_of_heaven
							value = 1500
						}
					}
					modifier = {
						factor = 1.06
						check_variable = {
							which = realm_mandate_of_heaven
							value = 2000
						}
					}
					modifier = {
						factor = 1.06
						check_variable = {
							which = realm_mandate_of_heaven
							value = 2500
						}
					}
					modifier = {
						factor = 1.06
						check_variable = {
							which = realm_mandate_of_heaven
							value = 3000
						}
					}
					modifier = {
						factor = 1.06
						check_variable = {
							which = realm_mandate_of_heaven
							value = 3500
						}
					}
					modifier = {
						factor = 1.06
						check_variable = {
							which = realm_mandate_of_heaven
							value = 4000
						}
					}
					modifier = {
						factor = 1.06
						check_variable = {
							which = realm_mandate_of_heaven
							value = 4500
						}
					}
					modifier = {
						factor = 1.06
						check_variable = {
							which = realm_mandate_of_heaven
							value = 5000
						}
					}
					modifier = {
						factor = 0.1
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = 0
							}
						}
					}
					# Misc
					modifier = {
						factor = 1.06
						check_variable = {
							which = misc_mandate_of_heaven
							value = 1000
						}
					}
					modifier = {
						factor = 1.06
						check_variable = {
							which = misc_mandate_of_heaven
							value = 1500
						}
					}
					modifier = {
						factor = 1.06
						check_variable = {
							which = misc_mandate_of_heaven
							value = 2000
						}
					}
					modifier = {
						factor = 1.06
						check_variable = {
							which = misc_mandate_of_heaven
							value = 2500
						}
					}
					modifier = {
						factor = 1.06
						check_variable = {
							which = misc_mandate_of_heaven
							value = 3000
						}
					}
					modifier = {
						factor = 1.06
						check_variable = {
							which = misc_mandate_of_heaven
							value = 3500
						}
					}
					modifier = {
						factor = 1.06
						check_variable = {
							which = misc_mandate_of_heaven
							value = 4000
						}
					}
					modifier = {
						factor = 1.02
						check_variable = {
							which = misc_mandate_of_heaven
							value = 4500
						}
					}
					modifier = {
						factor = 1.06
						check_variable = {
							which = misc_mandate_of_heaven
							value = 5000
						}
					}
					modifier = {
						factor = 0.1
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = 0
							}
						}
					}
					# Other
					modifier = { # It is hard to have a good Mandate level if you don't rule China
						factor = 0.9
						NOT = {
							has_landed_title = e_china
						}
					}
					set_character_flag = new_mandate_of_heaven_2
					set_character_flag = mandate_changed_good
				}
				75 = {
					# Personal
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = 500
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = 0
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -500
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -1000
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -1500
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -2000
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -2500
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -3000
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -3500
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -4000
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -4500
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = personal_mandate_of_heaven
								value = -5000
							}
						}
					}
					modifier = {
						factor = 0.01
						check_variable = {
							which = personal_mandate_of_heaven
							value = 1000
						}
					}
					# Realm
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = 500
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = 0
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -500
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -1000
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -1500
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -2000
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -2500
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -3000
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -3500
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -4000
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -4500
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = realm_mandate_of_heaven
								value = -5000
							}
						}
					}
					modifier = {
						factor = 0.01
						check_variable = {
							which = realm_mandate_of_heaven
							value = 1000
						}
					}
					# Misc
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = 500
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = 0
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -500
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -1000
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -1500
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -2000
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -2500
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -3000
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -3500
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -4000
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -4500
							}
						}
					}
					modifier = {
						factor = 1.02
						NOT = {
							check_variable = {
								which = misc_mandate_of_heaven
								value = -5000
							}
						}
					}
					modifier = {
						factor = 0.01
						check_variable = {
							which = misc_mandate_of_heaven
							value = 1000
						}
					}
					set_character_flag = new_mandate_of_heaven_1
				}
			}
		}
		else = { # Shouldn't happen a lot, but best to be certain it isn't frequent...
			if = {
				limit = {
					OR = {
						has_character_flag = new_chinese_imperial_dynasty
						has_landed_title = e_china
					}
					primary_title = {
						NOT = {
							has_title_flag = pretender_chinese_empire
						}
					}
				}
				set_character_flag = new_mandate_of_heaven_4
			}
			else = {
				set_character_flag = new_mandate_of_heaven_3
			}
			log = "MANDATE OF HEAVEN: [Root.GetTitledName]'s Mandate of Heaven calculation used the fallback option!"
		}
	}
}


update_mandate_of_heaven_modifier_effect = {
	remove_character_modifier = mandate_of_heaven_5
	remove_character_modifier = mandate_of_heaven_4
	remove_character_modifier = mandate_of_heaven_3
	remove_character_modifier = mandate_of_heaven_2
	remove_character_modifier = mandate_of_heaven_1
	if = {
		limit = {
			has_game_rule = {
				name = mandate_of_heaven
				value = enabled
			}
		}
		if = {
			limit = {
				has_character_flag = new_mandate_of_heaven_5
			}
			add_character_modifier = {
				modifier = mandate_of_heaven_5
				duration = -1
			}
			log = "MANDATE OF HEAVEN: [Root.GetTitledName]'s Mandate of Heaven is Unquestioned!"
		}
		else_if = {
			limit = {
				has_character_flag = new_mandate_of_heaven_4
			}
			add_character_modifier = {
				modifier = mandate_of_heaven_4
				duration = -1
			}
			log = "MANDATE OF HEAVEN: [Root.GetTitledName]'s Mandate of Heaven is Good!"
		}
		else_if = {
			limit = {
				has_character_flag = new_mandate_of_heaven_3
			}
			add_character_modifier = {
				modifier = mandate_of_heaven_3
				duration = -1
			}
			log = "MANDATE OF HEAVEN: [Root.GetTitledName]'s Mandate of Heaven is Average!"
		}
		else_if = {
			limit = {
				has_character_flag = new_mandate_of_heaven_2
			}
			add_character_modifier = {
				modifier = mandate_of_heaven_2
				duration = -1
			}
			log = "MANDATE OF HEAVEN: [Root.GetTitledName]'s Mandate of Heaven is Poor!"
		}
		else = {
			add_character_modifier = {
				modifier = mandate_of_heaven_1
				duration = -1
			}
			log = "MANDATE OF HEAVEN: [Root.GetTitledName]'s Mandate of Heaven is Lost!"
		}
		
		if = {
			limit =  {
				has_character_flag = mandate_changed_good
			}
			remove_character_modifier = recent_mandate_change_good
			remove_character_modifier = recent_mandate_change_bad
			add_character_modifier = {
				modifier = recent_mandate_change_good
				duration = 3650
			}
			narrative_event = { id = mandate_of_heaven.7 }
		}
		else_if = {
			limit =  {
				has_character_flag = mandate_changed_bad
			}
			remove_character_modifier = recent_mandate_change_good
			remove_character_modifier = recent_mandate_change_bad
			add_character_modifier = {
				modifier = recent_mandate_change_bad
				duration = 3650
			}
			narrative_event = { id = mandate_of_heaven.8 }
		}
	}
	else = {
		add_character_modifier = {
			modifier = mandate_of_heaven_3
			duration = -1
		}
		log = "MANDATE OF HEAVEN: The Mandate of Heaven is disabled!"
	}
}