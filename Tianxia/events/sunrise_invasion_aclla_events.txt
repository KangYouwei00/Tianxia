# Aclla events
# Partially based on work done by Keizer Harm
# Expanded upon by Silverswee(e)per

namespace = aclla

##### Maintenance events

# Fire on_yearly_pulse; find e_tawantinsuyu: if active, activate this and put it under the Sapa Inca, and fill it up. Otherwise do nothing.
character_event = {
	id = aclla.1
	hide_window = yes
	
	is_triggered_only = yes
	
	religion = catholic
	only_rulers = yes
	
	trigger = {
		controls_religion = yes
		has_global_flag = sunrise_invasion_happened
		e_tawantinsuyu = {
			holder_scope = { always = yes }
		}
		NOT = {
			e_tawantinsuyu = {
				holder_scope = {
					any_courtier_or_vassal = {
						has_landed_title = d_acllahuasi
					}
				}
			}
		}
	}
	
	immediate = {
		activate_title = { title = d_acllahuasi status = yes }
		if = {
			limit = {
				d_acllahuasi = {
					holder_scope = {
						is_female = yes
						age = 35
						has_education_learning_trigger = yes
						OR = {
							AND = {
								religion = inca_religion
								NOT = {
									has_global_flag = inca_reformation
								}
							}
							AND = {
								religion = inca_religion_reformed
								has_global_flag = inca_reformation
							}
						}
					}
				}
			}
			d_acllahuasi = {
				holder_scope = {
					de_jure_liege = e_tawantinsuyu
					set_defacto_liege = e_tawantinsuyu
				}
				fill_acllahuasi = yes
			}
		}
		else = {
			e_tawantinsuyu = {
				holder_scope = {
					create_random_priest = {
						age = 50
						health = 7
						fertility = 0
						female = yes
						random_traits = yes
						culture = quechua
						religion = inca_religion
						trait = aclla
					}
					new_character = {
						if = {
							limit = {
								has_global_flag = inca_reformation
							}
							religion = inca_religion_reformed
						}
						set_government_type = theocracy_government
						d_acllahuasi = {
							grant_title = PREV
							add_law = succ_open_elective
							add_law = enatic_succession
							de_jure_liege = e_tawantinsuyu
							fill_acllahuasi = yes
						}
						set_defacto_liege = PREV
					}
				}
			}
		}
	}
}

# Fire on_death for aclla holder to ensure right successor
character_event = {
	id = aclla.2
	hide_window = yes
	
	is_triggered_only = yes
	
	only_playable = yes
	
	trigger = {
		has_landed_title = d_acllahuasi
	}
	
	immediate = {
		if = {
			limit = {
				NOT = {
					current_heir = {
						age = 35
						is_female = yes
						has_education_learning_trigger = yes
						OR = {
							AND = {
								religion = inca_religion
								NOT = {
									has_global_flag = inca_reformation
								}
							}
							AND = {
								religion = inca_religion_reformed
								has_global_flag = inca_reformation
							}
						}
					}
				}
			}
			create_random_priest = {
				age = 50
				health = 7
				fertility = 0
				female = yes
				random_traits = yes
				culture = quechua
				religion = inca_religion
				trait = aclla
			}
			new_character = {
				if = {
					limit = {
						has_global_flag = inca_reformation
					}
					religion = inca_religion_reformed
				}
				set_government_type = theocracy_government
				d_acllahuasi = {
					grant_title = PREV
					add_law = succ_open_elective
					add_law = enatic_succession
					fill_acllahuasi = yes
					set_defacto_liege = e_tawantinsuyu
					de_jure_liege = e_tawantinsuyu
				}
			}
		}
	}
}

##### Aclla recruitment

# Sapa Inca won war - can a daughter be claimed?
character_event = {
	id = aclla.3
	hide_window = yes
	
	is_triggered_only = yes
	
	has_dlc = "Sunset Invasion"
	
	only_playable = yes
	
	has_global_flag = sunrise_invasion_happened
	
	trigger = {
		FROM = { # Attacker
			has_landed_title = e_tawantinsuyu
			any_realm_lord = {
				has_landed_title = d_acllahuasi
			}
			OR = {
				religion = inca_religion
				religion = inca_religion_reformed
			}
			NOR = {
				has_religion_feature = religion_matriarchal
				has_religion_feature = religion_equal
			}
		}
		top_liege = {
			has_landed_title = e_tawantinsuyu
		}
		any_child = {
			is_female = yes
			is_married = no # In case someone is pre-scripted or something odd has happened
			is_consort = no # In case someone is pre-scripted or something odd has happened
			age = 7
			NOT = { age = 11 }
			host = { character = ROOT }
			has_ugly_trait_trigger = no
			is_landed = no
			NOT = {
				has_character_flag = ex_aclla # Rescued
			}
		}
	}
	
	immediate = {
		# Find daughter to seize
		random_child = {
			limit = {
				is_female = yes
				is_married = no # In case someone is pre-scripted or something odd has happened
				is_consort = no # In case someone is pre-scripted or something odd has happened
				age = 7
				NOT = { age = 11 }
				host = { character = ROOT }
				has_ugly_trait_trigger = no
				is_landed = no
				NOT = {
					has_character_flag = ex_aclla # Rescued
				}
			}
			preferred_limit = {
				trait = fair
			}
			preferred_limit = {
				trait = groomed
			}
			save_event_target_as = child_to_seize
		}
		# Get apupanaca
		d_acllahuasi = {
			holder_scope = {
				character_event = { id = aclla.4 }
			}
		}
	}
}

# Ping Acllahuasi
character_event = {
	id = aclla.4
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		create_character = {
			age = 30
			female = no
			random_traits = yes
			culture = quechua
			religion = inca_religion
		}
		new_character = {
			set_character_flag = apupanaca
			save_event_target_as = apupanaca
			character_event = { id = aclla.5 }
		}
	}
}

# Ping Apupanaca
character_event = {
	id = aclla.5
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		FROMFROM = {
			long_character_event = { id = aclla.6 } # The "offer" arrives
		}
	}
}

# An offer you can't refuse...
long_character_event = {
	id = aclla.6
	desc = EVTDESC_ACLLA_6
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	picture = {
		trigger = {
			is_female = yes
		}
		picture = GFX_evt_daughter_asking_mother
	}
	picture = {
		trigger = {
			is_female = no
		}
		picture = GFX_evt_daughter_asking_father
	}
	
	option = {
		name = EVTOPTA_ACLLA_6 # Oh no!
		trigger = {
			event_target:child_to_seize = {
				is_betrothed = no
			}
		}
	}
	
	option = {
		name = EVTOPTB_ACLLA_6 # Her betrothal will have to be broken
		trigger = {
			event_target:child_to_seize = {
				is_betrothed = yes
			}
		}
		event_target:child_to_seize = {
			betrothed = {
				break_betrothal = PREV
			}
		}
	}
	
	after = {
		hidden_tooltip = {
			character_event = { id = aclla.13 } # Time to say goodbye...
		}
	}
}

# Random chance that someone comes along and asks nicely if you're a vassal and have a decent candidate - on-bi-yearly pulse
character_event = {
	id = aclla.8
	hide_window = yes
	
	has_dlc = "Sunset Invasion"
	
	is_triggered_only = yes
	
	only_playable = yes
	
	has_global_flag = sunrise_invasion_happened
	
	trigger = {
		is_inaccessible_or_incapable_trigger = no
		top_liege = {
			has_landed_title = e_tawantinsuyu
			any_realm_lord = {
				has_landed_title = d_acllahuasi
			}
			OR = {
				religion = inca_religion
				religion = inca_religion_reformed
			}
			NOR = {
				has_religion_feature = religion_matriarchal
				has_religion_feature = religion_equal
			}
		}
		any_child = {
			is_female = yes
			is_married = no # In case someone is pre-scripted or something odd has happened
			is_consort = no # In case someone is pre-scripted or something odd has happened
			age = 7
			NOT = { age = 11 }
			host = { character = ROOT }
			has_ugly_trait_trigger = no
			is_landed = no
			NOT = {
				has_character_flag = ex_aclla # Rescued
			}
		}
		NOT = { has_flag = ruler_supplied_acllahuasi } 
		NOT = { has_flag = dynasty_supplied_acllahuasi }
	}

	immediate = {
		# Find daughter to seize
		random_child = {
			limit = {
				is_female = yes
				is_married = no # In case someone is pre-scripted or something odd has happened
				is_consort = no # In case someone is pre-scripted or something odd has happened
				age = 7
				NOT = { age = 11 }
				host = { character = ROOT }
				has_ugly_trait_trigger = no
				is_landed = no
				NOT = {
					has_character_flag = ex_aclla # Rescued
				}
			}
			preferred_limit = {
				trait = fair
			}
			preferred_limit = {
				trait = groomed
			}
			save_event_target_as = child_to_seize
		}
		# Get apupanaca
		d_acllahuasi = {
			holder_scope = {
				character_event = { id = aclla.9 }
			}
		}
	}
	
}

# Ping Acllahuasi
character_event = {
	id = aclla.9
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		create_character = {
			age = 30
			female = no
			random_traits = yes
			culture = quechua
			religion = inca_religion
		}
		new_character = {
			set_character_flag = apupanaca
			save_event_target_as = apupanaca
			character_event = { id = aclla.10 }
		}
	}
}

# Ping Apupanaca
character_event = {
	id = aclla.10
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		FROMFROM = {
			long_character_event = { id = aclla.11 } # The "offer" arrives
		}
	}
}

# Apupanaca arrives
long_character_event = {
	id = aclla.11
	desc = EVTDESC_ACLLA_11
	picture = GFX_evt_emissary
	border = GFX_event_long_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_11 # Sure
		trigger = {
			event_target:child_to_seize = {
				is_betrothed = no
			}
		}
		prestige = 100
		hidden_tooltip = {
			character_event = { id = aclla.13 }
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				NOR = {
					true_religion = inca_religion
					true_religion = inca_religion_reformed
				}
			}
			modifier = {
				factor = 0.1
				trait = proud
				NOR = {
					true_religion = inca_religion
					true_religion = inca_religion_reformed
				}
			}
			modifier = {
				factor = 0
				trait = zealous
				NOR = {
					true_religion = inca_religion
					true_religion = inca_religion_reformed
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_ACLLA_11 # Her betrothal will have to be broken...
		trigger = {
			event_target:child_to_seize = {
				is_betrothed = yes
			}
		}
		event_target:child_to_seize = {
			betrothed = {
				break_betrothal = PREV
			}
		}
		hidden_tooltip = {
			character_event = { id = aclla.13 }
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				NOR = {
					true_religion = inca_religion
					true_religion = inca_religion_reformed
				}
			}
			modifier = {
				factor = 0.1
				trait = proud
				NOR = {
					true_religion = inca_religion
					true_religion = inca_religion_reformed
				}
			}
			modifier = {
				factor = 0
				trait = zealous
				NOR = {
					true_religion = inca_religion
					true_religion = inca_religion_reformed
				}
			}
		}
	}
	
	option = {
		name = EVTOPTC_ACLLA_11 # Never!
		custom_tooltip = { text = EVTOPTC_ACLLA_11_TOOLTIP } # This may have repercussions... 
		
		hidden_tooltip = {
			event_target:apupanaca = {
				death = {
					death_reason = death_missing
				}
			}
			character_event = { id = aclla.12 days = 30 random = 60 } # Repercussions
		}
		
		if = {
			limit = {
				OR = {
					religion = inca_religion
					religion = inca_religion_reformed
				}
			}
			piety = -100
			prestige = -100
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				OR = {
					religion = inca_religion
					religion = inca_religion_reformed
				}
			}
			modifier = {
				factor = 0
				trait = zealous
				OR = {
					religion = inca_religion
					religion = inca_religion_reformed
				}
			}
		}
	}
}

character_event = { # Repercussions for not obeying Sapa Inca
	id = aclla.12 
	desc = EVTDESC_ACLLA_12
	picture = GFX_evt_scandal
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	trigger = {
		top_liege = {
			has_landed_title = e_tawantinsuyu
			OR = {
				religion = inca_religion
				religion = inca_religion_reformed
			}
		}
	}
	
	option = {
		name = EVTOPTA_ACLLA_12 # Oh noes!
		
		prestige = -100
		
		any_playable_ruler = {
			limit = {
				OR = {
					religion = inca_religion
					religion = inca_religion_reformed
					same_realm = ROOT
				}
			}
			opinion = {
				modifier = opinion_refused_acllahuasi
				who = ROOT
			}
		}
	}
}

# Time to say goodbye
character_event = {
	id = aclla.13
	desc = EVTDESC_ACLLA_13
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	picture = {
		trigger = {
			is_female = yes
		}
		picture = GFX_evt_daughter_asking_mother
	}
	picture = {
		trigger = {
			is_female = no
		}
		picture = GFX_evt_daughter_asking_father
	}
	
	immediate = {
		event_target:child_to_seize = {
			move_character = FROMFROMFROM
			set_character_flag = acllakuna
			add_trait = aclla
			set_character_flag = no_court_invites
			d_acllahuasi = {
				change_variable = { which = no_of_acllakuna value = 1 }
			}
		}
	}
	
	option = {
		name = EVTOPTA_ACLLA_13 # Be strong!
		
		hidden_tooltip = {
			if = {
				limit = {
					has_dlc = "Jade Dragon"
				}
			}
			if = {
				limit = {
					event_target:child_to_seize = {
						any_close_relative = {
							dynasty = PREV
							is_chinese_emperor_trigger = yes
						}
					}
				}
				e_tawantinsuyu = {
					holder_scope = {
						detract_grace_massive_effect = yes
					}
				}
			}
			else_if = {
				limit = {
					event_target:child_to_seize = {
						any_dynasty_member = {
							is_chinese_emperor_trigger = yes
						}
					}
				}
				e_tawantinsuyu = {
					holder_scope = {
						detract_grace_major_effect = yes
					}
				}
			}
		}
		
		event_target:child_to_seize = {
			random_list = {
				20 = {
					modifier = {
						factor = 0
						OR = {
							is_strong_trigger = yes
							trait = weak
						}
					}
					if = {
						limit = {
							trait = feeble
						}
						remove_trait = feeble
					}
					else = {
						add_trait = robust
					}
				}
				20 = {
					add_trait = stressed
				}
				40 = {
					add_trait = proud
				}
				20 = {}
			}
		}
		
		prestige = 50
	}
	
	option = {
		trigger = {
			OR = {
				true_religion = inca_religion
				true_religion = inca_religion_reformed
			}
		}
		name = EVTOPTB_ACLLA_13 # It is for Inti!
		
		event_target:child_to_seize = {
			random_list = {
				40 = { 
					add_trait = zealous
				}
				40 = {
					add_trait = depressed
				}
				20 = {}
			}
		}
		
		piety = 100
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 100
				trait = zealous
			}
			modifier = {
				factor = 0
				trait = cynical
			}
		}
	}
	
	option = {
		name = EVTOPTC_ACLLA_13 # I *will* come back for you.
		event_target:child_to_seize = {
			random_list = {
				40 = { 
					add_trait = deceitful
				}
				40 = {
					add_trait = depressed
				}
				20 = {}
			}
			opinion = {
				who = ROOT
				modifier = opinion_aclla_rescuer
			}
		}
		
		if = {
			limit = {
				OR = {
					true_religion = inca_religion
					true_religion = inca_religion_reformed
				}
			}
			piety = -100
		}
		
		custom_tooltip = {
			text = ACLLA_13_GET_BACK_DAUGHTER
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = zealous
				NOR = {
					trait = arbitrary
					trait = deceitful
				}
				OR = {
					true_religion = inca_religion
					true_religion = inca_religion_reformed
				}
			}
		}
	}
	
	after = {
		set_character_flag = ruler_supplied_acllahuasi
		any_playable_ruler = {
			limit = {
				same_realm = ROOT
				OR = {
					religion = inca_religion
					religion = inca_religion_reformed
				}
			}
			opinion = {
				modifier = opinion_supplied_acllahuasi
				who = ROOT
			}
		}
		hidden_tooltip = {
			event_target:apupanaca = {
				death = {
					death_reason = death_missing
				}
			}
		}
		character_event = { id = aclla.14 days = 3650 random = 3650 } # Flag cleanup
	}
}

# Flag cleanup (delayed a bit)
character_event = {
	id = aclla.14
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		clr_character_flag = ruler_supplied_acllahuasi
	}
}

### Aclla training

# on_childhood_pulse - let's see what happens
character_event = {
	id = aclla.15
	hide_window = yes
	
	is_triggered_only = yes
	
	has_dlc = "Sunset Invasion"
	
	only_women = yes
	
	has_global_flag = sunrise_invasion_happened
	
	trigger = {
		is_inaccessible_or_incapable_trigger = no
		trait = aclla
		d_acllahuasi = {
			holder_scope = {
				any_courtier = {
					character = ROOT
				}
			}
		}
	}
	
	immediate = {
		if = {
			limit = {
				is_landed = yes
			}
			remove_trait = aclla
		}
		else = {
			random_list = {
				1 = {
					modifier = {
						factor = 0
						culture = quechua
					}
					modifier = {
						factor = 0
						trait = proud
					}
					modifier = {
						factor = 10
						trait = humble
					}
					character_event = { id = aclla.16 } # Convert culture
				}
				1 = {
					modifier = {
						factor = 0
						OR = {
							religion = inca_religion
							religion = inca_religion_reformed
						}
					}
					modifier = {
						factor = 0
						trait = zealous
					}
					modifier = {
						factor = 10
						trait = cynical
					}
					character_event = { id = aclla.17 } # Convert religion
				}
				1 = {
					modifier = {
						factor = 0
						NAND = {
							NOR = {
								true_religion = inca_religion
								true_religion = inca_religion_reformed
							}
							trait = zealous
						}
					}
					character_event = { id = aclla.18 } # Zealous Aclla gets into trouble
				}
				1 = {
					modifier = {
						factor = 0
						OR = {
							trait = zealous
							trait = cynical
						}
					}
					add_trait = zealous
				}
				1 = {
					modifier = {
						factor = 0
						OR = {
							trait = zealous
							trait = cynical
						}
					}
					add_trait = cynical
				}
				1 = {
					modifier = {
						factor = 0
						OR = {
							has_character_modifier = aclla_okay_weaver
							has_character_modifier = aclla_good_weaver
							has_character_modifier = aclla_prodigious_weaver
						}
					}
					character_event = { id = aclla.21 } # Learns to weave
				}
				1 = {
					modifier = {
						factor = 0
						has_character_modifier = aclla_brewer
					}
					character_event = { id = aclla.22 } # Learns to brew chica
				}
				1 = {
					modifier = {
						factor = 0
						has_character_modifier = aclla_cook
					}
					character_event = { id = aclla.23 } # Learns to prepare sancu
				}
				1 = {
					modifier = {
						factor = 0
						has_character_modifier = aclla_singer
					}
					character_event = { id = aclla.24 } # Learns to sing
				}
				1 = {
					modifier = {
						factor = 0
						has_character_modifier = aclla_dancer
					}
					character_event = { id = aclla.25 } # Learns to dance
				}
				1 = {
					modifier = {
						factor = 0
						trait = groomed
					}
					character_event = { id = aclla.26 } # Becomes groomed
				}
				10 = {} # Nothing
			}
		}
	}
}

# Character becomes Inca culture
character_event = {
	id = aclla.16
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		culture = quechua
		prestige = 25
	}
}

# Character becomes Inca religion
character_event = {
	id = aclla.17
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				NOT = {
					has_global_flag = inca_reformation
				}
			}
			religion = inca_religion
		}
		else = {
			religion = inca_religion_reformed
		}
		piety = 25
	}
}

# Zealous non-Inca might get into trouble
character_event = {
	id = aclla.18
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				d_acllahuasi = {
					holder_scope = {
						NOT = {
							true_religion = ROOT
						}
					}
				}
			}
			d_acllahuasi = {
				holder_scope = {
					character_event = { id = aclla.19 } # How do you want to handle this?
				}
			}
		}
		piety = 25
	}
}

# Handling of Zealous non-Inca
character_event = {
	id = aclla.19
	desc = EVTDESC_ACLLA_19
	picture = GFX_evt_daughter_asking_mother
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_19 # It's not worth making a fuss...
		
		piety = -25
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = zealous
			}
		}
	}
	
	option = {
		name = EVTOPTB_ACLLA_19 # Try to convince her
		
		if = {
			limit = {
				diplomacy = 15
			}
			FROM = {
				remove_trait = zealous
			}
			piety = 25
		}
		else = {
			FROM = {
				add_trait = stubborn
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = cynical
			}
		}
	}
	
	option = {
		name = EVTOPTC_ACLLA_19 # You asked for it!
		
		prestige = 25
		
		FROM = {
			death = {
				death_reason = death_execution
			}
			any_close_relative = {
				character_event = { id = aclla.20 }
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = cruel
			}
		}
	}
}

# Inform the family
character_event = {
	id = aclla.20
	desc = EVTDESC_ACLLA_20
	picture = GFX_evt_emissary
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			NOR = {
				religion = inca_religion
				religion = inca_religion_reformed
			}
		}
		name = EVTOPTA_ACLLA_20 # She will pay for this!
		
		add_rival = FROM
	}
	
	option = {
		trigger = {
			OR = {
				religion = inca_religion
				religion = inca_religion_reformed
			}
			NOT = {
				trait = zealous
			}
		}
		name = EVTOPTB_ACLLA_20 # She will pay for this!
		
		add_rival = FROM
	}
	
	option = {
		trigger = {
			OR = {
				religion = inca_religion
				religion = inca_religion_reformed
			}
			trait = zealous
		}
		name = EVTOPTC_ACLLA_20 # She did the right thing!
		
		piety = 25
	}
}

# Character learns to weave
character_event = {
	id = aclla.21
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		random_list = {
			30 = {
				modifier = {
					factor = 6
					is_dumb_trigger = yes
				}
				add_character_modifier = {
					modifier = aclla_okay_weaver
					duration = -1
				}
				prestige = 25
			}
			20 = {
				add_character_modifier = {
					modifier = aclla_good_weaver
					duration = -1
				}
				prestige = 50
			}
			10 = {
				modifier = {
					factor = 6
					is_smart_trigger = yes
				}
				add_character_modifier = {
					modifier = aclla_prodigious_weaver
					duration = -1
				}
				prestige = 100
			}
		}
	}
}

# Character learns to brew chica
character_event = {
	id = aclla.22
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		add_character_modifier = {
			modifier = aclla_brewer
			duration = -1
		}
		prestige = 25
		piety = 25
	}
}

# Character learns to prepare sancu
character_event = {
	id = aclla.23
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		add_character_modifier = {
			modifier = aclla_cook
			duration = -1
		}
		prestige = 50
	}
}

# Character learns to sing
character_event = {
	id = aclla.24
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		add_character_modifier = {
			modifier = aclla_singer
			duration = -1
		}
		prestige = 50
	}
}

# Character learns to dance
character_event = {
	id = aclla.25
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		add_character_modifier = {
			modifier = aclla_dancer
			duration = -1
		}
		prestige = 50
	}
}

# Character becomes groomed
character_event = {
	id = aclla.26
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				trait = uncouth
			}
			remove_trait = uncouth
		}
		else = {
			add_trait = groomed
		}
		prestige = 25
	}
}

### Rescue chain

# on_yearly_pulse - see if we see an opportunity
character_event = {
	id = aclla.27
	hide_window = yes
	
	is_triggered_only = yes
	
	has_dlc = "Sunset Invasion"
	
	only_playable = yes
	
	has_global_flag = sunrise_invasion_happened
	
	min_age = 16
	
	only_capable = yes
	
	trigger = {
		has_global_flag = sunrise_invasion_happened
		top_liege = {
			has_landed_title = e_tawantinsuyu
		}
		is_inaccessible_or_incapable_trigger = no
		any_opinion_modifier_target = {
			has_opinion_modifier = {
				who = ROOT
				modifier = opinion_aclla_rescuer
			}
			trait = aclla
			NOR = {
				has_character_flag = aclla_being_rescued
				has_character_flag = aclla_rescue_attempt_lover
				has_character_flag = aclla_rescue_attempt_snitch
				has_character_flag = aclla_being_married
				has_character_flag = aclla_sacrifice_in_progress # Too late to rescue her
			}
		}
	}
	
	immediate = {
		random_list = {
			25 = {
				modifier = {
					factor = 2
					is_smart_trigger = yes
				}
				modifier = {
					factor = 2
					intrigue = 40
				}
				modifier = {
					factor = 2
					intrigue = 36
				}
				modifier = {
					factor = 2
					intrigue = 32
				}
				modifier = {
					factor = 2
					intrigue = 28
				}
				modifier = {
					factor = 2
					intrigue = 24
				}
				modifier = {
					factor = 2
					intrigue = 20
				}
				modifier = {
					factor = 2
					intrigue = 16
				}
				modifier = {
					factor = 2
					combat_rating = 200
				}
				modifier = {
					factor = 2
					combat_rating = 175
				}
				modifier = {
					factor = 2
					combat_rating = 150
				}
				modifier = {
					factor = 2
					combat_rating = 125
				}
				modifier = {
					factor = 2
					combat_rating = 100
				}
				modifier = {
					factor = 2
					combat_rating = 75
				}
				modifier = {
					factor = 5
					any_opinion_modifier_target = {
						has_opinion_modifier = {
							who = ROOT
							modifier = opinion_aclla_rescuer
						}
						trait = aclla
						has_character_flag = aclla_being_sacrificed
					}
				}
				character_event = { id = aclla.28 } # You see an opportunity
			}
			75 = {
				modifier = {
					factor = 2
					is_dumb_trigger = yes
				}
				modifier = {
					factor = 2
					NOT = {
						intrigue = 12
					}
				}
				modifier = {
					factor = 2
					NOT = {
						intrigue = 8
					}
				}
				modifier = {
					factor = 2
					NOT = {
						intrigue = 4
					}
				}
				modifier = {
					factor = 2
					NOT = {
						combat_rating = 50
					}
				}
				modifier = {
					factor = 2
					NOT = {
						combat_rating = 25
					}
				}
				# No opportunity
			}
		}
	}
}

# You see an opportunity
character_event = {
	id = aclla.28
	desc = EVTDESC_ACLLA_28
	picture = GFX_evt_jailbreak
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	immediate = {
		random_opinion_modifier_target = {
			limit = {
				has_opinion_modifier = {
					who = ROOT
					modifier = opinion_aclla_rescuer
				}
				trait = aclla
				NOR = {
					has_character_flag = aclla_being_rescued
					has_character_flag = aclla_rescue_attempt_lover
					has_character_flag = aclla_rescue_attempt_snitch
					has_character_flag = aclla_being_married
					has_character_flag = aclla_sacrifice_in_progress # Too late to rescue her
				}
			}
			preferred_limit = {
				has_character_flag = aclla_being_sacrificed
			}
			save_event_target_as = aclla_to_rescue
		}
	}
	
	option = {
		name = EVTOPTA_ACLLA_28 # I must rescue her!
		
		if = {
			limit = {
				OR = {
					true_religion = inca_religion
					true_religion = inca_religion_reformed
				}
			}
			piety = -25
		}
		
		add_trait = travelling
		set_character_flag = do_not_disturb
		
		hidden_tooltip = {
			event_target:aclla_to_rescue = {
				set_character_flag = aclla_being_rescued # Keeps various events from targeting her
			}
		}
		
		character_event = { id = aclla.29 days = 30 random = 30 } # Dealing with the guards
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = zealous
				OR = {
					true_religion = inca_religion
					true_religion = inca_religion_reformed
				}
			}
			modifier = {
				factor = 0.1
				trait = craven
			}
			modifier = {
				factor = 0.1
				trait = humble
			}
			modifier = {
				factor = 0.1
				trait = just
			}
			modifier = {
				factor = 100
				event_target:aclla_to_rescue = {
					has_character_flag = aclla_being_sacrificed
				}
				NOR = {
					true_religion = inca_religion
					true_religion = inca_religion_reformed
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_ACLLA_28 # It is too dangerous...
		
		prestige = -25
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = zealous
				NOR = {
					true_religion = inca_religion
					true_religion = inca_religion_reformed
				}
			}
			modifier = {
				factor = 0.1
				trait = brave
			}
			modifier = {
				factor = 0.1
				trait = proud
			}
			modifier = {
				factor = 0.1
				trait = arbitrary
			}
		}
	}
	
	option = {
		name = EVTOPTC_ACLLA_28 # I will give up on this...
		
		prestige = -100
		
		event_target:aclla_to_rescue = {
			remove_opinion = {
				who = ROOT
				modifier = opinion_aclla_rescuer
			}
		}
		
		ai_chance = {
			factor = 0
		}
	}
}

# Arrival - how do you handle the situation?
character_event = {
	id = aclla.29
	desc = EVTDESC_ACLLA_29
	picture = GFX_evt_jailbreak
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_29 # I will fight the guards!
		
		random_list = {
			20 = {
				modifier = {
					factor = 0
					NOT = {
						combat_rating = 25
					}
				}
				modifier = {
					factor = 2
					combat_rating = 75
				}
				random_list = {
					50 = {
						modifier = {
							factor = 2
							intrigue = 40
						}
						modifier = {
							factor = 2
							intrigue = 36
						}
						modifier = {
							factor = 2
							intrigue = 32
						}
						modifier = {
							factor = 2
							intrigue = 28
						}
						modifier = {
							factor = 2
							intrigue = 24
						}
						modifier = {
							factor = 2
							intrigue = 20
						}
						modifier = {
							factor = 2
							intrigue = 16
						}
						character_event = { id = aclla.31 days = 1 } # Clean victory
					}
					50 = {
						modifier = {
							factor = 2
							NOT = {
								intrigue = 12
							}
						}
						modifier = {
							factor = 2
							NOT = {
								intrigue = 8
							}
						}
						modifier = {
							factor = 2
							NOT = {
								intrigue = 4
							}
						}
						character_event = { id = aclla.32 days = 1 } # Noisy
					}
				}
			}
			20 = {
				modifier = {
					factor = 0
					combat_rating = 100
				}
				random_list = {
					50 = {
						modifier = {
							factor = 2
							intrigue = 40
						}
						modifier = {
							factor = 2
							intrigue = 36
						}
						modifier = {
							factor = 2
							intrigue = 32
						}
						modifier = {
							factor = 2
							intrigue = 28
						}
						modifier = {
							factor = 2
							intrigue = 24
						}
						modifier = {
							factor = 2
							intrigue = 20
						}
						modifier = {
							factor = 2
							intrigue = 16
						}
						character_event = { id = aclla.33 days = 1 } # Wounded
					}
					50 = {
						modifier = {
							factor = 2
							NOT = {
								intrigue = 12
							}
						}
						modifier = {
							factor = 2
							NOT = {
								intrigue = 8
							}
						}
						modifier = {
							factor = 2
							NOT = {
								intrigue = 4
							}
						}
						character_event = { id = aclla.34 days = 1 } # Wounded and noisy
					}
				}
			}
			20 = {
				modifier = {
					factor = 0
					combat_rating = 75
				}
				random_list = {
					50 = {
						modifier = {
							factor = 2
							intrigue = 40
						}
						modifier = {
							factor = 2
							intrigue = 36
						}
						modifier = {
							factor = 2
							intrigue = 32
						}
						modifier = {
							factor = 2
							intrigue = 28
						}
						modifier = {
							factor = 2
							intrigue = 24
						}
						modifier = {
							factor = 2
							intrigue = 20
						}
						modifier = {
							factor = 2
							intrigue = 16
						}
						character_event = { id = aclla.35 days = 1 } # Maimed
					}
					50 = {
						modifier = {
							factor = 2
							NOT = {
								intrigue = 12
							}
						}
						modifier = {
							factor = 2
							NOT = {
								intrigue = 8
							}
						}
						modifier = {
							factor = 2
							NOT = {
								intrigue = 4
							}
						}
						character_event = { id = aclla.36 days = 1 } # Maimed and noisy
					}
				}
			}
			20 = {
				modifier = {
					factor = 0
					combat_rating = 75
				}
				modifier = {
					factor = 0.5
					combat_rating = 50
				}
				modifier = {
					factor = 2
					NOT = {
						intrigue = 12
					}
				}
				modifier = {
					factor = 2
					NOT = {
						intrigue = 8
					}
				}
				modifier = {
					factor = 2
					NOT = {
						intrigue = 4
					}
				}
				character_event = { id = aclla.37 days = 1 } # Captured
			}
			20 = {
				modifier = {
					factor = 0
					combat_rating = 50
				}
				character_event = { id = aclla.40 days = 1 } # Killed
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				NOT = {
					combat_rating = 50
				}
			}
			modifier = {
				factor = 0
				trait = craven
			}
			modifier = {
				factor = 0.1
				trait = deceitful
			}
		}
	}
	
	option = {
		name = EVTOPTB_ACLLA_29 # I will bribe them!
		
		random_list = {
			33 = {
				modifier = {
					factor = 2
					diplomacy = 40
				}
				modifier = {
					factor = 2
					diplomacy = 36
				}
				modifier = {
					factor = 2
					diplomacy = 32
				}
				modifier = {
					factor = 2
					diplomacy = 28
				}
				modifier = {
					factor = 2
					diplomacy = 24
				}
				modifier = {
					factor = 2
					diplomacy = 20
				}
				modifier = {
					factor = 2
					diplomacy = 16
				}
				character_event = { id = aclla.41 days = 1 } # It worked
			}
			34 = {
				character_event = { id = aclla.42 days = 1 } # They refuse
			}
			33 = {
				modifier = {
					factor = 2
					NOT = {
						diplomacy = 12
					}
				}
				modifier = {
					factor = 2
					NOT = {
						diplomacy = 8
					}
				}
				modifier = {
					factor = 2
					NOT = {
						diplomacy = 4
					}
				}
				character_event = { id = aclla.43 days = 1 } # They try to arrest you
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				NOT = {
					wealth = 100
				}
			}
			modifier = {
				factor = 0
				trait = greedy
			}
			modifier = {
				factor = 0.1
				trait = deceitful
			}
		}
	}
	
	option = {
		name = EVTOPTC_ACLLA_29 # I will sneak inside!
		
		random_list = {
			33 = {
				modifier = {
					factor = 2
					intrigue = 40
				}
				modifier = {
					factor = 2
					intrigue = 36
				}
				modifier = {
					factor = 2
					intrigue = 32
				}
				modifier = {
					factor = 2
					intrigue = 28
				}
				modifier = {
					factor = 2
					intrigue = 24
				}
				modifier = {
					factor = 2
					intrigue = 20
				}
				modifier = {
					factor = 2
					intrigue = 16
				}
				character_event = { id = aclla.44 days = 1 } # It worked
			}
			34 = {
				character_event = { id = aclla.45 days = 1 } # You made too much noise - fight or leave?
			}
			33 = {
				modifier = {
					factor = 2
					NOT = {
						intrigue = 12
					}
				}
				modifier = {
					factor = 2
					NOT = {
						intrigue = 8
					}
				}
				modifier = {
					factor = 2
					NOT = {
						intrigue = 4
					}
				}
				character_event = { id = aclla.46 days = 1 } # Guards arrive to arrest you
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				NOT = {
					intrigue = 10
				}
			}
			modifier = {
				factor = 0
				trait = brave
			}
			modifier = {
				factor = 0.1
				trait = honest
			}
		}
	}
	
	option = {
		name = EVTOPTD_ACLLA_29 # This is too dangerous...
		
		prestige = -25
		
		character_event = { id = aclla.30 days = 30 random = 30 } # Returned home
		
		event_target:aclla_to_rescue = {
			clr_character_flag = aclla_being_rescued
		}
		
		ai_chance = {
			factor = 0
		}
	}
}

# Aborted rescue attempt - returned home
character_event = {
	id = aclla.30
	desc = EVTDESC_ACLLA_30
	picture = GFX_evt_stressed_ruler
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_30 # Maybe I'll do it in the future...
		
		remove_trait = travelling
		clr_character_flag = do_not_disturb
		clr_character_flag = aclla_no_more_guards
	}
}

# You fought the guards - won
character_event = {
	id = aclla.31
	desc = EVTDESC_ACLLA_31
	picture = GFX_evt_dueling_knights_hf
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_31 # I knew I could do it!
		
		prestige = 25
		
		character_event = { id = aclla.47 days = 1 } # Inside - now what?
		
		set_character_flag = aclla_no_more_guards
	}
}

# You fought the guards - won but made too much noise
character_event = {
	id = aclla.32
	desc = EVTDESC_ACLLA_32
	picture = GFX_evt_dueling_knights_hf
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_32 # Curses!
		
		prestige = -5
		
		character_event = { id = aclla.30 days = 30 random = 30 } # Return home
		
		event_target:aclla_to_rescue = {
			clr_character_flag = aclla_being_rescued
		}
	}
}

# You fought the guards - wounded
character_event = {
	id = aclla.33
	desc = EVTDESC_ACLLA_33
	picture = GFX_evt_dueling_knights_hf
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_33 # I knew I could do it!
		
		prestige = 10
		
		add_trait = wounded
		
		character_event = { id = aclla.47 days = 1 } # Inside - now what?
		
		set_character_flag = aclla_no_more_guards
	}
}

# You fought the guards - wounded and made too much noise
character_event = {
	id = aclla.34
	desc = EVTDESC_ACLLA_34
	picture = GFX_evt_dueling_knights_hf
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_34 # Curses!
		
		prestige = -15
		
		add_trait = wounded
		
		character_event = { id = aclla.30 days = 30 random = 30 } # Return home
		
		event_target:aclla_to_rescue = {
			clr_character_flag = aclla_being_rescued
		}
	}
}

# You fought the guards - maimed
character_event = {
	id = aclla.35
	desc = EVTDESC_ACLLA_35
	picture = GFX_evt_dueling_knights_hf
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_35 # I knew I could do it!
		
		add_maimed_trait_effect = yes
		
		character_event = { id = aclla.47 days = 1 } # Inside - now what?
		
		set_character_flag = aclla_no_more_guards
	}
}

# You fought the guards - maimed and made too much noise
character_event = {
	id = aclla.36
	desc = EVTDESC_ACLLA_36
	picture = GFX_evt_dueling_knights_hf
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_36 # Curses!
		
		prestige = -25
		
		add_maimed_trait_effect = yes
		
		character_event = { id = aclla.30 days = 30 random = 30 } # Return home
		
		event_target:aclla_to_rescue = {
			clr_character_flag = aclla_being_rescued
		}
	}
}

# You fought the guards - captured
character_event = {
	id = aclla.37
	desc = EVTDESC_ACLLA_37
	picture = GFX_evt_into_the_dungeon
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_37 # This is bad...
		
		prestige = -25
		
		d_acllahuasi = {
			holder_scope = {
				ROOT = {
					imprison = PREV
				}
				if = {
					limit = {
						has_dlc = "Jade Dragon"
					}
					if = {
						limit = {
							ROOT = {
								is_chinese_emperor_trigger = yes
							}
						}
						detract_grace_super_huge_effect = yes
					}
					else_if = {
						limit = {
							ROOT = {
								any_close_relative = {
									dynasty = PREV
									is_chinese_emperor_trigger = yes
								}
							}
						}
						detract_grace_massive_effect = yes
					}
					else_if = {
						limit = {
							ROOT = {
								any_dynasty_member = {
									is_chinese_emperor_trigger = yes
								}
							}
						}
						detract_grace_major_effect = yes
					}
				}
				character_event = { id = aclla.38 days = 1 }
			}
		}
		
		event_target:aclla_to_rescue = {
			clr_character_flag = aclla_being_rescued
		}
	}
}

# Aclla leader notified - might make an example of your kinswoman
character_event = {
	id = aclla.38
	desc = EVTDESC_ACLLA_38
	picture = GFX_evt_into_the_dungeon
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_38 # What FROM deserves!
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				OR = {
					event_target:aclla_to_rescue = {
						any_rival = {
							character = ROOT
						}
						NOT = {
							has_character_flag = aclla_being_sacrificed
						}
					}
					AND = {
						trait = cruel
						event_target:aclla_to_rescue = {
							NOR = {
								any_friend = {
									character = ROOT
								}
								any_lover = {
									character = ROOT
								}
							}
						}
						NOT = {
							has_character_flag = aclla_being_sacrificed
						}
					}
				}
			}
		}
	}
	
	option = {
		trigger = {
			event_target:aclla_to_rescue = {
				NOT = {
					has_character_flag = aclla_being_sacrificed
				}
			}
		}
		name = EVTOPTB_ACLLA_38 # Time to make an example!
		
		event_target:aclla_to_rescue = {
			if = {
				limit = {
					has_dlc = "Jade Dragon"
				}
				if = {
					limit = {
						is_chinese_emperor_trigger = yes # Should be impossible...
					}
					ROOT = {
						detract_grace_super_huge_effect = yes
					}
				}
				else_if = {
					limit = {
						any_close_relative = {
							dynasty = PREV
							is_chinese_emperor_trigger = yes
						}
					}
					ROOT = {
						detract_grace_massive_effect = yes
					}
				}
				else_if = {
					limit = {
						any_dynasty_member = {
							is_chinese_emperor_trigger = yes
						}
					}
					ROOT = {
						detract_grace_major_effect = yes
					}
				}
			}
			death = {
				death_reason = death_execution
				killer = ROOT
			}
		}
		
		FROM = {
			character_event = { id = aclla.39 } # Inform FROM!
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				NOR = {
					event_target:aclla_to_rescue = {
						any_rival = {
							character = ROOT
						}
					}
					AND = {
						trait = cruel
						event_target:aclla_to_rescue = {
							NOR = {
								any_friend = {
									character = ROOT
								}
								any_lover = {
									character = ROOT
								}
							}
						}
					}
				}
			}
		}
	}
}

# Notified that an example was made
character_event = {
	id = aclla.39
	desc = EVTDESC_ACLLA_39
	picture = GFX_evt_slit_throat_hf
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_39 # You will pay for this!
		
		add_rival = FROM
	}
}

# You fought the guards - killed
character_event = {
	id = aclla.40
	desc = EVTDESC_ACLLA_40
	picture = GFX_evt_bloody_man
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_40 # This cannot be!
		
		prestige = -25
		
		death = {
			death_reason = death_battle
		}
		
		event_target:aclla_to_rescue = {
			clr_character_flag = aclla_being_rescued
		}
	}
}

# Bribery succeded
character_event = {
	id = aclla.41
	desc = EVTDESC_ACLLA_41
	picture = GFX_evt_jailbreak
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_41 # Just as planned!
		
		wealth = -100
		
		character_event = { id = aclla.47 days = 1 } # Inside - now what?
		
		set_character_flag = aclla_no_more_guards
	}
}

# Bribery failed - the guards tell you to leave - fight?
character_event = {
	id = aclla.42
	desc = EVTDESC_ACLLA_42
	picture = GFX_evt_jailbreak
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_42 # I guess it's time to fight...
		
		random_list = { # No noise penalty
			20 = {
				modifier = {
					factor = 0
					NOT = {
						combat_rating = 25
					}
				}
				modifier = {
					factor = 2
					combat_rating = 75
				}
				character_event = { id = aclla.31 days = 1 } # Clean victory
			}
			20 = {
				modifier = {
					factor = 0
					combat_rating = 100
				}
				character_event = { id = aclla.33 days = 1 } # Wounded
			}
			20 = {
				modifier = {
					factor = 0
					combat_rating = 75
				}
				character_event = { id = aclla.35 days = 1 } # Maimed
			}
			20 = {
				modifier = {
					factor = 0
					combat_rating = 75
				}
				modifier = {
					factor = 0.5
					combat_rating = 50
				}
				character_event = { id = aclla.37 days = 1 } # Captured
			}
			20 = {
				modifier = {
					factor = 0
					combat_rating = 50
				}
				character_event = { id = aclla.40 days = 1 } # Killed
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = craven
			}
		}
	}
	
	option = {
		name = EVTOPTB_ACLLA_42 # I guess it's time to leave...
		
		prestige = -25
		
		character_event = { id = aclla.30 days = 30 random = 30 } # Return home
		
		event_target:aclla_to_rescue = {
			clr_character_flag = aclla_being_rescued
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = brave
			}
		}
	}
}

# Bribery crit failed - time to fight!
character_event = {
	id = aclla.43
	desc = EVTDESC_ACLLA_43
	picture = GFX_evt_jailbreak
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_43 # I guess it's time to fight...
		
		random_list = { # No noise penalty
			20 = {
				modifier = {
					factor = 0
					NOT = {
						combat_rating = 25
					}
				}
				modifier = {
					factor = 2
					combat_rating = 75
				}
				character_event = { id = aclla.31 days = 1 } # Clean victory
			}
			20 = {
				modifier = {
					factor = 0
					combat_rating = 100
				}
				character_event = { id = aclla.33 days = 1 } # Wounded
			}
			20 = {
				modifier = {
					factor = 0
					combat_rating = 75
				}
				character_event = { id = aclla.35 days = 1 } # Maimed
			}
			20 = {
				modifier = {
					factor = 0
					combat_rating = 75
				}
				modifier = {
					factor = 0.5
					combat_rating = 50
				}
				character_event = { id = aclla.37 days = 1 } # Captured
			}
			20 = {
				modifier = {
					factor = 0
					combat_rating = 50
				}
				character_event = { id = aclla.40 days = 1 } # Killed
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = craven
			}
		}
	}
	
	option = {
		name = EVTOPTB_ACLLA_43 # I will come quietly!
		
		prestige = -25
		
		d_acllahuasi = {
			holder_scope = {
				ROOT = {
					imprison = PREV
				}
				if = {
					limit = {
						has_dlc = "Jade Dragon"
					}
					if = {
						limit = {
							ROOT = {
								is_chinese_emperor_trigger = yes
							}
						}
						detract_grace_super_huge_effect = yes
					}
					else_if = {
						limit = {
							ROOT = {
								any_close_relative = {
									dynasty = PREV
									is_chinese_emperor_trigger = yes
								}
							}
						}
						detract_grace_massive_effect = yes
					}
					else_if = {
						limit = {
							ROOT = {
								any_dynasty_member = {
									is_chinese_emperor_trigger = yes
								}
							}
						}
						detract_grace_major_effect = yes
					}
				}
				character_event = { id = aclla.38 days = 1 }
			}
		}
		
		event_target:aclla_to_rescue = {
			clr_character_flag = aclla_being_rescued
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = brave
			}
		}
	}
}

# Sneaking in - you succeed
character_event = {
	id = aclla.44
	desc = EVTDESC_ACLLA_44
	picture = GFX_evt_jailbreak
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_44 # Just as planned!
		
		prestige = 25
		
		character_event = { id = aclla.47 days = 1 } # Inside - now what?
	}
}

# Sneaking in - can't find a way - try another method?
character_event = {
	id = aclla.45
	desc = EVTDESC_ACLLA_45
	picture = GFX_evt_jailbreak
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_45 # I guess it's time to fight...
		
		random_list = { # No noise penalty
			20 = {
				modifier = {
					factor = 0
					NOT = {
						combat_rating = 25
					}
				}
				modifier = {
					factor = 2
					combat_rating = 75
				}
				character_event = { id = aclla.31 days = 1 } # Clean victory
			}
			20 = {
				modifier = {
					factor = 0
					combat_rating = 100
				}
				character_event = { id = aclla.33 days = 1 } # Wounded
			}
			20 = {
				modifier = {
					factor = 0
					combat_rating = 75
				}
				character_event = { id = aclla.35 days = 1 } # Maimed
			}
			20 = {
				modifier = {
					factor = 0
					combat_rating = 75
				}
				modifier = {
					factor = 0.5
					combat_rating = 50
				}
				character_event = { id = aclla.37 days = 1 } # Captured
			}
			20 = {
				modifier = {
					factor = 0
					combat_rating = 50
				}
				character_event = { id = aclla.40 days = 1 } # Killed
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = craven
			}
		}
	}
	
	option = {
		name = EVTOPTB_ACLLA_42 # I guess it's time to leave...
		
		prestige = -25
		
		character_event = { id = aclla.30 days = 30 random = 30 } # Return home
		
		event_target:aclla_to_rescue = {
			clr_character_flag = aclla_being_rescued
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = brave
			}
		}
	}
}

# Sneaking in - crit failed - time to fight!
character_event = {
	id = aclla.46
	desc = EVTDESC_ACLLA_46
	picture = GFX_evt_jailbreak
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_46 # I guess it's time to fight...
		
		random_list = { # No noise penalty
			20 = {
				modifier = {
					factor = 0
					NOT = {
						combat_rating = 25
					}
				}
				modifier = {
					factor = 2
					combat_rating = 75
				}
				character_event = { id = aclla.31 days = 1 } # Clean victory
			}
			20 = {
				modifier = {
					factor = 0
					combat_rating = 100
				}
				character_event = { id = aclla.33 days = 1 } # Wounded
			}
			20 = {
				modifier = {
					factor = 0
					combat_rating = 75
				}
				character_event = { id = aclla.35 days = 1 } # Maimed
			}
			20 = {
				modifier = {
					factor = 0
					combat_rating = 75
				}
				modifier = {
					factor = 0.5
					combat_rating = 50
				}
				character_event = { id = aclla.37 days = 1 } # Captured
			}
			20 = {
				modifier = {
					factor = 0
					combat_rating = 50
				}
				character_event = { id = aclla.40 days = 1 } # Killed
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = craven
			}
		}
	}
	
	option = {
		name = EVTOPTB_ACLLA_46 # I will come quietly!
		
		prestige = -25
		
		d_acllahuasi = {
			holder_scope = {
				ROOT = {
					imprison = PREV
				}
				if = {
					limit = {
						has_dlc = "Jade Dragon"
					}
					if = {
						limit = {
							ROOT = {
								is_chinese_emperor_trigger = yes
							}
						}
						detract_grace_super_huge_effect = yes
					}
					else_if = {
						limit = {
							ROOT = {
								any_close_relative = {
									dynasty = PREV
									is_chinese_emperor_trigger = yes
								}
							}
						}
						detract_grace_massive_effect = yes
					}
					else_if = {
						limit = {
							ROOT = {
								any_dynasty_member = {
									is_chinese_emperor_trigger = yes
								}
							}
						}
						detract_grace_major_effect = yes
					}
				}
				character_event = { id = aclla.38 days = 1 }
			}
		}
		
		event_target:aclla_to_rescue = {
			clr_character_flag = aclla_being_rescued
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = brave
			}
		}
	}
}

# Inside - let's see what happens
character_event = {
	id = aclla.47
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		random_list = {
			1 = {
				modifier = {
					factor = 0
					intrigue = 20
				}
				modifier = {
					factor = 0
					d_acllahuasi = {
						holder_scope = {
							NOT = {
								any_courtier = {
									is_inaccessible_or_incapable_trigger = no
									NOR = {
										has_character_flag = aclla_being_rescued
										has_character_flag = aclla_rescue_attempt_lover
										has_character_flag = aclla_rescue_attempt_snitch
										has_character_flag = aclla_being_married
										has_character_flag = aclla_being_sacrificed
									}
									trait = aclla
									intrigue = 10
									OR = {
										true_religion = inca_religion
										true_religion = inca_religion_reformed
										trait = cruel
										trait = just
										trait = honest
										trait = zealous
									}
								}
							}
						}
					}
				}
				d_acllahuasi = {
					holder_scope = {
						random_courtier = {
							limit = {
								is_inaccessible_or_incapable_trigger = no
								NOR = {
									has_character_flag = aclla_being_rescued
									has_character_flag = aclla_rescue_attempt_lover
									has_character_flag = aclla_rescue_attempt_snitch
									has_character_flag = aclla_being_married
									has_character_flag = aclla_being_sacrificed
								}
								trait = aclla
								intrigue = 10
								OR = {
									true_religion = inca_religion
									true_religion = inca_religion_reformed
									trait = cruel
									trait = just
									trait = honest
									trait = zealous
								}
							}
							set_character_flag = aclla_rescue_attempt_snitch
							save_event_target_as = aclla_rescue_attempt_snitch
						}
					}
				}
				if = {
					limit = {
						has_character_flag = aclla_no_more_guards
					}
					character_event = { id = aclla.48 } # No guards!
				}
				else = {
					character_event = { id = aclla.49 } # Guards!
				}
			}
			1 = {
				modifier = {
					factor = 0
					d_acllahuasi = {
						holder_scope = {
							NOT = {
								any_courtier = {
									is_adult = yes
									is_inaccessible_or_incapable_trigger = no
									NOR = {
										has_character_flag = aclla_being_rescued
										has_character_flag = aclla_rescue_attempt_lover
										has_character_flag = aclla_rescue_attempt_snitch
										has_character_flag = aclla_being_married
										has_character_flag = aclla_being_sacrificed
									}
									trait = aclla
									OR = {
										AND = {
											ROOT = {
												is_female = yes
												trait = homosexual
											}
											trait = homosexual
										}
										AND = {
											ROOT = {
												is_female = no
												NOT = {
													trait = homosexual
												}
											}
											NOT = {
												trait = homosexual
											}
										}
									}
									OR = {
										NOT = {
											is_close_relative = ROOT
										}
										AND = {
											OR = {
												religion = inca_religion
												religion = inca_religion_reformed
											}
											any_sibling = {
												character = ROOT
											}
										}
										AND = {
											OR = {
												religion = messalian
												religion = zoroastrian
												has_religion_feature = religion_feature_zun
												has_religion_feature = religion_holy_family
											}
											ROOT = {
												OR = {
													religion = messalian
													religion = zoroastrian
													has_religion_feature = religion_feature_zun
													has_religion_feature = religion_holy_family
												}
											}
										}
									}
								}
							}
						}
					}
				}
				d_acllahuasi = {
					holder_scope = {
						random_courtier = {
							limit = {
								is_adult = yes
								is_inaccessible_or_incapable_trigger = no
								NOR = {
									has_character_flag = aclla_being_rescued
									has_character_flag = aclla_rescue_attempt_lover
									has_character_flag = aclla_rescue_attempt_snitch
									has_character_flag = aclla_being_married
									has_character_flag = aclla_being_sacrificed
								}
								is_attractive_trigger = yes
								is_unattractive_trigger = no
								trait = aclla
								OR = {
									AND = {
										ROOT = {
											is_female = yes
											trait = homosexual
										}
										trait = homosexual
									}
									AND = {
										ROOT = {
											is_female = no
											NOT = {
												trait = homosexual
											}
										}
										NOT = {
											trait = homosexual
										}
									}
								}
								OR = {
									NOT = {
										is_close_relative = ROOT
									}
									AND = {
										OR = {
											religion = inca_religion
											religion = inca_religion_reformed
										}
										any_sibling = {
											character = ROOT
										}
									}
									AND = {
										OR = {
											religion = messalian
											religion = zoroastrian
											has_religion_feature = religion_feature_zun
											has_religion_feature = religion_holy_family
										}
										ROOT = {
											OR = {
												religion = messalian
												religion = zoroastrian
												has_religion_feature = religion_feature_zun
												has_religion_feature = religion_holy_family
											}
										}
									}
								}
							}
							set_character_flag = aclla_rescue_attempt_lover
							save_event_target_as = aclla_rescue_attempt_lover
						}
					}
				}
				character_event = { id = aclla.55 } # Possible tumbling
			}
			1 = {
				modifier = {
					factor = 0
					NOR = {
						true_religion = inca_religion
						true_religion = inca_religion_reformed
					}
				}
				modifier = {
					factor = 10
					trait = zealous
				}
				# Possible second thoughts
				character_event = { id = aclla.63 days = 1 }
			}
			5 = {
				# Go directly to kinswoman
				character_event = { id = aclla.64 days = 1 }
			}
		}
	}
}

# No guards arrive - how deal with the snitch?
character_event = {
	id = aclla.48
	desc = EVTDESC_ACLLA_48
	picture = GFX_evt_jailbreak
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_48 # Get lost!
		
		piety = 5
		
		character_event = { id = aclla.64 days = 1 }
		
		event_target:aclla_rescue_attempt_snitch = {
			clr_character_flag = aclla_rescue_attempt_snitch
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = cruel
			}
			modifier = {
				factor = 0
				NOT = {
					trait = kind
				}
				event_target:aclla_rescue_attempt_snitch = {
					any_rival = {
						character = ROOT
					}
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_ACLLA_48 # And now you die!
		
		piety = -10
		
		character_event = { id = aclla.64 days = 1 }
		
		event_target:aclla_rescue_attempt_snitch = {
			death = {
				death_reason = death_murder_unknown
				killer = ROOT
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				NOR = {
					trait = cruel
					event_target:aclla_rescue_attempt_snitch = {
						any_rival = {
							character = ROOT
						}
					}
				}
			}
			modifier = {
				factor = 0
				trait = cruel
				event_target:aclla_rescue_attempt_snitch = {
					OR = {
						any_friend = {
							character = ROOT
						}
						any_lover = {
							character = ROOT
						}
					}
				}
			}
		}
	}
}

# Spotted by someone sneaky - she calls the guards
character_event = {
	id = aclla.49
	desc = EVTDESC_ACLLA_49
	picture = GFX_evt_jailbreak
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_49 # I guess it's time to fight...
		
		random_list = { # No noise penalty
			20 = {
				modifier = {
					factor = 0
					NOT = {
						combat_rating = 25
					}
				}
				modifier = {
					factor = 2
					combat_rating = 75
				}
				character_event = { id = aclla.50 days = 1 } # Clean victory
			}
			20 = {
				modifier = {
					factor = 0
					combat_rating = 100
				}
				character_event = { id = aclla.51 days = 1 } # Wounded
			}
			20 = {
				modifier = {
					factor = 0
					combat_rating = 75
				}
				character_event = { id = aclla.52 days = 1 } # Maimed
			}
			20 = {
				modifier = {
					factor = 0
					combat_rating = 75
				}
				modifier = {
					factor = 0.5
					combat_rating = 50
				}
				character_event = { id = aclla.53 days = 1 } # Captured
			}
			20 = {
				modifier = {
					factor = 0
					combat_rating = 50
				}
				character_event = { id = aclla.54 days = 1 } # Killed
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = craven
			}
		}
	}
	
	option = {
		name = EVTOPTB_ACLLA_49 # I will come quietly!
		
		prestige = -25
		
		d_acllahuasi = {
			holder_scope = {
				ROOT = {
					imprison = PREV
				}
				if = {
					limit = {
						has_dlc = "Jade Dragon"
					}
					if = {
						limit = {
							ROOT = {
								is_chinese_emperor_trigger = yes
							}
						}
						detract_grace_super_huge_effect = yes
					}
					else_if = {
						limit = {
							ROOT = {
								any_close_relative = {
									dynasty = PREV
									is_chinese_emperor_trigger = yes
								}
							}
						}
						detract_grace_massive_effect = yes
					}
					else_if = {
						limit = {
							ROOT = {
								any_dynasty_member = {
									is_chinese_emperor_trigger = yes
								}
							}
						}
						detract_grace_major_effect = yes
					}
				}
				character_event = { id = aclla.38 days = 1 }
			}
		}
		
		event_target:aclla_to_rescue = {
			clr_character_flag = aclla_being_rescued
		}
		event_target:aclla_rescue_attempt_snitch = {
			clr_character_flag = aclla_rescue_attempt_snitch
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = brave
			}
		}
	}
}

# You fought the guards - won - how deal with the snitch?
character_event = {
	id = aclla.50
	desc = EVTDESC_ACLLA_50
	picture = GFX_evt_jailbreak
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_50 # Get lost!
		
		prestige = 25
		piety = 5
		
		character_event = { id = aclla.64 days = 1 }
		
		event_target:aclla_rescue_attempt_snitch = {
			clr_character_flag = aclla_rescue_attempt_snitch
		}
		
		set_character_flag = aclla_no_more_guards
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = cruel
			}
			modifier = {
				factor = 0
				NOT = {
					trait = kind
				}
				event_target:aclla_rescue_attempt_snitch = {
					any_rival = {
						character = ROOT
					}
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_ACLLA_50 # And now you die!
		
		prestige = 25
		piety = -10
		
		character_event = { id = aclla.64 days = 1 }
		
		set_character_flag = aclla_no_more_guards
		
		event_target:aclla_rescue_attempt_snitch = {
			death = {
				death_reason = death_murder_unknown
				killer = ROOT
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				NOR = {
					trait = cruel
					event_target:aclla_rescue_attempt_snitch = {
						any_rival = {
							character = ROOT
						}
					}
				}
			}
			modifier = {
				factor = 0
				trait = cruel
				event_target:aclla_rescue_attempt_snitch = {
					OR = {
						any_friend = {
							character = ROOT
						}
						any_lover = {
							character = ROOT
						}
					}
				}
			}
		}
	}
}

# You fought the guards - wounded
character_event = {
	id = aclla.51
	desc = EVTDESC_ACLLA_51
	picture = GFX_evt_jailbreak
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_50 # Get lost!
		
		prestige = 10
		add_trait = wounded
		piety = 5
		
		character_event = { id = aclla.64 days = 1 }
		
		event_target:aclla_rescue_attempt_snitch = {
			clr_character_flag = aclla_rescue_attempt_snitch
		}
		
		set_character_flag = aclla_no_more_guards
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = cruel
			}
			modifier = {
				factor = 0
				NOT = {
					trait = kind
				}
				event_target:aclla_rescue_attempt_snitch = {
					any_rival = {
						character = ROOT
					}
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_ACLLA_51 # And now you die!
		
		prestige = 10
		piety = -10
		add_trait = wounded
		
		character_event = { id = aclla.64 days = 1 }
		
		event_target:aclla_rescue_attempt_snitch = {
			death = {
				death_reason = death_murder_unknown
				killer = ROOT
			}
		}
		
		set_character_flag = aclla_no_more_guards
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				NOR = {
					trait = cruel
					event_target:aclla_rescue_attempt_snitch = {
						any_rival = {
							character = ROOT
						}
					}
				}
			}
			modifier = {
				factor = 0
				trait = cruel
				event_target:aclla_rescue_attempt_snitch = {
					OR = {
						any_friend = {
							character = ROOT
						}
						any_lover = {
							character = ROOT
						}
					}
				}
			}
		}
	}
}

# You fought the guards - maimed
character_event = {
	id = aclla.52
	desc = EVTDESC_ACLLA_52
	picture = GFX_evt_jailbreak
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_50 # Get lost!
		
		add_maimed_trait_effect = yes
		piety = 5
		
		character_event = { id = aclla.64 days = 1 }
		
		event_target:aclla_rescue_attempt_snitch = {
			clr_character_flag = aclla_rescue_attempt_snitch
		}
		
		set_character_flag = aclla_no_more_guards
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = cruel
			}
			modifier = {
				factor = 0
				NOT = {
					trait = kind
				}
				event_target:aclla_rescue_attempt_snitch = {
					any_rival = {
						character = ROOT
					}
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_ACLLA_52 # And now you die!
		
		piety = -10
		add_maimed_trait_effect = yes
		
		character_event = { id = aclla.64 days = 1 }
		
		event_target:aclla_rescue_attempt_snitch = {
			death = {
				death_reason = death_murder_unknown
				killer = ROOT
			}
		}
		
		set_character_flag = aclla_no_more_guards
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				NOR = {
					trait = cruel
					event_target:aclla_rescue_attempt_snitch = {
						any_rival = {
							character = ROOT
						}
					}
				}
			}
			modifier = {
				factor = 0
				trait = cruel
				event_target:aclla_rescue_attempt_snitch = {
					OR = {
						any_friend = {
							character = ROOT
						}
						any_lover = {
							character = ROOT
						}
					}
				}
			}
		}
	}
}

# You fought the guards - captured
character_event = {
	id = aclla.53
	desc = EVTDESC_ACLLA_53
	picture = GFX_evt_into_the_dungeon
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_53 # This is bad...
		
		prestige = -25
		
		d_acllahuasi = {
			holder_scope = {
				ROOT = {
					imprison = PREV
				}
				if = {
					limit = {
						has_dlc = "Jade Dragon"
					}
					if = {
						limit = {
							ROOT = {
								is_chinese_emperor_trigger = yes
							}
						}
						detract_grace_super_huge_effect = yes
					}
					else_if = {
						limit = {
							ROOT = {
								any_close_relative = {
									dynasty = PREV
									is_chinese_emperor_trigger = yes
								}
							}
						}
						detract_grace_massive_effect = yes
					}
					else_if = {
						limit = {
							ROOT = {
								any_dynasty_member = {
									is_chinese_emperor_trigger = yes
								}
							}
						}
						detract_grace_major_effect = yes
					}
				}
				character_event = { id = aclla.38 days = 1 }
			}
		}
		
		event_target:aclla_rescue_attempt_snitch = {
			clr_character_flag = aclla_rescue_attempt_snitch
		}
		
		event_target:aclla_to_rescue = {
			clr_character_flag = aclla_being_rescued
		}
	}
}

# You fought the guards - killed
character_event = {
	id = aclla.54
	desc = EVTDESC_ACLLA_54
	picture = GFX_evt_bloody_man
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_54 # This cannot be!
		
		prestige = -25
		
		death = {
			death_reason = death_battle
		}
		
		event_target:aclla_rescue_attempt_snitch = {
			clr_character_flag = aclla_rescue_attempt_snitch
		}
		
		event_target:aclla_to_rescue = {
			clr_character_flag = aclla_being_rescued
		}
	}
}

# Adult aclla is quite pretty - try to tumble?
character_event = {
	id = aclla.55
	desc = EVTDESC_ACLLA_55
	picture = GFX_evt_shadow
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_55 # I have time for a detour...
		
		piety = -10
		
		random_list = {
			33 = {
				modifier = {
					factor = 0
					event_target:aclla_rescue_attempt_lover = {
						any_rival = {
							character = ROOT
						}
					}
				}
				modifier = {
					factor = 0
					event_target:aclla_rescue_attempt_lover = {
						OR = {
							trait = celibate
							trait = chaste
						}
					}
				}
				modifier = {
					factor = 0
					is_unattractive_trigger = yes
				}
				modifier = {
					factor = 10
					OR = {
						trait = seducer
						trait = seductress
					}
				}
				modifier = {
					factor = 0
					event_target:aclla_rescue_attempt_lover = {
						OR = {
							true_religion = inca_religion
							true_religion = inca_religion_reformed
						}
						trait = zealous
					}
				}
				character_event = { id = aclla.56 days = 1 }
			}
			34 = {
				modifier = {
					factor = 0
					event_target:aclla_rescue_attempt_lover = {
						any_rival = {
							character = ROOT
						}
					}
				}
				modifier = {
					factor = 0
					event_target:aclla_rescue_attempt_lover = {
						any_lover = {
							character = ROOT
						}
					}
				}
				character_event = { id = aclla.60 days = 1 }
			}
			33 = {
				modifier = {
					factor = 0
					event_target:aclla_rescue_attempt_lover = {
						OR = {
							any_friend = {
								character = ROOT
							}
							any_lover = {
								character = ROOT
							}
						}
					}
				}
				modifier = {
					factor = 0
					event_target:aclla_rescue_attempt_lover = {
						trait = lustful
					}
				}
				modifier = {
					factor = 0
					is_attractive_trigger = yes
				}
				modifier = {
					factor = 0
					OR = {
						trait = seducer
						trait = seductress
					}
				}
				modifier = {
					factor = 10
					event_target:aclla_rescue_attempt_lover = {
						OR = {
							true_religion = inca_religion
							true_religion = inca_religion_reformed
						}
						trait = zealous
					}
				}
				# Crit fail
				event_target:aclla_rescue_attempt_lover = {
					clr_character_flag = aclla_rescue_attempt_lover
					save_event_target_as = aclla_rescue_attempt_snitch
					set_character_flag = aclla_rescue_attempt_snitch
					if = {
						limit = {
							has_character_flag = aclla_no_more_guards
						}
						character_event = { id = aclla.61 } # No guards!
					}
					else = {
						character_event = { id = aclla.62 } # Guards!
					}
				}
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				OR = {
					trait = chaste
					trait = celibate
				}
			}
			modifier = {
				factor = 0.1
				trait = content
			}
			modifier = {
				factor = 0.1
				event_target:aclla_rescue_attempt_lover = {
					is_unattractive_trigger = yes
				}
			}
			modifier = {
				factor = 0
				OR = {
					true_religion = inca_religion
					true_religion = inca_religion_reformed
				}
				trait = zealous
				NOT = {
					trait = lustful
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_ACLLA_55 # I must focus!
		
		piety = 10
		
		character_event = { id = aclla.64 days = 1 }
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = lustful
			}
			modifier = {
				factor = 0.1
				trait = ambitious
			}
			modifier = {
				factor = 0.1
				event_target:aclla_rescue_attempt_lover = {
					is_attractive_trigger = yes
				}
			}
		}
	}
}

# Tumbling attempt succeeded - take her with you (and make her a lover) or leave?
character_event = {
	id = aclla.56
	desc = EVTDESC_ACLLA_56
	picture = GFX_evt_lovers
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_56 # Come with me if you want to leave!
		
		event_target:aclla_rescue_attempt_lover = {
			piety = -10
			save_event_target_as = sex_partner
		}
		unprotected_sex_effect_event_target = yes
		
		add_lover = event_target:aclla_rescue_attempt_lover
		
		character_event = { id = aclla.64 days = 1 }
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = cruel
			}
		}
	}
	
	option = {
		name = EVTOPTB_ACLLA_56 # Bye!
		
		if = {
			limit = {
				trait = kind
			}
			remove_trait = kind
		}
		
		event_target:aclla_rescue_attempt_lover = {
			piety = -10
			save_event_target_as = sex_partner
		}
		unprotected_sex_effect_event_target = yes
		
		event_target:aclla_rescue_attempt_lover = {
			character_event = { id = aclla.57 }
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = kind
			}
		}
	}
	
	option = {
		name = EVTOPTC_ACLLA_56 # I can't afford a loose end...
		
		piety = -25
		
		add_trait = cruel
		
		character_event = { id = aclla.64 days = 1 }
		
		event_target:aclla_rescue_attempt_lover = {
			piety = -10
			save_event_target_as = sex_partner
		}
		unprotected_sex_effect_event_target = yes
		
		event_target:aclla_rescue_attempt_lover = {
			death = {
				death_reason = death_murder_unknown
				killer = ROOT
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				NOT = {
					trait = cruel
				}
			}
		}
	}
}

# Left her behind - does she call the guards?
character_event = {
	id = aclla.57
	desc = EVTDESC_ACLLA_57
	picture = GFX_evt_lovers
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_57 # It's probably for the best...
		
		prestige = -10
		
		FROM = {
			character_event = { id = aclla.64 days = 1 }
		}
		
		clr_character_flag = aclla_rescue_attempt_lover
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = proud
				trait = cruel
				trait = wroth
			}
			modifier = {
				factor = 0.1
				trait = proud
			}
			modifier = {
				factor = 0.1
				trait = cruel
			}
			modifier = {
				factor = 0.1
				trait = wroth
			}
		}
	}
	
	option = {
		name = EVTOPTB_ACLLA_57 # Hell hath no fury...
		
		save_event_target_as = aclla_rescue_attempt_snitch
		clr_character_flag = aclla_rescue_attempt_lover
		set_character_flag = aclla_rescue_attempt_snitch
		
		if = {
			limit = {
				has_character_flag = aclla_no_more_guards
			}
			character_event = { id = aclla.58 } # No guards!
		}
		else = {
			character_event = { id = aclla.59 } # Guards!
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = humble
				trait = kind
				trait = content
			}
			modifier = {
				factor = 0.1
				trait = humble
			}
			modifier = {
				factor = 0.1
				trait = kind
			}
			modifier = {
				factor = 0.1
				trait = content
			}
		}
	}
}

# No guards arrive - how deal with the snitch?
character_event = {
	id = aclla.58
	desc = EVTDESC_ACLLA_58
	picture = GFX_evt_jailbreak
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_58 # Get lost!
		
		piety = 5
		
		character_event = { id = aclla.64 days = 1 }
		
		event_target:aclla_rescue_attempt_snitch = {
			clr_character_flag = aclla_rescue_attempt_snitch
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = cruel
			}
			modifier = {
				factor = 0
				NOT = {
					trait = kind
				}
				event_target:aclla_rescue_attempt_snitch = {
					any_rival = {
						character = ROOT
					}
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_ACLLA_58 # And now you die!
		
		piety = -10
		
		character_event = { id = aclla.64 days = 1 }
		
		event_target:aclla_rescue_attempt_snitch = {
			death = {
				death_reason = death_murder_unknown
				killer = ROOT
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				NOR = {
					trait = cruel
					event_target:aclla_rescue_attempt_snitch = {
						any_rival = {
							character = ROOT
						}
					}
				}
			}
			modifier = {
				factor = 0
				trait = cruel
				event_target:aclla_rescue_attempt_snitch = {
					OR = {
						any_friend = {
							character = ROOT
						}
						any_lover = {
							character = ROOT
						}
					}
				}
			}
		}
	}
}

# Woman scorned calls guards
character_event = {
	id = aclla.59
	desc = EVTDESC_ACLLA_59
	picture = GFX_evt_jailbreak
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_59 # I guess it's time to fight...
		
		random_list = { # No noise penalty
			20 = {
				modifier = {
					factor = 0
					NOT = {
						combat_rating = 25
					}
				}
				modifier = {
					factor = 2
					combat_rating = 75
				}
				character_event = { id = aclla.50 days = 1 } # Clean victory
			}
			20 = {
				modifier = {
					factor = 0
					combat_rating = 100
				}
				character_event = { id = aclla.51 days = 1 } # Wounded
			}
			20 = {
				modifier = {
					factor = 0
					combat_rating = 75
				}
				character_event = { id = aclla.52 days = 1 } # Maimed
			}
			20 = {
				modifier = {
					factor = 0
					combat_rating = 75
				}
				modifier = {
					factor = 0.5
					combat_rating = 50
				}
				character_event = { id = aclla.53 days = 1 } # Captured
			}
			20 = {
				modifier = {
					factor = 0
					combat_rating = 50
				}
				character_event = { id = aclla.54 days = 1 } # Killed
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = craven
			}
		}
	}
	
	option = {
		name = EVTOPTB_ACLLA_59 # I will come quietly!
		
		prestige = -25
		
		d_acllahuasi = {
			holder_scope = {
				ROOT = {
					imprison = PREV
				}
				if = {
					limit = {
						has_dlc = "Jade Dragon"
					}
					if = {
						limit = {
							ROOT = {
								is_chinese_emperor_trigger = yes
							}
						}
						detract_grace_super_huge_effect = yes
					}
					else_if = {
						limit = {
							ROOT = {
								any_close_relative = {
									dynasty = PREV
									is_chinese_emperor_trigger = yes
								}
							}
						}
						detract_grace_massive_effect = yes
					}
					else_if = {
						limit = {
							ROOT = {
								any_dynasty_member = {
									is_chinese_emperor_trigger = yes
								}
							}
						}
						detract_grace_major_effect = yes
					}
				}
				character_event = { id = aclla.38 days = 1 }
			}
		}
		
		event_target:aclla_to_rescue = {
			clr_character_flag = aclla_being_rescued
		}
		event_target:aclla_rescue_attempt_snitch = {
			clr_character_flag = aclla_rescue_attempt_snitch
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = brave
			}
		}
	}
}

# Tumbling attempt failed - she promises to stay silent
character_event = {
	id = aclla.60
	desc = EVTDESC_ACLLA_60
	picture = GFX_evt_shadow
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_60 # Bye!
		
		character_event = { id = aclla.64 days = 1 }
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = paranoid
			}
			modifier = {
				factor = 0
				trait = cruel
			}
		}
	}
	
	option = {
		name = EVTOPTB_ACLLA_60 # I can't afford a loose end...
		
		piety = -25
		
		character_event = { id = aclla.64 days = 1 }
		
		event_target:aclla_rescue_attempt_lover = {
			death = {
				death_reason = death_murder_unknown
				killer = ROOT
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				NOR = {
					trait = cruel
					trait = paranoid
				}
			}
		}
	}
}

# Tumbling attempt crit failed - guards called but don't arrive
character_event = {
	id = aclla.61
	desc = EVTDESC_ACLLA_61
	picture = GFX_evt_shadow
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_58 # Get lost!
		
		piety = 5
		
		character_event = { id = aclla.64 days = 1 }
		
		event_target:aclla_rescue_attempt_snitch = {
			clr_character_flag = aclla_rescue_attempt_snitch
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = cruel
			}
			modifier = {
				factor = 0
				NOT = {
					trait = kind
				}
				event_target:aclla_rescue_attempt_snitch = {
					any_rival = {
						character = ROOT
					}
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_ACLLA_61 # And now you die!
		
		piety = -10
		
		character_event = { id = aclla.64 days = 1 }
		
		event_target:aclla_rescue_attempt_snitch = {
			death = {
				death_reason = death_murder_unknown
				killer = ROOT
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				NOR = {
					trait = cruel
					event_target:aclla_rescue_attempt_snitch = {
						any_rival = {
							character = ROOT
						}
					}
				}
			}
			modifier = {
				factor = 0
				trait = cruel
				event_target:aclla_rescue_attempt_snitch = {
					OR = {
						any_friend = {
							character = ROOT
						}
						any_lover = {
							character = ROOT
						}
					}
				}
			}
		}
	}
}

# Tumbling attempt crit failed - guards called
character_event = {
	id = aclla.62
	desc = EVTDESC_ACLLA_62
	picture = GFX_evt_jailbreak
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_62 # I guess it's time to fight...
		
		random_list = { # No noise penalty
			20 = {
				modifier = {
					factor = 0
					NOT = {
						combat_rating = 25
					}
				}
				modifier = {
					factor = 2
					combat_rating = 75
				}
				character_event = { id = aclla.50 days = 1 } # Clean victory
			}
			20 = {
				modifier = {
					factor = 0
					combat_rating = 100
				}
				character_event = { id = aclla.51 days = 1 } # Wounded
			}
			20 = {
				modifier = {
					factor = 0
					combat_rating = 75
				}
				character_event = { id = aclla.52 days = 1 } # Maimed
			}
			20 = {
				modifier = {
					factor = 0
					combat_rating = 75
				}
				modifier = {
					factor = 0.5
					combat_rating = 50
				}
				character_event = { id = aclla.53 days = 1 } # Captured
			}
			20 = {
				modifier = {
					factor = 0
					combat_rating = 50
				}
				character_event = { id = aclla.54 days = 1 } # Killed
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = craven
			}
		}
	}
	
	option = {
		name = EVTOPTB_ACLLA_62 # I will come quietly!
		
		prestige = -25
		
		d_acllahuasi = {
			holder_scope = {
				ROOT = {
					imprison = PREV
				}
				if = {
					limit = {
						has_dlc = "Jade Dragon"
					}
					if = {
						limit = {
							ROOT = {
								is_chinese_emperor_trigger = yes
							}
						}
						detract_grace_super_huge_effect = yes
					}
					else_if = {
						limit = {
							ROOT = {
								any_close_relative = {
									dynasty = PREV
									is_chinese_emperor_trigger = yes
								}
							}
						}
						detract_grace_massive_effect = yes
					}
					else_if = {
						limit = {
							ROOT = {
								any_dynasty_member = {
									is_chinese_emperor_trigger = yes
								}
							}
						}
						detract_grace_major_effect = yes
					}
				}
				character_event = { id = aclla.38 days = 1 }
			}
		}
		
		event_target:aclla_to_rescue = {
			clr_character_flag = aclla_being_rescued
		}
		event_target:aclla_rescue_attempt_snitch = {
			clr_character_flag = aclla_rescue_attempt_snitch
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = brave
			}
		}
	}
}

# Zealous Inca - second thoughts
character_event = {
	id = aclla.63
	desc = EVTDESC_ACLLA_63
	picture = GFX_evt_jailbreak
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_63 # I came here for a reason!
		
		piety = -25
		
		if = {
			limit = {
				trait = zealous
			}
			remove_trait = zealous
		}
		
		character_event = { id = aclla.64 days = 1 }
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = zealous
			}
		}
	}
	
	option = {
		name = EVTOPTB_ACLLA_63 # I guess I should leave...
		
		piety = 25
		
		if = {
			limit = {
				trait = cynical
			}
			remove_trait = cynical
		}
		
		character_event = { id = aclla.30 days = 30 random = 30 } # Returned home
		
		event_target:aclla_to_rescue = {
			clr_character_flag = aclla_being_rescued
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = cynical
			}
		}
	}
}

# You finally reach your kinswoman
character_event = {
	id = aclla.64
	desc = EVTDESC_ACLLA_64
	picture = GFX_evt_shadow
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_64 # Come with me if you want to leave!
		
		random_list = {
			50 = {
				modifier = {
					factor = 0
					event_target:aclla_to_rescue = {
						OR = {
							true_religion = inca_religion
							true_religion = inca_religion_reformed
						}
						NOT = {
							trait = cynical
						}
						OR = {
							NOT = {
								has_character_flag = aclla_being_sacrificed
							}
							trait = zealous
						}
					}
				}
				modifier = {
					factor = 0.1
					any_rival = {
						character = event_target:aclla_to_rescue
					}
				}
				# She's willing to leave
				character_event = { id = aclla.65 }
			}
			40 = {
				modifier = {
					factor = 0
					event_target:aclla_to_rescue = {
						NOR = {
							true_religion = inca_religion
							true_religion = inca_religion_reformed
						}
						trait = zealous
					}
				}
				modifier = {
					factor = 0
					event_target:aclla_to_rescue = {
						OR = {
							true_religion = inca_religion
							true_religion = inca_religion_reformed
						}
						trait = zealous
					}
				}
				modifier = {
					factor = 0.1
					any_rival = {
						character = event_target:aclla_to_rescue
					}
				}
				modifier = {
					factor = 0.1
					any_friend = {
						character = event_target:aclla_to_rescue
					}
				}
				modifier = {
					factor = 0.1
					any_lover = { # Extremely unlikely to be relevant...
						character = event_target:aclla_to_rescue
					}
				}
				modifier = {
					factor = 0
					event_target:aclla_to_rescue = {
						has_character_flag = aclla_being_sacrificed
						NAND = {
							OR = {
								true_religion = inca_religion
								true_religion = inca_religion_reformed
							}
							trait = zealous
						}
					}
				}
				# She's unwilling to leave
				character_event = { id = aclla.66 }
			}
			10 = {
				modifier = {
					factor = 0
					event_target:aclla_to_rescue = {
						NOR = {
							true_religion = inca_religion
							true_religion = inca_religion_reformed
						}
					}
				}
				modifier = {
					factor = 0.1
					any_friend = {
						character = event_target:aclla_to_rescue
					}
				}
				modifier = {
					factor = 0.1
					any_lover = { # Extremely unlikely to be relevant...
						character = event_target:aclla_to_rescue
					}
				}
				modifier = {
					factor = 0
					event_target:aclla_to_rescue = {
						has_character_flag = aclla_being_sacrificed
						NAND = {
							OR = {
								true_religion = inca_religion
								true_religion = inca_religion_reformed
							}
							trait = zealous
						}
					}
				}
				# She's extremely unwilling to leave
				event_target:aclla_to_rescue = {
					character_event = { id = aclla.68 }
				}
			}
		}
	}
}

# Your kinswoman is willing - time to leave
character_event = {
	id = aclla.65
	desc = EVTDESC_ACLLA_65
	picture = GFX_evt_jailbreak
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_65 # We out!
		
		if = {
			limit = {
				event_target:aclla_rescue_attempt_lover = {
					any_lover = {
						character = ROOT
					}
					host = {
						has_landed_title = d_acllahuasi
					}
				}
			}
			event_target:aclla_rescue_attempt_lover = {
				move_character = ROOT
				add_trait = travelling
				set_character_flag = do_not_disturb
				set_character_flag = ex_aclla # Rescued
				clr_character_flag = no_court_invites
				remove_trait = aclla
				character_event = { id = aclla.84 days = 61 } # Safety flag cleanup
				ROOT = {
					set_character_flag = aclla_lover_is_coming_along
				}
			}
		}
		event_target:aclla_to_rescue = {
			move_character = ROOT
			add_trait = travelling
			set_character_flag = do_not_disturb
			set_character_flag = ex_aclla # Rescued
			clr_character_flag = no_court_invites
			remove_trait = aclla
			clr_character_flag = aclla_being_sacrificed
			clr_character_flag = aclla_sacrifice_in_progress
			remove_character_modifier = qhapaq_hucha
			character_event = { id = aclla.84 days = 61 } # Safety flag cleanup
		}
		ROOT = {
			set_character_flag = aclla_is_willing
		}
		
		character_event = { id = aclla.76 days = 1 } # Escape
	}
}

# Your kinswoman is unwilling - drag her along or leave her?
character_event = {
	id = aclla.66
	desc = EVTDESC_ACLLA_66
	picture = GFX_evt_jailbreak
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_66 # Fine!
		
		if = {
			limit = {
				event_target:aclla_rescue_attempt_lover = {
					any_lover = {
						character = ROOT
					}
					host = {
						has_landed_title = d_acllahuasi
					}
				}
			}
			event_target:aclla_rescue_attempt_lover = {
				move_character = ROOT
				add_trait = travelling
				set_character_flag = do_not_disturb
				set_character_flag = ex_aclla # Rescued
				clr_character_flag = no_court_invites
				remove_trait = aclla
				character_event = { id = aclla.84 days = 61 } # Safety flag cleanup
				ROOT = {
					set_character_flag = aclla_lover_is_coming_along
				}
			}
		}
		
		character_event = { id = aclla.76 days = 1 } # Escape
		
		event_target:aclla_to_rescue = {
			clr_character_flag = aclla_being_rescued
			remove_opinion = {
				who = ROOT
				modifier = opinion_aclla_rescuer
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				NOR = {
					religion = inca_religion
					religion = inca_religion_reformed
				}
				trait = zealous
			}
			modifier = {
				factor = 0.1
				NOR = {
					religion = inca_religion
					religion = inca_religion_reformed
				}
			}
			modifier = {
				factor = 0.1
				trait = stubborn
			}
		}
	}
	
	option = {
		name = EVTOPTB_ACLLA_66 # It wasn't a request!
		
		event_target:aclla_to_rescue = {
			character_event = { id = aclla.67 days = 1 } # Call guards?
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				OR = {
					religion = inca_religion
					religion = inca_religion_reformed
				}
				trait = zealous
			}
			modifier = {
				factor = 0.1
				OR = {
					religion = inca_religion
					religion = inca_religion_reformed
				}
			}
			modifier = {
				factor = 0.1
				trait = kind
			}
		}
	}
}

# If dragged along, do you want to call the guards?
character_event = {
	id = aclla.67
	desc = EVTDESC_ACLLA_67
	picture = GFX_evt_jailbreak
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_67 # Fine!
		
		if = {
			limit = {
				event_target:aclla_rescue_attempt_lover = {
					any_lover = {
						character = FROM
					}
					host = {
						has_landed_title = d_acllahuasi
					}
				}
			}
			event_target:aclla_rescue_attempt_lover = {
				move_character = FROM
				add_trait = travelling
				set_character_flag = do_not_disturb
				set_character_flag = ex_aclla # Rescued
				clr_character_flag = no_court_invites
				remove_trait = aclla
				character_event = { id = aclla.84 days = 61 } # Safety flag cleanup
				FROM = {
					set_character_flag = aclla_lover_is_coming_along
				}
			}
			move_character = FROM
			add_trait = travelling
			set_character_flag = do_not_disturb
			set_character_flag = ex_aclla # Rescued
			clr_character_flag = no_court_invites
			clr_character_flag = aclla_being_sacrificed
			clr_character_flag = aclla_sacrifice_in_progress
			remove_character_modifier = qhapaq_hucha
			remove_trait = aclla
			character_event = { id = aclla.84 days = 61 } # Safety flag cleanup
		}
		FROM = {
			set_character_flag = aclla_is_unwilling
			character_event = { id = aclla.76 days = 1 } # Escape
		}
		
		event_target:aclla_to_rescue = {
			clr_character_flag = aclla_being_rescued
			remove_opinion = {
				who = FROM
				modifier = opinion_aclla_rescuer
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				OR = {
					religion = inca_religion
					religion = inca_religion_reformed
				}
				trait = zealous
			}
			modifier = {
				factor = 0.1
				OR = {
					religion = inca_religion
					religion = inca_religion_reformed
				}
			}
			modifier = {
				factor = 0.1
				trait = stubborn
			}
		}
	}
	
	option = {
		name = EVTOPTB_ACLLA_67 # Guards!
		
		if = {
			limit = {
				FROM = {
					has_character_flag = aclla_no_more_guards
				}
			}
			FROM = {
				character_event = { id = aclla.69 days = 1 } # No guards
			}
		}
		else = {
			FROM = {
				character_event = { id = aclla.70 days = 1 } # Guards
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				NOR = {
					religion = inca_religion
					religion = inca_religion_reformed
				}
				trait = zealous
			}
			modifier = {
				factor = 0.1
				OR = {
					religion = inca_religion
					religion = inca_religion_reformed
				}
			}
		}
	}
}

# Your kinswoman is extremely unwilling - calls guards
character_event = {
	id = aclla.68
	desc = EVTDESC_ACLLA_68
	picture = GFX_evt_jailbreak
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_68 # Guards!
		
		add_rival = FROM
		
		if = {
			limit = {
				FROM = {
					has_character_flag = aclla_no_more_guards
				}
			}
			FROM = {
				character_event = { id = aclla.69 days = 1 } # No guards
			}
		}
		else = {
			FROM = {
				character_event = { id = aclla.70 days = 1 } # Guards
			}
		}
	}
}

# No guards arrive - how deal with kinswoman?
character_event = {
	id = aclla.69
	desc = EVTDESC_ACLLA_69
	picture = GFX_evt_jailbreak
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_69 # Shut up!
		
		if = {
			limit = {
				event_target:aclla_rescue_attempt_lover = {
					any_lover = {
						character = ROOT
					}
					host = {
						has_landed_title = d_acllahuasi
					}
				}
			}
			event_target:aclla_rescue_attempt_lover = {
				move_character = ROOT
				add_trait = travelling
				set_character_flag = do_not_disturb
				set_character_flag = ex_aclla # Rescued
				clr_character_flag = no_court_invites
				remove_trait = aclla
				character_event = { id = aclla.84 days = 61 } # Safety flag cleanup
				ROOT = {
					set_character_flag = aclla_lover_is_coming_along
				}
			}
		}
		event_target:aclla_to_rescue = {
			move_character = ROOT
			add_trait = travelling
			set_character_flag = do_not_disturb
			set_character_flag = ex_aclla # Rescued
			clr_character_flag = no_court_invites
			clr_character_flag = aclla_being_sacrificed
			clr_character_flag = aclla_sacrifice_in_progress
			remove_character_modifier = qhapaq_hucha
			remove_trait = aclla
			character_event = { id = aclla.84 days = 61 } # Safety flag cleanup
		}
		ROOT = {
			set_character_flag = aclla_is_unwilling
		}
		
		character_event = { id = aclla.76 days = 1 } # Escape
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = cruel
			}
			modifier = {
				factor = 0
				NOT = {
					trait = kind
				}
				event_target:aclla_to_rescue = {
					any_rival = {
						character = ROOT
					}
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_ACLLA_69 # You want to stay? STAY FOREVER!
		
		piety = -10
		
		if = {
			limit = {
				event_target:aclla_rescue_attempt_lover = {
					any_lover = {
						character = ROOT
					}
					host = {
						has_landed_title = d_acllahuasi
					}
				}
			}
			event_target:aclla_rescue_attempt_lover = {
				move_character = ROOT
				add_trait = travelling
				set_character_flag = do_not_disturb
				set_character_flag = ex_aclla # Rescued
				clr_character_flag = no_court_invites
				remove_trait = aclla
				character_event = { id = aclla.84 days = 61 } # Safety flag cleanup
				ROOT = {
					set_character_flag = aclla_lover_is_coming_along
				}
			}
		}
		
		character_event = { id = aclla.76 days = 1 } # Escape
		
		event_target:aclla_to_rescue = {
			death = {
				death_reason = death_murder_unknown
				killer = ROOT
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				NOR = {
					trait = cruel
					event_target:aclla_to_rescue = {
						any_rival = {
							character = ROOT
						}
					}
				}
			}
			modifier = {
				factor = 0
				trait = cruel
				event_target:aclla_to_rescue = {
					OR = {
						any_friend = {
							character = ROOT
						}
						any_lover = {
							character = ROOT
						}
					}
				}
			}
		}
	}
}

# Guards - time to fight!
character_event = {
	id = aclla.70
	desc = EVTDESC_ACLLA_70
	picture = GFX_evt_jailbreak
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_70 # I guess it's time to fight...
		
		random_list = { # No noise penalty
			20 = {
				modifier = {
					factor = 0
					NOT = {
						combat_rating = 25
					}
				}
				modifier = {
					factor = 2
					combat_rating = 75
				}
				character_event = { id = aclla.71 days = 1 } # Clean victory
			}
			20 = {
				modifier = {
					factor = 0
					combat_rating = 100
				}
				character_event = { id = aclla.72 days = 1 } # Wounded
			}
			20 = {
				modifier = {
					factor = 0
					combat_rating = 75
				}
				character_event = { id = aclla.73 days = 1 } # Maimed
			}
			20 = {
				modifier = {
					factor = 0
					combat_rating = 75
				}
				modifier = {
					factor = 0.5
					combat_rating = 50
				}
				character_event = { id = aclla.74 days = 1 } # Captured
			}
			20 = {
				modifier = {
					factor = 0
					combat_rating = 50
				}
				character_event = { id = aclla.75 days = 1 } # Killed
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = craven
			}
		}
	}
	
	option = {
		name = EVTOPTB_ACLLA_70 # I will come quietly!
		
		prestige = -25
		
		d_acllahuasi = {
			holder_scope = {
				ROOT = {
					imprison = PREV
				}
				if = {
					limit = {
						has_dlc = "Jade Dragon"
					}
					if = {
						limit = {
							ROOT = {
								is_chinese_emperor_trigger = yes
							}
						}
						detract_grace_super_huge_effect = yes
					}
					else_if = {
						limit = {
							ROOT = {
								any_close_relative = {
									dynasty = PREV
									is_chinese_emperor_trigger = yes
								}
							}
						}
						detract_grace_massive_effect = yes
					}
					else_if = {
						limit = {
							ROOT = {
								any_dynasty_member = {
									is_chinese_emperor_trigger = yes
								}
							}
						}
						detract_grace_major_effect = yes
					}
				}
				character_event = { id = aclla.38 days = 1 }
			}
		}
		
		event_target:aclla_to_rescue = {
			clr_character_flag = aclla_being_rescued
		}
		event_target:aclla_rescue_attempt_lover = {
			clr_character_flag = aclla_rescue_attempt_lover
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = brave
			}
		}
	}
}

# You fought the guards - won - how deal with kinswoman?
character_event = {
	id = aclla.71
	desc = EVTDESC_ACLLA_71
	picture = GFX_evt_jailbreak
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_71 # You ARE coming with me!
		
		if = {
			limit = {
				event_target:aclla_rescue_attempt_lover = {
					any_lover = {
						character = ROOT
					}
					host = {
						has_landed_title = d_acllahuasi
					}
				}
			}
			event_target:aclla_rescue_attempt_lover = {
				move_character = ROOT
				add_trait = travelling
				set_character_flag = do_not_disturb
				set_character_flag = ex_aclla # Rescued
				clr_character_flag = no_court_invites
				remove_trait = aclla
				character_event = { id = aclla.84 days = 61 } # Safety flag cleanup
				ROOT = {
					set_character_flag = aclla_lover_is_coming_along
				}
			}
		}
		event_target:aclla_to_rescue = {
			move_character = ROOT
			add_trait = travelling
			set_character_flag = do_not_disturb
			set_character_flag = ex_aclla # Rescued
			clr_character_flag = no_court_invites
			clr_character_flag = aclla_being_sacrificed
			clr_character_flag = aclla_sacrifice_in_progress
			remove_character_modifier = qhapaq_hucha
			remove_trait = aclla
			character_event = { id = aclla.84 days = 61 } # Safety flag cleanup
		}
		ROOT = {
			set_character_flag = aclla_is_unwilling
		}
		
		character_event = { id = aclla.76 days = 1 } # Escape
		
		prestige = 25
		piety = 5
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = cruel
			}
			modifier = {
				factor = 0
				NOT = {
					trait = kind
				}
				event_target:aclla_to_rescue = {
					any_rival = {
						character = ROOT
					}
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_ACLLA_71 # And now you die!
		
		prestige = 25
		piety = -10
		
		event_target:aclla_to_rescue = {
			death = {
				death_reason = death_murder_unknown
				killer = ROOT
			}
		}
		
		if = {
			limit = {
				event_target:aclla_rescue_attempt_lover = {
					any_lover = {
						character = ROOT
					}
					host = {
						has_landed_title = d_acllahuasi
					}
				}
			}
			event_target:aclla_rescue_attempt_lover = {
				move_character = ROOT
				add_trait = travelling
				set_character_flag = do_not_disturb
				set_character_flag = ex_aclla # Rescued
				clr_character_flag = no_court_invites
				remove_trait = aclla
				character_event = { id = aclla.84 days = 61 } # Safety flag cleanup
				ROOT = {
					set_character_flag = aclla_lover_is_coming_along
				}
			}
		}
		
		character_event = { id = aclla.76 days = 1 } # Escape
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				NOR = {
					trait = cruel
					event_target:aclla_to_rescue = {
						any_rival = {
							character = ROOT
						}
					}
				}
			}
			modifier = {
				factor = 0
				trait = cruel
				event_target:aclla_to_rescue = {
					OR = {
						any_friend = {
							character = ROOT
						}
						any_lover = {
							character = ROOT
						}
					}
				}
			}
		}
	}
}

# You fought the guards - wounded - how deal with kinswoman?
character_event = {
	id = aclla.72
	desc = EVTDESC_ACLLA_72
	picture = GFX_evt_jailbreak
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_72 # You ARE coming with me!
		
		if = {
			limit = {
				event_target:aclla_rescue_attempt_lover = {
					any_lover = {
						character = ROOT
					}
					host = {
						has_landed_title = d_acllahuasi
					}
				}
			}
			event_target:aclla_rescue_attempt_lover = {
				move_character = ROOT
				add_trait = travelling
				set_character_flag = do_not_disturb
				set_character_flag = ex_aclla # Rescued
				clr_character_flag = no_court_invites
				remove_trait = aclla
				character_event = { id = aclla.84 days = 61 } # Safety flag cleanup
				ROOT = {
					set_character_flag = aclla_lover_is_coming_along
				}
			}
		}
		event_target:aclla_to_rescue = {
			move_character = ROOT
			add_trait = travelling
			set_character_flag = do_not_disturb
			set_character_flag = ex_aclla # Rescued
			clr_character_flag = no_court_invites
			clr_character_flag = aclla_being_sacrificed
			clr_character_flag = aclla_sacrifice_in_progress
			remove_character_modifier = qhapaq_hucha
			remove_trait = aclla
			character_event = { id = aclla.84 days = 61 } # Safety flag cleanup
			ROOT = {
				set_character_flag = aclla_is_unwilling
			}
		}
		
		character_event = { id = aclla.76 days = 1 } # Escape
		
		prestige = 10
		add_trait = wounded
		piety = 5
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = cruel
			}
			modifier = {
				factor = 0
				NOT = {
					trait = kind
				}
				event_target:aclla_to_rescue = {
					any_rival = {
						character = ROOT
					}
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_ACLLA_72 # And now you die!
		
		prestige = 10
		piety = -10
		add_trait = wounded
		
		event_target:aclla_to_rescue = {
			death = {
				death_reason = death_murder_unknown
				killer = ROOT
			}
		}
		
		if = {
			limit = {
				event_target:aclla_rescue_attempt_lover = {
					any_lover = {
						character = ROOT
					}
					host = {
						has_landed_title = d_acllahuasi
					}
				}
			}
			event_target:aclla_rescue_attempt_lover = {
				move_character = ROOT
				add_trait = travelling
				set_character_flag = do_not_disturb
				set_character_flag = ex_aclla # Rescued
				clr_character_flag = no_court_invites
				remove_trait = aclla
				character_event = { id = aclla.84 days = 61 } # Safety flag cleanup
				ROOT = {
					set_character_flag = aclla_lover_is_coming_along
				}
			}
		}
		
		character_event = { id = aclla.76 days = 1 } # Escape
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				NOR = {
					trait = cruel
					event_target:aclla_to_rescue = {
						any_rival = {
							character = ROOT
						}
					}
				}
			}
			modifier = {
				factor = 0
				trait = cruel
				event_target:aclla_to_rescue = {
					OR = {
						any_friend = {
							character = ROOT
						}
						any_lover = {
							character = ROOT
						}
					}
				}
			}
		}
	}
}

# You fought the guards - maimed - how deal with kinswoman?
character_event = {
	id = aclla.73
	desc = EVTDESC_ACLLA_73
	picture = GFX_evt_jailbreak
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_73 # You ARE coming with me!
		
		if = {
			limit = {
				event_target:aclla_rescue_attempt_lover = {
					any_lover = {
						character = ROOT
					}
					host = {
						has_landed_title = d_acllahuasi
					}
				}
			}
			event_target:aclla_rescue_attempt_lover = {
				move_character = ROOT
				add_trait = travelling
				set_character_flag = do_not_disturb
				set_character_flag = ex_aclla # Rescued
				clr_character_flag = no_court_invites
				remove_trait = aclla
				character_event = { id = aclla.84 days = 61 } # Safety flag cleanup
				ROOT = {
					set_character_flag = aclla_lover_is_coming_along
				}
			}
		}
		event_target:aclla_to_rescue = {
			move_character = ROOT
			add_trait = travelling
			set_character_flag = do_not_disturb
			set_character_flag = ex_aclla # Rescued
			clr_character_flag = no_court_invites
			clr_character_flag = aclla_being_sacrificed
			clr_character_flag = aclla_sacrifice_in_progress
			remove_character_modifier = qhapaq_hucha
			remove_trait = aclla
			character_event = { id = aclla.84 days = 61 } # Safety flag cleanup
			ROOT = {
				set_character_flag = aclla_is_unwilling
			}
		}
		
		character_event = { id = aclla.76 days = 1 } # Escape
		
		add_maimed_trait_effect = yes
		piety = 5
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = cruel
			}
			modifier = {
				factor = 0
				NOT = {
					trait = kind
				}
				event_target:aclla_to_rescue = {
					any_rival = {
						character = ROOT
					}
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_ACLLA_73 # And now you die!
		
		piety = -10
		add_maimed_trait_effect = yes
		
		event_target:aclla_to_rescue = {
			death = {
				death_reason = death_murder_unknown
				killer = ROOT
			}
		}
		
		if = {
			limit = {
				event_target:aclla_rescue_attempt_lover = {
					any_lover = {
						character = ROOT
					}
					host = {
						has_landed_title = d_acllahuasi
					}
				}
			}
			event_target:aclla_rescue_attempt_lover = {
				move_character = ROOT
				add_trait = travelling
				set_character_flag = do_not_disturb
				set_character_flag = ex_aclla # Rescued
				clr_character_flag = no_court_invites
				remove_trait = aclla
				character_event = { id = aclla.84 days = 61 } # Safety flag cleanup
				ROOT = {
					set_character_flag = aclla_lover_is_coming_along
				}
			}
		}
		
		character_event = { id = aclla.76 days = 1 } # Escape
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				NOR = {
					trait = cruel
					event_target:aclla_to_rescue = {
						any_rival = {
							character = ROOT
						}
					}
				}
			}
			modifier = {
				factor = 0
				trait = cruel
				event_target:aclla_to_rescue = {
					OR = {
						any_friend = {
							character = ROOT
						}
						any_lover = {
							character = ROOT
						}
					}
				}
			}
		}
	}
}

# You fought the guards - captured
character_event = {
	id = aclla.74
	desc = EVTDESC_ACLLA_74
	picture = GFX_evt_into_the_dungeon
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_74 # This is bad...
		
		prestige = -25
		
		d_acllahuasi = {
			holder_scope = {
				ROOT = {
					imprison = PREV
				}
				if = {
					limit = {
						has_dlc = "Jade Dragon"
					}
					if = {
						limit = {
							ROOT = {
								is_chinese_emperor_trigger = yes
							}
						}
						detract_grace_super_huge_effect = yes
					}
					else_if = {
						limit = {
							ROOT = {
								any_close_relative = {
									dynasty = PREV
									is_chinese_emperor_trigger = yes
								}
							}
						}
						detract_grace_massive_effect = yes
					}
					else_if = {
						limit = {
							ROOT = {
								any_dynasty_member = {
									is_chinese_emperor_trigger = yes
								}
							}
						}
						detract_grace_major_effect = yes
					}
				}
				character_event = { id = aclla.38 days = 1 }
			}
		}
		
		event_target:aclla_rescue_attempt_lover = {
			clr_character_flag = aclla_rescue_attempt_lover
		}
		
		event_target:aclla_to_rescue = {
			clr_character_flag = aclla_being_rescued
		}
	}
}

# You fought the guards - killed
character_event = {
	id = aclla.75
	desc = EVTDESC_ACLLA_75
	picture = GFX_evt_bloody_man
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_75 # This cannot be!
		
		prestige = -25
		
		death = {
			death_reason = death_battle
		}
		
		event_target:aclla_rescue_attempt_lover = {
			clr_character_flag = aclla_rescue_attempt_lover
		}
		
		event_target:aclla_to_rescue = {
			clr_character_flag = aclla_being_rescued
		}
	}
}

# Check which version of the next event to fire
character_event = {
	id = aclla.76
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				has_character_flag = aclla_is_willing
				has_character_flag = aclla_lover_is_coming_along
			}
			character_event = { id = aclla.77 }
		}
		else_if = {
			limit = {
				has_character_flag = aclla_is_unwilling
				has_character_flag = aclla_lover_is_coming_along
			}
			character_event = { id = aclla.78 }
		}
		else_if = {
			limit = {
				has_character_flag = aclla_is_willing
			}
			character_event = { id = aclla.79 }
		}
		else_if = {
			limit = {
				has_character_flag = aclla_is_unwilling
			}
			character_event = { id = aclla.80 }
		}
		else_if = {
			limit = {
				has_character_flag = aclla_lover_is_coming_along
			}
			character_event = { id = aclla.81 }
		}
		else = {
			character_event = { id = aclla.82 }
		}
	}
}

# Succesful escape with willing kinswoman + lover
character_event = {
	id = aclla.77
	desc = EVTDESC_ACLLA_77
	picture = GFX_evt_jailbreak
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_77 # We out!
		
		character_event = { id = aclla.83 days = 30 random = 30 }
	}
}

# Succesful escape with unwilling kinswoman + lover
character_event = {
	id = aclla.78
	desc = EVTDESC_ACLLA_78
	picture = GFX_evt_jailbreak
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_78 # We out!
		
		character_event = { id = aclla.83 days = 30 random = 30 }
	}
}

# Succesful escape with willing kinswoman
character_event = {
	id = aclla.79
	desc = EVTDESC_ACLLA_79
	picture = GFX_evt_jailbreak
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_79 # We out!
		
		character_event = { id = aclla.83 days = 30 random = 30 }
	}
}

# Succesful escape with unwilling kinswoman
character_event = {
	id = aclla.80
	desc = EVTDESC_ACLLA_80
	picture = GFX_evt_jailbreak
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_80 # We out!
		
		character_event = { id = aclla.83 days = 30 random = 30 }
	}
}

# Succesful escape with lover
character_event = {
	id = aclla.81
	desc = EVTDESC_ACLLA_81
	picture = GFX_evt_jailbreak
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_81 # We out!
		
		character_event = { id = aclla.83 days = 30 random = 30 }
	}
}

# Succesful escape alone
character_event = {
	id = aclla.82
	desc = EVTDESC_ACLLA_82
	picture = GFX_evt_jailbreak
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_82 # We out!
		
		character_event = { id = aclla.83 days = 30 random = 30 }
	}
}

# Returned home - flag and trait cleanup for ROOT and target/lover
character_event = {
	id = aclla.83
	desc = EVTDESC_ACLLA_83
	picture = GFX_evt_relaxed_ruler
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_83 # Home at last!
		
		remove_trait = travelling
		clr_character_flag = do_not_disturb
		clr_character_flag = aclla_no_more_guards
		clr_character_flag = aclla_lover_is_coming_along
		clr_character_flag = aclla_is_unwilling
		clr_character_flag = aclla_is_willing
		
		if = {
			limit = {
				has_character_flag = aclla_lover_is_coming_along
			}
			prestige = 25
			event_target:aclla_rescue_attempt_lover = {
				remove_trait = travelling
				clr_character_flag = do_not_disturb
				character_event = { id = aclla.85 days = 30 random = 30 } # See if lover wants to be more
			}
		}
		
		if = {
			limit = {
				OR = {
					has_character_flag = aclla_is_willing
					has_character_flag = aclla_is_unwilling
				}
			}
			prestige = 25
			event_target:aclla_to_rescue = {
				remove_trait = travelling
				clr_character_flag = do_not_disturb
			}
		}
	}
}

# DND flag and trait cleanup for rescue target/lover
character_event = {
	id = aclla.84
	desc = EVTDESC_ACLLA_84
	picture = GFX_evt_relaxed_ruler
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_84 # Home at last!
		
		remove_trait = travelling
		clr_character_flag = do_not_disturb
	}
}

# See if lover wants to be more
character_event = {
	id = aclla.85
	desc = EVTDESC_ACLLA_85
	picture = GFX_evt_lovers
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	trigger = {
		FROM = {
			is_inaccessible_or_incapable_trigger = no
			is_alive = yes
			is_married = no
			is_consort = no
			is_betrothed = no
			any_lover = {
				character = ROOT
			}
		}
	}
	
	option = {
		trigger = {
			FROM = {
				is_female = no
				OR = {
					is_married = no
					AND = {
						OR = {
							has_religion_feature = religion_harems
							has_religion_feature = religion_feature_tengri
						}
						NOT = {
							num_of_spouses = 4
						}
					}
				}
			}
		}
		
		name = EVTOPTA_ACLLA_85 # I want to marry FROM!
		
		if = {
			limit = {
				NOT = {
					trait = ambitious
				}
			}
			add_trait = ambitious
		}
		
		FROM = {
			character_event = { id = aclla.86 } # FROM approached
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = content
			}
			modifier = {
				factor = 0.1
				trait = humble
			}
		}
	}
	
	option = {
		trigger = {
			FROM = {
				is_female = no
				OR = {
					AND = {
						OR = {
							has_concubinage = yes
							government = tribal_government
							government = nomadic_government
						}
						NOT = {
							num_of_consorts = 3
						}
					}
					AND = {
						OR = { # Theoretically possible to max out consorts, but yeah...
							government = chinese_imperial_government
							government = japanese_imperial_government
						}
					}
				}
			}
		}
		
		if = {
			limit = {
				NOT = {
					trait = ambitious
				}
			}
			add_trait = ambitious
		}
		
		name = EVTOPTB_ACLLA_85 # I want to be a consort!
		
		FROM = {
			character_event = { id = aclla.87 } # FROM approached
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				FROM = {
					is_married = no # Better!
				}
			}
			modifier = {
				factor = 0
				trait = content
			}
			modifier = {
				factor = 0.1
				trait = humble
			}
		}
	}
	
	
	
	option = {
		name = EVTOPTC_ACLLA_85 # This is fine...
		
		if = {
			limit = {
				NOT = {
					trait = content
				}
			}
			add_trait = content
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				trait = proud
			}
			modifier = {
				factor = 0.1
				trait = envious
			}
			modifier = {
				factor = 0
				trait = ambitious
			}
		}
	}
}

# Lover asks to become wife
character_event = {
	id = aclla.86
	desc = EVTDESC_ACLLA_86
	picture = GFX_evt_daughter_asking_father
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_86 # Sure!
		
		add_spouse = FROM
	}
	
	option = {
		name = EVTOPTB_ACLLA_86 # Nope!
		
		remove_lover = FROM
	}
}

# Lover asks to become consort
character_event = {
	id = aclla.87
	desc = EVTDESC_ACLLA_87
	picture = GFX_evt_daughter_asking_father
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_87 # Sure!
		
		add_consort = FROM
	}
	
	option = {
		name = EVTOPTB_ACLLA_87 # Nope!
		
		remove_lover = FROM
	}
}

##### on_adulthood events

# Let's see what kind of aclla she is
character_event = {
	id = aclla.88
	hide_window = yes
	is_triggered_only = yes
	
	has_dlc = "Sunset Invasion"
	
	only_women = yes
	
	has_global_flag = sunrise_invasion_happened
	
	trigger = {
		trait = aclla
		e_tawantinsuyu = {
			has_holder = yes
			holder_scope = {
				OR = {
					religion = inca_religion
					religion = inca_religion_reformed
				}
				NOR = {
					has_religion_feature = religion_matriarchal
					has_religion_feature = religion_equal
				}
			}
		}
	}
	
	immediate = {
		if = {
			limit = {
				OR = {
					has_character_flag = aclla_being_rescued
					has_character_flag = aclla_rescue_attempt_snitch
				}
			}
			repeat_event = { id = aclla.88 days = 30 } # We don't want the other chain to collide with this one...
		}
		else = {
			random_list = {
				20 = { # Tier 1, sacrifice
					modifier = {
						factor = 2
						trait = fair
					}
					modifier = {
						factor = 2
						trait = groomed
					}
					modifier = {
						factor = 2
						is_smart_trigger = yes
					}
					modifier = {
						factor = 1.5
						has_character_modifier = aclla_prodigious_weaver
					}
					modifier = {
						factor = 1.4
						trait = zealous
						OR = {
							religion = inca_religion
							religion = inca_religion_reformed
						}
					}
					add_character_modifier = {
						modifier = yurac_aclla
						duration = -1
					}
					prestige = 250
					any_close_relative = {
						limit = {
							is_landed = yes
						}
						character_event = { id = aclla.89 } # Alert family 
					}
				}
				20 = { # Tier 2, marrige to Sapa Inca
					modifier = {
						factor = 0
						e_tawantinsuyu = {
							holder_scope = {
								OR = {
									is_female = yes
									AND = {
										is_married = yes
										NOT = {
											has_religion_feature = religion_harems
										}
									}
									num_of_spouses = 4
									AND = {
										is_close_relative = ROOT
										NOR = {
											any_sibling = {
												character = ROOT
											}
											has_religion_feature = religion_holy_family
										}
									}
								}
							}
						}
					}
					modifier = {
						factor = 1.5
						trait = fair
					}
					modifier = {
						factor = 1.5
						has_character_modifier = aclla_prodigious_weaver
					}
					modifier = {
						factor = 6
						OR = {
							trait = shrewd
							trait = quick
							trait = genius
						}
					}
					add_character_modifier = {
						modifier = huayru_aclla
						duration = -1
					}
					prestige = 200
					set_character_flag = aclla_being_married
					e_tawantinsuyu = {
						holder_scope = {
							character_event = { id = aclla.90 } # Sapa Inca asked about marriage
						}
					}
				}
				40 = { # Tier 3, marriage to vassal
					add_character_modifier = {
						modifier = pacu_aclla
						duration = -1
					}
					prestige = 100
					set_character_flag = aclla_being_married
					character_event = { id = aclla.92 } # Ping to set up vassal marriage
				}
				20 = { # Tier 4, servitude
					modifier = {
						factor = 1.5
						has_character_modifier = aclla_dancer
					}
					modifier = {
						factor = 1.5
						has_character_modifier = aclla_singer
					}
					modifier = {
						factor = 1.5
						has_character_modifier = aclla_brewer
					}
					modifier = {
						factor = 1.5
						has_character_modifier = aclla_cook
					}
					modifier = { # Can't become a servant if you can't do nothing
						factor = 0
						NOR = {
							has_character_modifier = aclla_cook
							has_character_modifier = aclla_dancer
							has_character_modifier = aclla_singer
							has_character_modifier = aclla_brewer
						}
					}
					add_character_modifier = {
						modifier = yana_aclla
						duration = -1
					}
					prestige = 50
					e_tawantinsuyu = {
						holder_scope = {
							random_realm_lord = {
								preferred_limit = {
									reverse_opinion = {
										who = PREV
										value = 25
									}
								}
								preferred_limit = {
									reverse_opinion = {
										who = PREV
										value = 0
									}
								}
								character_event = { id = aclla.95 } # Have a servant!
							}
						}
					}
				}
			}
		}
	}
}

# Notify family if aclla might be sacrifice
character_event = {
	id = aclla.89
	desc = EVTDESC_ACLLA_89
	picture = GFX_evt_emissary
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			OR = {
				true_religion = inca_religion
				true_religion = inca_religion_reformed
			}
		}
		name = EVTOPTA_ACLLA_89 # That's great!
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = cynical
			}
		}
	}
	
	option = {
		name = EVTOPTB_ACLLA_89 # Not my daughter/sister/aunt!
		
		if = {
			limit = {
				OR = {
					true_religion = inca_religion
					true_religion = inca_religion_reformed
				}
			}
			remove_trait = zealous
		}
		
		FROM = {
			opinion = {
				who = ROOT
				modifier = opinion_aclla_rescuer
			}
		}
		
		custom_tooltip = {
			text = ACLLA_89_GET_BACK_DAUGHTER
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				OR = {
					true_religion = inca_religion
					true_religion = inca_religion_reformed
				}
				trait = zealous
			}
		}
	}
}

# Does Sapa Inca wish to marry the newest Huayru Aclla?
character_event = {
	id = aclla.90
	desc = EVTDESC_ACLLA_90
	picture = GFX_evt_emissary
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_90 # Sure!
		FROM = {
			clr_character_flag = aclla_being_married
			clr_character_flag = no_court_invites
			remove_trait = aclla # Marriage blocker
		}
		add_spouse = FROM
		prestige = 250
		piety = 150
		
		hidden_tooltip = {
			FROM = {
				any_close_relative = {
					character_event = { id = aclla.91 } # Inform family
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_ACLLA_90 # Something for my heir, perhaps?
		trigger = {
			any_child = {
				is_female = no
				is_adult = yes
				is_ascetic_trigger = no
				NOT = { trait = celibate }
				NOR = {
					AND = {
						is_married = yes
						NOR = {
							has_religion_feature = religion_harems
							has_religion_feature = religion_feature_zun
							has_religion_feature = religion_feature_tengri
						}
					}
					num_of_spouses = 4
					AND = {
						is_close_relative = FROM
						NOR = {
							any_sibling = {
								character = FROM
							}
							has_religion_feature = religion_holy_family
							has_religion_feature = religion_feature_zun
							religion = messalian
							religion = zoroastrian
						}
					}
				}
				host = { character = PREV }
				is_landed = no
			}
		
		}
		random_child = {
			limit = {
				is_female = no
				is_adult = yes
				is_ascetic_trigger = no
				NOT = { trait = celibate }
				NOR = {
					AND = {
						is_married = yes
						NOR = {
							has_religion_feature = religion_harems
							has_religion_feature = religion_feature_zun
							has_religion_feature = religion_feature_tengri
						}
					}
					num_of_spouses = 4
					AND = {
						is_close_relative = FROM
						NOR = {
							any_sibling = {
								character = FROM
							}
							has_religion_feature = religion_holy_family
							has_religion_feature = religion_feature_zun
							religion = messalian
							religion = zoroastrian
						}
					}
				}
				host = { character = PREV }
				is_landed = no
			}
			FROM = {
				clr_character_flag = aclla_being_married
				clr_character_flag = no_court_invites
				remove_trait = aclla # Marriage blocker
			}
			add_spouse = FROM
			prestige = 150
			piety = 100
		}
		
		hidden_tooltip = {
			FROM = {
				any_close_relative = {
					character_event = { id = aclla.94 } # Inform her family
				}
			}
		}
	}

	option = {
		name = EVTOPTC_ACLLA_90 # Nah, let the vassals have her.
		piety = -50
		
		FROM = {
			remove_character_modifier = huayru_aclla
			add_character_modifier = {
				modifier = pacu_aclla
				duration = -1
			}
			prestige = -100
			hidden_tooltip = {
				character_event = { id = aclla.92 } # Ping
			}
		}
	}
}

# Daughter/sister/aunt grew up to marry the Sapa Inca!
character_event = {
	id = aclla.91
	desc = EVTDESC_ACLLA_91
	picture = GFX_evt_emissary
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_91 # So proud of her!
		prestige = 150
	}
}

# Marry to vassal setup event
character_event = {
	id = aclla.92
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		change_variable = { which = no_of_tries value = 1 } # To prevent bouncing between vassals endlessly
		if = {
			limit = {
				NOT = {
					check_variable = { which = no_of_tries value = 6 }
				}
			}
			
			e_tawantinsuyu = {
				holder_scope = {
					random_realm_lord = {
						limit = {
							is_female = no
							NOR = {
								AND = {
									is_married = yes
									NOR = {
										has_religion_feature = religion_harems
										has_religion_feature = religion_feature_zun
										has_religion_feature = religion_feature_tengri
									}
								}
								num_of_spouses = 4
								AND = {
									is_close_relative = ROOT
									NOR = {
										any_sibling = {
											character = ROOT
										}
										has_religion_feature = religion_holy_family
										has_religion_feature = religion_feature_zun
										religion = messalian
										religion = zoroastrian
									}
								}
							}
						}
						preferred_limit = {
							reverse_opinion = {
								who = PREV
								value = 25
							}
						}
						preferred_limit = {
							reverse_opinion = {
								who = PREV
								value = 0
							}
						}
						character_event = {
							id = aclla.93 # Here, have a wife!
							days = 3
						}
					}
				}
			}
		}
		else = {
			clr_character_flag = aclla_being_married
			remove_character_modifier = pacu_aclla
			add_character_modifier = {
				modifier = yana_aclla
				duration = -1
			}
			prestige = -100
			e_tawantinsuyu = {
				holder_scope = {
					random_realm_lord = {
						preferred_limit = {
							reverse_opinion = {
								who = PREV
								value = 25
							}
						}
						preferred_limit = {
							reverse_opinion = {
								who = PREV
								value = 0
							}
						}
						character_event = { id = aclla.95 } # Here, have a servant!
					}
				}
			}
		}
	}
}

# Vassal is offered wife from Acllahuasi
character_event = {
	id = aclla.93
	desc = EVTDESC_ACLLA_93
	picture = GFX_evt_emissary
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_93 # Sure!
		FROM = {
			clr_character_flag = aclla_being_married
			clr_character_flag = no_court_invites
			remove_trait = aclla # Marriage blocker
		}
		add_spouse = FROM
		prestige = 250
		piety = 150
		
		hidden_tooltip = {
			FROM = {
				any_close_relative = {
					character_event = { id = aclla.94 } # Inform her family
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_ACLLA_93 # Something for my heir, perhaps?
		trigger = {
			any_child = {
				is_female = no
				is_adult = yes
				is_ascetic_trigger = no
				NOT = { trait = celibate }
				NOR = {
					AND = {
						is_married = yes
						NOR = {
							has_religion_feature = religion_harems
							has_religion_feature = religion_feature_zun
							has_religion_feature = religion_feature_tengri
						}
					}
					num_of_spouses = 4
					AND = {
						is_close_relative = FROM
						NOR = {
							any_sibling = {
								character = FROM
							}
							has_religion_feature = religion_holy_family
							has_religion_feature = religion_feature_zun
							religion = messalian
							religion = zoroastrian
						}
					}
				}
				host = { character = PREV }
				is_landed = no
			}
		
		}
		random_child = {
			limit = {
				is_female = no
				is_adult = yes
				is_ascetic_trigger = no
				NOT = { trait = celibate }
				NOR = {
					AND = {
						is_married = yes
						NOR = {
							has_religion_feature = religion_harems
							has_religion_feature = religion_feature_zun
							has_religion_feature = religion_feature_tengri
						}
					}
					num_of_spouses = 4
					AND = {
						is_close_relative = FROM
						NOR = {
							any_sibling = {
								character = FROM
							}
							has_religion_feature = religion_holy_family
							has_religion_feature = religion_feature_zun
							religion = messalian
							religion = zoroastrian
						}
					}
				}
				host = { character = PREV }
				is_landed = no
			}
			FROM = {
				clr_character_flag = aclla_being_married
				clr_character_flag = no_court_invites
				remove_trait = aclla # Marriage blocker
			}
			add_spouse = FROM
			prestige = 150
			piety = 100
		}
		
		hidden_tooltip = {
			FROM = {
				any_close_relative = {
					character_event = { id = aclla.94 } # Inform her family
				}
			}
		}
	}

	option = {
		name = EVTOPTC_ACLLA_93 # Nothing for me.
		
		FROM = {
			prestige = -10
			hidden_tooltip = {
				character_event = { id = aclla.92 } # Try again
			}
		}
	}
}

# Daughter/sister/aunt grew up to marry this realm lord!
character_event = {
	id = aclla.94
	desc = EVTDESC_ACLLA_94
	picture = GFX_evt_emissary
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_94 # Proud of her!
		prestige = 50
	}
}

# Have a servant!
character_event = {
	id = aclla.95
	desc = EVTDESC_ACLLA_95
	picture = GFX_evt_emissary
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_95 # She'll come in handy!
		prestige = 50
		
		FROM = {
			move_character = ROOT
			remove_trait = aclla
		}
	}
}

# 96 isn't a real number!

##### Servant events

# Dancer dances; triggered on yearly pulse
character_event = {
	id = aclla.97
	desc = EVTDESC_ACLLA_97
	picture = GFX_evt_dancing
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	has_dlc = "Sunset Invasion"
	
	only_playable = yes
	
	has_global_flag = sunrise_invasion_happened
	
	trigger = {
		OR = {
			trait = stressed
			trait = depressed
		}
		any_courtier = {
			has_character_modifier = aclla_dancer
		}
	}
	
	immediate = {
		random_courtier = {
			limit = {
				has_character_modifier = aclla_dancer
			}
			save_event_target_as = aclla_servant
		}
	}
	
	option = {
		name = EVTOPTA_ACLLA_97 # Entrancing...
		if = {
			limit = {
				trait = stressed
			}
			remove_trait = stressed
		}
		if = {
			limit = {
				trait = depressed
			}
			remove_trait = depressed
		}
		random = {
			chance = 30
			add_trait = content
		}
	}
}

# Singer sings; triggered on yearly pulse
character_event = {
	id = aclla.98
	desc = EVTDESC_ACLLA_98
	picture = GFX_evt_dancing
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	has_dlc = "Sunset Invasion"
	
	only_playable = yes
	
	has_global_flag = sunrise_invasion_happened
	
	trigger = {
		OR = {
			trait = stressed
			trait = depressed
		}
		any_courtier = {
			has_character_modifier = aclla_singer
		}
	}
	
	immediate = {
		random_courtier = {
			limit = {
				has_character_modifier = aclla_singer
			}
			save_event_target_as = aclla_servant
		}
	}
	
	option = {
		name = EVTOPTA_ACLLA_98 # Entrancing...
		if = {
			limit = {
				trait = stressed
			}
			remove_trait = stressed
		}
		if = {
			limit = {
				trait = depressed
			}
			remove_trait = depressed
		}
		random = {
			chance = 30
			add_trait = content
		}
	}
}

# Brewer brews; triggered on yearly pulse
character_event = {
	id = aclla.99
	desc = EVTDESC_ACLLA_99
	picture = GFX_evt_feast
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	has_dlc = "Sunset Invasion"
	
	only_playable = yes
	
	has_global_flag = sunrise_invasion_happened
	
	trigger = {
		OR = {
			trait = stressed
			trait = depressed
		}
		any_courtier = {
			has_character_modifier = aclla_brewer
		}
	}
	
	immediate = {
		random_courtier = {
			limit = {
				has_character_modifier = aclla_brewer
			}
			save_event_target_as = aclla_servant
		}
	}
	
	option = {
		name = EVTOPTA_ACLLA_99 # Delicious!
		if = {
			limit = {
				trait = stressed
			}
			remove_trait = stressed
		}
		if = {
			limit = {
				trait = depressed
			}
			remove_trait = depressed
		}
		random = {
			chance = 30
			add_trait = drunkard
		}
	}
}

# Cook cooks; triggered on yearly pulse
character_event = {
	id = aclla.100
	desc = EVTDESC_ACLLA_100
	picture = GFX_evt_fancy_feast
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	has_dlc = "Sunset Invasion"
	
	only_playable = yes
	
	has_global_flag = sunrise_invasion_happened
	
	trigger = {
		OR = {
			trait = stressed
			trait = depressed
		}
		any_courtier = {
			has_character_modifier = aclla_cook
		}
	}
	
	immediate = {
		random_courtier = {
			limit = {
				has_character_modifier = aclla_cook
			}
			save_event_target_as = aclla_servant
		}
	}
	
	option = {
		name = EVTOPTA_ACLLA_100 # Delicious!
		if = {
			limit = {
				trait = stressed
			}
			remove_trait = stressed
		}
		if = {
			limit = {
				trait = depressed
			}
			remove_trait = depressed
		}
		random = {
			chance = 30
			add_trait = gluttonous
		}
	}
}

##### Sacrifice events

### Startup

# on_new_holder (any_kind) for e_tawantinsuyu
character_event = {
	id = aclla.101
	hide_window = yes
	
	is_triggered_only = yes
	
	has_dlc = "Sunset Invasion"
	
	only_playable = yes
	
	has_global_flag = sunrise_invasion_happened
	
	trigger = {
		FROM = {
			title = e_tawantinsuyu
		}
		OR = {
			religion = inca_religion
			religion = inca_religion_reformed
		}
		NOR = {
			has_religion_feature = religion_matriarchal
			has_religion_feature = religion_equal
		}
	}
	
	immediate = {
		character_event = { id = aclla.105 days = 1 } # Delay by one day to handle possible title deactivation
	}
}

# on_war_lost for e_tawantinsuyu - e_tawantinsuyu was the attacker
character_event = {
	id = aclla.102
	hide_window = yes
	
	is_triggered_only = yes
	
	has_dlc = "Sunset Invasion"
	
	only_playable = yes
	
	has_global_flag = sunrise_invasion_happened
	
	trigger = {
		FROM = { # Attacker
			has_landed_title = e_tawantinsuyu
			OR = {
				religion = inca_religion
				religion = inca_religion_reformed
			}
			NOR = {
				has_religion_feature = religion_matriarchal
				has_religion_feature = religion_equal
			}
		}
	}
	
	immediate = {
		FROM = {
			character_event = { id = aclla.103 } # Ping
		}
	}
}

# Ping e_tawantinsuyu's holder
character_event = {
	id = aclla.103
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		character_event = { id = aclla.105 days = 1 } # Delay by one day to handle possible title deactivation
	}
}

# on_war_lost for e_tawantinsuyu - e_tawantinsuyu was the defender
character_event = {
	id = aclla.104
	hide_window = yes
	
	is_triggered_only = yes
	
	has_dlc = "Sunset Invasion"
	
	only_playable = yes
	
	has_global_flag = sunrise_invasion_happened
	
	trigger = {
		has_landed_title = e_tawantinsuyu
		OR = {
			religion = inca_religion
			religion = inca_religion_reformed
		}
		NOR = {
			has_religion_feature = religion_matriarchal
			has_religion_feature = religion_equal
		}
	}
	
	immediate = {
		character_event = { id = aclla.105 days = 1 } # Delay by one day to handle possible title deactivation
	}
}

# Ping self - delay one day to see if e_tawantinsuyu was disabled
character_event = {
	id = aclla.105
	hide_window = yes
	
	is_triggered_only = yes
	only_rulers = yes
	
	immediate = {
		if = {
			limit = {
				has_landed_title = e_tawantinsuyu
				OR = {
					religion = inca_religion
					religion = inca_religion_reformed
				}
				NOR = {
					has_religion_feature = religion_matriarchal
					has_religion_feature = religion_equal
				}
			}
			d_acllahuasi = {
				holder_scope = {
					character_event = { id = aclla.106 }
				}
			}
		}
	}
}

# Ping d_acllahuasi
character_event = {
	id = aclla.106
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		random_courtier = {
			limit = {
				trait = aclla
				NOT = {
					has_character_flag = aclla_being_sacrificed
				}
				has_character_modifier = yurac_aclla
			}
			preferred_limit = {
				NOR = {
					has_character_flag = aclla_being_rescued
					has_character_flag = aclla_rescue_attempt_lover
					has_character_flag = aclla_rescue_attempt_snitch
					has_character_flag = aclla_being_married
				}
			}
			preferred_limit = {
				NOR = {
					has_character_flag = aclla_being_rescued
					has_character_flag = aclla_rescue_attempt_lover
					has_character_flag = aclla_rescue_attempt_snitch
				}
			}
			preferred_limit = {
				NOR = {
					has_character_flag = aclla_being_rescued
					has_character_flag = aclla_rescue_attempt_lover
				}
			}
			preferred_limit = {
				NOT = {
					has_character_flag = aclla_being_rescued
				}
			}
			add_character_modifier = {
				modifier = qhapaq_hucha
				duration = -1
			}
			add_trait = groomed
			character_event = { id = aclla.107 }
		}
	}
}

# Ping aclla
character_event = {
	id = aclla.107
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		set_character_flag = aclla_being_sacrificed
		any_close_relative = {
			limit = {
				is_landed = yes
			}
			character_event = { id = aclla.108 } # Inform family
		}
		
		character_event = {	id = aclla.109 days = 200 } # Stage 1 - zealous
	}
}

# Inform family of pending sacrifice, possibly resulting in a rescue attempt
character_event = {
	id = aclla.108
	desc = EVTDESC_ACLLA_108
	picture = GFX_evt_religious_exultation
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			OR = {
				true_religion = inca_religion
				true_religion = inca_religion_reformed
			}
		}
		name = EVTOPTA_ACLLA_108 # It is for Inti!
		
		piety = 100
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 100
				trait = zealous
			}
			modifier = {
				factor = 0
				trait = cynical
			}
		}
	}
	
	option = {
		name = EVTOPTB_ACLLA_108 # I *will* rescue her!
		FROM = {
			opinion = {
				who = ROOT
				modifier = opinion_aclla_rescuer
			}
		}
		
		if = {
			limit = {
				OR = {
					true_religion = inca_religion
					true_religion = inca_religion_reformed
				}
			}
			piety = -100
		}
		
		custom_tooltip = {
			text = ACLLA_108_GET_BACK_DAUGHTER
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = zealous
				NOR = {
					trait = arbitrary
					trait = deceitful
				}
				OR = {
					true_religion = inca_religion
					true_religion = inca_religion_reformed
				}
			}
		}
	}
}

# Preparation - zealous (works even if you're not of the right religion because you *really* don't like these weird ways!)
character_event = {
	id = aclla.109
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				has_character_flag = aclla_being_sacrificed
				e_tawantinsuyu = {
					has_holder = yes
					holder_scope = {
						OR = {
							religion = inca_religion
							religion = inca_religion_reformed
						}
						NOR = {
							has_religion_feature = religion_matriarchal
							has_religion_feature = religion_equal
						}
					}
				}
			}
			remove_trait = cynical
			random = {
				chance = 75
				add_trait = zealous
			}
			character_event = {	id = aclla.110 days = 100 }
		}
		else = {
			clr_character_flag = aclla_being_sacrificed
			remove_character_modifier = qhapaq_hucha
		}
	}
}

# Preparation - fed well
character_event = {
	id = aclla.110
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				has_character_flag = aclla_being_sacrificed
				e_tawantinsuyu = {
					has_holder = yes
					holder_scope = {
						OR = {
							religion = inca_religion
							religion = inca_religion_reformed
						}
						NOR = {
							has_religion_feature = religion_matriarchal
							has_religion_feature = religion_equal
						}
					}
				}
			}
			remove_trait = is_malnourished
			remove_trait = feeble
			if = {
				limit = {
					NOT = {
						is_strong_trigger = yes
					}
				}
				random = {
					chance = 50
					add_trait = sturdy
				}
			}
			set_character_flag = aclla_sacrifice_in_progress # No furter rescue attempts possible
			if = {
				limit = {
					has_character_flag = aclla_being_rescued
				}
				character_event = { id = aclla.111 days = 75 } # Slight delay
			}
			else = {
				character_event = { id = aclla.111 days = 50 }
			}
		}
		else = {
			clr_character_flag = aclla_being_sacrificed
			remove_character_modifier = qhapaq_hucha
		}
	}
}

# Preparation - drugged
character_event = {
	id = aclla.111
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				has_character_flag = aclla_being_sacrificed
				e_tawantinsuyu = {
					has_holder = yes
					holder_scope = {
						OR = {
							religion = inca_religion
							religion = inca_religion_reformed
						}
						NOR = {
							has_religion_feature = religion_matriarchal
							has_religion_feature = religion_equal
						}
					}
				}
			}
			add_trait = content
			random = {
				chance = 50
				add_trait = drunkard
			}
			
			random_list = {
				50 = { # Sacrifice in Cuzco
					character_event = { id = aclla.112 days = 50 }
				}
				50 = { # Sacrifice in home province
					modifier = {
						factor = 0
						NOT = {
							any_close_relative = {
								is_landed = yes
								top_liege = {
									has_landed_title = e_tawantinsuyu
								}
							}
						}
					}
					character_event = { id = aclla.115 days = 50 }
				}
			}
		}
		else = {
			clr_character_flag = aclla_being_sacrificed
			clr_character_flag = aclla_sacrifice_in_progress
			remove_character_modifier = qhapaq_hucha
		}
	}
}

### Sacrifice in Cuzco

# Ping sacrifice
character_event = {
	id = aclla.112
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				has_character_flag = aclla_being_sacrificed
				e_tawantinsuyu = {
					has_holder = yes
					holder_scope = {
						OR = {
							religion = inca_religion
							religion = inca_religion_reformed
						}
						NOR = {
							has_religion_feature = religion_matriarchal
							has_religion_feature = religion_equal
						}
					}
				}
			}
			e_tawantinsuyu = {
				holder_scope = {
					character_event = { id = aclla.113 }
				}
			}
		}
		else = {
			clr_character_flag = aclla_being_sacrificed
			clr_character_flag = aclla_sacrifice_in_progress
			remove_character_modifier = qhapaq_hucha
		}
	}
}

# Sacrifice happens - Sapa Inca
character_event = {
	id = aclla.113
	desc = EVTDESC_ACLLA_113
	picture = GFX_evt_religious_exultation
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_113 # Glory to Inti!
		piety = 300
		
		FROM = {
			death = {
				death_reason = death_sacrificed
				#killer = ROOT
			}
		}
		
		hidden_tooltip = {
			FROM = {
				any_close_relative = {
					character_event = { id = aclla.114 } # Inform family
				}
			}
		}
	}
}

# Sacrifice happened - relatives
character_event = {
	id = aclla.114
	desc = EVTDESC_ACLLA_114
	picture = GFX_evt_religious_exultation
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			OR = {
				true_religion = inca_religion
				true_religion = inca_religion_reformed
			}
		}
		name = EVTOPTA_ACLLA_114 # It is for Inti!
		
		piety = 100
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 100
				trait = zealous
			}
			modifier = {
				factor = 0
				trait = cynical
			}
		}
	}
	
	option = {
		name = EVTOPTB_ACLLA_114 # I *will* avenge her!
		
		add_rival = FROM
		
		if = {
			limit = {
				OR = {
					true_religion = inca_religion
					true_religion = inca_religion_reformed
				}
			}
			piety = -100
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = zealous
				NOR = {
					trait = arbitrary
					trait = deceitful
				}
				OR = {
					true_religion = inca_religion
					true_religion = inca_religion_reformed
				}
			}
		}
	}
}

### Sacrifice at home

# Ping sacrifice
character_event = {
	id = aclla.115
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				has_character_flag = aclla_being_sacrificed
				e_tawantinsuyu = {
					has_holder = yes
					holder_scope = {
						OR = {
							religion = inca_religion
							religion = inca_religion_reformed
						}
						NOR = {
							has_religion_feature = religion_matriarchal
							has_religion_feature = religion_equal
						}
					}
				}
			}
			if = {
				limit = {
					any_close_relative = {
						is_landed = yes
						top_liege = {
							has_landed_title = e_tawantinsuyu
						}
					}
				}
				random_close_relative = {
					limit = {
						is_landed = yes
						top_liege = {
							has_landed_title = e_tawantinsuyu
						}
					}
					long_character_event = { id = aclla.116 } # Inform family
				}
				character_event = { id = aclla.123 days = 15 } # Fallback sacrifice
			}
			else = {
				character_event = { id = aclla.112 } # Fallback: Cuzco
			}
		}
		else = {
			clr_character_flag = aclla_being_sacrificed
			clr_character_flag = aclla_sacrifice_in_progress
			remove_character_modifier = qhapaq_hucha
		}
	}
}
			

# Sacrifice arrives - last chance to attempt a rescue
long_character_event = {
	id = aclla.116
	desc = EVTDESC_ACLLA_116
	picture = GFX_evt_emissary
	border = GFX_event_long_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_ACLLA_116 # It is for Inti!
		
		piety = 100
		
		FROM = {
			save_event_target_as = qhapaq_hucha
		}
		
		character_event = { id = aclla.117 days = 10 } # Sacrifice in progress
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 100
				trait = zealous
				OR = {
					true_religion = inca_religion
					true_religion = inca_religion_reformed
				}
			}
			modifier = {
				factor = 100
				trait = zealous
				NOR = {
					true_religion = inca_religion
					true_religion = inca_religion_reformed
				}
			}
			modifier = {
				factor = 0.1
				trait = brave
			}
		}
	}
	
	option = {
		name = EVTOPTB_ACLLA_116 # I *will* rescue her!
		
		if = {
			limit = {
				OR = {
					true_religion = inca_religion
					true_religion = inca_religion_reformed
				}
			}
			piety = -100
		}
		
		FROM = {
			save_event_target_as = qhapaq_hucha
		}
		
		character_event = { id = aclla.118 days = 10 } # Rescue attempt
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = zealous
				NOR = {
					trait = arbitrary
					trait = deceitful
				}
				OR = {
					true_religion = inca_religion
					true_religion = inca_religion_reformed
				}
			}
			modifier = {
				factor = 0.1
				trait = craven
			}
		}
	}
}

# Going towards the place where the sacrifice will take place - no rescue attempt
character_event = {
	id = aclla.117
	desc = EVTDESC_ACLLA_117
	picture = GFX_evt_religious_exultation
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	trigger = {
		event_target:qhapaq_hucha = {
			is_alive = yes
		}
	}
	
	option = {
		name = EVTOPTA_ACLLA_117 # She's not much of a talker now
		character_event = { id = aclla.122 days = 1 } # Go up the mountain
	}
}

# Going towards the place where the sacrifice will take place - rescue attempt
character_event = {
	id = aclla.118
	desc = EVTDESC_ACLLA_118
	picture = GFX_evt_religious_exultation
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	trigger = {
		event_target:qhapaq_hucha = {
			is_alive = yes
		}
	}
	
	option = {
		name = EVTOPTA_ACLLA_118 # Come with me if you want to live!
		if = {
			limit = {
				event_target:qhapaq_hucha = {
					NAND = {
						OR = {
							true_religion = inca_religion
							true_religion = inca_religion_reformed
						}
						trait = zealous
					}
				}
			}
			random_list = {
				50 = {
					modifier = {
						factor = 2
						intrigue = 40
					}
					modifier = {
						factor = 2
						intrigue = 36
					}
					modifier = {
						factor = 2
						intrigue = 32
					}
					modifier = {
						factor = 2
						intrigue = 28
					}
					modifier = {
						factor = 2
						intrigue = 24
					}
					modifier = {
						factor = 2
						intrigue = 20
					}
					modifier = {
						factor = 2
						intrigue = 16
					}
					modifier = {
						factor = 2
						event_target:qhapaq_hucha = {
							intrigue = 40
						}
					}
					modifier = {
						factor = 2
						event_target:qhapaq_hucha = {
							intrigue = 36
						}
					}
					modifier = {
						factor = 2
						event_target:qhapaq_hucha = {
							intrigue = 32
						}
					}
					modifier = {
						factor = 2
						event_target:qhapaq_hucha = {
							intrigue = 24
						}
					}
					modifier = {
						factor = 2
						event_target:qhapaq_hucha = {
							intrigue = 20
						}
					}
					modifier = {
						factor = 2
						event_target:qhapaq_hucha = {
							intrigue = 16
						}
					}
					character_event = { id = aclla.119 days = 1 } # Succesful rescue
				}
				50 = {
					modifier = {
						factor = 2
						NOT = {
							intrigue = 12
						}
					}
					modifier = {
						factor = 2
						NOT = {
							intrigue = 8
						}
					}
					modifier = {
						factor = 2
						NOT = {
							intrigue = 4
						}
					}
					modifier = {
						factor = 2
						event_target:qhapaq_hucha = {
							NOT = {
								intrigue = 12
							}
						}
					}
					modifier = {
						factor = 2
						event_target:qhapaq_hucha = {
							NOT = {
								intrigue = 8
							}
						}
					}
					modifier = {
						factor = 2
						event_target:qhapaq_hucha = {
							NOT = {
								intrigue = 4
							}
						}
					}
					modifier = {
						factor = 0
						NOT = {
							any_courtier_or_vassal = {
								ai = yes
								OR = {
									true_religion = inca_religion
									true_religion = inca_religion_reformed
								}
							}
						}
					}
					random_courtier_or_vassal = {
						limit = {
							ai = yes
							OR = {
								true_religion = inca_religion
								true_religion = inca_religion_reformed
							}
						}
						preferred_limit = {
							trait = zealous
							NOR = {
								any_friend = {
									character = ROOT
								}
								any_lover = {
									character = ROOT
								}
								opinion = {
									who = ROOT
									value = 50
								}
							}
							NOR = {
								any_friend = {
									character = event_target:qhapaq_hucha
								}
								any_lover = {
									character = event_target:qhapaq_hucha
								}
								opinion = {
									who = ROOT
									value = 50
								}
							}
						}
						preferred_limit = {
							trait = zealous
							NOR = {
								any_friend = {
									character = ROOT
								}
								any_lover = {
									character = ROOT
								}
							}
							NOR = {
								any_friend = {
									character = event_target:qhapaq_hucha
								}
								any_lover = {
									character = event_target:qhapaq_hucha
								}
							}
						}
						preferred_limit = {
							trait = zealous
							NOR = {
								any_friend = {
									character = ROOT
								}
							}
							NOR = {
								any_friend = {
									character = event_target:qhapaq_hucha
								}
							}
						}
						preferred_limit = {
							trait = zealous
						}
						save_event_target_as = meddlesome_vassal
					}
					character_event = { id = aclla.120 days = 1 } # Not-quite successful rescue
				}
			}
		}
		else = {
			character_event = { id = aclla.121 days = 1 } # She's a lost cause
		}
	}
}

# Rescue attempt goes well
character_event = {
	id = aclla.119
	desc = EVTDESC_ACLLA_119
	picture = GFX_evt_religious_exultation
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	trigger = {
		event_target:qhapaq_hucha = {
			is_alive = yes
		}
	}
	
	option = {
		name = EVTOPTA_ACLLA_119 # You're safe now!
		
		prestige = 100
		
		add_friend = event_target:qhapaq_hucha
		event_target:qhapaq_hucha = {
			move_character = ROOT
			remove_trait = aclla
			clr_character_flag = aclla_being_sacrificed
			clr_character_flag = aclla_sacrifice_in_progress
			remove_character_modifier = qhapaq_hucha
		}
	}
}

# Rescue attempt goes semi-well - someone spots you - gain a rival and gain a crime modifier from all inca_religion/inca_religion_reformed realm lords
character_event = {
	id = aclla.120
	desc = EVTDESC_ACLLA_120
	picture = GFX_evt_religious_exultation
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	trigger = {
		event_target:qhapaq_hucha = {
			is_alive = yes
		}
	}
	
	option = {
		name = EVTOPTA_ACLLA_120 # At least she's safe...
		
		prestige = -100
		
		add_rival = event_target:meddlesome_vassal
		
		add_friend = event_target:qhapaq_hucha
		event_target:qhapaq_hucha = {
			prestige = -100
			if = {
				limit = {
					has_dlc = "Jade Dragon"
					is_chinese_emperor_trigger = no
				}
				if = {
					limit = {
						ROOT = {
							is_chinese_emperor_trigger = yes # Should be impossible, but...
						}
					}
					detract_grace_super_huge_effect = yes
				}
				else_if = {
					limit = {
						ROOT = {
							any_close_relative = {
								dynasty = PREV
								is_chinese_emperor_trigger = yes
							}
						}
					}
					detract_grace_massive_effect = yes
				}
				else_if = {
					limit = {
						ROOT = {
							any_dynasty_member = {
								is_chinese_emperor_trigger = yes
							}
						}
					}
					detract_grace_major_effect = yes
				}
			}
			
			add_rival = event_target:meddlesome_vassal
			move_character = ROOT
			remove_trait = aclla
			clr_character_flag = aclla_being_sacrificed
			clr_character_flag = aclla_sacrifice_in_progress
			remove_character_modifier = qhapaq_hucha
		}
		
		any_playable_ruler = {
			limit = {
				OR = {
					religion = inca_religion
					religion = inca_religion_reformed
					same_realm = ROOT
				}
			}
			opinion = {
				modifier = opinion_meddled_with_sacrifice
				who = ROOT
			}
		}
	}
}

# Rescue attempt fails - sacrifice is convinced she wants to go ahead with the sacrifice
character_event = {
	id = aclla.121
	desc = EVTDESC_ACLLA_121
	picture = GFX_evt_religious_exultation
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	trigger = {
		event_target:qhapaq_hucha = {
			is_alive = yes
		}
	}
	
	option = {
		name = EVTOPTA_ACLLA_121 # She's truly lost to me...
		
		prestige = -100
		
		character_event = { id = aclla.122 days = 1 }
	}
}

# The sacrifice takes place
character_event = {
	id = aclla.122
	desc = EVTDESC_ACLLA_122
	picture = GFX_evt_religious_exultation
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			OR = {
				religion = inca_religion
				religion = inca_religion_reformed
				true_religion = inca_religion
				true_religion = inca_religion_reformed
			}
		}
		name = EVTOPTA_ACLLA_122 # Glory... to Inti.
		prestige = 100
		if = {
			limit = {
				OR = {
					true_religion = inca_religion
					true_religion = inca_religion_reformed
				}
			}
			piety = 100
		}
		
		event_target:qhapaq_hucha = {
			death = {
				death_reason = death_sacrificed
			}
		}
		if = {
			limit = {
				OR = {
					true_religion = inca_religion
					true_religion = inca_religion_reformed
				}
				trait = zealous
			}
			random = {
				chance = 50
				remove_trait = zealous
			}
		}
		
		random = {
			chance = 50
			add_trait = depressed
		}
	}
	
	option = {
		trigger = {
			NOR = {
				religion = inca_religion
				religion = inca_religion_reformed
			}
		}
		name = EVTOPTB_ACLLA_122 # Curse these savages!
		
		prestige = -100
		if = {
			limit = {
				OR = {
					true_religion = inca_religion
					true_religion = inca_religion_reformed
				}
			}
			piety = -100
		}
		else = {
			random = {
				chance = 50
				add_trait = zealous
			}
		}
		random = {
			chance = 50
			add_trait = ambitious
		}
		random = {
			chance = 50
			add_trait = wroth
		}
		
		event_target:qhapaq_hucha = {
			death = {
				death_reason = death_sacrificed
			}
		}
		
		random = {
			chance = 50
			add_trait = depressed
		}
	}
}

# If the sacrifice somehow is alive too late, kill her!
character_event = {
	id = aclla.123
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				trait = aclla
			}
			death = {
				death_reason = death_sacrificed
			}
		}
	}
}