# A powerful vassal or councillor can attempt to become the regent - mostly based on faction_claimant
faction_regent = {
	type = liege_titles
	cancel_on_leader_death = yes # The faction members might not approve of the new leader, so let's have them start over...
	
	warning_level = 0.7 # At this level of faction power we give player an alert. Set to 0 for no alerts.
	
	# Plotter scope
	potential = {
		NOR = {
			trait = treasure_fleet_preparation
			trait = treasure_fleet_voyage
		}
		prisoner = no
		is_ruler = yes
		independent = no
		is_landed = yes
		is_adult = yes
		has_regent = no
		is_feudal = yes
		primary_title = { holy_order = no }
		OR = {
			NOT = { has_dlc = "Zeus" }
			is_voter = no
			liege = { 
				OR = {
					is_council_content = no
					AND = {
						NOT = { primary_title = { has_law = war_voting_power_1 } }
					}
					#has_council = no
				}
			}
		}
		NOT = { trait = incapable }
		liege = {
			is_feudal = yes
			religion = shinto
			controls_religion = yes
			has_regent = no
			NOT = {
				any_demesne_title = {
					temporary = yes
				}
			}
		}
		OR = {
			religion = shinto
			AND = {
				culture_group = japonic
				religion = buddhist
			}
		}
		NOT = {
			any_demesne_title = {
				temporary = yes
			}
		}
		primary_title = { higher_tier_than = BARON }
		
		OR = {
			# Is not affected by a Crown Law title
			NOT = {
				crownlaw_title = {
					always = yes
				}
			}
			
			# The Crown Law title holder is my liege
			crownlaw_title = {
				holder_scope = {
					ROOT = {
						liege = {
							character = PREVPREV
						}
					}
				}
			}
			
			# The Crown Law title allows vassal infighting
			crownlaw_title = {
				NOT = {
					OR = {
						has_law = crown_authority_2
						has_law = crown_authority_3
						has_law = crown_authority_4
					}
				}
			}
		}
		NOT = { has_character_modifier = faction_regent_timer }
	}
	
	# Target scope
	allow = {
		is_primary_holder_title = yes
		holder_scope = {
			primary_title = {
				ROOT = {
					tier = PREV
				}
			}
		}
		NOT = {
			holder_scope = {
				reverse_has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_leaving_faction
				}
			}
		}
	}
	
	# Faction member scope (ROOT = joiner, FROM = target)
	allow_join = {
		ROOT = {
			NOR = {
				trait = treasure_fleet_preparation
				trait = treasure_fleet_voyage
			}
			is_ruler = yes
			independent = no
			is_landed = yes
			is_adult = yes
			NOT = { trait = incapable }
			prisoner = no
			OR = {
				NOT = { has_dlc = "Zeus"}
				is_voter = no
				liege = { 
					OR = {
						is_council_content = no
						AND = {
							NOT = { primary_title = { has_law = war_voting_power_1 } }
						}
						#has_council = no
					}
				}
			}
		}
	}
	
	# AI creation weight
	chance = {
		factor = 1
		modifier = {
			factor = 5
			FROM = {
				any_owned_bloodline = {
					has_bloodline_flag = regency_bloodline
					bloodline_is_active_for = PREV
				}
			}
		}
		
		modifier = {
			factor = 0.5
			holder_scope = {
				any_owned_bloodline = { has_bloodline_flag = bloodline_less_factions }
			}
		}
		modifier = {
			factor = 0.2
			FROM = { pacifist = yes }
		}	
		
		modifier = {
			factor = 0
			FROM = {
				OR = {
					prisoner = yes
					has_character_modifier = in_seclusion
				}
			}
		}
		
		modifier = {
			factor = 0
			holder_scope = {
				any_spouse = { character = FROM }
			}
		}
		
		modifier = { # Title does NOT have Elective and the current heir is me
			factor = 0
			NOT = { has_law = succ_feudal_elective }
			NOT = { has_law = succ_hre_elective }
			ROOT = {
				holder_scope = {
					current_heir = {
						character = FROM
					}
				}
			}
		}
		
		modifier = { # Let's not give our own dynasty a regent...
			factor = 0
			holder_scope = {
				dynasty = FROM
			}
		}
		
		modifier = {
			factor = 0
			FROM = {
				OR = {
					AND = {
						NOT = { leads_faction = faction_regent }
						opinion = { who = LIEGE value = 50 } 
					}
					AND = {
						leads_faction = faction_regent
						opinion = { who = LIEGE value = 75 } 
					}
				}
			}
		}
		
		# If we're a claimant, let's try taking the throne instead...
		modifier = {
			factor = 0
			FROM = {
				has_claim = ROOT
			}
		}
		
		modifier = {
			factor = 0
			FROM = { preparing_invasion = yes }
		}
		
		modifier = {
			factor = 0
			FROM = { 
				opinion = { who = LIEGE value = 25 } 
				NOR = {
					trait = deceitful
					trait = proud
					trait = ambitious
					trait = envious
				}
			}
		}		
		
		modifier = {
			factor = 0
			FROM = {
				opinion = { who = LIEGE value = 50 } 
				OR = {
					trait = deceitful
					trait = proud
					trait = ambitious
					trait = envious
				}			
			}
		}
		
		modifier = {
			factor = 1.5
			NOT = { FROM = { opinion = { who = LIEGE value = 0 } } }
		}
		modifier = {
			factor = 1.5
			NOT = { FROM = { opinion = { who = LIEGE value = -25 } } }
		}
		modifier = {
			factor = 2.0
			NOT = { FROM = { opinion = { who = LIEGE value = -50 } } }
		}
		modifier = {
			factor = 4.0
			NOT = { FROM = { opinion = { who = LIEGE value = -75 } } }
		}
		
		modifier = {
			factor = 0.01
			FROM = { trait = content }
		}
		modifier = {
			factor = 0.01
			FROM = { trait = imbecile }
		}
		modifier = {
			factor = 0.1
			FROM = { trait = inbred }
		}
		modifier = {
			factor = 0.1
			FROM = { trait = craven }
		}
		modifier = {
			factor = 0.2
			FROM = { 
				OR = {
					trait = slow
					trait = dull
				}
			}
		}
		modifier = {
			factor = 1.5
			FROM = { trait = brave }
		}
		modifier = {
			factor = 4.0
			FROM = { trait = ambitious }
		}
		modifier = {
			factor = 2
			FROM = {
				OR = {
					has_opinion_modifier = { who = LIEGE modifier = opinion_evil_tyrant }
					has_opinion_modifier = { who = LIEGE modifier = opinion_tyrant }
				}
			}
		}
	}
	
	# AI membership weight: ROOT is the prospective member. FROM is the faction leader. FROMFROM is the target title or character.
	membership = {
		factor = 1
		
		# I should be the regent instead...
		modifier = {
			factor = 0.1
			any_owned_bloodline = {
				has_bloodline_flag = regency_bloodline
				bloodline_is_active_for = PREV
			}
			NOT = {
				dynasty = FROM
			}
		}
		
		modifier = {
			factor = 0.5
			ROOT = {  
				liege = { 
					any_owned_bloodline = { has_bloodline_flag = bloodline_less_factions }
				}
			}
		}
		modifier = {
			factor = 0.2
			pacifist = yes
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 0
			OR = {
				prisoner = yes
				trait = incapable
				is_adult = no
				is_landed = no
				preparing_invasion = yes
			}
		}
		
		modifier = { # I do not join factions if I am the heir, unless the claimant is myself
			factor = 0
			FROMFROM = {
				holder_scope = {
					current_heir = {
						character = ROOT
					}
				}
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		# This is some weird foreign stuff...
		modifier = {
			factor = 0.1
			NOR = {
				religion = shinto
				AND = {
					religion = buddhist
					culture_group = japonic
				}
			}
		}
		
		modifier = { # If my liege is my dynasty, I don't want there to be a regent
			factor = 0
			liege = {
				dynasty = ROOT
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = { # Lower chance of joining if I myself has a claim on the same title
			factor = 0.1
			FROMFROM = {
				claimed_by = ROOT
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 0
			has_character_modifier = faction_regent_timer
		}
		
		modifier = {
			factor = 0
			opinion = { who = LIEGE value = 40 }
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = { # If the claimant is not me, make sure I like the claimant more than my current liege
			factor = 0
			
			NOT = {
				ROOT = {
					OR = {
						AND = {
							NOT = { in_faction = faction_regent }
							opinion_diff = {
								first = FROM
								second = LIEGE
								value = 10 # I like the regent more than the current ruler
							}
						}
						AND = {
							in_faction = faction_regent
							opinion_diff = {
								first = FROM
								second = LIEGE
								value = -25
							}
						}
					}
				}
			}
			
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 0
			has_opinion_modifier = {
				who = LIEGE
				modifier = opinion_coerced_into_leaving_faction
			}
		}
		
		modifier = {
			factor = 1000
			has_opinion_modifier = {
				who = FROM
				modifier = opinion_coerced_into_joining_faction
			}
		}
		
		modifier = {
			factor = 0.7
			NAND = {
				has_dlc = "Zeus"
				OR = {
					has_law = status_of_women_4
					has_religion_feature = religion_equal
					has_religion_feature = religion_feature_bon
					has_religion_feature = religion_feature_ryukyuan_three_mountains
					has_religion_feature = religion_feature_ryukyuan_historical
					has_religion_feature = religion_matriarchal
					has_game_rule = {
						name = gender
						value = all
					}
				}
			}
			FROM = {
				is_female = yes
				NOT = { character = ROOT }
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 2.0
			ROOT = {
				opinion_diff = {
					first = FROM
					second = LIEGE
					value = 20
				}
			}
		}
		
		modifier = {
			factor = 2.0
			ROOT = {
				opinion_diff = {
					first = FROM
					second = LIEGE
					value = 30
				}
			}
		}
		
		modifier = {
			factor = 2.0
			ROOT = {
				opinion_diff = {
					first = FROM
					second = LIEGE
					value = 40
				}
			}
		}
		
		modifier = {
			factor = 0.01
			trait = content
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 2.0
			liege = {
				dynasty_realm_power = 0.25
			}
			ROOT = {
				liege = { 
					NOT = { dynasty = FROM }
				}
			}
		}
		
		modifier = {
			factor = 2.0
			liege = {
				dynasty_realm_power = 0.4
			}
			ROOT = {
				liege = { 
					NOT = { dynasty = FROM }
				}
			}
		}
		
		modifier = {
			factor = 0.01
			trait = imbecile
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.1
			trait = inbred
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.1
			trait = craven
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.2
			OR = {
				trait = slow
				trait = dull
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 1.5
			trait = proud
		}
		modifier = {
			factor = 1.5
			trait = brave
		}
		modifier = {
			factor = 1.5
			trait = arbitrary
		}
		modifier = {
			factor = 2.0
			trait = envious
		}
		modifier = {
			factor = 2.0
			trait = greedy
		}
		modifier = {
			factor = 2.0
			trait = impaler
		}
		modifier = {
			factor = 2.0
			trait = deceitful
		}
		modifier = {
			factor = 4.0
			trait = ambitious
		}
		modifier = {
			factor = 1.5
			NOT = { opinion = { who = LIEGE value = 0 } }
		}
		modifier = {
			factor = 1.5
			NOT = { opinion = { who = LIEGE value = -25 } }
		}
		modifier = {
			factor = 2.0
			NOT = { opinion = { who = LIEGE value = -50 } }
		}
		modifier = {
			factor = 4.0
			NOT = { opinion = { who = LIEGE value = -75 } }
		}
		modifier = {
			factor = 2
			OR = {
				has_opinion_modifier = { who = LIEGE modifier = opinion_evil_tyrant }
				has_opinion_modifier = { who = LIEGE modifier = opinion_tyrant }
			}
		}
	}
	
	success = {
		always = no
	}
	
	abort = {
		always = no		# Factions will abort if the Potential or Allow triggers are no longer valid
	}
	
	abort_effect = {
	}
	
	effect = {
	}
}

# The Permanent Regent will be backed by this faction if you attempt to depose them by war; the faction will otherwise not do anything
faction_regent_loyalists = {
	type = liege_titles
	cancel_on_leader_death = yes # The faction members might not approve of the new Regent, so let's have them start over...
	
	warning_level = 0.7 # At this level of faction power we give player an alert. Set to 0 for no alerts.
	
	# Plotter scope
	potential = {
		NOR = {
			trait = treasure_fleet_preparation
			trait = treasure_fleet_voyage
		}
		prisoner = no
		is_ruler = yes
		independent = no
		is_landed = yes
		is_adult = yes
		is_feudal = yes
		has_regent = no
		primary_title = { holy_order = no }
		trait = japanese_regent
		NOT = { trait = incapable }
		liege = {
			is_feudal = yes
			trait = under_regency
			regent = {
				character = ROOT
			}
		}
		OR = {
			religion = shinto
			AND = {
				culture_group = japonic
				religion = buddhist
			}
		}
		NOT = {
			any_demesne_title = {
				temporary = yes
			}
		}
		primary_title = { higher_tier_than = BARON }
	}
	
	# Target scope
	allow = {
		higher_tier_than = duke
		is_primary_holder_title = yes
		holder_scope = {
			primary_title = {
				ROOT = {
					tier = PREV
				}
			}
		}
	}
	
	# Faction member scope (ROOT = joiner, FROM = target)
	allow_join = {
		ROOT = {
			NOR = {
				trait = treasure_fleet_preparation
				trait = treasure_fleet_voyage
			}
			is_ruler = yes
			independent = no
			is_landed = yes
			is_adult = yes
			NOT = { trait = incapable }
			prisoner = no
			OR = {
				NOT = { has_dlc = "Zeus"}
				is_voter = no
				liege = { 
					OR = {
						is_council_content = no
						AND = {
							NOT = { primary_title = { has_law = war_voting_power_1 } }
							NOT = {
								trait = under_regency # If there is a Regent the council votes on wars by default...
							}
						}
						#has_council = no
					}
				}
				liege = {
					regent = {
						dynasty = ROOT # The Regent's family won't turn against the regent so easily!
					}
				}
			}
			NOT = {
				in_faction = faction_shogun # If you're trying to install a Shogun, you don't really support the Regent's rule
			}
		}
	}
	
	# AI creation weight
	chance = {
		factor = 1000 # The Regent always wants backers
	}
	
	# AI membership weight: ROOT is the prospective member. FROM is the faction leader. FROMFROM is the target title or character.
	membership = {
		factor = 1
		
		# The Regent's dynasty generally backs the Regent unless also the liege's dynasty
		modifier = {
			factor = 10
			dynasty = FROM
			liege = {
				NOT = {
					dynasty = ROOT
				}
			}
			opinion = {
				who = FROM
				value = 0
			}
			NOT = {
				any_rival = {
					character = FROM
				}
			}
		}
		
		# People that installed the Regent in the first place will back the Regent most of the time
		modifier = {
			factor = 5
			OR = {
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_fought_for_regent
				}
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_supported_as_regent
				}
			}
			opinion = {
				who = FROM
				value = 0
			}
			NOT = {
				any_rival = {
					character = FROM
				}
			}
		}
		
		# If the Regent has a Regency bloodline they'll be a bit more popular
		modifier = {
			factor = 2.5
			FROM = {
				any_owned_bloodline = {
					has_bloodline_flag = regency_bloodline
					bloodline_is_active_for = PREV
				}
			}
			OR = {
				dynasty = FROM
				NOT = {
					any_owned_bloodline = {
						has_bloodline_flag = regency_bloodline
						bloodline_is_active_for = PREV
					}
				}
			}
			liege = {
				NOT = {
					dynasty = ROOT
				}
			}
		}
		
		# I should be the regent instead...
		modifier = {
			factor = 0.1
			any_owned_bloodline = {
				has_bloodline_flag = regency_bloodline
				bloodline_is_active_for = PREV
			}
			NOT = {
				dynasty = FROM
			}
		}
		
		modifier = {
			factor = 0.5
			ROOT = {  
				liege = { 
					any_owned_bloodline = { has_bloodline_flag = bloodline_less_factions }
				}
			}
		}
		modifier = {
			factor = 0.2
			pacifist = yes
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 0
			OR = {
				prisoner = yes
				trait = incapable
				is_adult = no
				is_landed = no
				preparing_invasion = yes
			}
		}
		
		modifier = { # I do not join factions if I am the heir, unless the claimant is myself
			factor = 0
			FROMFROM = {
				holder_scope = {
					current_heir = {
						character = ROOT
					}
				}
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		# This is some weird foreign stuff...
		modifier = {
			factor = 0.1
			NOR = {
				religion = shinto
				AND = {
					religion = buddhist
					culture_group = japonic
				}
			}
		}
		
		modifier = { # If my liege is my dynasty, I don't want there to be a regent
			factor = 0
			liege = {
				dynasty = ROOT
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = { # Lower chance of joining if I myself has a claim on the same title
			factor = 0.1
			FROMFROM = {
				claimed_by = ROOT
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 0.1 # Unlikely, but not a full blocker
			opinion = { who = LIEGE value = 40 }
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = { # If the claimant is not me, make sure I like the claimant more than my current liege
			factor = 0
			
			OR = {
				NOT = {
					dynasty = FROM
				}
				liege = {
					dynasty = ROOT
				}
			}
			
			NOT = {
				ROOT = {
					OR = {
						AND = {
							NOT = { in_faction = faction_regent_loyalists }
							opinion_diff = {
								first = FROM
								second = LIEGE
								value = 10 # I like the regent more than the current ruler
							}
						}
						AND = {
							in_faction = faction_regent_loyalists
							opinion_diff = {
								first = FROM
								second = LIEGE
								value = -25
							}
						}
					}
				}
			}
			
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = { # If the claimant is not me, make sure I like the claimant more than my current liege
			factor = 0
			
			dynasty = FROM # We prefer the Regent a bit more if we are part of his dynasty
			liege = {
				NOT = {
					dynasty = ROOT
				}
			}
			
			NOT = {
				ROOT = {
					OR = {
						AND = {
							NOT = { in_faction = faction_regent_loyalists }
							opinion_diff = {
								first = FROM
								second = LIEGE
								value = 0 # I like the regent more than the current ruler
							}
						}
						AND = {
							in_faction = faction_regent_loyalists
							opinion_diff = {
								first = FROM
								second = LIEGE
								value = -50
							}
						}
					}
				}
			}
			
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 0
			has_opinion_modifier = {
				who = LIEGE
				modifier = opinion_coerced_into_leaving_faction
			}
		}
		
		modifier = {
			factor = 1000
			has_opinion_modifier = {
				who = FROM
				modifier = opinion_coerced_into_joining_faction
			}
		}
		
		modifier = {
			factor = 0.7
			NAND = {
				has_dlc = "Zeus"
				OR = {
					has_law = status_of_women_4
					has_religion_feature = religion_equal
					has_religion_feature = religion_feature_bon
					has_religion_feature = religion_feature_ryukyuan_three_mountains
					has_religion_feature = religion_feature_ryukyuan_historical
					has_religion_feature = religion_matriarchal
					has_game_rule = {
						name = gender
						value = all
					}
				}
			}
			FROM = {
				is_female = yes
				NOT = { character = ROOT }
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 2.0
			ROOT = {
				opinion_diff = {
					first = FROM
					second = LIEGE
					value = 20
				}
			}
		}
		
		modifier = {
			factor = 2.0
			ROOT = {
				opinion_diff = {
					first = FROM
					second = LIEGE
					value = 30
				}
			}
		}
		
		modifier = {
			factor = 2.0
			ROOT = {
				opinion_diff = {
					first = FROM
					second = LIEGE
					value = 40
				}
			}
		}
		
		modifier = {
			factor = 0.01
			trait = content
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 2.0
			liege = {
				dynasty_realm_power = 0.25
			}
			ROOT = {
				liege = { 
					NOT = { dynasty = FROM }
				}
			}
		}
		
		modifier = {
			factor = 2.0
			liege = {
				dynasty_realm_power = 0.4
			}
			ROOT = {
				liege = { 
					NOT = { dynasty = FROM }
				}
			}
		}
		
		modifier = {
			factor = 0.01
			trait = imbecile
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.1
			trait = inbred
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.1
			trait = craven
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.2
			OR = {
				trait = slow
				trait = dull
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 1.5
			trait = proud
		}
		modifier = {
			factor = 1.5
			trait = brave
		}
		modifier = {
			factor = 1.5
			trait = arbitrary
		}
		modifier = {
			factor = 2.0
			trait = envious
		}
		modifier = {
			factor = 2.0
			trait = greedy
		}
		modifier = {
			factor = 2.0
			trait = impaler
		}
		modifier = {
			factor = 2.0
			trait = deceitful
		}
		modifier = {
			factor = 4.0
			trait = ambitious
		}
		modifier = {
			factor = 1.5
			NOT = { opinion = { who = LIEGE value = 0 } }
		}
		modifier = {
			factor = 1.5
			NOT = { opinion = { who = LIEGE value = -25 } }
		}
		modifier = {
			factor = 2.0
			NOT = { opinion = { who = LIEGE value = -50 } }
		}
		modifier = {
			factor = 4.0
			NOT = { opinion = { who = LIEGE value = -75 } }
		}
		modifier = {
			factor = 2
			OR = {
				has_opinion_modifier = { who = LIEGE modifier = opinion_evil_tyrant }
				has_opinion_modifier = { who = LIEGE modifier = opinion_tyrant }
			}
		}
	}
	
	success = {
		always = no
	}
	
	abort = {
		always = no		# Factions will abort if the Potential or Allow triggers are no longer valid
	}
	
	abort_effect = {
	}
	
	effect = {
	}
}

# Powerful vassal that isn't the Permanent Regent can attempt to create a Shogunate; similar to both faction_claimant and faction_powerful_vassal_takeover
faction_shogun = {
	type = liege_titles
	cancel_on_leader_death = yes # The faction members might not approve of the new leader, so let's have them start over...
	
	warning_level = 0.7 # At this level of faction power we give player an alert. Set to 0 for no alerts.
	
	potential = {
		NOR = {
			trait = treasure_fleet_preparation
			trait = treasure_fleet_voyage
		}
		prisoner = no
		is_ruler = yes
		independent = no
		is_landed = yes
		is_adult = yes
		is_feudal = yes
		has_regent = no
		primary_title = { holy_order = no }
		OR = {
			NOT = { has_dlc = "Zeus" }
			is_voter = no
			liege = { 
				OR = {
					is_council_content = no
					AND = {
						NOT = { primary_title = { has_law = war_voting_power_1 } }
					}
					#has_council = no
					trait = under_regency
				}
			}
		}
		NOT = { trait = incapable }
		liege = {
			is_feudal = yes
			religion = shinto
			controls_religion = yes
			OR = {
				trait = under_regency # ONLY if theres's a Permanent Regency or you're part of a Shogunate bloodline
				ROOT = {
					any_owned_bloodline = {
						bloodline_is_active_for = PREV
						has_bloodline_flag = shogunate_bloodline
					}
				}
			}
			NOT = {
				any_demesne_title = {
					temporary = yes
				}
			}
			# The Tenno's own dynasty should try to take over k_chrysanthemum_throne AND the empire!
			NOT = {
				dynasty = ROOT
			}
		}
		NOT = {
			any_demesne_title = {
				temporary = yes
			}
		}
			
		
		NOR = {
			trait = japanese_regent # Can't be the Regent
			# Our dynasty can't currently control the Permanent Regency
			liege = {
				any_vassal = {
					dynasty = ROOT
					trait = japanese_regent
				}
			}
		}
			
		OR = {
			religion = shinto
			AND = {
				culture_group = japonic
				religion = buddhist
			}
		}
		
		# Only king-tier vassals, duke-tier members of a shogunate_bloodline, or very high prestige vassals can attempt this
		OR = {
			tier = king
			AND = {
				tier = duke
				any_owned_bloodline = {
					has_bloodline_flag = shogunate_bloodline
					bloodline_is_active_for = PREV
				}
				prestige = 1000
			}
			AND = {
				tier = duke
				prestige = 5000
			}
		}
		primary_title = { higher_tier_than = BARON }
		
		NOT = { has_character_modifier = faction_shogun_timer }
	}
	
	# Target scope
	allow = {
		tier = emperor # ONLY if the Tenno is an emperor
		is_primary_holder_title = yes
		holder_scope = {
			primary_title = {
				ROOT = {
					tier = PREV
				}
			}
		}
		holder_scope = {
			NOT = {
				any_war = {
					war_title = ROOT
					using_cb = shogunate_war
				}
			}
		}
		
		NOT = {
			holder_scope = {
				reverse_has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_leaving_faction
				}
			}
		}
	}
	
	# Faction member scope (ROOT = joiner, FROM = target)
	allow_join = {
		ROOT = {
			NOR = {
				trait = treasure_fleet_preparation
				trait = treasure_fleet_voyage
			}
			is_ruler = yes
			independent = no
			is_landed = yes
			is_adult = yes
			NOT = { trait = incapable }
			prisoner = no
			OR = {
				NOT = { has_dlc = "Zeus"}
				is_voter = no
				liege = { 
					OR = {
						is_council_content = no
						AND = {
							NOT = { primary_title = { has_law = war_voting_power_1 } }
						}
						#has_council = no
					}
					trait = under_regency
				}
			}
			# Neither the Tenno's dynasty, the Regent, or the Regent's dynasty can join
			NOT = {
				liege = {
					dynasty = ROOT
				}
			}
			NOR = {
				trait = japanese_regent
				liege = {
					any_vassal = {
						dynasty = ROOT
						trait = japanese_regent
					}
				}
			}
		}
	}
	
	# AI creation weight
	chance = {
		factor = 1
		modifier = {
			factor = 5
			FROM = {
				any_owned_bloodline = {
					has_bloodline_flag = shogunate_bloodline
					bloodline_is_active_for = PREV
				}
			}
		}
		
		modifier = {
			factor = 0.5
			holder_scope = {
				any_owned_bloodline = { has_bloodline_flag = bloodline_less_factions }
			}
		}
		modifier = {
			factor = 0.2
			FROM = { pacifist = yes }
		}			

		modifier = {
			factor = 0
			FROM = {
				OR = {
					leads_faction = faction_claimant
					in_faction = faction_claimant 
				}
			}
		}
		
		modifier = {
			factor = 0
			FROM = {
				OR = {
					prisoner = yes
					has_character_modifier = in_seclusion
				}
			}
		}
		
		modifier = {
			factor = 0
			holder_scope = {
				any_spouse = { character = FROM }
			}
		}
		
		modifier = { # The current heir is me
			factor = 0
			ROOT = {
				holder_scope = {
					current_heir = {
						character = FROM
					}
				}
			}
		}
		
		modifier = {
			factor = 0
			FROM = {
				OR = {
					AND = {
						NOT = { leads_faction = faction_shogun }
						opinion = { who = LIEGE value = 50 } 
					}
					AND = {
						leads_faction = faction_shogun
						opinion = { who = LIEGE value = 75 } 
					}
				}
			}
		}
		
		# If we're a claimant, let's try taking the throne instead...
		modifier = {
			factor = 0
			FROM = {
				has_claim = ROOT
			}
		}
		
		modifier = {
			factor = 0
			FROM = { preparing_invasion = yes }
		}
		
		modifier = {
			factor = 0
			FROM = { 
				opinion = { who = LIEGE value = 25 } 
				NOR = {
					trait = proud
					trait = deceitful
					trait = ambitious
					trait = envious
				}
			}
		}		
		
		modifier = {
			factor = 0
			FROM = {
				opinion = { who = LIEGE value = 50 } 
				OR = {
					trait = proud
					trait = deceitful
					trait = ambitious
					trait = envious
				}			
			}
		}
		
		modifier = {
			factor = 1.5
			NOT = { FROM = { opinion = { who = LIEGE value = 0 } } }
		}
		modifier = {
			factor = 1.5
			NOT = { FROM = { opinion = { who = LIEGE value = -25 } } }
		}
		modifier = {
			factor = 2.0
			NOT = { FROM = { opinion = { who = LIEGE value = -50 } } }
		}
		modifier = {
			factor = 4.0
			NOT = { FROM = { opinion = { who = LIEGE value = -75 } } }
		}
		
		modifier = {
			factor = 0.01
			FROM = { trait = content }
		}
		modifier = {
			factor = 0.01
			FROM = { trait = imbecile }
		}
		modifier = {
			factor = 0.1
			FROM = { trait = inbred }
		}
		modifier = {
			factor = 0.1
			FROM = { trait = craven }
		}
		modifier = {
			factor = 0.2
			FROM = { 
				OR = {
					trait = slow
					trait = dull
				}
			}
		}
		modifier = {
			factor = 0.5
			FROM = { trait = kind }
		}
		modifier = {
			factor = 0.5
			FROM = { trait = charitable }
		}
		modifier = {
			factor = 0.5
			FROM = { trait = honest }
		}
		modifier = {
			factor = 0.75
			FROM = { trait = humble }
		}
		modifier = {
			factor = 0.75
			FROM = { trait = just }
		}
		modifier = {
			factor = 1.5
			FROM = { trait = proud }
		}
		modifier = {
			factor = 1.5
			FROM = { trait = brave }
		}
		modifier = {
			factor = 1.5
			FROM = { trait = arbitrary }
		}
		modifier = {
			factor = 2.0
			FROM = { trait = envious }
		}
		modifier = {
			factor = 2.0
			FROM = { trait = greedy }
		}
		modifier = {
			factor = 2.0
			FROM = { trait = impaler }
		}
		modifier = {
			factor = 2.0
			FROM = { trait = deceitful }
		}
		modifier = {
			factor = 4.0
			FROM = { trait = ambitious }
		}
		modifier = {
			factor = 2
			FROM = {
				OR = {
					has_opinion_modifier = { who = LIEGE modifier = opinion_evil_tyrant }
					has_opinion_modifier = { who = LIEGE modifier = opinion_tyrant }
				}
			}
		}
	}
	
	# AI membership weight: ROOT is the prospective member. FROM is the faction leader. FROMFROM is the target title or character.
	membership = {
		factor = 1
		
		# I should be the Shogun instead...
		modifier = {
			factor = 0.1
			any_owned_bloodline = {
				has_bloodline_flag = shogunate_bloodline
				bloodline_is_active_for = PREV
			}
			NOT = {
				dynasty = FROM
			}
		}
		
		modifier = {
			factor = 0.5
			ROOT = {  
				liege = { 
					any_owned_bloodline = { has_bloodline_flag = bloodline_less_factions }
				}
			}
		}
		modifier = {
			factor = 0.2
			pacifist = yes
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 0
			OR = {
				leads_faction = faction_claimant
				in_faction = faction_claimant
			}
		}
		
		modifier = {
			factor = 0
			OR = {
				prisoner = yes
				trait = incapable
				is_adult = no
				is_landed = no
				preparing_invasion = yes
			}
		}
		
		modifier = { # I do not join factions if I am the heir, unless the claimant is myself
			factor = 0
			FROMFROM = {
				holder_scope = {
					current_heir = {
						character = ROOT
					}
				}
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		# This is some weird foreign stuff...
		modifier = {
			factor = 0.1
			NOR = {
				religion = shinto
				AND = {
					religion = buddhist
					culture_group = japonic
				}
			}
		}
		
		modifier = { # If my liege is my dynasty, I don't want there to be a Shogun
			factor = 0
			liege = {
				dynasty = ROOT
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = { # Lower chance of joining if I myself has a claim on the same title
			factor = 0.1
			FROMFROM = {
				claimed_by = ROOT
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 0
			has_character_modifier = faction_shogun_timer
		}
		
		modifier = {
			factor = 0
			opinion = { who = LIEGE value = 40 }
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = { # If the claimant is not me, make sure I like the claimant more than my current liege
			factor = 0
			
			NOT = {
				ROOT = {
					OR = {
						AND = {
							NOT = { in_faction = faction_shogun }
							opinion_diff = {
								first = FROM
								second = LIEGE
								value = 10 # I like the Shogun more than the Tenno
								as_if_liege = yes
							}
						}
						AND = {
							in_faction = faction_shogun
							opinion_diff = {
								first = FROM
								second = LIEGE
								value = -25
								as_if_liege = yes
							}
						}
					}
				}
			}
			
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 0
			has_opinion_modifier = {
				who = LIEGE
				modifier = opinion_coerced_into_leaving_faction
			}
		}
		
		modifier = {
			factor = 1000
			has_opinion_modifier = {
				who = FROM
				modifier = opinion_coerced_into_joining_faction
			}
		}
		
		modifier = {
			factor = 0.7
			NAND = {
				has_dlc = "Zeus"
				OR = {
					has_law = status_of_women_4
					has_religion_feature = religion_equal
					has_religion_feature = religion_feature_bon
					has_religion_feature = religion_feature_ryukyuan_three_mountains
					has_religion_feature = religion_feature_ryukyuan_historical
					has_religion_feature = religion_matriarchal
					has_game_rule = {
						name = gender
						value = all
					}
				}
			}
			FROM = {
				is_female = yes
				NOT = { character = ROOT }
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 2.0
			ROOT = {
				opinion_diff = {
					first = FROM
					second = LIEGE
					value = 20
				}
			}
		}
		
		modifier = {
			factor = 2.0
			ROOT = {
				opinion_diff = {
					first = FROM
					second = LIEGE
					value = 30
				}
			}
		}
		
		modifier = {
			factor = 2.0
			ROOT = {
				opinion_diff = {
					first = FROM
					second = LIEGE
					value = 40
				}
			}
		}
		
		modifier = {
			factor = 0.01
			trait = content
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.01
			trait = imbecile
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.1
			trait = inbred
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.1
			trait = craven
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.2
			OR = {
				trait = slow
				trait = dull
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.5
			trait = kind
		}
		modifier = {
			factor = 0.5
			trait = charitable
		}
		modifier = {
			factor = 0.5
			trait = honest
		}
		modifier = {
			factor = 0.75
			trait = humble
		}
		modifier = {
			factor = 0.75
			trait = just
		}
		modifier = {
			factor = 1.5
			trait = proud
		}
		modifier = {
			factor = 1.5
			trait = brave
		}
		modifier = {
			factor = 1.5
			trait = arbitrary
		}
		modifier = {
			factor = 2.0
			trait = envious
		}
		modifier = {
			factor = 2.0
			trait = greedy
		}
		modifier = {
			factor = 2.0
			trait = impaler
		}
		modifier = {
			factor = 2.0
			trait = deceitful
		}
		modifier = {
			factor = 4.0
			trait = ambitious
		}
		modifier = {
			factor = 1.5
			NOT = { opinion = { who = LIEGE value = 0 } }
		}
		modifier = {
			factor = 1.5
			NOT = { opinion = { who = LIEGE value = -25 } }
		}
		modifier = {
			factor = 2.0
			NOT = { opinion = { who = LIEGE value = -50 } }
		}
		modifier = {
			factor = 4.0
			NOT = { opinion = { who = LIEGE value = -75 } }
		}
		modifier = {
			factor = 2
			OR = {
				has_opinion_modifier = { who = LIEGE modifier = opinion_evil_tyrant }
				has_opinion_modifier = { who = LIEGE modifier = opinion_tyrant }
			}
		}
		modifier = {
			factor = 0.25 # If my dynasty wouldn't get the shogunate it is less important for me
			FROM = {
				NOT = {
					dynasty = ROOT
				}
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		# A family that's controlled the Shogunate has an easier time getting support
		modifier = {
			factor = 2
			NOT = {
				any_owned_bloodline = {
					has_bloodline_flag = shogunate_bloodline
					bloodline_is_active_for = PREV
				}
			}
			FROM = {
				any_owned_bloodline = {
					has_bloodline_flag = shogunate_bloodline
					bloodline_is_active_for = PREV
				}
			}
		}
	}
	
	success = {
		always = no
	}
	
	abort = {
		always = no		# Factions will abort if the Potential or Allow triggers are no longer valid
	}
	
	abort_effect = {
	}
	
	effect = {
	}
}

faction_oust_shogun = {
	type = liege_titles
	# Does not cancel on leader death; the leader is irrelevant!
	
	warning_level = 0.7 # At this level of faction power we give player an alert. Set to 0 for no alerts.
	
	potential = {
		NOR = {
			trait = treasure_fleet_preparation
			trait = treasure_fleet_voyage
		}
		prisoner = no
		is_ruler = yes
		independent = no
		is_landed = yes
		is_adult = yes
		has_regent = no
		is_feudal = yes
		primary_title = { holy_order = no }
		OR = {
			NOT = { has_dlc = "Zeus" }
			is_voter = no
			liege = { 
				OR = {
					is_council_content = no
					AND = {
						NOT = { primary_title = { has_law = war_voting_power_1 } }
					}
					#has_council = no
				}
			}
			# The Tenno can't be blocked from this faction by a council position; you hold HIS throne!
			AND = {
				religion = shinto
				controls_religion = yes
			}
		}
		NOT = { trait = incapable }
		liege = {
			is_feudal = yes
			OR = {
				religion = shinto
				AND = {
					culture_group = japonic
					religion = buddhist
				}
			}
			controls_religion = no
			NOT = {
				any_demesne_title = {
					temporary = yes
				}
			}
			any_vassal = {
				religion = shinto
				controls_religion = yes
			}
		}
		OR = {
			religion = shinto
			AND = {
				culture_group = japonic
				religion = buddhist
			}
		}
		NOT = {
			any_demesne_title = {
				temporary = yes
			}
		}
		primary_title = { higher_tier_than = BARON }
		
		NOT = { has_character_modifier = faction_oust_shogun_timer }
	}
	
	# Target scope
	allow = {
		tier = emperor # ONLY if the Tenno is an emperor
		is_primary_holder_title = yes
		holder_scope = {
			primary_title = {
				ROOT = {
					tier = PREV
				}
			}
		}
		
		holder_scope = {
			# The Shogun's own dynasty shouldn't try to oust the Shogun, unless the Tenno also is part of the same dynasty
			OR = {
				NOT = {
					dynasty = FROM
				}
				any_dynasty_member = {
					religion = shinto
					controls_religion = yes
				}
			}
			
			# Our dynasty can't currently control the Permanent Regency for the Shogun
			NOR = {
				trait = japanese_regent
				any_vassal = {
					dynasty = FROM
					trait = japanese_regent
				}
			}
		}
		
		NOT = {
			holder_scope = {
				reverse_has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_leaving_faction
				}
			}
		}
	}
	
	# Faction member scope (ROOT = joiner, FROM = target)
	allow_join = {
		ROOT = {
			NOR = {
				trait = treasure_fleet_preparation
				trait = treasure_fleet_voyage
			}
			is_ruler = yes
			independent = no
			is_landed = yes
			is_adult = yes
			NOT = { trait = incapable }
			prisoner = no
			OR = {
				NOT = { has_dlc = "Zeus"}
				is_voter = no
				liege = { 
					OR = {
						is_council_content = no
						AND = {
							NOT = { primary_title = { has_law = war_voting_power_1 } }
						}
						#has_council = no
					}
				}
				# The Tenno can't be blocked from this faction by a council position; you hold HIS throne!
				AND = {
					religion = shinto
					controls_religion = yes
				}
			}
			# The Shogun's own dynasty shouldn't try to oust the Shogun, unless the Tenno also is part of the same dynasty
			OR = {
				NOT = {
					liege = {
						dynasty = ROOT
					}
				}
				any_dynasty_member = {
					religion = shinto
					controls_religion = yes
				}
			}
			# The Shogun's Permanent Regent (if applicable) and the Regent's dynasty members shouldn't ever want to oust the Shogun unless they'd gain from it due to the Tenno being part of their dynasty
			OR = {
				NOR = {
					trait = japanese_regent
					liege = {
						any_vassal = {
							dynasty = ROOT
							trait = japanese_regent
						}
					}
				}
				any_dynasty_member = {
					religion = shinto
					controls_religion = yes
				}
			}
		}
	}
	
	# AI creation weight
	chance = {
		factor = 1
		modifier = {
			factor = 5
			FROM = {
				religion = shinto
				controls_religion = yes
			}
		}
		
		modifier = {
			factor = 0.5
			holder_scope = {
				any_owned_bloodline = { has_bloodline_flag = bloodline_less_factions }
			}
		}
		modifier = {
			factor = 0.2
			FROM = { pacifist = yes }
		}			

		modifier = {
			factor = 0
			FROM = {
				OR = {
					leads_faction = faction_claimant
					in_faction = faction_claimant 
				}
			}
		}
		
		modifier = {
			factor = 0
			FROM = {
				OR = {
					prisoner = yes
					has_character_modifier = in_seclusion
				}
			}
		}
		
		modifier = {
			factor = 0
			holder_scope = {
				any_spouse = { character = FROM }
			}
		}
		
		modifier = { # Title does NOT have Elective and the current heir is me
			factor = 0
			NOT = { has_law = succ_feudal_elective }
			NOT = { has_law = succ_hre_elective }
			ROOT = {
				holder_scope = {
					current_heir = {
						character = FROM
					}
				}
			}
		}
		
		modifier = {
			factor = 0
			FROM = {
				OR = {
					AND = {
						NOT = { leads_faction = faction_oust_shogun }
						opinion = { who = LIEGE value = 50 } 
					}
					AND = {
						leads_faction = faction_oust_shogun
						opinion = { who = LIEGE value = 75 } 
					}
				}
			}
		}
		
		# If we're a claimant, let's try taking the throne instead...
		modifier = {
			factor = 0
			FROM = {
				has_claim = ROOT
				NAND = {
					religion = shinto
					controls_religion = yes
				}
			}
		}
		
		modifier = {
			factor = 0
			FROM = { preparing_invasion = yes }
		}
		
		modifier = {
			factor = 0
			FROM = { 
				opinion = { who = LIEGE value = 25 } 
				NOR = {
					trait = proud
					trait = deceitful
					trait = ambitious
					trait = envious
				}
			}
		}		
		
		modifier = {
			factor = 0
			FROM = {
				opinion = { who = LIEGE value = 50 } 
				OR = {
					trait = proud
					trait = deceitful
					trait = ambitious
					trait = envious
				}			
			}
		}
		
		modifier = {
			factor = 1.5
			NOT = { FROM = { opinion = { who = LIEGE value = 0 } } }
		}
		modifier = {
			factor = 1.5
			NOT = { FROM = { opinion = { who = LIEGE value = -25 } } }
		}
		modifier = {
			factor = 2.0
			NOT = { FROM = { opinion = { who = LIEGE value = -50 } } }
		}
		modifier = {
			factor = 4.0
			NOT = { FROM = { opinion = { who = LIEGE value = -75 } } }
		}
		
		modifier = {
			factor = 0.01
			FROM = { trait = content }
		}
		modifier = {
			factor = 0.01
			FROM = { trait = imbecile }
		}
		modifier = {
			factor = 0.1
			FROM = { trait = inbred }
		}
		modifier = {
			factor = 0.1
			FROM = { trait = craven }
		}
		modifier = {
			factor = 0.2
			FROM = { 
				OR = {
					trait = slow
					trait = dull
				}
			}
		}
		modifier = {
			factor = 0.5
			FROM = { trait = kind }
		}
		modifier = {
			factor = 0.5
			FROM = { trait = charitable }
		}
		modifier = {
			factor = 0.5
			FROM = { trait = honest }
		}
		modifier = {
			factor = 0.75
			FROM = { trait = humble }
		}
		modifier = {
			factor = 0.75
			FROM = { trait = just }
		}
		modifier = {
			factor = 1.5
			FROM = { trait = proud }
		}
		modifier = {
			factor = 1.5
			FROM = { trait = brave }
		}
		modifier = {
			factor = 1.5
			FROM = { trait = arbitrary }
		}
		modifier = {
			factor = 2.0
			FROM = { trait = envious }
		}
		modifier = {
			factor = 2.0
			FROM = { trait = greedy }
		}
		modifier = {
			factor = 2.0
			FROM = { trait = impaler }
		}
		modifier = {
			factor = 2.0
			FROM = { trait = deceitful }
		}
		modifier = {
			factor = 4.0
			FROM = { trait = ambitious }
		}
		modifier = {
			factor = 2
			FROM = {
				OR = {
					has_opinion_modifier = { who = LIEGE modifier = opinion_evil_tyrant }
					has_opinion_modifier = { who = LIEGE modifier = opinion_tyrant }
				}
			}
		}
	}
	
	# AI membership weight: ROOT is the prospective member. FROM is the faction leader. FROMFROM is the target title or character.
	membership = {
		factor = 1
		
		# I should be the Shogun, not back the Tenno
		modifier = {
			factor = 0.1
			any_owned_bloodline = {
				has_bloodline_flag = shogunate_bloodline
				bloodline_is_active_for = PREV
			}
			NOR = {
				AND = {
					religion = shinto
					controls_religion = yes
				}
				any_dynasty_member = {
					religion = shinto
					controls_religion = yes
				}
			}
		}
		
		modifier = {
			factor = 0.5
			ROOT = {  
				liege = { 
					any_owned_bloodline = { has_bloodline_flag = bloodline_less_factions }
				}
			}
		}
		modifier = {
			factor = 0.2
			pacifist = yes
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 0
			OR = {
				leads_faction = faction_claimant
				in_faction = faction_claimant
			}
		}
		
		modifier = {
			factor = 0
			OR = {
				prisoner = yes
				trait = incapable
				is_adult = no
				is_landed = no
				preparing_invasion = yes
			}
		}
		
		modifier = { # I do not join factions if I am the heir, unless the claimant is myself
			factor = 0
			FROMFROM = {
				holder_scope = {
					current_heir = {
						character = ROOT
					}
				}
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		# This is some weird foreign stuff...
		modifier = {
			factor = 0.1
			NOR = {
				religion = shinto
				AND = {
					religion = buddhist
					culture_group = japonic
				}
			}
		}
		
		modifier = { # If my liege is my dynasty, I don't want there to be a Shogun
			factor = 0
			liege = {
				dynasty = ROOT
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = { # Lower chance of joining if I myself has a claim on the same title
			factor = 0.1
			FROMFROM = {
				claimed_by = ROOT
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 0
			has_character_modifier = faction_oust_shogun_timer
		}
		
		modifier = {
			factor = 0
			opinion = { who = LIEGE value = 40 }
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = { # If the claimant is not me, make sure I like the claimant more than my current liege
			factor = 0
			NAND = {
				religion = shinto
				controls_religion = yes
			}
			
			NOT = {
				k_chrysanthemum_throne = {
					holder_scope = {
						ROOT = {
							OR = {
								AND = {
									NOT = { in_faction = faction_oust_shogun }
									opinion_diff = {
										first = PREV
										second = LIEGE
										value = 10 # I like the Shogun more than the Tenno
										as_if_liege = yes
									}
								}
								AND = {
									in_faction = faction_oust_shogun
									opinion_diff = {
										first = PREV
										second = LIEGE
										value = -25
										as_if_liege = yes
									}
								}
							}
						}
					}
				}
			}
			
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 0
			has_opinion_modifier = {
				who = LIEGE
				modifier = opinion_coerced_into_leaving_faction
			}
		}
		
		modifier = {
			factor = 1000
			has_opinion_modifier = {
				who = FROM
				modifier = opinion_coerced_into_joining_faction
			}
		}
		
		modifier = {
			factor = 0.7
			NAND = {
				has_dlc = "Zeus"
				OR = {
					has_law = status_of_women_4
					has_religion_feature = religion_equal
					has_religion_feature = religion_feature_bon
					has_religion_feature = religion_feature_ryukyuan_three_mountains
					has_religion_feature = religion_feature_ryukyuan_historical
					has_religion_feature = religion_matriarchal
					has_game_rule = {
						name = gender
						value = all
					}
				}
			}
			k_chrysanthemum_throne = {
				holder_scope = {
					is_female = yes
					NOT = { character = ROOT }
				}
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 2.0
			k_chrysanthemum_throne = {
				holder_scope = {
					ROOT = {
						opinion_diff = {
							first = PREV
							second = LIEGE
							value = 20
						}
					}
				}
			}
		}
		
		modifier = {
			factor = 2.0
			k_chrysanthemum_throne = {
				holder_scope = {
					ROOT = {
						opinion_diff = {
							first = PREV
							second = LIEGE
							value = 30
						}
					}
				}
			}
		}
		
		modifier = {
			factor = 2.0
			k_chrysanthemum_throne = {
				holder_scope = {
					ROOT = {
						opinion_diff = {
							first = PREV
							second = LIEGE
							value = 40
						}
					}
				}
			}
		}
		
		modifier = {
			factor = 0.01
			trait = content
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.01
			trait = imbecile
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.1
			trait = inbred
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.1
			trait = craven
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.2
			OR = {
				trait = slow
				trait = dull
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.5
			trait = kind
		}
		modifier = {
			factor = 0.5
			trait = charitable
		}
		modifier = {
			factor = 0.5
			trait = honest
		}
		modifier = {
			factor = 0.75
			trait = humble
		}
		modifier = {
			factor = 0.75
			trait = just
		}
		modifier = {
			factor = 1.5
			trait = proud
		}
		modifier = {
			factor = 1.5
			trait = brave
		}
		modifier = {
			factor = 1.5
			trait = arbitrary
		}
		modifier = {
			factor = 2.0
			trait = envious
		}
		modifier = {
			factor = 2.0
			trait = greedy
		}
		modifier = {
			factor = 2.0
			trait = impaler
		}
		modifier = {
			factor = 2.0
			trait = deceitful
		}
		modifier = {
			factor = 4.0
			trait = ambitious
		}
		modifier = {
			factor = 1.5
			NOT = { opinion = { who = LIEGE value = 0 } }
		}
		modifier = {
			factor = 1.5
			NOT = { opinion = { who = LIEGE value = -25 } }
		}
		modifier = {
			factor = 2.0
			NOT = { opinion = { who = LIEGE value = -50 } }
		}
		modifier = {
			factor = 4.0
			NOT = { opinion = { who = LIEGE value = -75 } }
		}
		modifier = {
			factor = 2
			OR = {
				has_opinion_modifier = { who = LIEGE modifier = opinion_evil_tyrant }
				has_opinion_modifier = { who = LIEGE modifier = opinion_tyrant }
			}
		}
		modifier = {
			factor = 0.25 # If my dynasty wouldn't get the shogunate it is less important for me
			FROM = {
				NOT = {
					dynasty = ROOT
				}
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		# A family that's controlled the Shogunate has an easier time getting support
		modifier = {
			factor =  0.5
			liege = {
				any_owned_bloodline = {
					has_bloodline_flag = shogunate_bloodline
					bloodline_is_active_for = PREV
				}
			}
		}
	}
	
	success = {
		always = no
	}
	
	abort = {
		always = no		# Factions will abort if the Potential or Allow triggers are no longer valid
	}
	
	abort_effect = {
	}
	
	effect = {
	}
}

# A powerful vassal or councillor can attempt to become the regent - mostly based on faction_claimant
faction_regent2 = {
	type = liege_titles
	cancel_on_leader_death = yes # The faction members might not approve of the new leader, so let's have them start over...
	
	warning_level = 0.7 # At this level of faction power we give player an alert. Set to 0 for no alerts.
	
	# Plotter scope
	potential = {
		NOR = {
			trait = treasure_fleet_preparation
			trait = treasure_fleet_voyage
		}
		prisoner = no
		is_ruler = yes
		independent = no
		is_landed = yes
		is_adult = yes
		has_regent = no
		is_feudal = yes
		primary_title = { holy_order = no }
		OR = {
			NOT = { has_dlc = "Zeus" }
			is_voter = no
			liege = { 
				OR = {
					is_council_content = no
					AND = {
						NOT = { primary_title = { has_law = war_voting_power_1 } }
					}
					#has_council = no
				}
			}
		}
		NOT = { trait = incapable }
		liege = {
			tier = emperor
			is_feudal = yes
			OR = {
				AND = {
					religion = shinto
					controls_religion = no
				}
				AND = {
					religion = buddhist
					culture_group = japonic
				}
			}
			NOT = {
				government = chinese_imperial_government
			}
			has_regent = no
			NOT = {
				any_demesne_title = {
					temporary = yes
				}
			}
		}
		OR = {
			OR = {
				AND = {
					religion = shinto
					controls_religion = no
				}
				AND = {
					religion = buddhist
					culture_group = japonic
				}
			}
		}
		NOT = {
			any_demesne_title = {
				temporary = yes
			}
		}
		primary_title = { higher_tier_than = BARON }
		
		NOT = { has_character_modifier = faction_regent_timer }
	}
	
	# Target scope
	allow = {
		is_primary_holder_title = yes
		holder_scope = {
			primary_title = {
				ROOT = {
					tier = PREV
				}
			}
		}
		NOT = {
			holder_scope = {
				reverse_has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_leaving_faction
				}
			}
		}
	}
	
	# Faction member scope (ROOT = joiner, FROM = target)
	allow_join = {
		ROOT = {
			NOR = {
				trait = treasure_fleet_preparation
				trait = treasure_fleet_voyage
			}
			is_ruler = yes
			independent = no
			is_landed = yes
			is_adult = yes
			NOT = { trait = incapable }
			prisoner = no
			OR = {
				NOT = { has_dlc = "Zeus"}
				is_voter = no
				liege = { 
					OR = {
						is_council_content = no
						AND = {
							NOT = { primary_title = { has_law = war_voting_power_1 } }
						}
						#has_council = no
					}
				}
			}
			# The Tenno isn't interested in maintaining the Shogunate
			NAND = {
				religion = shinto
				controls_religion = yes
			}
		}
	}
	
	# AI creation weight
	chance = {
		factor = 1
		modifier = {
			factor = 5
			FROM = {
				any_owned_bloodline = {
					has_bloodline_flag = regency_bloodline
					bloodline_is_active_for = PREV
				}
			}
		}
		
		modifier = {
			factor = 0.5
			holder_scope = {
				any_owned_bloodline = { has_bloodline_flag = bloodline_less_factions }
			}
		}
		modifier = {
			factor = 0.2
			FROM = { pacifist = yes }
		}	
		
		modifier = {
			factor = 0
			FROM = {
				OR = {
					prisoner = yes
					has_character_modifier = in_seclusion
				}
			}
		}
		
		modifier = {
			factor = 0
			holder_scope = {
				any_spouse = { character = FROM }
			}
		}
		
		modifier = { # Title does NOT have Elective and the current heir is me
			factor = 0
			NOT = { has_law = succ_feudal_elective }
			NOT = { has_law = succ_hre_elective }
			ROOT = {
				holder_scope = {
					current_heir = {
						character = FROM
					}
				}
			}
		}
		
		modifier = { # Let's not give our own dynasty a regent...
			factor = 0
			holder_scope = {
				dynasty = FROM
			}
		}
		
		modifier = {
			factor = 0
			FROM = {
				OR = {
					AND = {
						NOT = { leads_faction = faction_regent2 }
						opinion = { who = LIEGE value = 50 } 
					}
					AND = {
						leads_faction = faction_regent2
						opinion = { who = LIEGE value = 75 } 
					}
				}
			}
		}
		
		# If we're a claimant, let's try taking the throne instead...
		modifier = {
			factor = 0
			FROM = {
				has_claim = ROOT
			}
		}
		
		modifier = {
			factor = 0
			FROM = { preparing_invasion = yes }
		}
		
		modifier = {
			factor = 0
			FROM = { 
				opinion = { who = LIEGE value = 25 } 
				NOR = {
					trait = deceitful
					trait = proud
					trait = ambitious
					trait = envious
				}
			}
		}		
		
		modifier = {
			factor = 0
			FROM = {
				opinion = { who = LIEGE value = 50 } 
				OR = {
					trait = deceitful
					trait = proud
					trait = ambitious
					trait = envious
				}			
			}
		}
		
		modifier = {
			factor = 1.5
			NOT = { FROM = { opinion = { who = LIEGE value = 0 } } }
		}
		modifier = {
			factor = 1.5
			NOT = { FROM = { opinion = { who = LIEGE value = -25 } } }
		}
		modifier = {
			factor = 2.0
			NOT = { FROM = { opinion = { who = LIEGE value = -50 } } }
		}
		modifier = {
			factor = 4.0
			NOT = { FROM = { opinion = { who = LIEGE value = -75 } } }
		}
		
		modifier = {
			factor = 0.01
			FROM = { trait = content }
		}
		modifier = {
			factor = 0.01
			FROM = { trait = imbecile }
		}
		modifier = {
			factor = 0.1
			FROM = { trait = inbred }
		}
		modifier = {
			factor = 0.1
			FROM = { trait = craven }
		}
		modifier = {
			factor = 0.2
			FROM = { 
				OR = {
					trait = slow
					trait = dull
				}
			}
		}
		modifier = {
			factor = 1.5
			FROM = { trait = brave }
		}
		modifier = {
			factor = 4.0
			FROM = { trait = ambitious }
		}
		modifier = {
			factor = 2
			FROM = {
				OR = {
					has_opinion_modifier = { who = LIEGE modifier = opinion_evil_tyrant }
					has_opinion_modifier = { who = LIEGE modifier = opinion_tyrant }
				}
			}
		}
	}
	
	# AI membership weight: ROOT is the prospective member. FROM is the faction leader. FROMFROM is the target title or character.
	membership = {
		factor = 1
		
		# I should be the regent instead...
		modifier = {
			factor = 0.1
			any_owned_bloodline = {
				has_bloodline_flag = regency_bloodline
				bloodline_is_active_for = PREV
			}
			NOT = {
				dynasty = FROM
			}
		}
		
		modifier = {
			factor = 0.5
			ROOT = {  
				liege = { 
					any_owned_bloodline = { has_bloodline_flag = bloodline_less_factions }
				}
			}
		}
		modifier = {
			factor = 0.2
			pacifist = yes
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 0
			OR = {
				prisoner = yes
				trait = incapable
				is_adult = no
				is_landed = no
				preparing_invasion = yes
			}
		}
		
		modifier = { # I do not join factions if I am the heir, unless the claimant is myself
			factor = 0
			FROMFROM = {
				holder_scope = {
					current_heir = {
						character = ROOT
					}
				}
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		# This is some weird foreign stuff...
		modifier = {
			factor = 0.1
			NOR = {
				religion = shinto
				AND = {
					religion = buddhist
					culture_group = japonic
				}
			}
		}
		
		modifier = { # If my liege is my dynasty, I don't want there to be a regent
			factor = 0
			liege = {
				dynasty = ROOT
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = { # Lower chance of joining if I myself has a claim on the same title
			factor = 0.1
			FROMFROM = {
				claimed_by = ROOT
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 0
			has_character_modifier = faction_regent_timer
		}
		
		modifier = {
			factor = 0
			opinion = { who = LIEGE value = 40 }
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = { # If the claimant is not me, make sure I like the claimant more than my current liege
			factor = 0
			
			NOT = {
				ROOT = {
					OR = {
						AND = {
							NOT = { in_faction = faction_regent2 }
							opinion_diff = {
								first = FROM
								second = LIEGE
								value = 10 # I like the regent more than the current ruler
							}
						}
						AND = {
							in_faction = faction_regent2
							opinion_diff = {
								first = FROM
								second = LIEGE
								value = -25
							}
						}
					}
				}
			}
			
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 0
			has_opinion_modifier = {
				who = LIEGE
				modifier = opinion_coerced_into_leaving_faction
			}
		}
		
		modifier = {
			factor = 1000
			has_opinion_modifier = {
				who = FROM
				modifier = opinion_coerced_into_joining_faction
			}
		}
		
		modifier = {
			factor = 0.7
			NAND = {
				has_dlc = "Zeus"
				OR = {
					has_law = status_of_women_4
					has_religion_feature = religion_equal
					has_religion_feature = religion_feature_bon
					has_religion_feature = religion_feature_ryukyuan_three_mountains
					has_religion_feature = religion_feature_ryukyuan_historical
					has_religion_feature = religion_matriarchal
					has_game_rule = {
						name = gender
						value = all
					}
				}
			}
			FROM = {
				is_female = yes
				NOT = { character = ROOT }
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 2.0
			ROOT = {
				opinion_diff = {
					first = FROM
					second = LIEGE
					value = 20
				}
			}
		}
		
		modifier = {
			factor = 2.0
			ROOT = {
				opinion_diff = {
					first = FROM
					second = LIEGE
					value = 30
				}
			}
		}
		
		modifier = {
			factor = 2.0
			ROOT = {
				opinion_diff = {
					first = FROM
					second = LIEGE
					value = 40
				}
			}
		}
		
		modifier = {
			factor = 0.01
			trait = content
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 2.0
			liege = {
				dynasty_realm_power = 0.25
			}
			ROOT = {
				liege = { 
					NOT = { dynasty = FROM }
				}
			}
		}
		
		modifier = {
			factor = 2.0
			liege = {
				dynasty_realm_power = 0.4
			}
			ROOT = {
				liege = { 
					NOT = { dynasty = FROM }
				}
			}
		}
		
		modifier = {
			factor = 0.01
			trait = imbecile
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.1
			trait = inbred
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.1
			trait = craven
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.2
			OR = {
				trait = slow
				trait = dull
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 1.5
			trait = proud
		}
		modifier = {
			factor = 1.5
			trait = brave
		}
		modifier = {
			factor = 1.5
			trait = arbitrary
		}
		modifier = {
			factor = 2.0
			trait = envious
		}
		modifier = {
			factor = 2.0
			trait = greedy
		}
		modifier = {
			factor = 2.0
			trait = impaler
		}
		modifier = {
			factor = 2.0
			trait = deceitful
		}
		modifier = {
			factor = 4.0
			trait = ambitious
		}
		modifier = {
			factor = 1.5
			NOT = { opinion = { who = LIEGE value = 0 } }
		}
		modifier = {
			factor = 1.5
			NOT = { opinion = { who = LIEGE value = -25 } }
		}
		modifier = {
			factor = 2.0
			NOT = { opinion = { who = LIEGE value = -50 } }
		}
		modifier = {
			factor = 4.0
			NOT = { opinion = { who = LIEGE value = -75 } }
		}
		modifier = {
			factor = 2
			OR = {
				has_opinion_modifier = { who = LIEGE modifier = opinion_evil_tyrant }
				has_opinion_modifier = { who = LIEGE modifier = opinion_tyrant }
			}
		}
	}
	
	success = {
		always = no
	}
	
	abort = {
		always = no		# Factions will abort if the Potential or Allow triggers are no longer valid
	}
	
	abort_effect = {
	}
	
	effect = {
	}
}

# The Permanent Regent will be backed by this faction if you attempt to depose them by war; the faction will otherwise not do anything
faction_regent_loyalists2 = {
	type = liege_titles
	cancel_on_leader_death = yes # The faction members might not approve of the new Regent, so let's have them start over...
	
	warning_level = 0.7 # At this level of faction power we give player an alert. Set to 0 for no alerts.
	
	# Plotter scope
	potential = {
		NOR = {
			trait = treasure_fleet_preparation
			trait = treasure_fleet_voyage
		}
		prisoner = no
		is_ruler = yes
		independent = no
		is_landed = yes
		is_adult = yes
		is_feudal = yes
		has_regent = no
		primary_title = { holy_order = no }
		trait = japanese_regent2
		NOT = { trait = incapable }
		liege = {
			is_feudal = yes
			trait = under_regency2
			regent = {
				character = ROOT
			}
		}
		OR = {
			AND = {
				religion = shinto
				controls_religion = no
			}
			AND = {
				culture_group = japonic
				religion = buddhist
			}
		}
		NOT = {
			any_demesne_title = {
				temporary = yes
			}
		}
		primary_title = { higher_tier_than = BARON }
	}
	
	# Target scope
	allow = {
		higher_tier_than = duke
		is_primary_holder_title = yes
		holder_scope = {
			primary_title = {
				ROOT = {
					tier = PREV
				}
			}
		}
	}
	
	# Faction member scope (ROOT = joiner, FROM = target)
	allow_join = {
		ROOT = {
			NOR = {
				trait = treasure_fleet_preparation
				trait = treasure_fleet_voyage
			}
			is_ruler = yes
			independent = no
			is_landed = yes
			is_adult = yes
			NOT = { trait = incapable }
			prisoner = no
			OR = {
				NOT = { has_dlc = "Zeus"}
				is_voter = no
				liege = { 
					OR = {
						is_council_content = no
						AND = {
							NOT = { primary_title = { has_law = war_voting_power_1 } }
							NOT = {
								trait = under_regency2 # If there is a Regent the council votes on wars by default...
							}
						}
						#has_council = no
					}
				}
				liege = {
					regent = {
						dynasty = ROOT # The Regent's family won't turn against the regent so easily!
					}
				}
			}
			OR = {
				AND = {
					religion = shinto
					controls_religion = no
				}
				AND = {
					culture_group = japonic
					religion = buddhist
				}
			}
			NOT = {
				in_faction = faction_oust_shogun # If you're seeking to end the Shogunate, you're not loyal to the regent
			}
		}
	}
	
	# AI creation weight
	chance = {
		factor = 1000 # The Regent always wants backers
	}
	
	# AI membership weight: ROOT is the prospective member. FROM is the faction leader. FROMFROM is the target title or character.
	membership = {
		factor = 1
		
		# The Regent's dynasty generally backs the Regent unless also the liege's dynasty or the Tenno's dynasty
		modifier = {
			factor = 10
			dynasty = FROM
			liege = {
				NOR = {
					dynasty = ROOT
					any_vassal = {
						religion = shinto
						controls_religion = yes
					}
				}
			}
			opinion = {
				who = FROM
				value = 0
			}
			NOT = {
				any_rival = {
					character = FROM
				}
			}
		}
		
		# People that installed the Regent in the first place will back the Regent most of the time
		modifier = {
			factor = 5
			OR = {
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_fought_for_regent
				}
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_supported_as_regent
				}
			}
			opinion = {
				who = FROM
				value = 0
			}
			NOT = {
				any_rival = {
					character = FROM
				}
			}
		}
		
		# If the Regent has a Regency bloodline they'll be a bit more popular
		modifier = {
			factor = 2.5
			FROM = {
				any_owned_bloodline = {
					has_bloodline_flag = regency_bloodline
					bloodline_is_active_for = PREV
				}
			}
			OR = {
				dynasty = FROM
				NOT = {
					any_owned_bloodline = {
						has_bloodline_flag = regency_bloodline
						bloodline_is_active_for = PREV
					}
				}
			}
			liege = {
				NOR = {
					dynasty = ROOT
					any_vassal = {
						religion = shinto
						controls_religion = yes
					}
				}
			}
		}
		
		# I should be the regent instead...
		modifier = {
			factor = 0.1
			any_owned_bloodline = {
				has_bloodline_flag = regency_bloodline
				bloodline_is_active_for = PREV
			}
			NOT = {
				dynasty = FROM
			}
		}
		
		modifier = {
			factor = 0.5
			ROOT = {  
				liege = { 
					any_owned_bloodline = { has_bloodline_flag = bloodline_less_factions }
				}
			}
		}
		modifier = {
			factor = 0.2
			pacifist = yes
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 0
			OR = {
				prisoner = yes
				trait = incapable
				is_adult = no
				is_landed = no
				preparing_invasion = yes
			}
		}
		
		modifier = { # I do not join factions if I am the heir, unless the claimant is myself
			factor = 0
			FROMFROM = {
				holder_scope = {
					current_heir = {
						character = ROOT
					}
				}
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		# This is some weird foreign stuff...
		modifier = {
			factor = 0.1
			NOR = {
				religion = shinto
				AND = {
					religion = buddhist
					culture_group = japonic
				}
			}
		}
		
		modifier = { # If my liege is my dynasty, I don't want there to be a regent
			factor = 0
			liege = {
				OR = {
					dynasty = ROOT
					any_vassal = {
						religion = shinto
						controls_religion = yes
					}
				}
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = { # Lower chance of joining if I myself has a claim on the same title
			factor = 0.1
			FROMFROM = {
				claimed_by = ROOT
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 0.1 # Unlikely, but not a full blocker
			opinion = { who = LIEGE value = 40 }
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = { # If the claimant is not me, make sure I like the claimant more than my current liege
			factor = 0
			
			OR = {
				NOT = {
					dynasty = FROM
				}
				liege = {
					OR = {
						dynasty = ROOT
						any_vassal = {
							religion = shinto
							controls_religion = yes
						}
					}
				}
			}
			
			NOT = {
				ROOT = {
					OR = {
						AND = {
							NOT = { in_faction = faction_regent_loyalists2 }
							opinion_diff = {
								first = FROM
								second = LIEGE
								value = 10 # I like the regent more than the current ruler
							}
						}
						AND = {
							in_faction = faction_regent_loyalists2
							opinion_diff = {
								first = FROM
								second = LIEGE
								value = -25
							}
						}
					}
				}
			}
			
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = { # If the claimant is not me, make sure I like the claimant more than my current liege
			factor = 0
			
			dynasty = FROM # We prefer the Regent a bit more if we are part of his dynasty
			liege = {
				OR = {
					dynasty = ROOT
					any_vassal = {
						religion = shinto
						controls_religion = yes
					}
				}
			}
			
			NOT = {
				ROOT = {
					OR = {
						AND = {
							NOT = { in_faction = faction_regent_loyalists2 }
							opinion_diff = {
								first = FROM
								second = LIEGE
								value = 0 # I like the regent more than the current ruler
							}
						}
						AND = {
							in_faction = faction_regent_loyalists2
							opinion_diff = {
								first = FROM
								second = LIEGE
								value = -50
							}
						}
					}
				}
			}
			
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 0
			has_opinion_modifier = {
				who = LIEGE
				modifier = opinion_coerced_into_leaving_faction
			}
		}
		
		modifier = {
			factor = 1000
			has_opinion_modifier = {
				who = FROM
				modifier = opinion_coerced_into_joining_faction
			}
		}
		
		modifier = {
			factor = 0.7
			NAND = {
				has_dlc = "Zeus"
				OR = {
					has_law = status_of_women_4
					has_religion_feature = religion_equal
					has_religion_feature = religion_feature_bon
					has_religion_feature = religion_feature_ryukyuan_three_mountains
					has_religion_feature = religion_feature_ryukyuan_historical
					has_religion_feature = religion_matriarchal
					has_game_rule = {
						name = gender
						value = all
					}
				}
			}
			FROM = {
				is_female = yes
				NOT = { character = ROOT }
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 2.0
			ROOT = {
				opinion_diff = {
					first = FROM
					second = LIEGE
					value = 20
				}
			}
		}
		
		modifier = {
			factor = 2.0
			ROOT = {
				opinion_diff = {
					first = FROM
					second = LIEGE
					value = 30
				}
			}
		}
		
		modifier = {
			factor = 2.0
			ROOT = {
				opinion_diff = {
					first = FROM
					second = LIEGE
					value = 40
				}
			}
		}
		
		modifier = {
			factor = 0.01
			trait = content
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 2.0
			liege = {
				dynasty_realm_power = 0.25
			}
			ROOT = {
				liege = { 
					NOT = { dynasty = FROM }
				}
			}
		}
		
		modifier = {
			factor = 2.0
			liege = {
				dynasty_realm_power = 0.4
			}
			ROOT = {
				liege = { 
					NOT = { dynasty = FROM }
				}
			}
		}
		
		modifier = {
			factor = 0.01
			trait = imbecile
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.1
			trait = inbred
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.1
			trait = craven
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.2
			OR = {
				trait = slow
				trait = dull
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 1.5
			trait = proud
		}
		modifier = {
			factor = 1.5
			trait = brave
		}
		modifier = {
			factor = 1.5
			trait = arbitrary
		}
		modifier = {
			factor = 2.0
			trait = envious
		}
		modifier = {
			factor = 2.0
			trait = greedy
		}
		modifier = {
			factor = 2.0
			trait = impaler
		}
		modifier = {
			factor = 2.0
			trait = deceitful
		}
		modifier = {
			factor = 4.0
			trait = ambitious
		}
		modifier = {
			factor = 1.5
			NOT = { opinion = { who = LIEGE value = 0 } }
		}
		modifier = {
			factor = 1.5
			NOT = { opinion = { who = LIEGE value = -25 } }
		}
		modifier = {
			factor = 2.0
			NOT = { opinion = { who = LIEGE value = -50 } }
		}
		modifier = {
			factor = 4.0
			NOT = { opinion = { who = LIEGE value = -75 } }
		}
		modifier = {
			factor = 2
			OR = {
				has_opinion_modifier = { who = LIEGE modifier = opinion_evil_tyrant }
				has_opinion_modifier = { who = LIEGE modifier = opinion_tyrant }
			}
		}
	}
	
	success = {
		always = no
	}
	
	abort = {
		always = no		# Factions will abort if the Potential or Allow triggers are no longer valid
	}
	
	abort_effect = {
	}
	
	effect = {
	}
}