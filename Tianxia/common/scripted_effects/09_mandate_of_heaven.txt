# Still a bit WIP

calculate_current_mandate_of_heaven_effect = {
	set_variable = {
		which = mandate_of_heaven
		value = 0
	}
	
	# Past trend - if no value exists, it is assumed to have been good
	if = {
		limit = {
			is_variable_equal = {
				which = old_mandate_of_heaven
				value = 0
			}
		}
		set_variable = {
			which = old_mandate_of_heaven
			value = 1000
		}
		set_variable = {
			which = old_mandate_of_heaven_2
			value = 500
		}
		set_variable = {
			which = old_mandate_of_heaven_3
			value = 250
		}
		set_variable = {
			which = old_mandate_of_heaven_4
			value = 100
		}
	}
	change_variable = {
		which = mandate_of_heaven
		which = old_mandate_of_heaven
	}
	change_variable = {
		which = mandate_of_heaven
		which = old_mandate_of_heaven_2
	}
	change_variable = {
		which = mandate_of_heaven
		which = old_mandate_of_heaven_3
	}
	change_variable = {
		which = mandate_of_heaven
		which = old_mandate_of_heaven_4
	}

	log = "MANDATE OF HEAVEN: Mandate after past trend is is [Root.mandate_of_heaven.GetValue]!"
	
	# Current Mandate level
	if = {
		limit = {
			has_character_modifier = mandate_of_heaven_5
		}
		change_variable = {
			which = mandate_of_heaven
			value = 1000
		}
	}
	else_if = {
		limit = {
			has_character_modifier = mandate_of_heaven_4
		}
		change_variable = {
			which = mandate_of_heaven
			value = 500
		}
	}
	else_if = {
		limit = {
			has_character_modifier = mandate_of_heaven_3
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	else_if = {
		limit = {
			has_character_modifier = mandate_of_heaven_2
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	else_if = {
		limit = {
			has_character_modifier = mandate_of_heaven_1
		}
		change_variable = {
			which = mandate_of_heaven
			value = -500
		}
	}

	log = "MANDATE OF HEAVEN: Mandate after current Mandate level is [Root.mandate_of_heaven.GetValue]!"
	
	# Stored yearly change from various places
	change_variable = {
		which = mandate_of_heaven
		which = stored_mandate_change
	}
	
	log = "MANDATE OF HEAVEN: [Root.GetTitledName]'s stored Mandate of Heaven value is [Root.stored_mandate_change.GetValue]!"

	log = "MANDATE OF HEAVEN: Mandate after stored value is [Root.mandate_of_heaven.GetValue]!"

	# From holding China or the existence of pretenders
	if = {
		limit = {
			has_landed_title = e_china
		}
		change_variable = {
			which = mandate_of_heaven
			value = 1000
		}
	}
	any_independent_ruler = {
		limit = {
			NOT = {
				character = ROOT
			}
			primary_title = {
				has_title_flag = pretender_chinese_empire
			}
		}
		ROOT = {
			change_variable = {
				which = mandate_of_heaven
				value = -500
			}
		}
	}

	log = "MANDATE OF HEAVEN: Mandate after pretenders is [Root.mandate_of_heaven.GetValue]!"
	
	### Traits
	# Education
	if = {
		limit = {
			OR = {
				# Poor education
				trait = naive_appeaser
				trait = misguided_warrior
				trait = indulgent_wastrel
				trait = amateurish_plotter
				trait = detached_priest
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	else_if = {
		limit = {
			OR = {
				# Middling education in relevant category
				trait = underhanded_rogue
				trait = thrifty_clerk
				trait = martial_cleric
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	else_if = {
		limit = {
			OR = {
				# Good education in irrelevant category
				trait = skilled_tactician
				trait = intricate_webweaver
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	else_if = {
		limit = {
			OR = {
				# Good education in relevant category
				trait = charismatic_negotiator
				trait = fortune_builder
				trait = scholarly_theologian
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	else_if = {
		limit = {
			OR = {
				# Great education in irrelevant category
				trait = brilliant_strategist
				trait = elusive_shadow
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	else_if = {
		limit = {
			OR = {
				# Great education in relevant category
				trait = grey_eminence
				trait = midas_touched
				trait = mastermind_theologian
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}

	log = "MANDATE OF HEAVEN: Mandate after education traits is [Root.mandate_of_heaven.GetValue]!"

	# Childhood
	if = {
		limit = {
			trait = affectionate # Diplomatic
		}
		change_variable = {
			which = mandate_of_heaven
			value = 25
		}
	}
	if = {
		limit = {
			trait = playful # Disorderly
		}
		change_variable = {
			which = mandate_of_heaven
			value = -25
		}
	}
	if = {
		limit = {
			trait = haughty # China sees itself as better than others
		}
		change_variable = {
			which = mandate_of_heaven
			value = 25
		}
	}
	if = {
		limit = {
			trait = rowdy # Disorderly
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = conscientious # Orderly
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			trait = fussy # China likes adhering to detailed rules
		}
		change_variable = {
			which = mandate_of_heaven
			value = 25
		}
	}
	if = {
		limit = {
			trait = brooding # China likes pondering things
		}
		change_variable = {
			which = mandate_of_heaven
			value = 25
		}
	}
	if = {
		limit = {
			trait = indolent # Unwilling to mentally exert themself
		}
		change_variable = {
			which = mandate_of_heaven
			value = -25
		}
	}
	if = {
		limit = {
			trait = willful # China is very particular about what it likes
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			trait = curious # Might become scholarly
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			trait = idolizer # Easily impressed
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = timid # China isn't timid
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}

	log = "MANDATE OF HEAVEN: Mandate after childhood traits is [Root.mandate_of_heaven.GetValue]!"

	# Health, diseases, symptoms, maimed
	if = {
		limit = {
			trait = depressed # Ruling China is supposed to feel good; something must be wrong with China if the EoC doesn't!
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			trait = drunkard # Gives in to excess
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			trait = immortal # Taoists might seek immortality, and if the EoC succeeds they must be great!
		}
		change_variable = {
			which = mandate_of_heaven
			value = 1000
		}
	}
	if = {
		limit = {
			trait = incapable # The ruler of China should be capable
		}
		change_variable = {
			which = mandate_of_heaven
			value = -1000
		}
	}
	if = {
		limit = {
			trait = infirm # The ruler of China shouldn't be infirm
		}
		change_variable = {
			which = mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			trait = lunatic # The ruler of China shouldn't be a lunatic
		}
		change_variable = {
			which = mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			trait = possessed # The ruler of China shouldn't be possessed
		}
		change_variable = {
			which = mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			trait = physician # Being well known as a learned person is good
		}
		change_variable = {
			which = mandate_of_heaven
			value = 500
		}
	}
	if = {
		limit = {
			trait = has_aztec_disease # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = has_typhus # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = cancer # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = has_tuberculosis # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = dancing_plague # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			trait = dysentery # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = flu # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			trait = food_poisoning # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			trait = gout # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			trait = syphilitic # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = ill # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = leper # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = has_measles # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = pneumonic # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = rabies # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = scurvy # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = sickly # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = has_small_pox # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = has_bubonic_plague # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			trait = abdominal_pain # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = chest_pain # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = cough # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = cramps # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = diarrhea # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = fatigue # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = fever # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = headache # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = infection # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = malaise # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = rash # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = vomiting # The ruler of China shouldn't be sick
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = disfigured # The ruler of China shouldn't be horribly disfigued
		}
		change_variable = {
			which = mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			trait = mangled # The ruler of China shouldn't be mangled
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = one_eyed # The ruler of China shouldn't be missing an eye
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = one_handed # The ruler of China shouldn't be missing a hand
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = one_legged # The ruler of China shouldn't be missing a leg
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = severely_injured # The ruler of China shouldn't be badly injured
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}

	log = "MANDATE OF HEAVEN: Mandate after health traits is [Root.mandate_of_heaven.GetValue]!"

	# Birth traits, genetic traits
	if = {
		limit = {
			trait = bastard # The ruler of China should not be a bastard
		}
		change_variable = {
			which = mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			trait = born_in_the_purple # Having other imperial claims isn't bad
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			trait = child_of_consort # Children of consorts are slightly penalized
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = child_of_consort_male # Children of consorts are slightly penalized
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			trait = legit_bastard # The ruler of China should not be a bastard, even if legitimized
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = fair # If they look good, they are probably a good ruler
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			trait = genius # Being smart is good
		}
		change_variable = {
			which = mandate_of_heaven
			value = 500
		}
	}
	if = {
		limit = {
			trait = quick # Being smart is good
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			trait = strong # Being strong is slightly good
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			trait = clubfooted # It would be better not to be clubfooted
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = dwarf # Won't be taken as seriously
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = harelip # Noticeable and bad
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			trait = hunchback # Noticeable and bad
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			trait = imbecile # The EoC should be smart
		}
		change_variable = {
			which = mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			trait = inbred # The EoC shouldn't be inbred
		}
		change_variable = {
			which = mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			trait = lisp # Slight negative
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = slow # THe EoC should be smart
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = stutter # Slightly bad
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = ugly # Noticeable and bad
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			trait = weak # It is better not to be weak
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = giant # Imposing
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			trait = lefthanded # Used to be stigmatized
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}

	log = "MANDATE OF HEAVEN: Mandate after genetic traits is [Root.mandate_of_heaven.GetValue]!"

	# Non-inheritable
	if = {
		limit = {
			trait = robust # Slightly good
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			trait = feeble # Slightly bad
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = shrewd # The EoC should be smart
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			trait = dull # The EoC should be smart
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = groomed # Looking good is good
		}
		change_variable = {
			which = mandate_of_heaven
			value = 25
		}
	}
	if = {
		limit = {
			trait = uncouth # Looking bad is bad
		}
		change_variable = {
			which = mandate_of_heaven
			value = -25
		}
	}

	log = "MANDATE OF HEAVEN: Mandate after non-inheritable traits is [Root.mandate_of_heaven.GetValue]!"

	# Lifestyles (and old lifestyles)
	if = {
		limit = {
			trait = administrator # Good ruler
		}
		change_variable = {
			which = mandate_of_heaven
			value = 500
		}
	}
	if = {
		limit = {
			trait = architect # Good ruler
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			trait = gamer # Probably smart
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			trait = gardener # Good ruler
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			trait = hedonist # Gives in to excess
		}
		change_variable = {
			which = mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			trait = impaler # Cruel
		}
		change_variable = {
			which = mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			trait = schemer # Probably smart
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			trait = seducer # Gives in to excess
		}
		change_variable = {
			which = mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			trait = seductress # Gives in to excess
		}
		change_variable = {
			which = mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			trait = mystic # Ritualistic
		}
		change_variable = {
			which = mandate_of_heaven
			value = 500
		}
	}
	if = {
		limit = {
			trait = scholar # Learned
		}
		change_variable = {
			which = mandate_of_heaven
			value = 500
		}
	}
	if = {
		limit = {
			trait = socializer # Diplomatic
		}
		change_variable = {
			which = mandate_of_heaven
			value = 500
		}
	}
	if = {
		limit = {
			trait = strategist # Probably smart
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			trait = theologian # Ritualistic
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			trait = celibate # Does not give in to excess
		}
		change_variable = {
			which = mandate_of_heaven
			value = 500
		}
	}
	if = {
		limit = {
			trait = poet # Probably smart
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}

	log = "MANDATE OF HEAVEN: Mandate after lifestyle traits is [Root.mandate_of_heaven.GetValue]!"

	# Personality (sins, virtues, others)
	if = {
		limit = {
			trait = chaste # Doesn't give in to excess
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			trait = temperate # Doesn't give in to excess
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			trait = charitable # Good
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			trait = diligent # Works hard
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			trait = patient # Calm
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			trait = kind # Good
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			trait = humble # China is not humble!
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = lustful # Gives in to excess
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			trait = gluttonous # Gives in to excess
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			trait = greedy # Gives in to excess
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			trait = slothful # Does not work hard
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = wroth # China shouldn't be wroth
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			trait = envious # China is obviously the best; why is the EoC envious of someone?
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = proud # Ruling China is obviously something to be proud of!
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			trait = ambitious # Goal-oriented
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			trait = arbitrary # China should follow its own laws!
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = brave # Good
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			trait = craven # China shouldn't be scared!
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			trait = cruel # China shouldn't be barbaric!
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = cynical # Don't have a negative view of things!
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			trait = deceitful # Crafty
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			trait = erudite # Learned
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			trait = gregarious # Well-spoken
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			trait = honest # Keeping your word is good
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			trait = just # China is obviously just
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			trait = paranoid # Everyone isn't out to get you!
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			trait = shy # China shouldn't be shy!
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = stubborn # China knows what China wants, and China expects what China wants!
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			trait = trusting # China isn't foolhardy
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			trait = zealous # Traditionalist
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}

	log = "MANDATE OF HEAVEN: Mandate after personality traits is [Root.mandate_of_heaven.GetValue]!"

	# Religious traits
	if = {
		limit = {
			trait = sympathy_christendom # China is Cosmopolitan
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			trait = sympathy_indian # China is Cosmopolitan, and the Eastern religions are closely related
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			trait = sympathy_islam # China is Cosmopolitan
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			trait = sympathy_judaism # China is Cosmopolitan
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			trait = sympathy_pagans # China is Cosmopolitan
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			trait = sympathy_zoroastrianism # China is Cosmopolitan
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			trait = pagan_branch_1 # China is Cosmopolitan
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			trait = pagan_branch_2 # China is Cosmopolitan
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}

	log = "MANDATE OF HEAVEN: Mandate after religious traits is [Root.mandate_of_heaven.GetValue]!"

	# Raiding traits
	if = {
		limit = {
			trait = viking # China shouldn't be barbaric!
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			trait = pirate # China shouldn't be barbaric!
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			trait = ravager # China shouldn't be barbaric!
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = seaking # China shouldn't be barbaric!
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = sea_queen # China shouldn't be barbaric!
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}

	log = "MANDATE OF HEAVEN: Mandate after raiding traits is [Root.mandate_of_heaven.GetValue]!"

	# Kinslayer traits
	if = {
		limit = {
			trait = tribal_kinslayer # The EoC shouldn't be a kinslayer
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = dynastic_kinslayer # The EoC shouldn't be a kinslayer
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = familial_kinslayer # The EoC shouldn't be a kinslayer
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = kinslayer # The EoC shouldn't be a kinslayer
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}

	log = "MANDATE OF HEAVEN: Mandate after kinslayer traits is [Root.mandate_of_heaven.GetValue]!"

	# Special traits
	if = {
		limit = {
			trait = adventurer # China shouldn't be barbaric!
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = augustus # Possesses another imperial claim
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			trait = blinded # The EoC shouldn't be blinded
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = cannibal_trait # China shouldn't be barbaric!
		}
		change_variable = {
			which = mandate_of_heaven
			value = -1000
		}
	}
	if = {
		limit = {
			trait = cat # China shouldn't be ruled by a cat!
		}
		change_variable = {
			which = mandate_of_heaven
			value = -1000
		}
	}
	if = {
		limit = {
			trait = excommunicated # China shouldn't be excommunicated (and it shouldn't ever happen)!
		}
		change_variable = {
			which = mandate_of_heaven
			value = -1000
		}
	}
	if = {
		limit = {
			trait = gladiator # China shouldn't be barbaric!
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = heresiarch # The EoC shouldn't be a heretic!
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = horse # China shouldn't be ruled by a horse!
		}
		change_variable = {
			which = mandate_of_heaven
			value = -1000
		}
	}
	if = {
		limit = {
			trait = in_hiding # The EoC shouldn't hide!
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			trait = lovers_pox # Sleeping around!
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			trait = peasant_leader # China shouldn't be ruled by an uppity peasant!
		}
		change_variable = {
			which = mandate_of_heaven
			value = -1000
		}
	}
	if = {
		limit = {
			trait = varangian # China shouldn't be barbaric!
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}

	log = "MANDATE OF HEAVEN: Mandate after special traits is [Root.mandate_of_heaven.GetValue]!"
	
	### Stats
	# Diplomacy
	if = {
		limit = {
			diplomacy = 20
		}
		change_variable = {
			which = mandate_of_heaven
			value = 500
		}
	}
	else_if = {
		limit = {
			diplomacy = 16
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	else_if = {
		limit = {
			diplomacy = 12
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	else_if = {
		limit = {
			NOT = {
				diplomacy = 8
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	else = {
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	
	# Martial
	if = {
		limit = {
			martial = 20
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	else_if = {
		limit = {
			martial = 16
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	else_if = {
		limit = {
			martial = 12
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	else_if = {
		limit = {
			NOT = {
				martial = 8
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	else = {
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	
	# Stewardship
	if = {
		limit = {
			stewardship = 20
		}
		change_variable = {
			which = mandate_of_heaven
			value = 500
		}
	}
	else_if = {
		limit = {
			stewardship = 16
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	else_if = {
		limit = {
			stewardship = 12
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	else_if = {
		limit = {
			NOT = {
				stewardship = 8
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	else = {
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	
	# Intrigue
	if = {
		limit = {
			intrigue = 20
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	else_if = {
		limit = {
			intrigue = 16
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	else_if = {
		limit = {
			intrigue = 12
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	else_if = {
		limit = {
			NOT = {
				intrigue = 8
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	else = {
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	
	# Learning
	if = {
		limit = {
			learning = 20
		}
		change_variable = {
			which = mandate_of_heaven
			value = 500
		}
	}
	else_if = {
		limit = {
			learning = 16
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	else_if = {
		limit = {
			learning = 12
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	else_if = {
		limit = {
			NOT = {
				learning = 8
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	else = {
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	
	log = "MANDATE OF HEAVEN: Mandate after stats is [Root.mandate_of_heaven.GetValue]!"
	
	
	# Culture
	if = {
		limit = {
			NOT = {
				has_acceptable_chinese_culture_no_gamerule_trigger = yes # With the game rule to allow it
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -500
		}
	}
	else_if = {
		limit = {
			NOT = {
				culture_group = chinese_group # China should ideally be Chinese
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	else_if = {
		limit = {
			culture = han # China should ideally be Han
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			religion = taoist # China should ideally be Taoist
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	else_if = {
		limit = {
			NOR = { # Preferred religions, even if others are allowd
				religion = taoist
				religion = buddhist
				religion = chinese_pagan
				religion = chinese_pagan_reformed
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	
	log = "MANDATE OF HEAVEN: Mandate after culture and religion is [Root.mandate_of_heaven.GetValue]!"
	
	### De jure countrol and control of China + status of the realm
	
	# Control of China + de jure
	any_province = {
		limit = {
			county = {
				OR = {
					region = world_china
					ROOT = {
						primary_title = {
							de_jure_vassal_or_below = PREVPREV
						}
					}
				}
				holder_scope = {
					NOR = {
						character = ROOT
						any_liege = {
							OR = {
								character = ROOT
								liege_before_war = {
									character = ROOT
								}
							}
						}
						liege_before_war = {
							character = ROOT
						}
					} 
				}
			}
		}
		ROOT = {
			change_variable = {
				which = mandate_of_heaven
				value = -5
			}
		}
	}
	
	# Diseased, Depopulated, or Prospering provinces in the realm
	any_realm_province = {
		if = {
			limit = {
				has_epidemic = yes
			}
			if = {
				limit = {
					county = {
						OR = {
							region = world_china
							ROOT = {
								primary_title = {
									de_jure_vassal_or_below = PREVPREV
								}
							}
						}
					}
				}
				ROOT = {
					change_variable = {
						which = mandate_of_heaven
						value = -5
					}
				}
			}
			else = {
				ROOT = {
					change_variable = {
						which = mandate_of_heaven
						value = -2
					}
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = depopulated_3
			}
			if = {
				limit = {
					county = {
						OR = {
							region = world_china
							ROOT = {
								primary_title = {
									de_jure_vassal_or_below = PREVPREV
								}
							}
						}
					}
				}
				ROOT = {
					change_variable = {
						which = mandate_of_heaven
						value = -10
					}
				}
			}
			else = {
				ROOT = {
					change_variable = {
						which = mandate_of_heaven
						value = -5
					}
				}
			}
		}
		else_if = {
			limit = {
				has_province_modifier = depopulated_2
			}
			if = {
				limit = {
					county = {
						OR = {
							region = world_china
							ROOT = {
								primary_title = {
									de_jure_vassal_or_below = PREVPREV
								}
							}
						}
					}
				}
				ROOT = {
					change_variable = {
						which = mandate_of_heaven
						value = -5
					}
				}
			}
			else = {
				ROOT = {
					change_variable = {
						which = mandate_of_heaven
						value = -2
					}
				}
			}
		}
		else_if = {
			limit = {
				has_province_modifier = depopulated_1
			}
			if = {
				limit = {
					county = {
						OR = {
							region = world_china
							ROOT = {
								primary_title = {
									de_jure_vassal_or_below = PREVPREV
								}
							}
						}
					}
				}
				ROOT = {
					change_variable = {
						which = mandate_of_heaven
						value = -2
					}
				}
			}
			else = {
				ROOT = {
					change_variable = {
						which = mandate_of_heaven
						value = -1
					}
				}
			}
		}
		else_if = {
			limit = {
				has_province_modifier = prosperity_modifier_1
			}
			if = {
				limit = {
					county = {
						OR = {
							region = world_china
							ROOT = {
								primary_title = {
									de_jure_vassal_or_below = PREVPREV
								}
							}
						}
					}
				}
				ROOT = {
					change_variable = {
						which = mandate_of_heaven
						value = 2
					}
				}
			}
			else = {
				ROOT = {
					change_variable = {
						which = mandate_of_heaven
						value = 1
					}
				}
			}
		}
		else_if = {
			limit = {
				has_province_modifier = prosperity_modifier_2
			}
			if = {
				limit = {
					county = {
						OR = {
							region = world_china
							ROOT = {
								primary_title = {
									de_jure_vassal_or_below = PREVPREV
								}
							}
						}
					}
				}
				ROOT = {
					change_variable = {
						which = mandate_of_heaven
						value = 5
					}
				}
			}
			else = {
				ROOT = {
					change_variable = {
						which = mandate_of_heaven
						value = 2
					}
				}
			}
		}
		else_if = {
			limit = {
				has_province_modifier = prosperity_modifier_3
			}
			if = {
				limit = {
					county = {
						OR = {
							region = world_china
							ROOT = {
								primary_title = {
									de_jure_vassal_or_below = PREVPREV
								}
							}
						}
					}
				}
				ROOT = {
					change_variable = {
						which = mandate_of_heaven
						value = 10
					}
				}
			}
			else = {
				ROOT = {
					change_variable = {
						which = mandate_of_heaven
						value = 5
					}
				}
			}
		}
	}
	
	log = "MANDATE OF HEAVEN: Mandate after realm status is [Root.mandate_of_heaven.GetValue]!"
	
	# Artefacts
	if = {
		limit = {
			has_artifact = heirloom_seal_of_the_realm
		}
		change_variable = {
			which = mandate_of_heaven
			value = 1000
		}
	}
	
	log = "MANDATE OF HEAVEN: Mandate after Heirloom Seal of the Realm check is [Root.mandate_of_heaven.GetValue]!"
	
	# Character modifiers
	if = {
		limit = {
			has_character_modifier = the_dungeon
		}
		change_variable = {
			which = mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			has_character_modifier = the_oubliette
		}
		change_variable = {
			which = mandate_of_heaven
			value = -1000
		}
	}
	if = {
		limit = {
			has_character_modifier = house_arrest
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = truce_breaker
		}
		change_variable = {
			which = mandate_of_heaven
			value = -1000
		}
	}
	if = {
		limit = {
			has_character_modifier = negative_money
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = the_merciful
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = the_bountiful
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = illumination
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = aspiring_poet
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = sweet_temptation
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = stay_strong
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = unrighteous_spouse
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = offended_moneylenders
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = diplomacy_advice
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = martial_advice
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = stewardship_advice
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = intrigue_advice
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = learning_advice
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = for_the_sake_of_love
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = chaste_learning
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = imprison_lawbreakers
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = kill_lawbreakers
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = modifier_witch
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = tortured_witch
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = spy_imprison
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = the_pompous
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = the_pitiful
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = the_judger
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = mod_ashamed
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = the_greedy
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = evil_rumours
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = slothful_ruler
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = the_cruel
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = the_alchemist
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = brazen_bull
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = master_impaler
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = chaste_learning
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = the_ruthless
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = gambler
		}
		change_variable = {
			which = mandate_of_heaven
			value = -10
		}
	}
	if = {
		limit = {
			has_character_modifier = whoremaster
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = proving_bravery
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = speaking_in_tounges
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = modifier_outfoxed
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = broken_spirit
		}
		change_variable = {
			which = mandate_of_heaven
			value = -1000
		}
	}
	if = {
		limit = {
			has_character_modifier = crushed_revolt
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = crushed_major_revolt
		}
		change_variable = {
			which = mandate_of_heaven
			value = 500
		}
	}
	if = {
		limit = {
			has_character_modifier = demon_child_non_pagan
		}
		change_variable = {
			which = mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			has_character_modifier = suspected_demon_spawn
		}
		change_variable = {
			which = mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			has_character_modifier = suspected_witch
		}
		change_variable = {
			which = mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			has_character_modifier = known_witch
		}
		change_variable = {
			which = mandate_of_heaven
			value = -1000
		}
	}
	if = {
		limit = {
			has_character_modifier = incestuous_adulterer
		}
		change_variable = {
			which = mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			has_character_modifier = incestuous_adulteress
		}
		change_variable = {
			which = mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			has_character_modifier = adulterer
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = adulteress
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = known_sodomite
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = known_sodomite_pagan
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = cradle_robber
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = wol_patriarch_1
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = wol_patriarch_2
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = wol_matriarch_1
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = wol_matriarch_2
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = wol_seducer_1
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = wol_seducer_2
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = wol_court_tomcat
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = wol_court_vixen
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = wol_respected_ruler
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = wol_legendary_wisdom
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = minor_disease_herpes
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = cannibal
		}
		change_variable = {
			which = mandate_of_heaven
			value = -1000
		}
	}
	if = {
		limit = {
			has_character_modifier = vicious_rumors
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = vicious_rumors_2
		}
		change_variable = {
			which = mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			has_character_modifier = unfaithful_rumors
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = known_murderer
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = studying_the_stars
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = heliocentrist_scholar
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = weird_scholar
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = the_necronomicon
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = ancient_wisdom
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = merciless
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = apprentice_boardgamer
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = religious_studies
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = religious_philosopher
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = disloyal_peasantry
		}
		change_variable = {
			which = mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			has_character_modifier = out_of_patience
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = groomed_to_perfection
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = commoners_abandoned
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = alliance_breaker
		}
		change_variable = {
			which = mandate_of_heaven
			value = -1000
		}
	}
	if = {
		limit = {
			has_character_modifier = broken_non_aggression_pact_char_modifier
		}
		change_variable = {
			which = mandate_of_heaven
			value = -1000
		}
	}
	if = {
		limit = {
			has_character_modifier = crazy_cannibal
		}
		change_variable = {
			which = mandate_of_heaven
			value = -1000
		}
	}
	if = {
		limit = {
			has_character_modifier = taking_it_easy
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = skull_trophy
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = skull_trophies
		}
		change_variable = {
			which = mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			has_character_modifier = graverobber
		}
		change_variable = {
			which = mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			has_character_modifier = severe_illness
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = bedridden_illness
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = astounding_visions
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = uplifting_visions
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = frightening_visions
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = withdrawal_symptoms
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = foolish_behavior
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = corrupting_magic_minor
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = corrupting_magic_major
		}
		change_variable = {
			which = mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			has_character_modifier = patron_of_the_arts
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = preserver_of_poetry
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = published_poet
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = popular_ruler
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = under_suspicion
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = highly_suspect
		}
		change_variable = {
			which = mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			has_character_modifier = played_strategy_game
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = discussed_scripture
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = discussed_realm_management
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = caught_red_handed
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = caught_stealing_artifact_penance
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = mediator
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = apathetic
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = cheap_laboratory
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = normal_laboratory
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = good_laboratory
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = great_laboratory
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = best_laboratory
		}
		change_variable = {
			which = mandate_of_heaven
			value = 500
		}
	}
	if = {
		limit = {
			has_character_modifier = good_battle_omen
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = bad_battle_omen
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = good_relationship_omen
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = bad_relationship_omen
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = good_power_omen
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = bad_power_omen
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = fulfilled_vision_great
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = fulfilled_vision_ok
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = fulfilled_vision_bad
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = fulfilled_vision_worst
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = stargazer
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = theoretical_alchemist
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = experimenting_alchemist
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = alchemy_good_ste_bonus
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = alchemy_ste_bonus
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = alchemy_ste_penalty
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = alchemy_bad_ste_penalty
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = astrology_good_dip_bonus
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = astrology_dip_bonus
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = astrology_dip_penalty
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = astrology_bad_dip_penalty
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = open_mind_good_lea_bonus
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = open_mind_lea_bonus
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = open_mind_lea_penalty
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = open_mind_bad_lea_penalty
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = hidden_truth_good_int_bonus
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = hidden_truth_int_bonus
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = hidden_truth_int_penalty
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = hidden_truth_bad_int_penalty
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = divine_summoning_failed
		}
		change_variable = {
			which = mandate_of_heaven
			value = -51000
		}
	}
	if = {
		limit = {
			has_character_modifier = divine_summoning_succeeded
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = theory_paper_heavy_investment
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = brilliant_insight
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = debater
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = horoscope_outcome_artist
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = horoscope_outcome_scatterbrain
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = horoscope_outcome_brute
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = horoscope_outcome_arrogant
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = horoscope_outcome_jittery
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = astronomical_insights_1
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = astronomical_insights_2
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = astronomical_insights_3
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = astronomical_insights_4
		}
		change_variable = {
			which = mandate_of_heaven
			value = 500
		}
	}
	if = {
		limit = {
			has_character_modifier = neglected_accounting
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = failed_to_predict_star_fall
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = published_theorem
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = tarnished_reputation
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = diplomatic_insight
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = martial_insight
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = intrigue_insight
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = learning_insight
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = stewardship_insight
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = accused_apostate
		}
		change_variable = {
			which = mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			has_character_modifier = jd_master_engineer
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50		}
	}
	if = {
		limit = {
			has_character_modifier = jd_administrator
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = employing_jd_administrator
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = employing_jd_administrator_golden_age
		}
		change_variable = {
			which = mandate_of_heaven
			value = 500
		}
	}
	if = {
		limit = {
			has_character_modifier = jd_strategist
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = impressive_treasury
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = cowardly_infanticide
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = munificent_modifier
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = jolly_matron_modifier
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = jolly_patriarch_modifier
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = tireless_worker
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = emptied_library
		}
		change_variable = {
			which = mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			has_character_modifier = hitting_the_books
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = antagonize_slandering_vassals
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = antagonize_slandering_relatives
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = luxurious_crown_modifier
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = popular_modifier
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = divination_crit_success
		}
		change_variable = {
			which = mandate_of_heaven
			value = 500
		}
	}
	if = {
		limit = {
			has_character_modifier = divination_success
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = divination_failure
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = divination_crit_failure
		}
		change_variable = {
			which = mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			has_character_modifier = callous
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = intimidated_plotters
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = well_spoken
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = confused_by_diplomacy
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = jumbling_words
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = confused_by_warfare
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = unrespected_general
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = well_governed
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = confused_by_governing
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = good_image
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = bad_image
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = unpopular_image
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = well_written
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = terrible_writer
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = strange_mind
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = clever_planner
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = inspiring_presence
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = motivated_ruler
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = bad_image
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = charismatic_leader
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = demon_horns
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = astrology_very_good_omen
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = astrology_good_omen
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = astrology_ambiguous_omen
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = astrology_bad_omen
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = astrology_very_bad_omen
		}
		change_variable = {
			which = mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			has_character_modifier = cannibal_haruspicy_sacrifice
		}
		change_variable = {
			which = mandate_of_heaven
			value = -1000
		}
	}
	if = {
		limit = {
			has_character_modifier = intrigue_def_haruspicy_sacrifice
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = intrigue_att_haruspicy_sacrifice
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = stewardship_haruspicy_sacrifice
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = exploring_local_culture
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = well_versed_in_local_culture
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = cowardly_ruler
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = forging_legend_revisiting_laws_1
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = forging_legend_revisiting_laws_2
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = forging_legend_peasant_disobedience_1
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = forging_legend_peasant_disobedience_2
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = forging_legend_family_dedication_1
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = forging_legend_family_dedication_2
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = forging_legend_family_dedication_3
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = forging_legend_religious_squabble_1
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = forging_legend_religious_squabble_2
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = forging_legend_searching_philosophers_1
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = forging_legend_searching_philosophers_1
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}

	if = {
		limit = {
			has_character_modifier = forging_legend_searching_philosophers_3
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = forging_legend_building_infrastructure_1
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = forging_legend_building_infrastructure_2
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = forging_legend_building_infrastructure_3
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = forging_legend_building_zealotry_1
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = forging_legend_building_zealotry_2
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = forging_legend_censoring_arts_1
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = forging_legend_censoring_arts_2
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = forging_legend_censoring_arts_3
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = forging_legend_martial_law_1
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = forging_legend_martial_law_2
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = crucible_weapon_very_bad_omen
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = crucible_weapon_caught_heretic
		}
		change_variable = {
			which = mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			has_character_modifier = superstitious_ruler
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = naive_host
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = generous_host
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = calculating_host
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = ruthless_host
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = caught_with_forgery
		}
		change_variable = {
			which = mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			has_character_modifier = ate_beating_heart
		}
		change_variable = {
			which = mandate_of_heaven
			value = -1000
		}
	}
	if = {
		limit = {
			has_character_modifier = weak_leader_modifier
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = strong_leader_modifier
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = plundering_leader_modifier
		}
		change_variable = {
			which = mandate_of_heaven
			value = -500
		}
	}
	
	log = "MANDATE OF HEAVEN: Mandate after various modifiers is [Root.mandate_of_heaven.GetValue]!"
	
	# Grace modifiers
	if = {
		limit = {
			has_landed_title = e_china
		}
		if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_1
			}
			ROOT = {
				change_variable = {
					which = mandate_of_heaven
					value = -50
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_2
			}
			ROOT = {
				change_variable = {
					which = mandate_of_heaven
					value = -100
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_3
			}
			ROOT = {
				change_variable = {
					which = mandate_of_heaven
					value = -150
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_4
			}
			ROOT = {
				change_variable = {
					which = mandate_of_heaven
					value = -200
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_5
			}
			ROOT = {
				change_variable = {
					which = mandate_of_heaven
					value = -250
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_6
			}
			ROOT = {
				change_variable = {
					which = mandate_of_heaven
					value = -300
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_7
			}
			ROOT = {
				change_variable = {
					which = mandate_of_heaven
					value = -350
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_8
			}
			ROOT = {
				change_variable = {
					which = mandate_of_heaven
					value = -400
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_9
			}
			ROOT = {
				change_variable = {
					which = mandate_of_heaven
					value = -450
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_10
			}
			ROOT = {
				change_variable = {
					which = mandate_of_heaven
					value = -500
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_11
			}
			ROOT = {
				change_variable = {
					which = mandate_of_heaven
					value = -550
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_12
			}
			ROOT = {
				change_variable = {
					which = mandate_of_heaven
					value = -600
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_13
			}
			ROOT = {
				change_variable = {
					which = mandate_of_heaven
					value = -650
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_14
			}
			ROOT = {
				change_variable = {
					which = mandate_of_heaven
					value = -700
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_15
			}
			ROOT = {
				change_variable = {
					which = mandate_of_heaven
					value = -750
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_16
			}
			ROOT = {
				change_variable = {
					which = mandate_of_heaven
					value = -800
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_17
			}
			ROOT = {
				change_variable = {
					which = mandate_of_heaven
					value = -850
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_18
			}
			ROOT = {
				change_variable = {
					which = mandate_of_heaven
					value = -900
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_19
			}
			ROOT = {
				change_variable = {
					which = mandate_of_heaven
					value = -950
				}
			}
		}
	}
	
	log = "MANDATE OF HEAVEN: Mandate after Tribute/Boon modifiers is [Root.mandate_of_heaven.GetValue]!"
	
	### Prestige and piety
	
	# Prestige
	if = {
		limit = {
			prestige = 25000
		}
		change_variable = {
			which = mandate_of_heaven
			value = 1000
		}
	}
	else_if = {
		limit = {
			prestige = 20000
		}
		change_variable = {
			which = mandate_of_heaven
			value = 500
		}
	}
	else_if = {
		limit = {
			prestige = 15000
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	else_if = {
		limit = {
			prestige = 10000
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	else_if = {
		limit = {
			prestige = 5000
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	else_if = {
		limit = {
			NOT = {
				prestige = -5000
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -2500
		}
	}
	else_if = {
		limit = {
			NOT = {
				prestige = -4000
			}
		}
		ROOT = {
			change_variable = {
				which = mandate_of_heaven
				value = -1000
			}
		}
	}
	else_if = {
		limit = {
			NOT = {
				prestige = -3000
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -500
		}
	}
	else_if = {
		limit = {
			NOT = {
				prestige = -2000
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	else_if = {
		limit = {
			NOT = {
				prestige = -1000
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	else_if = {
		limit = {
			NOT = {
				prestige = 0
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	# Piety
	if = {
		limit = {
			piety = 5000
		}
		change_variable = {
			which = mandate_of_heaven
			value = 1000
		}
	}
	else_if = {
		limit = {
			piety = 4000
		}
		change_variable = {
			which = mandate_of_heaven
			value = 500
		}
	}
	else_if = {
		limit = {
			piety = 3000
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	else_if = {
		limit = {
			piety = 2000
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	else_if = {
		limit = {
			piety = 1000
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	else_if = {
		limit = {
			NOT = {
				piety = -1000
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -1000
		}
	}
	else_if = {
		limit = {
			NOT = {
				piety = -500
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -500
		}
	}
	else_if = {
		limit = {
			NOT = {
				piety = 0
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	
	log = "MANDATE OF HEAVEN: Mandate after prestige and piety is is [Root.mandate_of_heaven.GetValue]!"
	
	# Tributaries
	any_tributary = {
		if = {
			limit = {
				is_tributary = {
					type = chinese_client_state
				}
			}
			ROOT = {
				change_variable = {
					which = mandate_of_heaven
					value = 500
				}
			}
		}
		else_if= {
			limit = {
				is_tributary = {
					type = chinese_protectorate
				}
			}
			change_variable = {
				which = mandate_of_heaven
				value = 250
			}
		}
		else_if= {
			limit = {
				is_tributary = {
					type = chinese_imperial_protectorate
				}
			}
			change_variable = {
				which = mandate_of_heaven
				value = 100
			}
		}
		else = {
			# Peripheral Tributaries and misc. types
			ROOT = {
				change_variable = {
					which = mandate_of_heaven
					value = 50
				}
			}
		}
	}
	
	log = "MANDATE OF HEAVEN: Mandate after tributaries is [Root.mandate_of_heaven.GetValue]!"
	
	# Misc
	if = {
		limit = {
			war = yes # China should be at peace
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			any_war = { # In a civil war
				defender = {
					character = ROOT
				}
				attacker = {
					liege_before_war = {
						character = ROOT
					}
				}
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			NOT = {
				any_owned_bloodline = { # Related by blood to the founder of a Chinese dynasty
					has_bloodline_flag = real_chinese_imperial_bloodline
					bloodline_is_active_for = ROOT
				}
			}
		}
		if = {
			limit = {
				NOT = {
					any_owned_bloodline = { # Related by blood to the founder of a pretender dynasty (and not currently the EoC)
						has_bloodline_flag = pretender_chinese_imperial_bloodline
						bloodline_is_active_for = ROOT
					}
				}
			}
			change_variable = {
				which = mandate_of_heaven
				value = -500
			}
		}
		else = {
			change_variable = {
				which = mandate_of_heaven
				value = -250
			}
		}
	}
	any_realm_province = {
		ROOT = { # Having a bigger realm is good
			change_variable = {
				which = mandate_of_heaven
				value = 1
			}
		}
		any_neighbor_province = {
			limit = {
				has_owner = yes
				owner = {
					top_liege = {
						NOR = {
							character = ROOT
							suzerain = {
								character = ROOT
							}
						}
					}
				}
			}
			ROOT = { # Having an unsecured border is bad
				change_variable = {
					which = mandate_of_heaven
					value = -10
				}
			}
		}
	}
	if = {
		limit = {
			primary_title = {
				has_title_flag = five_dynasties_and_ten_kingdoms # The FDaTK realms are less likely to have a good Mandate
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			NOT = {
				age = 4 # Just a child
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -500
		}
	}
	else_if = {
		limit = {
			NOT = {
				age = 10 # Just a child
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	else_if = {
		limit = {
			NOT = {
				age = 16 # Just a child
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			is_female = yes
			primary_title = {
				has_law = status_of_women_0 # Sexism
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -500
		}
	}
	else_if = {
		limit = {
			is_female = yes
			primary_title = {
				has_law = status_of_women_1 # Sexism
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	else_if = {
		limit = {
			is_female = yes
			primary_title = {
				has_law = status_of_women_2 # Sexism
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	else_if = {
		limit = {
			is_female = yes
			primary_title = {
				has_law = status_of_women_3 # Sexism
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	
	log = "MANDATE OF HEAVEN: Mandate after misc stuff is [Root.mandate_of_heaven.GetValue]!"
	
	# Make it harder to reach either end of the scale
	if = {
		limit = {
			has_character_modifier = mandate_of_heaven_5
		}
		if = {
			limit = {
				check_variable = {
					which = mandate_of_heaven
					value = 0
				}
			}
			divide_variable = {
				which = mandate_of_heaven
				value = 2.5
			}
		}
		else = {
			multiply_variable = {
				which = mandate_of_heaven
				value = 2.5
			}
		}
	}
	else_if = {
		limit = {
			has_character_modifier = mandate_of_heaven_4
		}
		if = {
			limit = {
				check_variable = {
					which = mandate_of_heaven
					value = 0
				}
			}
			divide_variable = {
				which = mandate_of_heaven
				value = 1.25
			}
		}
		else = {
			multiply_variable = {
				which = mandate_of_heaven
				value = 1.25
			}
		}
	}
	else_if = {
		limit = {
			has_character_modifier = mandate_of_heaven_2
		}
		if = {
			limit = {
				check_variable = {
					which = mandate_of_heaven
					value = 0
				}
			}
			multiply_variable = {
				which = mandate_of_heaven
				value = 1.25
			}
		}
		else = {
			divide_variable = {
				which = mandate_of_heaven
				value = 1.25
			}
		}
	}
	else_if = {
		limit = {
			has_character_modifier = mandate_of_heaven_1
		}
		if = {
			limit = {
				check_variable = {
					which = mandate_of_heaven
					value = 0
				}
			}
			multiply_variable = {
				which = mandate_of_heaven
				value = 2.5
			}
		}
		else = {
			divide_variable = {
				which = mandate_of_heaven
				value = 2.5
			}
		}
	}
	
	log = "MANDATE OF HEAVEN: [Root.GetTitledName]'s Mandate of Heaven value is [Root.mandate_of_heaven.GetValue]!"
	
	# Save the last MoH values so that a positive/negative trend can be tracked
	set_variable = {
		which = old_mandate_of_heaven_4
		which = old_mandate_of_heaven_3
	}
	divide_variable = {
		which = old_mandate_of_heaven_4
		value = 5
	}
	set_variable = {
		which = old_mandate_of_heaven_3
		which = old_mandate_of_heaven_2
	}
	divide_variable = {
		which = old_mandate_of_heaven_3
		value = 5
	}
	set_variable = {
		which = old_mandate_of_heaven_2
		which = old_mandate_of_heaven
	}
	divide_variable = {
		which = old_mandate_of_heaven_2
		value = 2
	}
	set_variable = {
		which = old_mandate_of_heaven
		which = mandate_of_heaven
	}
	divide_variable = {
		which = old_mandate_of_heaven
		value = 2
	}
	set_variable = {
		which = stored_mandate_change
		value = 0
	}
}

potentially_change_current_mandate_of_heaven_level_effect = {
	# The Mandate of Heaven will tend to move towards average, though not too harshly
	
	clr_character_flag = new_mandate_of_heaven_5
	clr_character_flag = new_mandate_of_heaven_4
	clr_character_flag = new_mandate_of_heaven_3
	clr_character_flag = new_mandate_of_heaven_2
	clr_character_flag = new_mandate_of_heaven_1
	clr_character_flag = mandate_changed_bad
	clr_character_flag = mandate_changed_good
	
	if = {
		limit = {
			has_character_modifier = mandate_of_heaven_5
		}
		random_list = {
			80 = {
				modifier = {
					factor = 1.05
					check_variable = {
						which = mandate_of_heaven
						value = 1000
					}
				}
				modifier = {
					factor = 1.05
					check_variable = {
						which = mandate_of_heaven
						value = 1500
					}
				}
				modifier = {
					factor = 1.05
					check_variable = {
						which = mandate_of_heaven
						value = 2000
					}
				}
				modifier = {
					factor = 1.05
					check_variable = {
						which = mandate_of_heaven
						value = 2500
					}
				}
				modifier = {
					factor = 1.05
					check_variable = {
						which = mandate_of_heaven
						value = 3000
					}
				}
				modifier = {
					factor = 1.05
					check_variable = {
						which = mandate_of_heaven
						value = 3500
					}
				}
				modifier = {
					factor = 1.05
					check_variable = {
						which = mandate_of_heaven
						value = 4000
					}
				}
				modifier = {
					factor = 1.05
					check_variable = {
						which = mandate_of_heaven
						value = 4500
					}
				}
				modifier = {
					factor = 1.05
					check_variable = {
						which = mandate_of_heaven
						value = 5000
					}
				}
				modifier = {
					factor = 0.01
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = 0
						}
					}
				}
				modifier = { # A pretender will never have their Mandate unquestioned
					factor = 0
					primary_title = {
						has_title_flag = pretender_chinese_empire
					}
				}
				modifier = { # If there's a pretender, the Mandate of Heaven will not remain unquestioned for most rulers
					factor = 0
					any_independent_ruler = {
						primary_title = {
							has_title_flag = pretender_chinese_empire
						}
					}
					has_landed_title = e_china
					NOT = {
						has_character_flag = new_chinese_imperial_dynasty # A new dynasty in China can be unquestioned for a while, even with a pretender around
					}
				}
				set_character_flag = new_mandate_of_heaven_5
			}
			20 = {
				modifier = {
					factor = 1.2
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = 500
						}
					}
				}
				modifier = {
					factor = 1.2
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = 0
						}
					}
				}
				modifier = {
					factor = 1.2
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -500
						}
					}
				}
				modifier = {
					factor = 1.2
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -1000
						}
					}
				}
				modifier = {
					factor = 1.2
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -1500
						}
					}
				}
				modifier = {
					factor = 1.2
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -2000
						}
					}
				}
				modifier = {
					factor = 1.2
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -2500
						}
					}
				}
				modifier = {
					factor = 1.2
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -3000
						}
					}
				}
				modifier = {
					factor = 1.2
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -3500
						}
					}
				}
				modifier = {
					factor = 1.2
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -4000
						}
					}
				}
				modifier = {
					factor = 1.2
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -4500
						}
					}
				}
				modifier = {
					factor = 1.2
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -5000
						}
					}
				}
				modifier = {
					factor = 0.01
					check_variable = {
						which = mandate_of_heaven
						value = 1000
					}
				}
				set_character_flag = new_mandate_of_heaven_4
				set_character_flag = mandate_changed_bad
			}
		}
	}
	else_if = {
		limit = {
			has_character_modifier = mandate_of_heaven_4
		}
		random_list = {
			10 = {
				modifier = {
					factor = 1.05
					check_variable = {
						which = mandate_of_heaven
						value = 1000
					}
				}
				modifier = {
					factor = 1.05
					check_variable = {
						which = mandate_of_heaven
						value = 1500
					}
				}
				modifier = {
					factor = 1.05
					check_variable = {
						which = mandate_of_heaven
						value = 2000
					}
				}
				modifier = {
					factor = 1.05
					check_variable = {
						which = mandate_of_heaven
						value = 2500
					}
				}
				modifier = {
					factor = 1.05
					check_variable = {
						which = mandate_of_heaven
						value = 3000
					}
				}
				modifier = {
					factor = 1.05
					check_variable = {
						which = mandate_of_heaven
						value = 3500
					}
				}
				modifier = {
					factor = 1.05
					check_variable = {
						which = mandate_of_heaven
						value = 4000
					}
				}
				modifier = {
					factor = 1.05
					check_variable = {
						which = mandate_of_heaven
						value = 4500
					}
				}
				modifier = {
					factor = 1.05
					check_variable = {
						which = mandate_of_heaven
						value = 5000
					}
				}
				modifier = {
					factor = 0.01
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = 0
						}
					}
				}
				modifier = { # A pretender will never have their Mandate unquestioned
					factor = 0
					primary_title = {
						has_title_flag = pretender_chinese_empire
					}
				}
				modifier = { # If there's a pretender, the Mandate of Heaven will not remain unquestioned for most rulers
					factor = 0
					any_independent_ruler = {
						primary_title = {
							has_title_flag = pretender_chinese_empire
						}
					}
					has_landed_title = e_china
					NOT = {
						has_character_flag = new_chinese_imperial_dynasty # A new dynasty in China can be unquestioned for a while, even with a pretender around
					}
				}
				modifier = {
					factor = 0.1
					has_character_modifier = recent_mandate_change_good
				}
				set_character_flag = new_mandate_of_heaven_5
				set_character_flag = mandate_changed_good
			}
			75 = {
				set_character_flag = new_mandate_of_heaven_4
			}
			15 = {
				modifier = {
					factor = 1.2
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = 500
						}
					}
				}
				modifier = {
					factor = 1.2
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = 0
						}
					}
				}
				modifier = {
					factor = 1.2
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -500
						}
					}
				}
				modifier = {
					factor = 1.2
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -1000
						}
					}
				}
				modifier = {
					factor = 1.2
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -1500
						}
					}
				}
				modifier = {
					factor = 1.2
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -2000
						}
					}
				}
				modifier = {
					factor = 1.2
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -2500
						}
					}
				}
				modifier = {
					factor = 1.2
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -3000
						}
					}
				}
				modifier = {
					factor = 1.2
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -3500
						}
					}
				}
				modifier = {
					factor = 1.2
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -4000
						}
					}
				}
				modifier = {
					factor = 1.2
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -4500
						}
					}
				}
				modifier = {
					factor = 1.2
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -5000
						}
					}
				}
				modifier = {
					factor = 0.01
					check_variable = {
						which = mandate_of_heaven
						value = 1000
					}
				}
				modifier = {
					factor = 0.5
					has_landed_title = e_china
				}
				modifier = {
					factor = 0.1
					has_character_modifier = recent_mandate_change_bad
				}
				set_character_flag = new_mandate_of_heaven_3
				set_character_flag = mandate_changed_bad
			}
		}
	}
	else_if = {
		limit = {
			has_character_modifier = mandate_of_heaven_3
		}
		random_list = {
			5 = {
				modifier = {
					factor = 1.1
					check_variable = {
						which = mandate_of_heaven
						value = 1000
					}
				}
				modifier = {
					factor = 1.1
					check_variable = {
						which = mandate_of_heaven
						value = 1500
					}
				}
				modifier = {
					factor = 1.1
					check_variable = {
						which = mandate_of_heaven
						value = 2000
					}
				}
				modifier = {
					factor = 1.1
					check_variable = {
						which = mandate_of_heaven
						value = 2500
					}
				}
				modifier = {
					factor = 1.1
					check_variable = {
						which = mandate_of_heaven
						value = 3000
					}
				}
				modifier = {
					factor = 1.1
					check_variable = {
						which = mandate_of_heaven
						value = 3500
					}
				}
				modifier = {
					factor = 1.1
					check_variable = {
						which = mandate_of_heaven
						value = 4000
					}
				}
				modifier = {
					factor = 1.1
					check_variable = {
						which = mandate_of_heaven
						value = 4500
					}
				}
				modifier = {
					factor = 1.1
					check_variable = {
						which = mandate_of_heaven
						value = 5000
					}
				}
				modifier = {
					factor = 0.01
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = 0
						}
					}
				}
				modifier = { # The FDATK emperors won't get a good Mandate value
					factor = 0
					any_independent_ruler = {
						primary_title = {
							has_title_flag = five_dynasties_and_ten_kingdoms
						}
					}
				}
				modifier = { # It is hard to have a good Mandate level if you don't rule china
					factor = 0.1
					NOT = {
						has_landed_title = e_china
					}
				}
				modifier = {
					factor = 0.1
					has_character_modifier = recent_mandate_change_good
				}
				set_character_flag = new_mandate_of_heaven_4
				set_character_flag = mandate_changed_good
			}
			90 = {
				set_character_flag = new_mandate_of_heaven_3
			}
			5 = {
				modifier = {
					factor = 1.1
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = 500
						}
					}
				}
				modifier = {
					factor = 1.1
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = 0
						}
					}
				}
				modifier = {
					factor = 1.1
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -500
						}
					}
				}
				modifier = {
					factor = 1.1
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -1000
						}
					}
				}
				modifier = {
					factor = 1.1
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -1500
						}
					}
				}
				modifier = {
					factor = 1.1
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -2000
						}
					}
				}
				modifier = {
					factor = 1.1
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -2500
						}
					}
				}
				modifier = {
					factor = 1.1
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -3000
						}
					}
				}
				modifier = {
					factor = 1.1
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -3500
						}
					}
				}
				modifier = {
					factor = 1.1
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -4000
						}
					}
				}
				modifier = {
					factor = 1.1
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -4500
						}
					}
				}
				modifier = {
					factor = 1.1
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -5000
						}
					}
				}
				modifier = {
					factor = 0.01
					check_variable = {
						which = mandate_of_heaven
						value = 1000
					}
				}
				set_character_flag = new_mandate_of_heaven_2
				set_character_flag = mandate_changed_bad
			}
		}
	}
	else_if = {
		limit = {
			has_character_modifier = mandate_of_heaven_2
		}
		random_list = {
			15 = {
				modifier = {
					factor = 1.2
					check_variable = {
						which = mandate_of_heaven
						value = 1000
					}
				}
				modifier = {
					factor = 1.2
					check_variable = {
						which = mandate_of_heaven
						value = 1500
					}
				}
				modifier = {
					factor = 1.2
					check_variable = {
						which = mandate_of_heaven
						value = 2000
					}
				}
				modifier = {
					factor = 1.2
					check_variable = {
						which = mandate_of_heaven
						value = 2500
					}
				}
				modifier = {
					factor = 1.2
					check_variable = {
						which = mandate_of_heaven
						value = 3000
					}
				}
				modifier = {
					factor = 1.2
					check_variable = {
						which = mandate_of_heaven
						value = 3500
					}
				}
				modifier = {
					factor = 1.2
					check_variable = {
						which = mandate_of_heaven
						value = 4000
					}
				}
				modifier = {
					factor = 1.2
					check_variable = {
						which = mandate_of_heaven
						value = 4500
					}
				}
				modifier = {
					factor = 1.2
					check_variable = {
						which = mandate_of_heaven
						value = 5000
					}
				}
				modifier = {
					factor = 0.01
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = 0
						}
					}
				}
				modifier = { # The FDATK emperors won't get a good Mandate value
					factor = 0.1
					any_independent_ruler = {
						primary_title = {
							has_title_flag = five_dynasties_and_ten_kingdoms
						}
					}
				}
				modifier = { # It is hard to have a good Mandate level if you don't rule china
					factor = 0.5
					NOT = {
						has_landed_title = e_china
					}
				}
				modifier = {
					factor = 0.1
					has_character_modifier = recent_mandate_change_good
				}
				set_character_flag = new_mandate_of_heaven_3
				set_character_flag = mandate_changed_good
			}
			75 = {
				set_character_flag = new_mandate_of_heaven_2
			}
			10 = {
				modifier = {
					factor = 1.05
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = 500
						}
					}
				}
				modifier = {
					factor = 1.05
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = 0
						}
					}
				}
				modifier = {
					factor = 1.05
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -500
						}
					}
				}
				modifier = {
					factor = 1.05
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -1000
						}
					}
				}
				modifier = {
					factor = 1.05
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -1500
						}
					}
				}
				modifier = {
					factor = 1.05
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -2000
						}
					}
				}
				modifier = {
					factor = 1.05
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -2500
						}
					}
				}
				modifier = {
					factor = 1.05
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -3000
						}
					}
				}
				modifier = {
					factor = 1.05
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -3500
						}
					}
				}
				modifier = {
					factor = 1.05
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -4000
						}
					}
				}
				modifier = {
					factor = 1.05
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -4500
						}
					}
				}
				modifier = {
					factor = 1.05
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -5000
						}
					}
				}
				modifier = {
					factor = 0.01
					check_variable = {
						which = mandate_of_heaven
						value = 1000
					}
				}
				modifier = {
					factor = 0.5
					has_landed_title = e_china
				}
				modifier = {
					factor = 0.1
					has_character_modifier = recent_mandate_change_bad
				}
				set_character_flag = new_mandate_of_heaven_1
				set_character_flag = mandate_changed_bad
			}
		}
	}
	else_if = {
		limit = {
			has_character_modifier = mandate_of_heaven_1
		}
		random_list = {
			20 = {
				modifier = {
					factor = 1.2
					check_variable = {
						which = mandate_of_heaven
						value = 1000
					}
				}
				modifier = {
					factor = 1.2
					check_variable = {
						which = mandate_of_heaven
						value = 1500
					}
				}
				modifier = {
					factor = 1.2
					check_variable = {
						which = mandate_of_heaven
						value = 2000
					}
				}
				modifier = {
					factor = 1.2
					check_variable = {
						which = mandate_of_heaven
						value = 2500
					}
				}
				modifier = {
					factor = 1.2
					check_variable = {
						which = mandate_of_heaven
						value = 3000
					}
				}
				modifier = {
					factor = 1.2
					check_variable = {
						which = mandate_of_heaven
						value = 3500
					}
				}
				modifier = {
					factor = 1.2
					check_variable = {
						which = mandate_of_heaven
						value = 4000
					}
				}
				modifier = {
					factor = 1.2
					check_variable = {
						which = mandate_of_heaven
						value = 4500
					}
				}
				modifier = {
					factor = 1.2
					check_variable = {
						which = mandate_of_heaven
						value = 5000
					}
				}
				modifier = {
					factor = 0.01
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = 0
						}
					}
				}
				modifier = { # The FDATK emperors won't get a good Mandate value
					factor = 0.5
					any_independent_ruler = {
						primary_title = {
							has_title_flag = five_dynasties_and_ten_kingdoms
						}
					}
				}
				modifier = { # It is hard to have a good Mandate level if you don't rule China
					factor = 0.9
					NOT = {
						has_landed_title = e_china
					}
				}
				set_character_flag = new_mandate_of_heaven_2
				set_character_flag = mandate_changed_good
			}
			80 = {
				modifier = {
					factor = 1.05
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = 500
						}
					}
				}
				modifier = {
					factor = 1.05
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = 0
						}
					}
				}
				modifier = {
					factor = 1.05
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -500
						}
					}
				}
				modifier = {
					factor = 1.05
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -1000
						}
					}
				}
				modifier = {
					factor = 1.05
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -1500
						}
					}
				}
				modifier = {
					factor = 1.05
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -2000
						}
					}
				}
				modifier = {
					factor = 1.05
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -2500
						}
					}
				}
				modifier = {
					factor = 1.05
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -3000
						}
					}
				}
				modifier = {
					factor = 1.05
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -3500
						}
					}
				}
				modifier = {
					factor = 1.05
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -4000
						}
					}
				}
				modifier = {
					factor = 1.05
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -4500
						}
					}
				}
				modifier = {
					factor = 1.05
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -5000
						}
					}
				}
				modifier = {
					factor = 0.01
					check_variable = {
						which = mandate_of_heaven
						value = 1000
					}
				}
				set_character_flag = new_mandate_of_heaven_1
			}
		}
	}
	else = { # Shouldn't happen a lot, but best to be certain it isn't frequent...
		if = {
			limit = {
				OR = {
					has_character_flag = new_chinese_imperial_dynasty
					has_landed_title = e_china
				}
				primary_title = {
					NOR = {
						has_title_flag = pretender_chinese_empire
						has_title_flag = five_dynasties_and_ten_kingdoms
					}
				}
			}
			set_character_flag = new_mandate_of_heaven_4
		}
		else = {
			set_character_flag = new_mandate_of_heaven_3
		}
		log = "MANDATE OF HEAVEN: [Root.GetTitledName]'s Mandate of Heaven calculation used the fallback option!"
	}
}


update_mandate_of_heaven_law_and_modifier_effect = {
	remove_character_modifier = mandate_of_heaven_5
	remove_character_modifier = mandate_of_heaven_4
	remove_character_modifier = mandate_of_heaven_3
	remove_character_modifier = mandate_of_heaven_2
	remove_character_modifier = mandate_of_heaven_1
	if = {
		limit = {
			has_game_rule = {
				name = mandate_of_heaven
				value = enabled
			}
		}
		if = {
			limit = {
				has_character_flag = new_mandate_of_heaven_5
			}
			add_character_modifier = {
				modifier = mandate_of_heaven_5
				duration = -1
			}
			log = "MANDATE OF HEAVEN: [Root.GetTitledName]'s Mandate of Heaven is Unquestioned!"
			#primary_title = {
			#	add_law = mandate_of_heaven_law_5
			#}
		}
		else_if = {
			limit = {
				has_character_flag = new_mandate_of_heaven_4
			}
			add_character_modifier = {
				modifier = mandate_of_heaven_4
				duration = -1
			}
			log = "MANDATE OF HEAVEN: [Root.GetTitledName]'s Mandate of Heaven is Good!"
			#primary_title = {
			#	add_law = mandate_of_heaven_law_4
			#}
		}
		else_if = {
			limit = {
				has_character_flag = new_mandate_of_heaven_3
			}
			add_character_modifier = {
				modifier = mandate_of_heaven_3
				duration = -1
			}
			log = "MANDATE OF HEAVEN: [Root.GetTitledName]'s Mandate of Heaven is Average!"
			#primary_title = {
			#	add_law = mandate_of_heaven_law_3
			#}
		}
		else_if = {
			limit = {
				has_character_flag = new_mandate_of_heaven_2
			}
			add_character_modifier = {
				modifier = mandate_of_heaven_2
				duration = -1
			}
			log = "MANDATE OF HEAVEN: [Root.GetTitledName]'s Mandate of Heaven is Poor!"
			#primary_title = {
			#	add_law = mandate_of_heaven_law_2
			#}
		}
		else = {
			add_character_modifier = {
				modifier = mandate_of_heaven_1
				duration = -1
			}
			log = "MANDATE OF HEAVEN: [Root.GetTitledName]'s Mandate of Heaven is Lost!"
			#primary_title = {
			#	add_law = mandate_of_heaven_law_1
			#}
		}
		
		if = {
			limit =  {
				has_character_flag = mandate_changed_good
			}
			remove_character_modifier = recent_mandate_change_good
			remove_character_modifier = recent_mandate_change_bad
			add_character_modifier = {
				modifier = recent_mandate_change_good
				duration = 3650
			}
			narrative_event = { id = mandate_of_heaven.7 }
		}
		else_if = {
			limit =  {
				has_character_flag = mandate_changed_bad
			}
			remove_character_modifier = recent_mandate_change_good
			remove_character_modifier = recent_mandate_change_bad
			add_character_modifier = {
				modifier = recent_mandate_change_bad
				duration = 3650
			}
			narrative_event = { id = mandate_of_heaven.8 }
		}
	}
	else = {
		add_character_modifier = {
			modifier = mandate_of_heaven_3
			duration = -1
		}
		log = "MANDATE OF HEAVEN: The Mandate of Heaven is disabled!"
	}
}