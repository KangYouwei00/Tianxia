# Treasure Fleet events
# by Silverswee(e)per

namespace = treasurefleet

##### Preparation

### Startup + event selection

# I have decided to send forth a Treasure Fleet - block wars!
narrative_event = {
	id = treasurefleet.1
	title = EVTTITLE_TREASURE_FLEET_1
	desc = EVTDESC_TREASURE_FLEET_1
	picture = GFX_evt_china_golden_age # TODO
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_1 # It will be auspicious!
	}
}

# Inform vassals
narrative_event = {
	id = treasurefleet.2
	title = EVTTITLE_TREASURE_FLEET_2
	desc = EVTDESC_TREASURE_FLEET_2
	picture = GFX_evt_china_golden_age # TODO
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			is_feudal = yes
		}
		name = EVTOPTA_TREASURE_FLEET_2 # Maybe I'll join it...
	}
	
	option = {
		trigger = {
			is_feudal = no
		}
		name = EVTOPTB_TREASURE_FLEET_2 # I don't care!
	}
}

# Inform playable rulers that might care
narrative_event = {
	id = treasurefleet.3
	title = EVTTITLE_TREASURE_FLEET_3
	desc = EVTDESC_TREASURE_FLEET_3
	picture = GFX_evt_china_golden_age # TODO
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			any_realm_province = {
				can_naval_path_to = c_hangzhou
			}
		}
		name = EVTOPTA_TREASURE_FLEET_3 # Interesting...
	}
	
	option = {
		trigger = {
			NOT = {
				any_realm_province = {
					can_naval_path_to = c_hangzhou
				}
			}
		}
		name = EVTOPTB_TREASURE_FLEET_3 # I don't care!
	}
}

# Check if the fleet should be cancelled or launched, otherwise go to preparation event selection
province_event = {
	id = treasurefleet.4
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		treasure_fleet_preparation = {
			limit = {
				NOT = {
					top_liege = {
						has_landed_title = e_china
					}
				}
			}
			remove_trait = treasure_fleet_preparation # Clean up people that shouldn't have the trait
		}
		if = { # First check if we should cancel the TF preparations
			limit = {
				OR = {
					has_province_flag = abort_treasure_fleet_asap
					e_china = {
						has_holder = no
					}
					e_china = {
						holder_scope = {
							any_war = {
								OR = {
									attacker = {
										character = PREV
									}
									defender = {
										character = PREV
									}
								}
							}
						}
					}
					e_china = {
						holder_scope = {
							is_chinese_emperor_trigger = no
						}
					}
				}
			}
			abort_treasure_fleet_for_everyone_effect = yes # TODO
			e_china = {
				holder_scope = {
					character_event = { id = treasurefleet.7 } # Inform the EoC
					any_realm_lord = {
						limit = {
							is_playable = yes
							ai = no
						}
						character_event = { id = treasurefleet.8 } # Inform vassals
					}
				}
			}
			any_independent_ruler = {
				limit = {
					NOT = {
						has_landed_title = e_china
					}
				}
				if = {
					limit = {
						is_playable = yes
						ai = no
					}
					character_event = { id = treasurefleet.9 } # Inform others
				}
				any_realm_lord = {
					limit = {
						is_playable = yes
						ai = no
					}
					character_event = { id = treasurefleet.9 } # Inform others
				}
			}
		}
		else_if = {
			limit = {
				check_variable = {
					which = treasure_fleet_progress
					value = 25
				}
			}
			# If the fleet is too weak, boost it up to the minimum amount
			if = {
				limit = {
					NOT = {
						check_variable = {
							which = treasure_fleet_ship_strength
							value = 10
						}
					}
				}
				set_variable = {
					which = treasure_fleet_ship_strength
					value = 10
				}
			}
			if = {
				limit = {
					NOT = {
						check_variable = {
							which = treasure_fleet_army_strength
							value = 10
						}
					}
				}
				set_variable = {
					which = treasure_fleet_army_strength
					value = 10
				}
			}
			if = {
				limit = {
					NOT = {
						check_variable = {
							which = treasure_fleet_wealth
							value = 10
						}
					}
				}
				set_variable = {
					which = treasure_fleet_wealth
					value = 10
				}
			}
			if = {
				limit = {
					NOT = {
						check_variable = {
							which = tf_supplies
							value = 10
						}
					}
				}
				set_variable = {
					which = tf_supplies
					value = 10
				}
			}
			clr_global_flag = treasure_fleet_preparation
			e_china = {
				holder_scope = {
					character_event = { id = treasurefleet.83 }
				}
			}
		}
		else = {
			change_variable = {
				which = treasure_fleet_progress
				value = 1
			}
			province_event = { id = treasurefleet.5 } # Preparation events
		}
	}
}

# Preparation event selection + hidden boosts
province_event = {
	id = treasurefleet.5
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		province_event = { id = treasurefleet.4 days = 30 } # Iterate
		
		# Hidden boosts
		random_list = {
			900 = {}
			90 = {
				add_or_boost_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
			}
			9 = {
				add_or_boost_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
			}
			1 = {
				add_or_boost_everything_permissible_effect = yes
			}
		}
		
		e_china = {
			holder_scope = {
				any_realm_province = {
					limit = {
						can_naval_path_to = c_hangzhou
						has_province_modifier = jd_dry_docks
					}
					2753 = { # Hangzhou
						random_list = {
							50 = {}
							45 = {
								boost_random_treasure_fleet_attribute_small_effect = yes
							}
							4 = {
								boost_random_treasure_fleet_attribute_medium_effect = yes
							}
							1 = {
								boost_random_treasure_fleet_attribute_large_effect = yes
							}
						}
					}
				}
				
				# Random events
				random_list = {
					100 = {
						modifier = {
							factor = 0.1
							NOT = {
								wealth = 1000
							}
						}
						modifier = {
							factor = 0
							NOT = {
								wealth = 0
							}
						}
						character_event = { id = treasurefleet.10 } # Invest more money
					}
					100 = {
						modifier = {
							factor = 0.1
							NOT = {
								prestige = 1000
							}
						}
						modifier = {
							factor = 0
							NOT = {
								prestige = 0
							}
						}
						character_event = { id = treasurefleet.11 } # Grand proclamation for prestige
					}
					100 = {
						modifier = {
							factor = 0.1
							NOT = {
								piety = 1000
							}
						}
						modifier = {
							factor = 0
							NOT = {
								piety = 0
							}
						}
						character_event = { id = treasurefleet.12 } # Lean on temples
					}
					100 = {
						character_event = { id = treasurefleet.13 } # Make a grand speech
					}
					100 = {
						character_event = { id = treasurefleet.16 } # Make military preparations
					}
					100 = {
						character_event = { id = treasurefleet.19 } # Investigate trade opportunities
					}
					100 = {
						character_event = { id = treasurefleet.22 } # Consult spies
					}
					100 = {
						character_event = { id = treasurefleet.25 } # Consult books
					}
					100 = {
						modifier = {
							factor = 0
							NOT = {
								any_realm_lord = {
									is_playable = yes
									is_feudal = yes
									ai = yes
									war = no
									NOR = {
										trait = treasure_fleet_preparation
										has_character_modifier = tf_join_request
										has_character_modifier = tf_joining_refused
									}
								}
							}
						}
						# Try to get the AI to join
						random_realm_lord = {
							limit = {
								is_playable = yes
								is_feudal = yes
								ai = yes
								war = no
								NOR = {
									trait = treasure_fleet_preparation
									has_character_modifier = tf_join_request
									has_character_modifier = tf_joining_refused
								}
							}
							character_event = { id = treasurefleet.28 }
						}
					}
					100 = {
						character_event = { id = treasurefleet.43 } # Foreign shipwrights
					}
					100 = {
						modifier = {
							factor = 0
							NOT = {
								any_independent_ruler = {
									is_tributary = yes
									suzerain = {
										has_landed_title = e_china
									}
									NOT = {
										has_character_modifier = tributary_supported_tf
									}
								}
							}
						}
						# Tributary might assist
						random_independent_ruler = {
							limit = {
								is_tributary = yes
								suzerain = {
									has_landed_title = e_china
								}
								NOT = {
									has_character_modifier = tributary_supported_tf
								}
							}
							character_event = { id = treasurefleet.46 }
						}
					}
					100 = {
						modifier = {
							factor = 0
							NOT = {
								any_realm_lord = {
									is_playable = yes
									is_devil_worshiper_trigger = yes
								}
							}
						}
						# DW sabotage
						random_realm_lord = {
							limit = {
								is_playable = yes
								is_devil_worshiper_trigger = yes
							}
							character_event = { id = treasurefleet.53 }
						}
					}
					100 = {
						modifier = {
							factor = 0
							NOT = {
								any_courtier_or_vassal = {
									is_council_eunuch_trigger = yes
								}
							}
						}
						# Council eunuch might help
						random_courtier_or_vassal = {
							limit = {
								is_council_eunuch_trigger = yes
							}
							character_event = { id = treasurefleet.62 }
						}
					}
					100 = {
						modifier = {
							factor = 0
							NOT = {
								any_courtier_or_vassal = {
									has_job_title = job_chancellor
								}
							}
						}
						# Chancellor might help
						random_courtier_or_vassal = {
							limit = {
								has_job_title = job_chancellor
							}
							character_event = { id = treasurefleet.65 }
						}
					}
					100 = {
						modifier = {
							factor = 0
							NOT = {
								any_courtier_or_vassal = {
									has_job_title = job_marshal
								}
							}
						}
						# Marshal might help
						random_courtier_or_vassal = {
							limit = {
								has_job_title = job_marshal
							}
							character_event = { id = treasurefleet.68 }
						}
					}
					100 = {
						modifier = {
							factor = 0
							NOT = {
								any_courtier_or_vassal = {
									has_job_title = job_treasurer
								}
							}
						}
						# Steward might help
						random_courtier_or_vassal = {
							limit = {
								has_job_title = job_treasurer
							}
							character_event = { id = treasurefleet.71 }
						}
					}
					100 = {
						modifier = {
							factor = 0
							NOT = {
								e_china = {
									any_courtier_or_vassal = {
										has_job_title = job_spymaster
									}
								}
							}
						}
						# Spymaster might help
						random_courtier_or_vassal = {
							limit = {
								has_job_title = job_spymaster
							}
							character_event = { id = treasurefleet.74 }
						}
					}
					100 = {
						modifier = {
							factor = 0
							NOT = {
								any_courtier_or_vassal = {
									has_job_title = job_spiritual
								}
							}
						}
						# Court Chaplain might help
						random_courtier_or_vassal = {
							limit = {
								has_job_title = job_spymaster
							}
							character_event = { id = treasurefleet.77 }
						}
					}
					100 = {
						modifier = {
							factor = 0
							NOT = {
								any_courtier_or_vassal = {
									OR = {
										has_minor_title = title_councilmember_king
										has_minor_title = title_councilmember_emperor
									}
								}
							}
						}
						# Advisor might help
						random_courtier_or_vassal = {
							limit = {
								OR = {
									has_minor_title = title_councilmember_king
									has_minor_title = title_councilmember_emperor
								}
							}
							character_event = { id = treasurefleet.80 }
						}
					}
					100 = {
						# Nothing
					}
				}
			}
		}
	}
}

# on_new_holder (and variations) event to add the treasure_fleet_preparation trait to owners of e_china and to remove it from the former holder
character_event = {
	id = treasurefleet.6
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		FROMFROM = {
			trait = treasure_fleet_preparation
		}
		FROM = {
			title = e_china
		}
	}
	
	immediate = {
		FROMFROM = {
			remove_trait = treasure_fleet_preparation
		}
	}
}

# Treasure Fleet cancelled for whatever reason
character_event = {
	id = treasurefleet.7
	desc = EVTDESC_TREASURE_FLEET_7
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_7 # Ok 
	}
}

# Inform vassals
character_event = {
	id = treasurefleet.8
	desc = EVTDESC_TREASURE_FLEET_8
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_8 # Ok 
	}
}

# Inform others
character_event = {
	id = treasurefleet.9
	desc = EVTDESC_TREASURE_FLEET_9
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_9 # Ok 
	}
}

### Invest more money

# Invest more money?
character_event = {
	id = treasurefleet.10
	desc = EVTDESC_TREASURE_FLEET_10
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_10 # Invest more money
		wealth = -1000
		
		hidden_tooltip = {
			2753 = { # Hangzhou
				90 = {
					add_or_boost_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
				}
				9 = {
					add_or_boost_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
				}
				1 = {
					add_or_boost_everything_permissible_effect = yes
				}
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				trait = greedy
			}
			modifier = {
				factor = 0.1
				NOT = {
					wealth = 1000
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_TREASURE_FLEET_10 # Nah
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				has_focus = focus_business
			}
		}
	}
}

### Make a general proclamation for prestige

# Seek help for prestige?
character_event = {
	id = treasurefleet.11
	desc = EVTDESC_TREASURE_FLEET_11
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_11 # Send the proclamation!
		prestige = -1000
		
		hidden_tooltip = {
			2753 = { # Hangzhou
				90 = {
					add_or_boost_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
				}
				9 = {
					add_or_boost_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
				}
				1 = {
					add_or_boost_everything_permissible_effect = yes
				}
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				trait = proud
			}
			modifier = {
				factor = 0.1
				NOT = {
					prestige = 1000
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_TREASURE_FLEET_11 # Nah
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				trait = humble
			}
		}
	}
}

### Lean on temples

# Help for piety?
character_event = {
	id = treasurefleet.12
	desc = EVTDESC_TREASURE_FLEET_12
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_12 # Lean on temples!
		piety = -1000
		
		hidden_tooltip = {
			2753 = { # Hangzhou
				90 = {
					add_or_boost_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
				}
				9 = {
					add_or_boost_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
				}
				1 = {
					add_or_boost_everything_permissible_effect = yes
				}
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				trait = zealous
			}
			modifier = {
				factor = 0.1
				NOT = {
					piety = 1000
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_TREASURE_FLEET_12 # Nah
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				trait = cynical
			}
		}
	}
}

### Make a grand speech - Diplomacy

# Make a grand speech?
character_event = {
	id = treasurefleet.13
	desc = EVTDESC_TREASURE_FLEET_13
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_13 # Do so!
		
		random_list = {
			50 = {
				modifier = {
					factor = 2
					diplomacy = 28
				}
				modifier = {
					factor = 2
					diplomacy = 24
				}
				modifier = {
					factor = 2
					diplomacy = 16
				}
				character_event = { id = treasurefleet.14 days = 5 random = 5 } # It goes well
			}
			50 = {
				modifier = {
					factor = 2
					NOT = {
						diplomacy = 12
					}
				}
				modifier = {
					factor = 2
					NOT = {
						diplomacy = 8
					}
				}
				modifier = {
					factor = 2
					NOT = {
						diplomacy = 4
					}
				}
				character_event = { id = treasurefleet.15 days = 5 random = 5 } # It goes poorly
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				NOT = {
					diplomacy = 12
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_TREASURE_FLEET_13 # Nah
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				diplomacy = 12
			}
		}
	}
}

# Speech goes well
character_event = {
	id = treasurefleet.14
	desc = EVTDESC_TREASURE_FLEET_14
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_14 # Great!
		
		prestige = 100
		
		hidden_tooltip = {
			2753 = { # Hangzhou
				90 = {
					add_or_boost_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
				}
				9 = {
					add_or_boost_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
				}
				1 = {
					add_or_boost_everything_permissible_effect = yes
				}
			}
		}
	}
}

# Speech goes poorly
character_event = {
	id = treasurefleet.15
	desc = EVTDESC_TREASURE_FLEET_15
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_15 # Curses!
		
		prestige = -100
		
		hidden_tooltip = {
			2753 = { # Hangzhou
				90 = {
					remove_or_weaken_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
				}
				9 = {
					remove_or_weaken_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
				}
				1 = {
					remove_or_weaken_everything_permissible_effect = yes
				}
			}
		}
	}
}

### Get involved in the military preparations - Martial

# Get involved in the military preparations?
character_event = {
	id = treasurefleet.16
	desc = EVTDESC_TREASURE_FLEET_16
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_16 # Do so!
		
		random_list = {
			50 = {
				modifier = {
					factor = 2
					martial = 28
				}
				modifier = {
					factor = 2
					martial = 24
				}
				modifier = {
					factor = 2
					martial = 16
				}
				character_event = { id = treasurefleet.17 days = 5 random = 5 } # It goes well
			}
			50 = {
				modifier = {
					factor = 2
					NOT = {
						martial = 12
					}
				}
				modifier = {
					factor = 2
					NOT = {
						martial = 8
					}
				}
				modifier = {
					factor = 2
					NOT = {
						martial = 4
					}
				}
				character_event = { id = treasurefleet.18 days = 5 random = 5 } # It goes poorly
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				NOT = {
					martial = 12
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_TREASURE_FLEET_16 # Nah
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				martial = 12
			}
		}
	}
}

# Preparations go well
character_event = {
	id = treasurefleet.17
	desc = EVTDESC_TREASURE_FLEET_17
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_17 # Great!
		
		prestige = 100
		
		hidden_tooltip = {
			2753 = { # Hangzhou
				90 = {
					add_or_boost_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
				}
				9 = {
					add_or_boost_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
				}
				1 = {
					add_or_boost_everything_permissible_effect = yes
				}
			}
		}
	}
}

# Preparations go poorly
character_event = {
	id = treasurefleet.18
	desc = EVTDESC_TREASURE_FLEET_18
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_18 # Curses!
		
		prestige = -100
		
		hidden_tooltip = {
			2753 = { # Hangzhou
				90 = {
					remove_or_weaken_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
				}
				9 = {
					remove_or_weaken_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
				}
				1 = {
					remove_or_weaken_everything_permissible_effect = yes
				}
			}
		}
	}
}

### Review trade - Stewardship

# Review trade?
character_event = {
	id = treasurefleet.19
	desc = EVTDESC_TREASURE_FLEET_19
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_19 # Do so!
		
		random_list = {
			50 = {
				modifier = {
					factor = 2
					stewardship = 28
				}
				modifier = {
					factor = 2
					stewardship = 24
				}
				modifier = {
					factor = 2
					stewardship = 16
				}
				character_event = { id = treasurefleet.20 days = 5 random = 5 } # It goes well
			}
			50 = {
				modifier = {
					factor = 2
					NOT = {
						stewardship = 12
					}
				}
				modifier = {
					factor = 2
					NOT = {
						stewardship = 8
					}
				}
				modifier = {
					factor = 2
					NOT = {
						stewardship = 4
					}
				}
				character_event = { id = treasurefleet.21 days = 5 random = 5 } # It goes poorly
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				NOT = {
					stewardship = 12
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_TREASURE_FLEET_19 # Nah
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				stewardship = 12
			}
		}
	}
}

# Review goes well
character_event = {
	id = treasurefleet.20
	desc = EVTDESC_TREASURE_FLEET_20
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_20 # Great!
		
		prestige = 100
		
		hidden_tooltip = {
			2753 = { # Hangzhou
				90 = {
					add_or_boost_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
				}
				9 = {
					add_or_boost_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
				}
				1 = {
					add_or_boost_everything_permissible_effect = yes
				}
			}
		}
	}
}

# Review goes poorly
character_event = {
	id = treasurefleet.21
	desc = EVTDESC_TREASURE_FLEET_21
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_21 # Curses!
		
		prestige = -100
		
		hidden_tooltip = {
			2753 = { # Hangzhou
				90 = {
					remove_or_weaken_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
				}
				9 = {
					remove_or_weaken_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
				}
				1 = {
					remove_or_weaken_everything_permissible_effect = yes
				}
			}
		}
	}
}

### Consult spies - Intrigue

# Consult spies?
character_event = {
	id = treasurefleet.22
	desc = EVTDESC_TREASURE_FLEET_22
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_22 # Do so!
		
		random_list = {
			50 = {
				modifier = {
					factor = 2
					intrigue = 28
				}
				modifier = {
					factor = 2
					intrigue = 24
				}
				modifier = {
					factor = 2
					intrigue = 16
				}
				character_event = { id = treasurefleet.23 days = 5 random = 5 } # It goes well
			}
			50 = {
				modifier = {
					factor = 2
					NOT = {
						intrigue = 12
					}
				}
				modifier = {
					factor = 2
					NOT = {
						intrigue = 8
					}
				}
				modifier = {
					factor = 2
					NOT = {
						intrigue = 4
					}
				}
				character_event = { id = treasurefleet.24 days = 5 random = 5 } # It goes poorly
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				NOT = {
					intrigue = 12
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_TREASURE_FLEET_22 # Nah
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				intrigue = 12
			}
		}
	}
}

# Got good information
character_event = {
	id = treasurefleet.23
	desc = EVTDESC_TREASURE_FLEET_23
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_23 # Great!
		
		prestige = 100
		
		hidden_tooltip = {
			2753 = { # Hangzhou
				90 = {
					add_or_boost_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
				}
				9 = {
					add_or_boost_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
				}
				1 = {
					add_or_boost_everything_permissible_effect = yes
				}
			}
		}
	}
}

# Got bad information
character_event = {
	id = treasurefleet.24
	desc = EVTDESC_TREASURE_FLEET_24
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_24 # Curses!
		
		prestige = -100
		
		hidden_tooltip = {
			2753 = { # Hangzhou
				90 = {
					remove_or_weaken_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
				}
				9 = {
					remove_or_weaken_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
				}
				1 = {
					remove_or_weaken_everything_permissible_effect = yes
				}
			}
		}
	}
}

### Consult books - Learning

# Consult books?
character_event = {
	id = treasurefleet.25
	desc = EVTDESC_TREASURE_FLEET_25
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_25 # Do so!
		
		random_list = {
			50 = {
				modifier = {
					factor = 2
					learning = 28
				}
				modifier = {
					factor = 2
					learning = 24
				}
				modifier = {
					factor = 2
					learning = 16
				}
				character_event = { id = treasurefleet.26 days = 5 random = 5 } # It goes well
			}
			50 = {
				modifier = {
					factor = 2
					NOT = {
						learning = 12
					}
				}
				modifier = {
					factor = 2
					NOT = {
						learning = 8
					}
				}
				modifier = {
					factor = 2
					NOT = {
						learning = 4
					}
				}
				character_event = { id = treasurefleet.27 days = 5 random = 5 } # It goes poorly
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				NOT = {
					learning = 12
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_TREASURE_FLEET_25 # Nah
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				learning = 12
			}
		}
	}
}

# Found good information
character_event = {
	id = treasurefleet.26
	desc = EVTDESC_TREASURE_FLEET_26
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_26 # Great!
		
		prestige = 100
		
		hidden_tooltip = {
			2753 = { # Hangzhou
				90 = {
					add_or_boost_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
				}
				9 = {
					add_or_boost_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
				}
				1 = {
					add_or_boost_everything_permissible_effect = yes
				}
			}
		}
	}
}

# Found bad information
character_event = {
	id = treasurefleet.27
	desc = EVTDESC_TREASURE_FLEET_27
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_27 # Curses!
		
		prestige = -100
		
		hidden_tooltip = {
			2753 = { # Hangzhou
				90 = {
					remove_or_weaken_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
				}
				9 = {
					remove_or_weaken_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
				}
				1 = {
					remove_or_weaken_everything_permissible_effect = yes
				}
			}
		}
	}
}

### Try to make AI subjects join

# Vassal/sub-vassal might ask to join
character_event = {
	id = treasurefleet.28
	desc = EVTDESC_TREASURE_FLEET_28
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_28 # I'll join!
		
		# TODO: Add character modifier
		
		if = {
			limit = {
				e_china = {
					holder_scope = {
						owes_favor_to = ROOT
					}
				}
			}
			character_event = { id = treasurefleet.29 } # Call in Favor?
		}
		else = {
			e_china = {
				holder_scope = {
					character_event = { id = treasurefleet.31 } # EoC gets the request
				}
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				in_faction = yes
			}
			modifier = {
				factor = 0.01
				leads_faction = yes
			}
		}
	}
	
	option = {
		name = EVTOPTB_TREASURE_FLEET_28 # Nah
		
		ai_chance = {
			factor = 100
		}
	}
}

# Asking to join from decision or event - use Favor or not?
character_event = {
	id = treasurefleet.29
	desc = EVTDESC_TREASURE_FLEET_29
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_29 # Call in Favor!
		
		add_trait = treasure_fleet_preparation
		
		e_china = {
			holder_scope = {
				reverse_remove_favor = ROOT
				character_event = { id = treasurefleet.30 } # Notify EoC
			}
		}
	}
	
	option = {
		name = EVTOPTB_TREASURE_FLEET_28 # Nah
		
		e_china = {
			holder_scope = {
				character_event = { id = treasurefleet.31 } # EoC gets non-Favor request
			}
		}
		
		ai_chance = {
			factor = 0
		}
	}
}

### Vassal calls in Favor to join

# EoC notified
character_event = {
	id = treasurefleet.30
	desc = EVTDESC_TREASURE_FLEET_30
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_30 # Very well...
	}
}

### Vassal asks to join - normal

# EoC gets to accept, refuse, or offer a deal
character_event = {
	id = treasurefleet.31
	desc = EVTDESC_TREASURE_FLEET_31
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_31 # Very well...
		
		FROM = {
			character_event = { id = treasurefleet.32 days = 1 } # Inform FROM
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				any_rival = {
					character = FROM
				}
			}
			modifier = {
				factor = 0.01
				NOR = {
					dynasty = FROM
					any_close_relative = {
						character = FROM
					}
					any_friend = {
						character = FROM
					}
					any_lover = {
						character = FROM
					}
				}
			}
		}
		
		hidden_tooltip = {
			2753 = { # Hangzhou
				90 = {
					add_or_boost_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
				}
				9 = {
					add_or_boost_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
				}
				1 = {
					add_or_boost_everything_permissible_effect = yes
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_TREASURE_FLEET_31 # You'll have to pay me
		
		FROM = {
			character_event = { id = treasurefleet.33 days = 1 } # Inform FROM
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				has_dlc = "Conclave"
			}
			modifier = {
				factor = 0.1
				trait = charitable
			}
		}
	}
	
	option = {
		trigger = {
			has_dlc = "Conclave"
			owes_favor_to = FROM
		}
		name = EVTOPTC_TREASURE_FLEET_31 # If we call it a Favor...
		
		FROM = {
			character_event = { id = treasurefleet.36 days = 1 } # Inform FROM
		}
		
		ai_chance = {
			factor = 100
		}
	}
	
	option = {
		trigger = {
			has_dlc = "Conclave"
			NOR = {
				owes_favor_to = FROM
				FROM = {
					owes_favor_to = ROOT
				}
			}
		}
		name = EVTOPTD_TREASURE_FLEET_31 # If we call it a Favor...
		
		FROM = {
			character_event = { id = treasurefleet.39 days = 1 } # Inform FROM
		}
		
		ai_chance = {
			factor = 100
		}
	}
	
	option = {
		trigger = {
			has_dlc = "Conclave"
			NOR = {
				owes_favor_to = FROM
				FROM = {
					owes_favor_to = ROOT
				}
			}
		}
		name = EVTOPTE_TREASURE_FLEET_31 # I don't think so!
		
		FROM = {
			character_event = { id = treasurefleet.42 days = 1 } # Inform FROM
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.01
				NOT = {
					any_rival = {
						character = FROM
					}
				}
			}
			modifier = {
				factor = 10
				any_rival = {
					character = FROM
				}
			}
			modifier = {
				factor = 0.01
				OR = {
					dynasty = FROM
					any_close_relative = {
						character = FROM
					}
					any_friend = {
						character = FROM
					}
					any_lover = {
						character = FROM
					}
				}
			}
		}
	}
}

# Request approved
character_event = {
	id = treasurefleet.32
	desc = EVTDESC_TREASURE_FLEET_32
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_32 # Great!
		
		add_trait = treasure_fleet_preparation
	}
}

# Deal - pay the EoC?
character_event = {
	id = treasurefleet.33
	desc = EVTDESC_TREASURE_FLEET_33
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_33 # Sure!
		
		add_trait = treasure_fleet_preparation
		wealth = -100
		
		FROM = {
			wealth = 100
			character_event = { id = treasurefleet.34 } # Inform FROM
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				trait = greedy
			}
			modifier = {
				factor = 0.1
				NOT = {
					wealth = 100
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_TREASURE_FLEET_33 # No!
		
		FROM = {
			character_event = { id = treasurefleet.35 } # Inform FROM
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				trait = charitable
			}
		}
	}
}

# Offer accepted
character_event = {
	id = treasurefleet.34
	desc = EVTDESC_TREASURE_FLEET_34
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_34 # Great!
	}
}

# Offer refused
character_event = {
	id = treasurefleet.35
	desc = EVTDESC_TREASURE_FLEET_35
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_35 # I see...
	}
}

# Deal - I'll consider it a Favor (calls in Favor owed *by* the EoC)
character_event = {
	id = treasurefleet.36
	desc = EVTDESC_TREASURE_FLEET_36
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_36 # Sure!
		
		add_trait = treasure_fleet_preparation
		FROM = {
			reverse_remove_favor  = ROOT
			character_event = { id = treasurefleet.37 } # Inform FROM
		}
	}
	
	option = {
		name = EVTOPTB_TREASURE_FLEET_36 # No!
		
		FROM = {
			character_event = { id = treasurefleet.38 } # Inform FROM
		}
	}
}

# Offer accepted
character_event = {
	id = treasurefleet.37
	desc = EVTDESC_TREASURE_FLEET_37
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_37 # Great!
	}
}

# Offer refused
character_event = {
	id = treasurefleet.38
	desc = EVTDESC_TREASURE_FLEET_38
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_38 # I see...
	}
}

# Deal - EoC demands a Favor
character_event = {
	id = treasurefleet.39
	desc = EVTDESC_TREASURE_FLEET_39
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_39 # Sure!
		
		add_trait = treasure_fleet_preparation
		FROM = {
			add_favor = ROOT
			character_event = { id = treasurefleet.40 } # Inform FROM
		}
	}
	
	option = {
		name = EVTOPTB_TREASURE_FLEET_39 # No!
		
		FROM = {
			character_event = { id = treasurefleet.41 } # Inform FROM
		}
	}
}

# Offer accepted
character_event = {
	id = treasurefleet.40
	desc = EVTDESC_TREASURE_FLEET_40
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_40 # Great!
	}
}

# Offer refused
character_event = {
	id = treasurefleet.41
	desc = EVTDESC_TREASURE_FLEET_41
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_41 # I see...
	}
}

# Request denied
character_event = {
	id = treasurefleet.42
	desc = EVTDESC_TREASURE_FLEET_42
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_42 # I see...
		
		prestige = -25
	}
}

### Foreign shipwrights

# Offer is made
character_event = {
	id = treasurefleet.43
	desc = EVTDESC_TREASURE_FLEET_43
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_43 # Do so!
		
		wealth = -500
		
		random_list = {
			50 = {
				character_event = { id = treasurefleet.44 days = 5 random = 5 } # It goes well
			}
			50 = {
				character_event = { id = treasurefleet.45 days = 5 random = 5 } # It goes poorly
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				trait = greedy
			}
			modifier = {
				factor = 0.1
				NOT = {
					wealth = 500
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_TREASURE_FLEET_43 # Nah
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				trait = greedy
			}
			modifier = {
				factor = 0.1
				NOT = {
					wealth = 500
				}
			}
		}
	}
}

# They were helpful
character_event = {
	id = treasurefleet.44
	desc = EVTDESC_TREASURE_FLEET_44
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_44 # Great!
		
		prestige = 100
		
		hidden_tooltip = {
			2753 = { # Hangzhou
				90 = {
					add_or_boost_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
				}
				9 = {
					add_or_boost_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
				}
				1 = {
					add_or_boost_everything_permissible_effect = yes
				}
			}
		}
	}
}

# They were unhelpful
character_event = {
	id = treasurefleet.45
	desc = EVTDESC_TREASURE_FLEET_45
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_45 # Curses!
		
		prestige = -100
		
		hidden_tooltip = {
			2753 = { # Hangzhou
				90 = {
					remove_or_weaken_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
				}
				9 = {
					remove_or_weaken_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
				}
				1 = {
					remove_or_weaken_everything_permissible_effect = yes
				}
			}
		}
	}
}

### Tributary might offer to support the endeavor

# Tributary gets the opportunity to make an offer
character_event = {
	id = treasurefleet.46
	desc = EVTDESC_TREASURE_FLEET_46
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			has_dlc = "Jade Dragon"
			has_game_rule = {
				name = grace_interactions
				value = enabled
			}
			e_china = {
				holder_scope = {
					is_blocking_all_boons_trigger = no
				}
			}
			china_hates_root_trigger = no
		}
		
		name = EVTOPTA_TREASURE_FLEET_46 # I want Grace!
		
		e_china = {
			holder_scope = {
				character_event = { id = treasurefleet.47 days = 1 } # Inform the EoC
			}
		}
		
		ai_chance = {
			factor = 100
		}
	}
	
	option = {
		name = EVTOPTB_TREASURE_FLEET_46 # I want a looser relationship!
		
		e_china = {
			holder_scope = {
				character_event = { id = treasurefleet.50 days = 1 } # Inform the EoC
			}
		}
		
		ai_chance = {
			factor = 100
		}
	}
	
	option = {
		name = EVTOPTC_TREASURE_FLEET_46 # Nah
		
		ai_chance = {
			factor = 100
		}
	}
}

# Offer made - want Grace
character_event = {
	id = treasurefleet.47
	desc = EVTDESC_TREASURE_FLEET_47
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_47 # Very well...
		
		FROM = {
			add_grace_massive_effect = yes
			character_event = { id = treasurefleet.48 } # Inform FROM
		}
		
		hidden_tooltip = {
			2753 = { # Hangzhou
				90 = {
					add_or_boost_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
				}
				9 = {
					add_or_boost_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
				}
				1 = {
					add_or_boost_everything_permissible_effect = yes
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_TREASURE_FLEET_47 # Nah
		
		prestige = -100
		
		FROM = {
			character_event = { id = treasurefleet.49 } # Inform FROM
		}
	}
}

# Offer accepted
character_event = {
	id = treasurefleet.48
	desc = EVTDESC_TREASURE_FLEET_48
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_48 # Great!
	}
}

# Offer refused
character_event = {
	id = treasurefleet.49
	desc = EVTDESC_TREASURE_FLEET_49
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_49 # I see...
	}
}

# Offer made - want a looser relationship
character_event = {
	id = treasurefleet.50
	desc = EVTDESC_TREASURE_FLEET_50
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_50 # Very well...
		
		FROM = {
			decrease_tributary_tier_or_release_effect = yes
			character_event = { id = treasurefleet.51 } # Inform FROM
		}
		
		hidden_tooltip = {
			2753 = { # Hangzhou
				90 = {
					add_or_boost_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
				}
				9 = {
					add_or_boost_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
				}
				1 = {
					add_or_boost_everything_permissible_effect = yes
				}
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				NOR = {
					is_tributary = {
						type = chinese_client_state
					}
					is_tributary = {
						type = chinese_protectorate
					}
					is_tributary = {
						type = chinese_imperial_tributary
					}
				}
			}
			modifier = {
				factor = 0.1
				is_tributary = {
					type = chinese_protectorate
				}
			}
			modifier = {
				factor = 0.01
				is_tributary = {
					type = chinese_imperial_tributary
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_TREASURE_FLEET_50 # Nah
		
		prestige = -100
		
		FROM = {
			character_event = { id = treasurefleet.52 } # Inform FROM
		}
		
		ai_chance = {
			factor = 100
		}
	}
}

# Offer accepted
character_event = {
	id = treasurefleet.51
	desc = EVTDESC_TREASURE_FLEET_51
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_51 # Great!
	}
}

# Offer refused
character_event = {
	id = treasurefleet.52
	desc = EVTDESC_TREASURE_FLEET_52
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_52 # I see...
	}
}

### DW sabotage

# Cultist gets the opportunity to try
character_event = {
	id = treasurefleet.53
	desc = EVTDESC_TREASURE_FLEET_53
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_53 # Yes!
		
		detract_society_currency_major_effect = yes
		
		random = {
			chance = 25
			increase_visibility_effect = yes
		}
		
		random_list = {
			25 = {
				modifier = {
					factor = 2
					intrigue = 50
				}
				modifier = {
					factor = 2
					intrigue = 45
				}
				modifier = {
					factor = 2
					intrigue = 40
				}
				modifier = {
					factor = 2
					intrigue = 35
				}
				modifier = {
					factor = 2
					intrigue = 30
				}
				modifier = {
					factor = 2
					intrigue = 25
				}
				modifier = {
					factor = 0
					has_character_modifier = known_satanist
				}
				character_event = { id = treasurefleet.54 days = 1 } # Success
			}
			25 = {
				modifier = {
					factor = 2
					intrigue = 50
				}
				modifier = {
					factor = 2
					intrigue = 45
				}
				modifier = {
					factor = 2
					intrigue = 40
				}
				modifier = {
					factor = 2
					intrigue = 35
				}
				modifier = {
					factor = 2
					intrigue = 30
				}
				modifier = {
					factor = 2
					intrigue = 25
				}
				modifier = {
					factor = 0
					NOT = {
						has_character_modifier = known_satanist
					}
				}
				character_event = { id = treasurefleet.56 days = 1 } # Success, but caught
			}
			25 = {
				modifier = {
					factor = 2
					NOT = {
						intrigue = 20
					}
				}
				modifier = {
					factor = 2
					NOT = {
						intrigue = 16
					}
				}
				modifier = {
					factor = 2
					NOT = {
						intrigue = 12
					}
				}
				modifier = {
					factor = 2
					NOT = {
						intrigue = 8
					}
				}
				modifier = {
					factor = 2
					NOT = {
						intrigue = 4
					}
				}
				modifier = {
					factor = 0
					has_character_modifier = known_satanist
				}
				character_event = { id = treasurefleet.58 days = 1 } # Failure
			}
			25 = {
				modifier = {
					factor = 2
					NOT = {
						intrigue = 20
					}
				}
				modifier = {
					factor = 2
					NOT = {
						intrigue = 16
					}
				}
				modifier = {
					factor = 2
					NOT = {
						intrigue = 12
					}
				}
				modifier = {
					factor = 2
					NOT = {
						intrigue = 8
					}
				}
				modifier = {
					factor = 2
					NOT = {
						intrigue = 4
					}
				}
				modifier = {
					factor = 0
					NOT = {
						has_character_modifier = known_satanist
					}
				}
				character_event = { id = treasurefleet.60 days = 1 } # Failure, and caught
			}
		}
	}
	
	option = {
		name = EVTOPTB_TREASURE_FLEET_53 # No!
		
		prestige = -100
		
		ai_chance = {
			factor = 0
		}
	}
}

# Sabotage successful
character_event = {
	id = treasurefleet.54
	desc = EVTDESC_TREASURE_FLEET_54
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_54 # Praise the dark powers!
		
		e_china = {
			holder_scope = {
				character_event = { id = treasurefleet.55 } # Inform the EoC
			}
		}
	}
}

# Inform the EoC
character_event = {
	id = treasurefleet.55
	desc = EVTDESC_TREASURE_FLEET_55
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_55 # Who could have done this?
		
		hidden_tooltip = {
			2753 = { # Hangzhou
				1 = {
					remove_or_weaken_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
				}
				9 = {
					remove_or_weaken_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
				}
				90 = {
					remove_or_weaken_everything_permissible_effect = yes
				}
			}
		}
	}
}

# Sabotage successful, but got caught
character_event = {
	id = treasurefleet.56
	desc = EVTDESC_TREASURE_FLEET_56
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_56 # Not quite what I wanted...
		
		e_china = {
			holder_scope = {
				FROM = {
					imprison = PREV
				}
				character_event = { id = treasurefleet.57 } # Inform the EoC
			}
		}
	}
}

# Inform the EoC
character_event = {
	id = treasurefleet.57
	desc = EVTDESC_TREASURE_FLEET_57
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_57 # At least we caught the perpetrator!
		
		hidden_tooltip = {
			2753 = { # Hangzhou
				1 = {
					remove_or_weaken_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
				}
				9 = {
					remove_or_weaken_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
				}
				90 = {
					remove_or_weaken_everything_permissible_effect = yes
				}
			}
		}
	}
}

# Sabotage fails
character_event = {
	id = treasurefleet.58
	desc = EVTDESC_TREASURE_FLEET_58
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_58 # At least I got away...
		
		e_china = {
			holder_scope = {
				character_event = { id = treasurefleet.59 } # Inform the EoC
			}
		}
	}
}

# Inform the EoC
character_event = {
	id = treasurefleet.59
	desc = EVTDESC_TREASURE_FLEET_59
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_59 # Who could have done this?
	}
}

# Sabotage fails, and got caught
character_event = {
	id = treasurefleet.60
	desc = EVTDESC_TREASURE_FLEET_60
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_60 # That went poorly...
		
		e_china = {
			holder_scope = {
				FROM = {
					imprison = PREV
				}
				character_event = { id = treasurefleet.61 } # Inform the EoC
			}
		}
	}
}

# Inform the EoC
character_event = {
	id = treasurefleet.61
	desc = EVTDESC_TREASURE_FLEET_61
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_61 # That could have been bad...
	}
}

### Council Eunuch might get involved

# Council Eunuch gets to decide
character_event = {
	id = treasurefleet.62
	desc = EVTDESC_TREASURE_FLEET_62
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_62 # Yes!
		
		random_list = {
			50 = {
				modifier = {
					factor = 2
					diplomacy = 28
				}
				modifier = {
					factor = 2
					diplomacy = 24
				}
				modifier = {
					factor = 2
					diplomacy = 16
				}
				modifier = {
					factor = 2
					martial = 28
				}
				modifier = {
					factor = 2
					martial = 24
				}
				modifier = {
					factor = 2
					martial = 16
				}
				modifier = {
					factor = 2
					stewardship = 28
				}
				modifier = {
					factor = 2
					stewardship = 24
				}
				modifier = {
					factor = 2
					stewardship = 16
				}
				modifier = {
					factor = 2
					intrigue = 28
				}
				modifier = {
					factor = 2
					intrigue = 24
				}
				modifier = {
					factor = 2
					intrigue = 16
				}
				modifier = {
					factor = 2
					learning = 28
				}
				modifier = {
					factor = 2
					learning = 24
				}
				modifier = {
					factor = 2
					learning = 16
				}
				hidden_tooltip = {
					2753 = { # Hangzhou
						90 = {
							add_or_boost_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
						}
						9 = {
							add_or_boost_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
						}
						1 = {
							add_or_boost_everything_permissible_effect = yes
						}
					}
					liege = {
						character_event = { id = treasurefleet.63 } # It goes well
					}
				}
			}
			50 = {
				modifier = {
					factor = 2
					NOT = {
						diplomacy = 12
					}
				}
				modifier = {
					factor = 2
					NOT = {
						diplomacy = 8
					}
				}
				modifier = {
					factor = 2
					NOT = {
						diplomacy = 4
					}
				}
				modifier = {
					factor = 2
					NOT = {
						martial = 12
					}
				}
				modifier = {
					factor = 2
					NOT = {
						martial = 8
					}
				}
				modifier = {
					factor = 2
					NOT = {
						martial = 4
					}
				}
				modifier = {
					factor = 2
					NOT = {
						stewardship = 12
					}
				}
				modifier = {
					factor = 2
					NOT = {
						stewardship = 8
					}
				}
				modifier = {
					factor = 2
					NOT = {
						stewardship = 4
					}
				}
				modifier = {
					factor = 2
					NOT = {
						intrigue = 12
					}
				}
				modifier = {
					factor = 2
					NOT = {
						intrigue = 8
					}
				}
				modifier = {
					factor = 2
					NOT = {
						intrigue = 4
					}
				}
				modifier = {
					factor = 2
					NOT = {
						learning = 12
					}
				}
				modifier = {
					factor = 2
					NOT = {
						learning = 8
					}
				}
				modifier = {
					factor = 2
					NOT = {
						learning = 4
					}
				}
				hidden_tooltip = {
					2753 = { # Hangzhou
						90 = {
							remove_or_weaken_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
						}
						9 = {
							remove_or_weaken_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
						}
						1 = {
							remove_or_weaken_everything_permissible_effect = yes
						}
					}
					liege = {
						character_event = { id = treasurefleet.64 } # It goes well
					}
				}
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				NOT = {
					opinion = {
						who = liege
						value = -25
					}
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_TREASURE_FLEET_62 # No!
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				opinion = {
					who = liege
					value = 25
				}
			}
		}
	}
}

# It went well
character_event = {
	id = treasurefleet.63
	desc = EVTDESC_TREASURE_FLEET_63
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_63 # Great!
	}
}

# It went poorly
character_event = {
	id = treasurefleet.64
	desc = EVTDESC_TREASURE_FLEET_64
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_64 # I see...
	}
}

### Chancellor might help (Diplomacy)

# Chancellor gets event
character_event = {
	id = treasurefleet.65
	desc = EVTDESC_TREASURE_FLEET_65
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_65 # Yes!
		
		random_list = {
			50 = {
				modifier = {
					factor = 2
					diplomacy = 28
				}
				modifier = {
					factor = 2
					diplomacy = 24
				}
				modifier = {
					factor = 2
					diplomacy = 16
				}
				hidden_tooltip = {
					2753 = { # Hangzhou
						90 = {
							add_or_boost_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
						}
						9 = {
							add_or_boost_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
						}
						1 = {
							add_or_boost_everything_permissible_effect = yes
						}
					}
					liege = {
						character_event = { id = treasurefleet.66 } # It goes well
					}
				}
			}
			50 = {
				modifier = {
					factor = 2
					NOT = {
						diplomacy = 12
					}
				}
				modifier = {
					factor = 2
					NOT = {
						diplomacy = 8
					}
				}
				modifier = {
					factor = 2
					NOT = {
						diplomacy = 4
					}
				}
				hidden_tooltip = {
					2753 = { # Hangzhou
						90 = {
							remove_or_weaken_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
						}
						9 = {
							remove_or_weaken_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
						}
						1 = {
							remove_or_weaken_everything_permissible_effect = yes
						}
					}
					liege = {
						character_event = { id = treasurefleet.67 } # It goes well
					}
				}
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				NOT = {
					opinion = {
						who = liege
						value = -25
					}
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_TREASURE_FLEET_65 # No!
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				opinion = {
					who = liege
					value = 25
				}
			}
		}
	}
}

# It went well
character_event = {
	id = treasurefleet.66
	desc = EVTDESC_TREASURE_FLEET_66
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_66 # Great!
	}
}

# It went poorly
character_event = {
	id = treasurefleet.67
	desc = EVTDESC_TREASURE_FLEET_67
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_67 # I see...
	}
}

### Marshal might help (Martial)

# Marshal gets event
character_event = {
	id = treasurefleet.68
	desc = EVTDESC_TREASURE_FLEET_68
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_68 # Yes!
		
		random_list = {
			50 = {
				modifier = {
					factor = 2
					martial = 28
				}
				modifier = {
					factor = 2
					martial = 24
				}
				modifier = {
					factor = 2
					martial = 16
				}
				hidden_tooltip = {
					2753 = { # Hangzhou
						90 = {
							add_or_boost_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
						}
						9 = {
							add_or_boost_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
						}
						1 = {
							add_or_boost_everything_permissible_effect = yes
						}
					}
					liege = {
						character_event = { id = treasurefleet.69 } # It goes well
					}
				}
			}
			50 = {
				modifier = {
					factor = 2
					NOT = {
						martial = 12
					}
				}
				modifier = {
					factor = 2
					NOT = {
						martial = 8
					}
				}
				modifier = {
					factor = 2
					NOT = {
						martial = 4
					}
				}
				hidden_tooltip = {
					2753 = { # Hangzhou
						90 = {
							remove_or_weaken_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
						}
						9 = {
							remove_or_weaken_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
						}
						1 = {
							remove_or_weaken_everything_permissible_effect = yes
						}
					}
					liege = {
						character_event = { id = treasurefleet.70 } # It goes well
					}
				}
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				NOT = {
					opinion = {
						who = liege
						value = -25
					}
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_TREASURE_FLEET_68 # No!
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				opinion = {
					who = liege
					value = 25
				}
			}
		}
	}
}

# It went well
character_event = {
	id = treasurefleet.69
	desc = EVTDESC_TREASURE_FLEET_69
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_69 # Great!
	}
}

# It went poorly
character_event = {
	id = treasurefleet.70
	desc = EVTDESC_TREASURE_FLEET_70
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_70 # I see...
	}
}

### Steward might help (Stewardship)

# Steward gets event
character_event = {
	id = treasurefleet.71
	desc = EVTDESC_TREASURE_FLEET_71
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_71 # Yes!
		
		random_list = {
			50 = {
				modifier = {
					factor = 2
					stewardship = 28
				}
				modifier = {
					factor = 2
					stewardship = 24
				}
				modifier = {
					factor = 2
					stewardship = 16
				}
				hidden_tooltip = {
					2753 = { # Hangzhou
						90 = {
							add_or_boost_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
						}
						9 = {
							add_or_boost_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
						}
						1 = {
							add_or_boost_everything_permissible_effect = yes
						}
					}
					liege = {
						character_event = { id = treasurefleet.72 } # It goes well
					}
				}
			}
			50 = {
				modifier = {
					factor = 2
					NOT = {
						stewardship = 12
					}
				}
				modifier = {
					factor = 2
					NOT = {
						stewardship = 8
					}
				}
				modifier = {
					factor = 2
					NOT = {
						stewardship = 4
					}
				}
				hidden_tooltip = {
					2753 = { # Hangzhou
						90 = {
							remove_or_weaken_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
						}
						9 = {
							remove_or_weaken_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
						}
						1 = {
							remove_or_weaken_everything_permissible_effect = yes
						}
					}
					liege = {
						character_event = { id = treasurefleet.73 } # It goes well
					}
				}
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				NOT = {
					opinion = {
						who = liege
						value = -25
					}
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_TREASURE_FLEET_71 # No!
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				opinion = {
					who = liege
					value = 25
				}
			}
		}
	}
}

# It went well
character_event = {
	id = treasurefleet.72
	desc = EVTDESC_TREASURE_FLEET_72
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_72 # Great!
	}
}

# It went poorly
character_event = {
	id = treasurefleet.73
	desc = EVTDESC_TREASURE_FLEET_73
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_73 # I see...
	}
}

### Spymaster might help (Intrigue)

# Spymaster gets event
character_event = {
	id = treasurefleet.74
	desc = EVTDESC_TREASURE_FLEET_74
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_74 # Yes!
		
		random_list = {
			50 = {
				modifier = {
					factor = 2
					intrigue = 28
				}
				modifier = {
					factor = 2
					intrigue = 24
				}
				modifier = {
					factor = 2
					intrigue = 16
				}
				hidden_tooltip = {
					2753 = { # Hangzhou
						90 = {
							add_or_boost_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
						}
						9 = {
							add_or_boost_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
						}
						1 = {
							add_or_boost_everything_permissible_effect = yes
						}
					}
					liege = {
						character_event = { id = treasurefleet.75 } # It goes well
					}
				}
			}
			50 = {
				modifier = {
					factor = 2
					NOT = {
						intrigue = 12
					}
				}
				modifier = {
					factor = 2
					NOT = {
						intrigue = 8
					}
				}
				modifier = {
					factor = 2
					NOT = {
						intrigue = 4
					}
				}
				hidden_tooltip = {
					2753 = { # Hangzhou
						90 = {
							remove_or_weaken_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
						}
						9 = {
							remove_or_weaken_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
						}
						1 = {
							remove_or_weaken_everything_permissible_effect = yes
						}
					}
					liege = {
						character_event = { id = treasurefleet.76 } # It goes well
					}
				}
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				NOT = {
					opinion = {
						who = liege
						value = -25
					}
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_TREASURE_FLEET_74 # No!
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				opinion = {
					who = liege
					value = 25
				}
			}
		}
	}
}

# It went well
character_event = {
	id = treasurefleet.75
	desc = EVTDESC_TREASURE_FLEET_75
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_75 # Great!
	}
}

# It went poorly
character_event = {
	id = treasurefleet.76
	desc = EVTDESC_TREASURE_FLEET_76
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_76 # I see...
	}
}

### Chaplain might help (Learning)

# Chaplain gets event
character_event = {
	id = treasurefleet.77
	desc = EVTDESC_TREASURE_FLEET_77
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_77 # Yes!
		
		random_list = {
			50 = {
				modifier = {
					factor = 2
					learning = 28
				}
				modifier = {
					factor = 2
					learning = 24
				}
				modifier = {
					factor = 2
					learning = 16
				}
				hidden_tooltip = {
					2753 = { # Hangzhou
						90 = {
							add_or_boost_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
						}
						9 = {
							add_or_boost_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
						}
						1 = {
							add_or_boost_everything_permissible_effect = yes
						}
					}
					liege = {
						character_event = { id = treasurefleet.78 } # It goes well
					}
				}
			}
			50 = {
				modifier = {
					factor = 2
					NOT = {
						learning = 12
					}
				}
				modifier = {
					factor = 2
					NOT = {
						learning = 8
					}
				}
				modifier = {
					factor = 2
					NOT = {
						learning = 4
					}
				}
				hidden_tooltip = {
					2753 = { # Hangzhou
						90 = {
							remove_or_weaken_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
						}
						9 = {
							remove_or_weaken_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
						}
						1 = {
							remove_or_weaken_everything_permissible_effect = yes
						}
					}
					liege = {
						character_event = { id = treasurefleet.79 } # It goes well
					}
				}
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				NOT = {
					opinion = {
						who = liege
						value = -25
					}
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_TREASURE_FLEET_62 # No!
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				opinion = {
					who = liege
					value = 25
				}
			}
		}
	}
}

# It went well
character_event = {
	id = treasurefleet.78
	desc = EVTDESC_TREASURE_FLEET_78
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_78 # Great!
	}
}

# It went poorly
character_event = {
	id = treasurefleet.79
	desc = EVTDESC_TREASURE_FLEET_79
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_79 # I see...
	}
}

### Advisor might help - all stats might help or hinder

# Random stat help?
character_event = {
	id = treasurefleet.80
	desc = EVTDESC_TREASURE_FLEET_80
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_80 # Yes!
		
		random_list = {
			50 = {
				modifier = {
					factor = 2
					diplomacy = 28
				}
				modifier = {
					factor = 2
					diplomacy = 24
				}
				modifier = {
					factor = 2
					diplomacy = 16
				}
				modifier = {
					factor = 2
					martial = 28
				}
				modifier = {
					factor = 2
					martial = 24
				}
				modifier = {
					factor = 2
					martial = 16
				}
				modifier = {
					factor = 2
					stewardship = 28
				}
				modifier = {
					factor = 2
					stewardship = 24
				}
				modifier = {
					factor = 2
					stewardship = 16
				}
				modifier = {
					factor = 2
					intrigue = 28
				}
				modifier = {
					factor = 2
					intrigue = 24
				}
				modifier = {
					factor = 2
					intrigue = 16
				}
				modifier = {
					factor = 2
					learning = 28
				}
				modifier = {
					factor = 2
					learning = 24
				}
				modifier = {
					factor = 2
					learning = 16
				}
				hidden_tooltip = {
					2753 = { # Hangzhou
						90 = {
							add_or_boost_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
						}
						9 = {
							add_or_boost_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
						}
						1 = {
							add_or_boost_everything_permissible_effect = yes
						}
					}
					liege = {
						character_event = { id = treasurefleet.81 } # It goes well
					}
				}
			}
			50 = {
				modifier = {
					factor = 2
					NOT = {
						diplomacy = 12
					}
				}
				modifier = {
					factor = 2
					NOT = {
						diplomacy = 8
					}
				}
				modifier = {
					factor = 2
					NOT = {
						diplomacy = 4
					}
				}
				modifier = {
					factor = 2
					NOT = {
						martial = 12
					}
				}
				modifier = {
					factor = 2
					NOT = {
						martial = 8
					}
				}
				modifier = {
					factor = 2
					NOT = {
						martial = 4
					}
				}
				modifier = {
					factor = 2
					NOT = {
						stewardship = 12
					}
				}
				modifier = {
					factor = 2
					NOT = {
						stewardship = 8
					}
				}
				modifier = {
					factor = 2
					NOT = {
						stewardship = 4
					}
				}
				modifier = {
					factor = 2
					NOT = {
						intrigue = 12
					}
				}
				modifier = {
					factor = 2
					NOT = {
						intrigue = 8
					}
				}
				modifier = {
					factor = 2
					NOT = {
						intrigue = 4
					}
				}
				modifier = {
					factor = 2
					NOT = {
						learning = 12
					}
				}
				modifier = {
					factor = 2
					NOT = {
						learning = 8
					}
				}
				modifier = {
					factor = 2
					NOT = {
						learning = 4
					}
				}
				hidden_tooltip = {
					2753 = { # Hangzhou
						90 = {
							remove_or_weaken_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
						}
						9 = {
							remove_or_weaken_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
						}
						1 = {
							remove_or_weaken_everything_permissible_effect = yes
						}
					}
					liege = {
						character_event = { id = treasurefleet.82 } # It goes well
					}
				}
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				NOT = {
					opinion = {
						who = liege
						value = -25
					}
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_TREASURE_FLEET_80 # No!
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				opinion = {
					who = liege
					value = 25
				}
			}
		}
	}
}

# It went well
character_event = {
	id = treasurefleet.81
	desc = EVTDESC_TREASURE_FLEET_81
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_81 # Great!
	}
}

# It went poorly
character_event = {
	id = treasurefleet.82
	desc = EVTDESC_TREASURE_FLEET_82
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_82 # I see...
	}
}

##### Departure + general progress check

### Departure

# Treasure Fleet is ready - all aboard!
character_event = {
	id = treasurefleet.83
	desc = EVTDESC_TREASURE_FLEET_83
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_83 # All aboard!
		
		remove_trait = treasure_fleet_preparation
		
		activate_title = {
			title = d_treasure_fleet
			status = yes
		}
		
		if = {
			limit = {
				FROM = {
					persistent_event_target:treasure_fleet_commander = {
						is_alive = yes
						is_inaccessible_or_incapable_trigger = no
						is_landed = no
					}
				}
			}
			FROM = {
				persistent_event_target:treasure_fleet_commander = {
					grant_title = d_treasure_fleet
					set_defacto_liege = THIS
				}
			}
		}
		else = {
			create_new_court_eunuch_effect = yes
			new_character = {
				change_diplomacy = 2
				change_martial = 2
				change_stewardship = 2
				change_intrigue = 2
				change_learning = 2
				save_event_target_as = new_treasure_fleet_commander
				FROM = {
					save_persistent_event_target = { name = treasure_fleet_commander scope = event_target:new_treasure_fleet_commander }
				}
				grant_title = d_treasure_fleet
				set_defacto_liege = THIS
 			}
		}
		
		hidden_tooltip = {
			any_realm_lord = {
				limit = {
					trait = treasure_fleet_preparation
				}
				if = {
					limit = {
						ai = no
					}
					character_event = { id = treasurefleet.84 }
				}
				else = {
					remove_trait = treasure_fleet_preparation
					add_trait = treasure_fleet_voyage
				}
			}
			FROM = {
				province_event = { id = treasurefleet.85 days = 1 } # Departure
			}
		}
	}
}

# Inform vassals that are joining
character_event = {
	id = treasurefleet.84
	desc = EVTDESC_TREASURE_FLEET_84
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_84 # All aboard!
		
		remove_trait = treasure_fleet_preparation
		add_trait = treasure_fleet_voyage
	}
}

# Check to see how it goes
province_event = {
	id = treasurefleet.85
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		random_list = {
			95 = {
				# Uneventful
				e_china = {
					holder_scope = {
						narrative_event = { id = treasurefleet.86 }
						any_realm_lord = {
							limit = {
								ai = no
								NOT = {
									trait = treasure_fleet_voyage
								}
							}
							narrative_event = { id = treasurefleet.88 }
						}
					}
				}
				d_treasure_fleet = {
					holder_scope = {
						narrative_event = { id = treasurefleet.87 }
					}
				}
				e_china = {
					holder_scope = {
						any_realm_lord = {
							limit = {
								ai = no
								trait = treasure_fleet_voyage
							}
							narrative_event = { id = treasurefleet.87 }
						}
					}
				}
				any_player = {
					limit = {
						NOR = {
							has_landed_title = e_china
							trait = treasure_fleet_voyage
							any_liege = {
								has_landed_title = e_china
							}
						}
					}
					narrative_event = { id = treasurefleet.89 }
				}
				set_province_flag = treasure_fleet_voyage_flag
				random_list = {
					20 = {
						set_province_flag = treasure_fleet_going_to_korea
					}
					80 = {
						set_province_flag = treasure_fleet_going_to_champa
					}
				}
				province_event = { id = treasurefleet.102 days = 15 } # Progress check
			}
			3 = {
				modifier = {
					factor = 0
					has_game_rule = {
						name = supernatural_events
						value = off
					}
				}
				# Celestial dragon
				e_china = {
					holder_scope = {
						narrative_event = { id = treasurefleet.90 }
						any_realm_lord = {
							limit = {
								ai = no
								NOT = {
									trait = treasure_fleet_voyage
								}
							}
							narrative_event = { id = treasurefleet.92 }
						}
					}
				}
				d_treasure_fleet = {
					holder_scope = {
						narrative_event = { id = treasurefleet.91 }
					}
				}
				e_china = {
					holder_scope = {
						any_realm_lord = {
							limit = {
								ai = no
								trait = treasure_fleet_voyage
							}
							narrative_event = { id = treasurefleet.91 }
						}
					}
				}
				any_player = {
					limit = {
						NOR = {
							has_landed_title = e_china
							trait = treasure_fleet_voyage
							any_liege = {
								has_landed_title = e_china
							}
						}
					}
					narrative_event = { id = treasurefleet.93 }
				}
				set_province_flag = treasure_fleet_voyage_flag
				random_list = {
					20 = {
						set_province_flag = treasure_fleet_going_to_korea
					}
					80 = {
						set_province_flag = treasure_fleet_going_to_champa
					}
				}
				province_event = { id = treasurefleet.102 days = 15 } # Progress check
			}
			1 = {
				modifier = {
					factor = 0
					NAND = {
						has_global_flag = first_dragon_attack
						NOR = {
							has_global_flag = dragon_injured
							has_global_flag = ongoing_dragon_attack
							has_global_flag = dragon_slain
						}
					}
				}
				# Red dragon
				e_china = {
					holder_scope = {
						narrative_event = { id = treasurefleet.94 }
						any_realm_lord = {
							limit = {
								ai = no
								NOT = {
									trait = treasure_fleet_voyage
								}
							}
							narrative_event = { id = treasurefleet.96 }
						}
					}
				}
				d_treasure_fleet = {
					holder_scope = {
						narrative_event = { id = treasurefleet.95 }
					}
				}
				e_china = {
					holder_scope = {
						any_realm_lord = {
							limit = {
								ai = no
								trait = treasure_fleet_voyage
							}
							narrative_event = { id = treasurefleet.95 }
						}
					}
				}
				any_player = {
					limit = {
						NOR = {
							has_landed_title = e_china
							trait = treasure_fleet_voyage
							any_liege = {
								has_landed_title = e_china
							}
						}
					}
					narrative_event = { id = treasurefleet.97 }
				}
			}
			1 = {
				# Fleet sinks in the harbour
				e_china = {
					holder_scope = {
						narrative_event = { id = treasurefleet.98 }
						any_realm_lord = {
							limit = {
								ai = no
								NOT = {
									trait = treasure_fleet_voyage
								}
							}
							narrative_event = { id = treasurefleet.100 }
						}
					}
				}
				d_treasure_fleet = {
					holder_scope = {
						narrative_event = { id = treasurefleet.99 }
					}
				}
				e_china = {
					holder_scope = {
						any_realm_lord = {
							limit = {
								ai = no
								trait = treasure_fleet_voyage
							}
							narrative_event = { id = treasurefleet.99 }
						}
					}
				}
				any_player = {
					limit = {
						NOR = {
							has_landed_title = e_china
							trait = treasure_fleet_voyage
							any_liege = {
								has_landed_title = e_china
							}
						}
					}
					narrative_event = { id = treasurefleet.101 }
				}
			}
		}
	}
}

# Departure is uneventful
narrative_event = {
	id = treasurefleet.86
	title = EVTTITLE_TREASURE_FLEET_86
	desc = EVTDESC_TREASURE_FLEET_86
	picture = GFX_evt_china_golden_age # TODO
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_86 # Auspicious!
		
		#TODO: MoH boost
	}
}

# Departure is uneventful - inform people that joined
narrative_event = {
	id = treasurefleet.87
	title = EVTTITLE_TREASURE_FLEET_87
	desc = EVTDESC_TREASURE_FLEET_87
	picture = GFX_evt_china_golden_age # TODO
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_87 # Auspicious!
	}
}

# Departure is uneventful - inform other vassals
narrative_event = {
	id = treasurefleet.88
	title = EVTTITLE_TREASURE_FLEET_88
	desc = EVTDESC_TREASURE_FLEET_88
	picture = GFX_evt_china_golden_age # TODO
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_88 # Auspicious!
	}
}

# Departure is uneventful - inform the world
narrative_event = {
	id = treasurefleet.89
	title = EVTTITLE_TREASURE_FLEET_89
	desc = EVTDESC_TREASURE_FLEET_89
	picture = GFX_evt_china_golden_age # TODO
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			any_realm_province = {
				can_naval_path_to = c_hangzhou
			}
		}
		name = EVTOPTA_TREASURE_FLEET_89 # Interesting...
	}
	
	option = {
		trigger = {
			NOT = {
				any_realm_province = {
					can_naval_path_to = c_hangzhou
				}
			}
		}
		name = EVTOPTB_TREASURE_FLEET_89 # I don't care!
	}
}

# Celestial dragon at departure
narrative_event = {
	id = treasurefleet.90
	title = EVTTITLE_TREASURE_FLEET_90
	desc = EVTDESC_TREASURE_FLEET_90
	picture = GFX_evt_china_golden_age # TODO
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_90 # Most auspicious!
		
		#TODO: MoH boost
	}
}

# Celestial dragon at departure - inform people that joined
narrative_event = {
	id = treasurefleet.91
	title = EVTTITLE_TREASURE_FLEET_91
	desc = EVTDESC_TREASURE_FLEET_91
	picture = GFX_evt_china_golden_age # TODO
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_91 # Most auspicious!
	}
}

# Celestial dragon at departure - inform other vassals
narrative_event = {
	id = treasurefleet.92
	title = EVTTITLE_TREASURE_FLEET_92
	desc = EVTDESC_TREASURE_FLEET_92
	picture = GFX_evt_china_golden_age # TODO
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_92 # Most auspicious!
	}
}

# Celestial dragon at departure - inform the world
narrative_event = {
	id = treasurefleet.93
	title = EVTTITLE_TREASURE_FLEET_93
	desc = EVTDESC_TREASURE_FLEET_93
	picture = GFX_evt_china_golden_age # TODO
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			any_realm_province = {
				can_naval_path_to = c_hangzhou
			}
		}
		name = EVTOPTA_TREASURE_FLEET_93 # Interesting...
	}
	
	option = {
		trigger = {
			NOT = {
				any_realm_province = {
					can_naval_path_to = c_hangzhou
				}
			}
		}
		name = EVTOPTB_TREASURE_FLEET_93 # I don't care!
	}
}

# Red dragon burns the fleet at departure
narrative_event = {
	id = treasurefleet.94
	title = EVTTITLE_TREASURE_FLEET_94
	desc = EVTDESC_TREASURE_FLEET_94
	picture = GFX_evt_china_golden_age # TODO
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_94 # Most inauspicious!
		
		#TODO: MoH loss
		clean_up_old_treasure_fleet_effect = yes
	}
}

# Red dragon burns the fleet at departure - inform people that joined
narrative_event = {
	id = treasurefleet.95
	title = EVTTITLE_TREASURE_FLEET_95
	desc = EVTDESC_TREASURE_FLEET_95
	picture = GFX_evt_china_golden_age # TODO
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_95 # Aargh!
		
		death = {
			death_reason = death_evil_dragon
		}
	}
}

# Red dragon burns the fleet at departure - inform other vassals
narrative_event = {
	id = treasurefleet.96
	title = EVTTITLE_TREASURE_FLEET_96
	desc = EVTDESC_TREASURE_FLEET_96
	picture = GFX_evt_china_golden_age # TODO
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_96 # Most inauspicious!
	}
}

# Red dragon burns the fleet at departure - inform the world
narrative_event = {
	id = treasurefleet.97
	title = EVTTITLE_TREASURE_FLEET_97
	desc = EVTDESC_TREASURE_FLEET_97
	picture = GFX_evt_china_golden_age # TODO
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_97 # So much for that...
	}
}

# Fleet sinks in the harbour
narrative_event = {
	id = treasurefleet.98
	title = EVTTITLE_TREASURE_FLEET_98
	desc = EVTDESC_TREASURE_FLEET_98
	picture = GFX_evt_china_golden_age # TODO
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_98 # Most inauspicious!
		
		#TODO: MoH loss
		clean_up_old_treasure_fleet_effect = yes
	}
}

# Fleet sinks in the harbour - inform people that joined
narrative_event = {
	id = treasurefleet.99
	title = EVTTITLE_TREASURE_FLEET_99
	desc = EVTDESC_TREASURE_FLEET_99
	picture = GFX_evt_china_golden_age # TODO
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_99 # I must swim to safety!
		
		random_list = {
			50 = {
				modifier = {
					factor = 5
					is_weak_trigger = yes
				}
				modifier = {
					factor = 5
					is_maimed_trigger = yes
				}
				modifier = {
					factor = 2
					is_dumb_trigger = yes
				}
				death = {
					death_reason = death_accident_drowning
				}
			}
			50 = {
				modifier = {
					factor = 5
					is_strong_trigger = yes
				}
				modifier = {
					factor = 2
					is_smart_trigger = yes
				}
			}
		}
	}
}

# Fleet sinks in the harbour - inform other vassals
narrative_event = {
	id = treasurefleet.100
	title = EVTTITLE_TREASURE_FLEET_100
	desc = EVTDESC_TREASURE_FLEET_100
	picture = GFX_evt_china_golden_age # TODO
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_100 # Most inauspicious!
	}
}

# Fleet sinks in the harbour - inform the world
narrative_event = {
	id = treasurefleet.101
	title = EVTTITLE_TREASURE_FLEET_101
	desc = EVTDESC_TREASURE_FLEET_101
	picture = GFX_evt_china_golden_age # TODO
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_101 # So much for that...
	}
}

### Progress check + maintenance for the title and treasure_fleet_voyage

# Check which chain to go to next - handled in a province!
province_event = {
	id = treasurefleet.102
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		treasure_fleet_voyage = {
			if = {
				limit = {
					NOT = {
						top_liege = {
							has_landed_title = e_china
						}
					}
				}
				remove_trait = treasure_fleet_voyage
			}
		}
		if = {
			limit = {
				d_treasure_fleet = {
					has_holder = yes
				}
			}
			if = { # First check if we should cancel the TF voyage
				limit = {
					OR = {
						has_province_flag = abort_treasure_fleet_asap
						e_china = {
							has_holder = no
						}
						e_china = {
							holder_scope = {
								is_chinese_emperor_trigger = no
							}
						}
					}
					NOR = {
						has_province_flag = treasure_fleet_sunrise_invasion_flag
						has_province_flag = treasure_fleet_empire_in_the_west_flag
					}
				}
				abort_treasure_fleet_for_everyone_effect = yes # TODO; should perhaps be different here...
			}
			else = {
				random_list = {
					10 = {
						change_variable = {
							which = tf_supplies
							value = -1
						}
					}
					10 = {
						change_variable = {
							which = tf_supplies
							value = -2
						}
					}
					10 = {
						modifier = {
							factor = 0.5
							NOT = {
								check_variable = {
									which = tf_supplies
									value = 10
								}
							}
						}
						modifier = {
							factor = 0.1
							NOT = {
								check_variable = {
									which = tf_supplies
									value = 5
								}
							}
						}
						change_variable = {
							which = tf_supplies
							value = -3
						}
					}
					10 = {
						modifier = {
							factor = 0.5
							NOT = {
								check_variable = {
									which = tf_supplies
									value = 10
								}
							}
						}
						modifier = {
							factor = 0
							NOT = {
								check_variable = {
									which = tf_supplies
									value = 5
								}
							}
						}
						change_variable = {
							which = tf_supplies
							value = -4
						}
					}
					10 = {
						modifier = {
							factor = 0.5
							NOT = {
								check_variable = {
									which = tf_supplies
									value = 20
								}
							}
						}
						modifier = {
							factor = 0.1
							NOT = {
								check_variable = {
									which = tf_supplies
									value = 10
								}
							}
						}
						modifier = {
							factor = 0
							NOT = {
								check_variable = {
									which = tf_supplies
									value = 5
								}
							}
						}
						change_variable = {
							which = tf_supplies
							value = -2
						}
					}
				}
				if = {
					limit = {
						has_province_flag = treasure_fleet_voyage_flag
					}
					province_event = { id = treasurefleet.105 } # Journey events
				}
				else_if = {
					limit = {
						has_province_flag = treasure_fleet_port_flag
					}
					province_event = { id = treasurefleet.207 }# Arrival and port events
				}
				else_if = {
					limit = {
						has_province_flag = treasure_fleet_sunrise_invasion_flag
					}
					# TODO: Sunrise Invasion tie-in
				}
				else_if = {
					limit = {
						has_province_flag = treasure_fleet_empire_in_the_west_flag
					}
					# TODO: Empire in the West tie-in
				}
			}
		}
		else = {
			abort_treasure_fleet_for_everyone_effect = yes # TODO
		}
	}
}

# If the commander dies, spawn a new one on_death
character_event = {
	id = treasurefleet.103
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		has_landed_title = d_treasure_fleet
	}
	
	immediate = {
		create_new_court_eunuch_effect = yes
		new_character = {
			change_diplomacy = 2
			change_martial = 2
			change_stewardship = 2
			change_intrigue = 2
			change_learning = 2
			save_event_target_as = new_treasure_fleet_commander
			2753 = { # Hangzhou
				save_persistent_event_target = { name = treasure_fleet_commander scope = event_target:new_treasure_fleet_commander }
			}
			grant_title = d_treasure_fleet
			set_defacto_liege = THIS
		}
		# Make sure that artifacts are kept
		any_artifact = {
			transfer_artifact = {
				from = ROOT
				to = event_target:new_treasure_fleet_commander
			}
		}
		# Make sure that wealth is kept
		transfer_scaled_wealth = {
			from = ROOT
			to = event_target:new_treasure_fleet_commander
			value = all
		}
	}
}

# on_new_holder (and variations) event to remove treasure_fleet_voyage if we gain an empire title
character_event = {
	id = treasurefleet.104
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		tier = emperor
	}
	
	immediate = {
		remove_trait = treasure_fleet_voyage # Shouldn't ever be possessed by an independent rulers
	}
}

##### Journey events

### Sub-chain selection

# Journey event selection
province_event = {
	id = treasurefleet.105
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		random_list = {
			10 = {
				# Major event - commander gets the event
				d_treasure_fleet = {
					holder_scope = {
						random_list = {
							10 = {
								modifier = {
									factor = 0
									has_game_rule = {
										name = supernatural_events
										value = off
									}
								}
								# Kraken
								character_event = { id = treasurefleet.106 }
							}
							10 = {
								# Storm
								character_event = { id = treasurefleet.120 }
							}
							10 = {
								# Pirate attack
								character_event = { id = treasurefleet.186 }
							}
							10 = {
								# Supply ship lost - no need to inform others
								character_event = { id = treasurefleet.199 }
							}
							10 = {
								# Fireworks go off
								character_event = { id = treasurefleet.200 }
							}
						}
					}
				}
			}
			80 = {
				# Minor events - various members can get events (players are always reasonably likely to get something, AI may or may not)
				e_china = {
					holder_scope = {
						any_realm_lord = {
							limit = {
								trait = treasure_fleet_voyage
							}
							if = {
								limit = {
									ai = no
								}
								random_list = {
									10 = {
										modifier = {
											factor = 2
											trait = cannibal_trait
										}
										# Cannibals
										character_event = { id = treasurefleet.126 }
									}
									10 = {
										modifier = {
											factor = 0
											has_game_rule = {
												name = supernatural_events
												value = off
											}
										}
										# The Eye
										character_event = { id = treasurefleet.119 }
									}
									10 = {
										# Man overboard
										character_event = { id = treasurefleet.132 }
									}
									10 = {
										modifier = {
											factor = 0
											NOT = {
												any_playable_ruler = {
													trait = treasure_fleet_voyage
													NOR = {
														character = PREV
														any_friend = {
															character = PREV
														}
														any_lover = {
															character = PREV
														}
														any_rival = {
															character = PREV
														}
													}
												}
											}
										}
										# Made a friend
										character_event = { id = treasurefleet.139 }
									}
									10 = {
										modifier = {
											factor = 0
											NOT = {
												any_playable_ruler = {
													trait = treasure_fleet_voyage
													NOR = {
														character = PREV
														any_friend = {
															character = PREV
														}
														any_lover = {
															character = PREV
														}
														any_rival = {
															character = PREV
														}
													}
													OR = {
														AND = {
															PREV = {
																is_female = no
																NOT = {
																	trait = homosexual
																}
															}
															is_female = yes
															NOT = {
																trait = homosexual
															}
														}
														AND = {
															PREV = {
																is_female = yes
																NOT = {
																	trait = homosexual
																}
															}
															is_female = no
															NOT = {
																trait = homosexual
															}
														}
														AND = {
															PREV = {
																is_female = yes
																trait = homosexual
															}
															is_female = yes
															trait = homosexual
														}
														AND = {
															PREV = {
																is_female = no
																trait = homosexual
															}
															is_female = no
															trait = homosexual
														}
													}
												}
											}
										}
										# Tumble opportunity
										character_event = { id = treasurefleet.141 }
									}
									10 = {
										modifier = {
											factor = 0
											NOT = {
												any_playable_ruler = {
													trait = treasure_fleet_voyage
													NOR = {
														character = PREV
														any_friend = {
															character = PREV
														}
														any_lover = {
															character = PREV
														}
														any_rival = {
															character = PREV
														}
													}
												}
											}
										}
										# Made a rival
										character_event = { id = treasurefleet.147 }
									}
									10 = {
										modifier = {
											factor = 0
											NOT = {
												any_playable_ruler = {
													trait = treasure_fleet_voyage
													any_rival = {
														character = PREV
													}
												}
											}
										}
										# Try to arrange an accident for a rival
										character_event = { id = treasurefleet.149 }
									}
									10 = {
										# Dolphins
										character_event = { id = treasurefleet.170 }
									}
									10 = {
										# Sharks
										character_event = { id = treasurefleet.171 }
									}
									10 = {
										# Turtles
										character_event = { id = treasurefleet.172 }
									}
									10 = {
										# Drifting ship
										character_event = { id = treasurefleet.173 }
									}
									10 = {
										# Deserted island
										character_event = { id = treasurefleet.181 }
									}
									10 = {
										modifier = {
											factor = 0
											has_game_rule = {
												name = supernatural_events
												value = off
											}
										}
										# Flying Dutchman
										character_event = { id = treasurefleet.185 }
									}
									10 = {
										modifier = {
											factor = 0
											ROOT = {
												check_variable = {
													which = tf_supplies
													value = 10
												}
											}
										}
										modifier = {
											factor = 0.1
											ROOT = {
												check_variable = {
													which = tf_supplies
													value = 5
												}
											}
										}
										# Food shortage
										character_event = { id = treasurefleet.206 }
									}
									200 = {} # Nothing
								}
							}
							else = {
								random = {
									chance = 10
									random_list = {
										10 = {
											modifier = {
												factor = 2
												trait = cannibal_trait
											}
											# Cannibals
											character_event = { id = treasurefleet.126 days = 5 random = 10 }
										}
										10 = {
											modifier = {
												factor = 0
												has_game_rule = {
													name = supernatural_events
													value = off
												}
											}
											# The Eye
											character_event = { id = treasurefleet.119 days = 5 random = 10  }
										}
										10 = {
											# Man overboard
											character_event = { id = treasurefleet.132 days = 5 random = 10  }
										}
										10 = {
											modifier = {
												factor = 0
												NOT = {
													any_playable_ruler = {
														trait = treasure_fleet_voyage
														NOR = {
															character = PREV
															any_friend = {
																character = PREV
															}
															any_lover = {
																character = PREV
															}
															any_rival = {
																character = PREV
															}
														}
													}
												}
											}
											# Made a friend
											character_event = { id = treasurefleet.139 days = 5 random = 10  }
										}
										10 = {
											modifier = {
												factor = 0
												NOT = {
													any_playable_ruler = {
														trait = treasure_fleet_voyage
														NOR = {
															character = PREV
															any_friend = {
																character = PREV
															}
															any_lover = {
																character = PREV
															}
															any_rival = {
																character = PREV
															}
														}
														OR = {
															AND = {
																PREV = {
																	is_female = no
																	NOT = {
																		trait = homosexual
																	}
																}
																is_female = yes
																NOT = {
																	trait = homosexual
																}
															}
															AND = {
																PREV = {
																	is_female = yes
																	NOT = {
																		trait = homosexual
																	}
																}
																is_female = no
																NOT = {
																	trait = homosexual
																}
															}
															AND = {
																PREV = {
																	is_female = yes
																	trait = homosexual
																}
																is_female = yes
																trait = homosexual
															}
															AND = {
																PREV = {
																	is_female = no
																	trait = homosexual
																}
																is_female = no
																trait = homosexual
															}
														}
													}
												}
											}
											# Tumble opportunity
											character_event = { id = treasurefleet.141 days = 5 random = 10  }
										}
										10 = {
											modifier = {
												factor = 0
												NOT = {
													any_playable_ruler = {
														trait = treasure_fleet_voyage
														NOR = {
															character = PREV
															any_friend = {
																character = PREV
															}
															any_lover = {
																character = PREV
															}
															any_rival = {
																character = PREV
															}
														}
													}
												}
											}
											# Made a rival
											character_event = { id = treasurefleet.147 days = 5 random = 10  }
										}
										10 = {
											modifier = {
												factor = 0
												NOT = {
													any_playable_ruler = {
														trait = treasure_fleet_voyage
														any_rival = {
															character = PREV
														}
													}
												}
											}
											# Try to arrange an accident for a rival
											character_event = { id = treasurefleet.149 days = 5 random = 10  }
										}
										10 = {
											# Dolphins
											character_event = { id = treasurefleet.170 days = 5 random = 10  }
										}
										10 = {
											# Sharks
											character_event = { id = treasurefleet.171 days = 5 random = 10  }
										}
										10 = {
											# Turtles
											character_event = { id = treasurefleet.172 days = 5 random = 10  }
										}
										10 = {
											# Drifting ship
											character_event = { id = treasurefleet.173 days = 5 random = 10  }
										}
										10 = {
											# Deserted island
											character_event = { id = treasurefleet.181 days = 5 random = 10  }
										}
										10 = {
											modifier = {
												factor = 0
												has_game_rule = {
													name = supernatural_events
													value = off
												}
											}
											# Flying Dutchman
											character_event = { id = treasurefleet.185 days = 5 random = 10  }
										}
										10 = {
											modifier = {
												factor = 0
												ROOT = {
													check_variable = {
														which = tf_supplies
														value = 10
													}
												}
											}
											modifier = {
												factor = 0.1
												ROOT = {
													check_variable = {
														which = tf_supplies
														value = 5
													}
												}
											}
											# Food shortage
											character_event = { id = treasurefleet.206 days = 5 random = 10  }
										}
										200 = {} # Nothing
									}
								}
							}
						}
					}
				}
			}
			10 = {
				# Nothing happens
			}
		}
		clr_province_flag = treasure_fleet_voyage_flag
		set_province_flag = treasure_fleet_port_flag
		province_event = { id = treasurefleet.102 days = 30 } # Back to event selection
	}
}

### Kraken

# Kraken attacks ship - inform commander
character_event = {
	id = treasurefleet.106
	desc = EVTDESC_TREASURE_FLEET_106
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_106 # To arms!
		if = {
			limit = {
				FROM = {
					check_variable = {
						which = treasure_fleet_ship_strength
						value = 100
					}
				}
			}
			FROM = {
				random_list = {
					1 = {
						remove_or_weaken_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
					}
					1 = {
						remove_or_weaken_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
					}
					1 = {
						remove_or_weaken_everything_permissible_effect = yes
					}
				}
			}
			e_china = {
				holder_scope = {
					any_realm_lord = {
						limit = {
							trait = treasure_fleet_voyage
						}
						random_list = {
							1 = {
								character_event = { id = treasurefleet.107 } # Your ship was attacked!
							}
							99 = {
								character_event = { id = treasurefleet.108 } # Other ship was attacked!
							}
						}
					}
				}
			}
		}
		else_if = {
			limit = {
				FROM = {
					check_variable = {
						which = treasure_fleet_ship_strength
						value = 50
					}
				}
			}
			FROM = {
				random_list = {
					1 = {
						remove_or_weaken_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
					}
					1 = {
						remove_or_weaken_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
					}
					1 = {
						remove_or_weaken_everything_permissible_effect = yes
					}
				}
			}
			e_china = {
				holder_scope = {
					any_realm_lord = {
						limit = {
							trait = treasure_fleet_voyage
						}
						random_list = {
							1 = {
								character_event = { id = treasurefleet.107 } # Your ship was attacked!
							}
							49 = {
								character_event = { id = treasurefleet.108 } # Other ship was attacked!
							}
						}
					}
				}
			}
		}
		else_if = {
			limit = {
				FROM = {
					check_variable = {
						which = treasure_fleet_ship_strength
						value = 25
					}
				}
			}
			FROM = {
				random_list = {
					1 = {
						remove_or_weaken_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
					}
					1 = {
						remove_or_weaken_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
					}
					1 = {
						remove_or_weaken_everything_permissible_effect = yes
					}
				}
			}
			e_china = {
				holder_scope = {
					any_realm_lord = {
						limit = {
							trait = treasure_fleet_voyage
						}
						random_list = {
							1 = {
								character_event = { id = treasurefleet.107 } # Your ship was attacked!
							}
							24 = {
								character_event = { id = treasurefleet.108 } # Other ship was attacked!
							}
						}
					}
				}
			}
		}
		else_if = {
			limit = {
				FROM = {
					check_variable = {
						which = treasure_fleet_ship_strength
						value = 10
					}
				}
			}
			FROM = {
				random_list = {
					1 = {
						remove_or_weaken_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
					}
					1 = {
						remove_or_weaken_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
					}
					1 = {
						remove_or_weaken_everything_permissible_effect = yes
					}
				}
				if = {
					limit = {
						NOT = {
							check_variable = {
								which = treasure_fleet_ship_strength
								value = 2
							}
						}
					}
					set_variable = {
						which = treasure_fleet_ship_strength
						value = 2
					}
				}
			}
			e_china = {
				holder_scope = {
					any_realm_lord = {
						limit = {
							trait = treasure_fleet_voyage
						}
						random_list = {
							1 = {
								character_event = { id = treasurefleet.107 } # Your ship was attacked!
							}
							9 = {
								character_event = { id = treasurefleet.108 } # Other ship was attacked!
							}
						}
					}
				}
			}
		}
		else_if = {
			limit = {
				FROM = {
					check_variable = {
						which = treasure_fleet_ship_strength
						value = 5
					}
				}
			}
			FROM = {
				random_list = {
					1 = {
						remove_or_weaken_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
					}
					1 = {
						remove_or_weaken_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
					}
					1 = {
						remove_or_weaken_everything_permissible_effect = yes
					}
				}
				if = {
					limit = {
						NOT = {
							check_variable = {
								which = treasure_fleet_ship_strength
								value = 2
							}
						}
					}
					set_variable = {
						which = treasure_fleet_ship_strength
						value = 2
					}
				}
			}
			e_china = {
				holder_scope = {
					any_realm_lord = {
						limit = {
							trait = treasure_fleet_voyage
						}
						random_list = {
							1 = {
								character_event = { id = treasurefleet.107 } # Your ship was attacked!
							}
							4 = {
								character_event = { id = treasurefleet.108 } # Other ship was attacked!
							}
						}
					}
				}
			}
		}
		else_if = {
			limit = {
				FROM = {
					check_variable = {
						which = treasure_fleet_ship_strength
						value = 4
					}
				}
			}
			FROM = {
				random_list = {
					1 = {
						remove_or_weaken_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
					}
					1 = {
						remove_or_weaken_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
					}
					1 = {
						remove_or_weaken_everything_permissible_effect = yes
					}
				}
				if = {
					limit = {
						NOT = {
							check_variable = {
								which = treasure_fleet_ship_strength
								value = 2
							}
						}
					}
					set_variable = {
						which = treasure_fleet_ship_strength
						value = 2
					}
				}
			}
			e_china = {
				holder_scope = {
					any_realm_lord = {
						limit = {
							trait = treasure_fleet_voyage
						}
						random_list = {
							1 = {
								character_event = { id = treasurefleet.107 } # Your ship was attacked!
							}
							3 = {
								character_event = { id = treasurefleet.108 } # Other ship was attacked!
							}
						}
					}
				}
			}
		}
		else_if = {
			limit = {
				FROM = {
					check_variable = {
						which = treasure_fleet_ship_strength
						value = 3
					}
				}
			}
			FROM = {
				random_list = {
					1 = {
						remove_or_weaken_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
					}
					1 = {
						remove_or_weaken_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
					}
					1 = {
						remove_or_weaken_everything_permissible_effect = yes
					}
				}
				if = {
					limit = {
						NOT = {
							check_variable = {
								which = treasure_fleet_ship_strength
								value = 2
							}
						}
					}
					set_variable = {
						which = treasure_fleet_ship_strength
						value = 2
					}
				}
			}
			e_china = {
				holder_scope = {
					any_realm_lord = {
						limit = {
							trait = treasure_fleet_voyage
						}
						random_list = {
							1 = {
								character_event = { id = treasurefleet.107 } # Your ship was attacked!
							}
							2 = {
								character_event = { id = treasurefleet.108 } # Other ship was attacked!
							}
						}
					}
				}
			}
		}
		else_if = {
			limit = {
				FROM = {
					check_variable = {
						which = treasure_fleet_ship_strength
						value = 2
					}
				}
			}
			FROM = {
				random_list = {
					1 = {
						remove_or_weaken_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
					}
					1 = {
						remove_or_weaken_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
					}
					1 = {
						remove_or_weaken_everything_permissible_effect = yes
					}
				}
				if = {
					limit = {
						NOT = {
							check_variable = {
								which = treasure_fleet_ship_strength
								value = 2
							}
						}
					}
					set_variable = {
						which = treasure_fleet_ship_strength
						value = 2
					}
				}
			}
			e_china = {
				holder_scope = {
					any_realm_lord = {
						limit = {
							trait = treasure_fleet_voyage
						}
						random_list = {
							1 = {
								character_event = { id = treasurefleet.107 } # Your ship was attacked!
							}
							1 = {
								character_event = { id = treasurefleet.108 } # Other ship was attacked!
							}
						}
					}
				}
			}
		}
		else = {
			e_china = {
				holder_scope = {
					any_realm_lord = {
						limit = {
							trait = treasure_fleet_voyage
						}
						character_event = { id = treasurefleet.107 } # Your ship was attacked!
					}
				}
			}
		}
		FROM = {
			province_event = { id = treasurefleet.109 days = 1 } # Calculate the outcome
		}
	}
}

# Kraken attacks ship - inform people on that ship
character_event = {
	id = treasurefleet.107
	desc = EVTDESC_TREASURE_FLEET_107
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_107 # To arms!
		
		set_character_flag = tf_call_to_arms
	}
}

# Kraken attacks ship - inform people on other ships
character_event = {
	id = treasurefleet.108
	desc = EVTDESC_TREASURE_FLEET_108
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_108 # How horrible!
	}
}

# Check outcome
province_event = {
	id = treasurefleet.109
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		# First, let's see how strong the TF is
		set_variable = {
			which = tf_fighting_value
			value = 0
		}
		change_variable = {
			which = tf_fighting_value
			which = treasure_fleet_army_strength
		}
		multiply_variable = {
			which = tf_fighting_value
			value = 10
		}
		divide_variable = {
			which = tf_fighting_value
			which = treasure_fleet_ship_strength
		}
		set_variable = {
			which = tf_pcs
			value = 0
		}
		if = {
			limit = {
				is_variable_equal = {
					which = treasure_fleet_ship_strength
					value = 1
				}
			}
			d_treasure_fleet = {
				holder_scope = {
					export_to_variable = {
						which = tf_pcs
						value = combat_rating
						who = PREV
					}
					ROOT = {
						change_variable = {
							which = tf_pcs
							who = PREV
						}
					}
					set_variable = {
						which = tf_pcs
						value = 0
					}
				}
			}
		}
		e_china = {
			holder_scope = {
				any_realm_lord = {
					limit = {
						trait = treasure_fleet_voyage
						has_character_flag = tf_call_to_arms
					}
					export_to_variable = {
						which = tf_pcs
						value = combat_rating
						who = PREV
					}
					ROOT = {
						change_variable = {
							which = tf_pcs
							who = PREV
						}
					}
					set_variable = {
						which = tf_pcs
						value = 0
					}
					clr_character_flag = tf_call_to_arms
				}
			}
		}
		change_variable = {
			which = tf_fighting_value
			which = tf_pcs
		}
		
		# Then randomize the enemy
		random_list = {
			1 = {
				change_variable = {
					which = tf_fighting_value
					value = -500
				}
			}
			1 = {
				change_variable = {
					which = tf_fighting_value
					value = -250
				}
			}
			1 = {
				change_variable = {
					which = tf_fighting_value
					value = -100
				}
			}
			1 = {
				change_variable = {
					which = tf_fighting_value
					value = -50
				}
			}
		}
		
		# Now let's see what the outcome is
		if = {
			limit = {
				check_variable = {
					which = treasure_fleet_ship_strength
					value = 2
				}
			}
			if = {
				limit = {
					NOT = {
						check_variable = {
							which = tf_fighting_value
							value = 0
						}
					}
				}
				change_variable = {
					which = treasure_fleet_ship_strength
					value = -1
				}
				# Ship sinks
				d_treasure_fleet = {
					holder_scope = {
						character_event = { id = treasurefleet.113 }
					}
				}
				e_china = {
					holder_scope = {
						any_realm_lord = {
							limit = {
								trait = treasure_fleet_voyage
							}
							if = {
								limit = {
									has_character_flag = tf_call_to_arms
								}
								character_event = { id = treasurefleet.114 }
							}
							else = {
								character_event = { id = treasurefleet.115 }
							}
						}
					}
				}
			}
			else = {
				# Kraken driven off
				d_treasure_fleet = {
					holder_scope = {
						character_event = { id = treasurefleet.110 }
					}
				}
				e_china = {
					holder_scope = {
						any_realm_lord = {
							limit = {
								trait = treasure_fleet_voyage
							}
							if = {
								limit = {
									has_character_flag = tf_call_to_arms
								}
								character_event = { id = treasurefleet.111 }
							}
							else = {
								character_event = { id = treasurefleet.112 }
							}
						}
					}
				}
			}
			reduce_army_if_ships_sink_effect = yes
		}
		else = {
			# Special case: The fleet might be lost!
			if = {
				limit = {
					NOT = {
						check_variable = {
							which = tf_fighting_value
							value = 0
						}
					}
				}
				d_treasure_fleet = {
					holder_scope = {
						character_event = { id = treasurefleet.116 }
					}
				}
				e_china = {
					holder_scope = {
						any_realm_lord = {
							limit = {
								trait = treasure_fleet_voyage
							}
							character_event = { id = treasurefleet.116 }
						}
						character_event = { id = treasurefleet.117 }
					}
				}
				any_player = {
					limit = {
						NOR = {
							trait = treasure_fleet_voyage
							has_landed_title = e_china
						}
					}
					character_event = { id = treasurefleet.118 }
				}
			}
			else = {
				# Kraken driven off
				d_treasure_fleet = {
					holder_scope = {
						character_event = { id = treasurefleet.110 }
					}
				}
				e_china = {
					holder_scope = {
						any_realm_lord = {
							limit = {
								trait = treasure_fleet_voyage
							}
							if = {
								limit = {
									has_character_flag = tf_call_to_arms
								}
								character_event = { id = treasurefleet.111 }
							}
							else = {
								character_event = { id = treasurefleet.112 }
							}
						}
					}
				}
			}
		}
	}
}

# Kraken driven off - inform commander
character_event = {
	id = treasurefleet.110
	desc = EVTDESC_TREASURE_FLEET_110
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_110 # Great!
		
		prestige = 100
	}
}

# Kraken driven off - inform people on that ship
character_event = {
	id = treasurefleet.111
	desc = EVTDESC_TREASURE_FLEET_111
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_111 # Great!
		
		prestige = 100
	}
}

# Kraken driven off - inform people on other ships
character_event = {
	id = treasurefleet.112
	desc = EVTDESC_TREASURE_FLEET_112
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_112 # Great!
		
		prestige = 100
	}
}

# Ship destroyed - inform commander
character_event = {
	id = treasurefleet.113
	desc = EVTDESC_TREASURE_FLEET_113
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_113 # Oh, no!
	}
}

# Ship destroyed - inform people on that ship
character_event = {
	id = treasurefleet.114
	desc = EVTDESC_TREASURE_FLEET_114
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_114 # I must swim to safety!
		
		random_list = {
			50 = {}
			50 = {
				add_trait = wounded
			}
		}
		
		random_list = {
			50 = {
				modifier = {
					factor = 5
					is_weak_trigger = yes
				}
				modifier = {
					factor = 5
					is_maimed_trigger = yes
				}
				modifier = {
					factor = 2
					is_dumb_trigger = yes
				}
				death = {
					death_reason = death_accident_drowning
				}
			}
			50 = {
				modifier = {
					factor = 5
					is_strong_trigger = yes
				}
				modifier = {
					factor = 2
					is_smart_trigger = yes
				}
			}
		}
	}
}

# Ship destroyed - inform people on other ships
character_event = {
	id = treasurefleet.115
	desc = EVTDESC_TREASURE_FLEET_115
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_115 # Oh, no!
	}
}

# Last ship destroyed - inform all TF people
character_event = {
	id = treasurefleet.116
	desc = EVTDESC_TREASURE_FLEET_116
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_116 # Aargh!
		
		death = {
			death_reason = death_accident_drowning
		}
	}
}

# Last ship destroyed - inform the EoC
character_event = {
	id = treasurefleet.117
	desc = EVTDESC_TREASURE_FLEET_117
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_117 # How inauspicious!
		
		prestige = -500
		
		# TODO: Grace penalty
	}
}

# Last ship destroyed - inform the world
character_event = {
	id = treasurefleet.118
	desc = EVTDESC_TREASURE_FLEET_118
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_118 # I see...
	}
}

### The Eye

# We are beheld!
character_event = {
	id = treasurefleet.119
	desc = EVTDESC_TREASURE_FLEET_119
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			NOT = {
				trait = lunatic
			}
		}
		
		name = EVTOPTA_TREASURE_FLEET_119 # Is that... an eye?
		
		random = {
			chance = 50
			add_trait = lunatic
		}
	}
	
	option = {
		trigger = {
			trait = lunatic
		}
		
		name = EVTOPTB_TREASURE_FLEET_119 # IT SEES US!
		
		prestige = -50
	}
}

### Storm

# Storm - inform commander
character_event = {
	id = treasurefleet.120
	desc = EVTDESC_TREASURE_FLEET_120
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_120 # Grab on to something!
		FROM = {
			random_list = {
				1 = {
					remove_or_weaken_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
				}
				1 = {
					remove_or_weaken_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
				}
				1 = {
					remove_or_weaken_everything_permissible_effect = yes
				}
			}
		}
		if = {
			limit = {
				FROM = {
					check_variable = {
						which = treasure_fleet_ship_strength
						value = 100
					}
				}
			}
			e_china = {
				holder_scope = {
					any_realm_lord = {
						limit = {
							trait = treasure_fleet_voyage
						}
						random_list = {
							1 = {
								character_event = { id = treasurefleet.121 } # Your ship sinks
							}
							99 = {
								character_event = { id = treasurefleet.122 } # Other ship sinks
							}
						}
					}
				}
			}
		}
		else_if = {
			limit = {
				FROM = {
					check_variable = {
						which = treasure_fleet_ship_strength
						value = 50
					}
				}
			}
			e_china = {
				holder_scope = {
					any_realm_lord = {
						limit = {
							trait = treasure_fleet_voyage
						}
						random_list = {
							1 = {
								character_event = { id = treasurefleet.121 } # Your ship sinks
							}
							45 = {
								character_event = { id = treasurefleet.122 } # Other ship sinks
							}
						}
					}
				}
			}
		}
		else_if = {
			limit = {
				FROM = {
					check_variable = {
						which = treasure_fleet_ship_strength
						value = 25
					}
				}
			}
			e_china = {
				holder_scope = {
					any_realm_lord = {
						limit = {
							trait = treasure_fleet_voyage
						}
						random_list = {
							1 = {
								character_event = { id = treasurefleet.121 } # Your ship sinks
							}
							24 = {
								character_event = { id = treasurefleet.122 } # Other ship sinks
							}
						}
					}
				}
			}
		}
		else_if = {
			limit = {
				FROM = {
					check_variable = {
						which = treasure_fleet_ship_strength
						value = 10
					}
				}
			}
			e_china = {
				holder_scope = {
					any_realm_lord = {
						limit = {
							trait = treasure_fleet_voyage
						}
						random_list = {
							1 = {
								character_event = { id = treasurefleet.121 } # Your ship sinks
							}
							9 = {
								character_event = { id = treasurefleet.122 } # Other ship sinks
							}
						}
					}
				}
			}
		}
		else_if = {
			limit = {
				FROM = {
					check_variable = {
						which = treasure_fleet_ship_strength
						value = 5
					}
				}
			}
			e_china = {
				holder_scope = {
					any_realm_lord = {
						limit = {
							trait = treasure_fleet_voyage
						}
						random_list = {
							1 = {
								character_event = { id = treasurefleet.121 } # Your ship sinks
							}
							4 = {
								character_event = { id = treasurefleet.122 } # Other ship sinks
							}
						}
					}
				}
			}
		}
		else_if = {
			limit = {
				FROM = {
					check_variable = {
						which = treasure_fleet_ship_strength
						value = 4
					}
				}
			}
			e_china = {
				holder_scope = {
					any_realm_lord = {
						limit = {
							trait = treasure_fleet_voyage
						}
						random_list = {
							1 = {
								character_event = { id = treasurefleet.121 } # Your ship sinks
							}
							3 = {
								character_event = { id = treasurefleet.122 } # Other ship sinks
							}
						}
					}
				}
			}
		}
		else_if = {
			limit = {
				FROM = {
					check_variable = {
						which = treasure_fleet_ship_strength
						value = 3
					}
				}
			}
			e_china = {
				holder_scope = {
					any_realm_lord = {
						limit = {
							trait = treasure_fleet_voyage
						}
						random_list = {
							1 = {
								character_event = { id = treasurefleet.121 } # Your ship sinks
							}
							2 = {
								character_event = { id = treasurefleet.122 } # Other ship sinks
							}
						}
					}
				}
			}
		}
		else_if = {
			limit = {
				FROM = {
					check_variable = {
						which = treasure_fleet_ship_strength
						value = 2
					}
				}
			}
			e_china = {
				holder_scope = {
					any_realm_lord = {
						limit = {
							trait = treasure_fleet_voyage
						}
						random_list = {
							1 = {
								character_event = { id = treasurefleet.121 } # Your ship sinks
							}
							1 = {
								character_event = { id = treasurefleet.122 } # Other ship sinks
							}
						}
					}
				}
			}
		}
		else_if = {
			limit = {
				FROM = {
					check_variable = {
						which = treasure_fleet_ship_strength
						value = 2
					}
				}
			}
			e_china = {
				holder_scope = {
					any_realm_lord = {
						limit = {
							trait = treasure_fleet_voyage
						}
						character_event = { id = treasurefleet.121 } # Your ship sinks
					}
				}
			}
		}
		else = {
			# Treasure Fleet lost with all hands
			d_treasure_fleet = {
				holder_scope = {
					character_event = { id = treasurefleet.123 }
				}
			}
			e_china = {
				holder_scope = {
					any_realm_lord = {
						limit = {
							trait = treasure_fleet_voyage
						}
						character_event = { id = treasurefleet.123 }
					}
					character_event = { id = treasurefleet.124 }
				}
			}
			any_player = {
				limit = {
					NOR = {
						trait = treasure_fleet_voyage
						has_landed_title = e_china
					}
				}
				character_event = { id = treasurefleet.125 }
			}
		}
	}
}

# Your ship sinks - inform people on that ship
character_event = {
	id = treasurefleet.121
	desc = EVTDESC_TREASURE_FLEET_121
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_121 # I must swim to safety!
		
		random_list = {
			50 = {
				modifier = {
					factor = 5
					is_weak_trigger = yes
				}
				modifier = {
					factor = 5
					is_maimed_trigger = yes
				}
				modifier = {
					factor = 2
					is_dumb_trigger = yes
				}
				death = {
					death_reason = death_accident_drowning
				}
			}
			50 = {
				modifier = {
					factor = 5
					is_strong_trigger = yes
				}
				modifier = {
					factor = 2
					is_smart_trigger = yes
				}
			}
		}
	}
}

# Other ship sinks - inform people on other ships
character_event = {
	id = treasurefleet.122
	desc = EVTDESC_TREASURE_FLEET_122
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_122 # Oh, no!
	}
}

# Last ship sinks - inform all TF people
character_event = {
	id = treasurefleet.123
	desc = EVTDESC_TREASURE_FLEET_123
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_123 # Aargh!
		
		death = {
			death_reason = death_accident_drowning
		}
	}
}

# Last ship sinks - inform the EoC
character_event = {
	id = treasurefleet.124
	desc = EVTDESC_TREASURE_FLEET_124
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_124 # How inauspicious!
		
		prestige = -500
		
		# TODO: Grace penalty
	}
}

# Last ship sinks - inform the world
character_event = {
	id = treasurefleet.125
	desc = EVTDESC_TREASURE_FLEET_125
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_125 # I see...
	}
}

### Cannibals

# Sailors offer to share a meal
character_event = {
	id = treasurefleet.126
	desc = EVTDESC_TREASURE_FLEET_126
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_126 # Sure!
		
		character_event = { id = treasurefleet.127 days = 1 random = 1 } # Gain Cannibal
	}
	
	option = {
		trigger = {
			NOT = {
				trait = cannibal_trait
			}
		}
		
		name = EVTOPTB_TREASURE_FLEET_126 # I don't think so!
		
		random_list = {
			25 = {
				character_event = { id = treasurefleet.128 days = 1 random = 1 } # Nothing
			}
			25 = {
				hidden_tooltip = {
					FROM = {
						change_variable = {
							which = treasure_fleet_army_strength
							value = -1
						}
					}
				}
				modifier = {
					factor = 0
					NOT = {
						combat_rating = 25
					}
				}
				modifier = {
					factor = 0.1
					NOT = {
						combat_rating = 50
					}
				}
				modifier = {
					factor = 10
					combat_rating = 75
				}
				character_event = { id = treasurefleet.129 days = 1 random = 1 } # You are attacked but fight off your attackers
			}
			25 = {
				modifier = {
					factor = 0
					combat_rating = 100
				}
				modifier = {
					factor = 0.1
					NOT = {
						combat_rating = 25
					}
				}
				hidden_tooltip = {
					FROM = {
						change_variable = {
							which = treasure_fleet_army_strength
							value = -1
						}
					}
				}
				character_event = { id = treasurefleet.130 days = 1 random = 1 } # You are attacked and wounded
			}
			25 = {
				modifier = {
					factor = 0
					combat_rating = 50
				}
				modifier = {
					factor = 0.1
					combat_rating = 25
				}
				hidden_tooltip = {
					random = {
						chance = 50
						FROM = {
							change_variable = {
								which = treasure_fleet_army_strength
								value = -1
							}
						}
					}
				}
				character_event = { id = treasurefleet.131 days = 1 random = 1 } # You are attacked and killed
			}
		}
	}
}

# You accepted - a smile, red and white
character_event = {
	id = treasurefleet.127
	desc = EVTDESC_TREASURE_FLEET_127
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_127 # Such a nice meal!
		
		add_trait = cannibal_trait
	}
}

# You refused, nothing happens
character_event = {
	id = treasurefleet.128
	desc = EVTDESC_TREASURE_FLEET_128
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_128 # How odd...
	}
}

# You refused - they attack - you win
character_event = {
	id = treasurefleet.129
	desc = EVTDESC_TREASURE_FLEET_129
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_129 # Good riddance!
		
		prestige = 50
	}
}

# You refused - they attack - you escape but get wounded
character_event = {
	id = treasurefleet.130
	desc = EVTDESC_TREASURE_FLEET_130
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_130 # I got away!
		
		prestige = 25
		add_trait = wounded
	}
}

# You refused - they attack - you get killed
character_event = {
	id = treasurefleet.131
	desc = EVTDESC_TREASURE_FLEET_131
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_131 # No! No! No!
		
		prestige = -50
		
		death = {
			death_reason = death_cannibals
		}
	}
}

### Man overboard

# You fell overboard
character_event = {
	id = treasurefleet.132
	desc = EVTDESC_TREASURE_FLEET_132
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_132 # I must get back!
		
		random_list = {
			50 = {
				modifier = {
					factor = 5
					is_weak_trigger = yes
				}
				modifier = {
					factor = 5
					is_maimed_trigger = yes
				}
				modifier = {
					factor = 2
					is_dumb_trigger = yes
				}
				if = {
					limit = {
						has_dlc = "Conclave"
					}
					character_event = { id = treasurefleet.133 days = 1 } # Favor
				}
				else = {
					character_event = { id = treasurefleet.138 days = 1 } # You drowned
				}
			}
			50 = {
				modifier = {
					factor = 5
					is_strong_trigger = yes
				}
				modifier = {
					factor = 2
					is_smart_trigger = yes
				}
				character_event = { id = treasurefleet.137 days = 1 } # You saved yourself
			}
		}
	}
}

# Someone offers a hand - accept and owe them a Favor?
character_event = {
	id = treasurefleet.133
	desc = EVTDESC_TREASURE_FLEET_133
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	immediate = {
		treasure_fleet_voyage = {
			limit = {
				NOR = {
					ai = no
					character = ROOT
					owes_favor_to = ROOT
					ROOT = {
						owes_favor_to = PREV
					}
				}
			}
			save_event_target_as = treasure_fleet_savior
		}
		if = {
			limit = {
				event_target:treasure_fleet_savior = {
					is_alive = yes
				}
			}
		}
		else = {
			d_treasure_fleet = {
				holder_scope = {
					save_event_target_as = treasure_fleet_savior
				}
			}
		}
	}
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_133 # I'll owe you one!
		
		character_event = { id = treasurefleet.134 days = 1 }
		
		ai_chance = {
			factor = 100
		}
	}
	
	option = {
		name = EVTOPTB_TREASURE_FLEET_133 # I don't need your help!
		
		random_list = {
			50 = {
				modifier = {
					factor = 5
					is_weak_trigger = yes
				}
				modifier = {
					factor = 5
					is_maimed_trigger = yes
				}
				modifier = {
					factor = 2
					is_dumb_trigger = yes
				}
				character_event = { id = treasurefleet.136 days = 1 } # Drowned
			}
			50 = {
				modifier = {
					factor = 5
					is_strong_trigger = yes
				}
				modifier = {
					factor = 2
					is_smart_trigger = yes
				}
				character_event = { id = treasurefleet.135 days = 1 } # You saved yourself
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				NOR = {
					trait = proud
					trait = stubborn
					event_target:treasure_fleet_savior = {
						any_rival = {
							character = ROOT
						}
					}
				}
			}
		}
	}
}

# Accepted and was saved
character_event = {
	id = treasurefleet.134
	desc = EVTDESC_TREASURE_FLEET_134
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_134 # It was worth it!
		
		event_target:treasure_fleet_savior = {
			add_favor = ROOT
		}
	}
}

# Refused and saved self
character_event = {
	id = treasurefleet.135
	desc = EVTDESC_TREASURE_FLEET_135
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_135 # I didn't need help!
		
		prestige = 25
	}
}

# Refused and drowned
character_event = {
	id = treasurefleet.136
	desc = EVTDESC_TREASURE_FLEET_136
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_136 # Not like this!
		
		death = {
			death_reason = death_accident_drowning
		}
	}
}

# Saved yourself
character_event = {
	id = treasurefleet.137
	desc = EVTDESC_TREASURE_FLEET_137
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_137 # I didn't need help!
		
		prestige = 25
	}
}

# Drowned
character_event = {
	id = treasurefleet.138
	desc = EVTDESC_TREASURE_FLEET_138
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_138 # Not like this!
		
		death = {
			death_reason = death_accident_drowning
		}
	}
}

### You made a friend

# You made a friend
character_event = {
	id = treasurefleet.139
	desc = EVTDESC_TREASURE_FLEET_139
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	immediate = {
		treasure_fleet_voyage = {
			limit = {
				NOR = {
					character = ROOT
					any_friend = {
						character = ROOT
					}
					any_lover = {
						character = ROOT
					}
					any_rival = {
						character = ROOT
					}
				}
			}
			save_event_target_as = treasure_fleet_friend
		}
	}
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_139 # That's great!
		
		add_friend = event_target:treasure_fleet_friend
		
		event_target:treasure_fleet_friend = {
			character_event = { id = treasurefleet.140 }
		}
	}
}

# Friend informed
character_event = {
	id = treasurefleet.140
	desc = EVTDESC_TREASURE_FLEET_140
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_140 # That's great!
		
		add_friend = FROM
	}
}

### Tumbling/lovers

# Someone else is attractive - attempt to seduce?
character_event = {
	id = treasurefleet.141
	desc = EVTDESC_TREASURE_FLEET_141
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	immediate = {
		treasure_fleet_voyage = {
			limit = {
				NOR = {
					character = ROOT
					any_friend = {
						character = ROOT
					}
					any_lover = {
						character = ROOT
					}
					any_rival = {
						character = ROOT
					}
				}
				OR = {
					AND = {
						is_female = no
						NOT = {
							trait = homosexual
						}
						ROOT = {
							is_female = yes
							NOT = {
								trait = homosexual
							}
						}
					}
					AND = {
						is_female = yes
						NOT = {
							trait = homosexual
						}
						ROOT = {
							is_female = no
							NOT = {
								trait = homosexual
							}
						}
					}
					AND = {
						is_female = yes
						trait = homosexual
						ROOT = {
							is_female = yes
							trait = homosexual
						}
					}
					AND = {
						is_female = no
						trait = homosexual
						ROOT = {
							is_female = no
							trait = homosexual
						}
					}
				}
			}
			save_event_target_as = treasure_fleet_lover
		}
	}
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_141
		
		event_target:treasure_fleet_lover = {
			character_event = { id = treasurefleet.142 days = 1 } # Other party approached
		}
		
		piety = -10
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = chaste
			}
			modifier = {
				factor = 0
				trait = celibate
			}
			modifier = {
				factor = 0
				is_ascetic_trigger = yes
				NOT = {
					trait = lustful
				}
			}
			modifier = {
				factor = 0.1
				event_target:treasure_fleet_lover = {
					is_unattractive_trigger = yes
				}
			}
			modifier = {
				factor = 5
				event_target:treasure_fleet_lover = {
					is_attractive_trigger = yes
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_TREASURE_FLEET_141 # I don't think so!
		
		piety = 10
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = lustful
			}
			modifier = {
				factor = 0
				OR = {
					trait = seducer
					trait = seductress
				}
			}
		}
	}
}

# Target approached
character_event = {
	id = treasurefleet.142
	desc = EVTDESC_TREASURE_FLEET_142
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_142 # Yes!
		
		FROM = {
			character_event = { id = treasurefleet.144 } # FROM informed
		}
		unprotected_sex_effect = yes
		
		piety = -10
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = chaste
			}
			modifier = {
				factor = 0
				trait = celibate
			}
			modifier = {
				factor = 0
				is_ascetic_trigger = yes
				NOT = {
					trait = lustful
				}
			}
			modifier = {
				factor = 0.1
				FROM = {
					is_unattractive_trigger = yes
				}
			}
			modifier = {
				factor = 5
				FROM = {
					is_attractive_trigger = yes
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_TREASURE_FLEET_142 # I don't think so!
		
		FROM = {
			character_event = { id = treasurefleet.143 } # FROM informed
		}
		
		piety = 10
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = lustful
			}
			modifier = {
				factor = 0
				OR = {
					trait = seducer
					trait = seductress
				}
			}
		}
	}
}

# Seduction failed
character_event = {
	id = treasurefleet.143
	desc = EVTDESC_TREASURE_FLEET_143
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_143 # I see...
		
		prestige = -25
	}
}

# Seduction succeeded - lovers?
character_event = {
	id = treasurefleet.144
	desc = EVTDESC_TREASURE_FLEET_144
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_144 # We should do this again!
		
		add_lover = FROM
		
		FROM = {
			character_event = { id = treasurefleet.145 days = 1 } # Inform FROM
		}
	}
	
	option = {
		name = EVTOPTB_TREASURE_FLEET_144 # This shouldn't become a long-term thing...
		
		FROM = {
			character_event = { id = treasurefleet.146 days = 1 } # Inform FROM
		}
	}
}

# Lovers
character_event = {
	id = treasurefleet.145
	desc = EVTDESC_TREASURE_FLEET_145
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_145 # That's great!
		
		add_lover = FROM
	}
}

# Not lovers
character_event = {
	id = treasurefleet.146
	desc = EVTDESC_TREASURE_FLEET_146
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_146 # Perhaps that's for the best...
	}
}

### Rivalry

# You made a rival
character_event = {
	id = treasurefleet.147
	desc = EVTDESC_TREASURE_FLEET_147
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	immediate = {
		treasure_fleet_voyage = {
			limit = {
				NOR = {
					character = ROOT
					any_friend = {
						character = ROOT
					}
					any_lover = {
						character = ROOT
					}
					any_rival = {
						character = ROOT
					}
				}
			}
			save_event_target_as = treasure_fleet_rival
		}
	}
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_147 # I hate them!
		
		add_rival = event_target:treasure_fleet_rival
		
		event_target:treasure_fleet_rival = {
			character_event = { id = treasurefleet.148 }
		}
	}
}

# Rival informed
character_event = {
	id = treasurefleet.148
	desc = EVTDESC_TREASURE_FLEET_148
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_148 # I hate them!
		
		add_rival = FROM
	}
}

### You have a rival in the fleet - try to kill them?

# You see an opportunity
character_event = {
	id = treasurefleet.149
	desc = EVTDESC_TREASURE_FLEET_149
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	immediate = {
		treasure_fleet_voyage = {
			limit = {
				any_rival = {
					character = ROOT
				}
			}
			save_event_target_as = treasure_fleet_rival_to_kill
		}
	}
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_149 # Do it!
		
		event_target:treasure_fleet_rival_to_kill = {
			random_list = {
				20 = {
					modifier = {
						factor = 2
						ROOT = {
							intrigue = 24
						}
					}
					modifier = {
						factor = 2
						ROOT = {
							intrigue = 20
						}
					}
					modifier = {
						factor = 2
						ROOT = {
							intrigue = 16
						}
					}
					modifier = {
						factor = 2
						NOT = {
							intrigue = 12
						}
					}
					modifier = {
						factor = 2
						NOT = {
							intrigue = 8
						}
					}
					modifier = {
						factor = 2
						NOT = {
							intrigue = 4
						}
					}
					modifier = {
						factor = 0
						combat_rating_diff = {
							character = ROOT
							value = 50
						}
					}
					modifier = {
						factor = 0.2
						combat_rating_diff = {
							character = ROOT
							value = 25
						}
					}
					modifier = {
						factor = 5
						combat_rating_diff = {
							character = ROOT
							value = -25
						}
					}
					modifier = {
						factor = 10
						combat_rating_diff = {
							character = ROOT
							value = -50
						}
					}
					# Thrown overboard; attacker unknown
					character_event = { id = treasurefleet.150 }
				}
				20 = {
					modifier = {
						factor = 2
						intrigue = 24
					}
					modifier = {
						factor = 2
						intrigue = 20
					}
					modifier = {
						factor = 2
						intrigue = 16
					}
					modifier = {
						factor = 2
						ROOT = {
							NOT = {
								intrigue = 12
							}
						}
					}
					modifier = {
						factor = 2
						ROOT = {
							NOT = {
								intrigue = 8
							}
						}
					}
					modifier = {
						factor = 2
						ROOT = {
							NOT = {
								intrigue = 4
							}
						}
					}
					modifier = {
						factor = 0
						combat_rating_diff = {
							character = ROOT
							value = 50
						}
					}
					modifier = {
						factor = 0.2
						combat_rating_diff = {
							character = ROOT
							value = 25
						}
					}
					modifier = {
						factor = 5
						combat_rating_diff = {
							character = ROOT
							value = -25
						}
					}
					modifier = {
						factor = 10
						combat_rating_diff = {
							character = ROOT
							value = -50
						}
					}
					# Thrown overboard; attacker known
					character_event = { id = treasurefleet.155 }
				}
				20 = {
					modifier = {
						factor = 2
						ROOT = {
							intrigue = 24
						}
					}
					modifier = {
						factor = 2
						ROOT = {
							intrigue = 20
						}
					}
					modifier = {
						factor = 2
						ROOT = {
							intrigue = 16
						}
					}
					modifier = {
						factor = 2
						NOT = {
							intrigue = 12
						}
					}
					modifier = {
						factor = 2
						NOT = {
							intrigue = 8
						}
					}
					modifier = {
						factor = 2
						NOT = {
							intrigue = 4
						}
					}
					modifier = {
						factor = 10
						combat_rating_diff = {
							character = ROOT
							value = 50
						}
					}
					modifier = {
						factor = 5
						combat_rating_diff = {
							character = ROOT
							value = 25
						}
					}
					modifier = {
						factor = 0.2
						combat_rating_diff = {
							character = ROOT
							value = -25
						}
					}
					modifier = {
						factor = 0.1
						combat_rating_diff = {
							character = ROOT
							value = -50
						}
					}
					# Not thrown overboard; attacker unknown
					character_event = { id = treasurefleet.160 }
				}
				20 = {
					modifier = {
						factor = 2
						intrigue = 24
					}
					modifier = {
						factor = 2
						intrigue = 20
					}
					modifier = {
						factor = 2
						intrigue = 16
					}
					modifier = {
						factor = 2
						ROOT = {
							NOT = {
								intrigue = 12
							}
						}
					}
					modifier = {
						factor = 2
						ROOT = {
							NOT = {
								intrigue = 8
							}
						}
					}
					modifier = {
						factor = 2
						ROOT = {
							NOT = {
								intrigue = 4
							}
						}
					}
					modifier = {
						factor = 10
						combat_rating_diff = {
							character = ROOT
							value = 50
						}
					}
					modifier = {
						factor = 5
						combat_rating_diff = {
							character = ROOT
							value = 25
						}
					}
					modifier = {
						factor = 0.2
						combat_rating_diff = {
							character = ROOT
							value = -25
						}
					}
					modifier = {
						factor = 0.1
						combat_rating_diff = {
							character = ROOT
							value = -50
						}
					}
					# Not thrown overboard; attacker known
					character_event = { id = treasurefleet.162 }
				}
				20 = {
					modifier = {
						factor = 2
						intrigue = 24
					}
					modifier = {
						factor = 2
						intrigue = 20
					}
					modifier = {
						factor = 2
						intrigue = 16
					}
					modifier = {
						factor = 2
						ROOT = {
							NOT = {
								intrigue = 12
							}
						}
					}
					modifier = {
						factor = 2
						ROOT = {
							NOT = {
								intrigue = 8
							}
						}
					}
					modifier = {
						factor = 2
						ROOT = {
							NOT = {
								intrigue = 4
							}
						}
					}
					modifier = {
						factor = 10
						combat_rating_diff = {
							character = ROOT
							value = 50
						}
					}
					modifier = {
						factor = 5
						combat_rating_diff = {
							character = ROOT
							value = 25
						}
					}
					modifier = {
						factor = 0.1
						combat_rating_diff = {
							character = ROOT
							value = -25
						}
					}
					modifier = {
						factor = 0
						combat_rating_diff = {
							character = ROOT
							value = -50
						}
					}
					# Threw attacker overboard
					character_event = { id = treasurefleet.164 }
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_TREASURE_FLEET_149 # It's too risky...
		
		prestige = -25
	}
}

# You were thrown from the ship by an unknown attacker - try to get back
character_event = {
	id = treasurefleet.150
	desc = EVTDESC_TREASURE_FLEET_150
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_150 # Get back to safety first, figure out who it was later!
		
		random_list = {
			50 = {
				modifier = {
					factor = 5
					is_weak_trigger = yes
				}
				modifier = {
					factor = 5
					is_maimed_trigger = yes
				}
				modifier = {
					factor = 2
					is_dumb_trigger = yes
				}
				character_event = { id = treasurefleet.153 days = 1 } # Drowned
			}
			50 = {
				modifier = {
					factor = 5
					is_strong_trigger = yes
				}
				modifier = {
					factor = 2
					is_smart_trigger = yes
				}
				character_event = { id = treasurefleet.151 days = 1 } # Survived
			}
		}
	}
}

# You succeded
character_event = {
	id = treasurefleet.151
	desc = EVTDESC_TREASURE_FLEET_151
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_151 # Phew!
		
		FROMFROM = {
			character_event = { id = treasurefleet.152 } # Inform the attacker
		}
	}
}

# Target survived, you're not revealed
character_event = {
	id = treasurefleet.152
	desc = EVTDESC_TREASURE_FLEET_152
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_152 # Unfortunate!
	}
}

# You failed
character_event = {
	id = treasurefleet.153
	desc = EVTDESC_TREASURE_FLEET_153
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_151 # No!
		
		death = {
			death_reason = death_murder_unknown_drowning
			killer = FROMFROM
		}
		
		FROMFROM = {
			character_event = { id = treasurefleet.154 } # Inform the attacker
		}
	}
}

# Target drowned, you're not revealed
character_event = {
	id = treasurefleet.154
	desc = EVTDESC_TREASURE_FLEET_154
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_154 # Just as planned!
	}
}

# You were thrown overboard by a known attacker - try to get back
character_event = {
	id = treasurefleet.155
	desc = EVTDESC_TREASURE_FLEET_155
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_155 # I saw the attacker!
		
		opinion = {
			who = FROM
			modifier = attempted_murder
		}
		
		random_list = {
			50 = {
				modifier = {
					factor = 5
					is_weak_trigger = yes
				}
				modifier = {
					factor = 5
					is_maimed_trigger = yes
				}
				modifier = {
					factor = 2
					is_dumb_trigger = yes
				}
				character_event = { id = treasurefleet.158 days = 1 } # Drowned
			}
			50 = {
				modifier = {
					factor = 5
					is_strong_trigger = yes
				}
				modifier = {
					factor = 2
					is_smart_trigger = yes
				}
				character_event = { id = treasurefleet.156 days = 1 } # Survived
			}
		}
	}
}

# You succeded
character_event = {
	id = treasurefleet.156
	desc = EVTDESC_TREASURE_FLEET_156
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_156 # Phew!
		
		FROMFROM = {
			character_event = { id = treasurefleet.157 } # Inform the attacker
		}
	}
}

# Target survived and knows that you did it
character_event = {
	id = treasurefleet.157
	desc = EVTDESC_TREASURE_FLEET_157
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_157 # That didn't go well!
	}
}

# You failed
character_event = {
	id = treasurefleet.158
	desc = EVTDESC_TREASURE_FLEET_158
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_158 # No!
		
		death = {
			death_reason = death_murder_drowning
			killer = FROMFROM
		}
		
		FROMFROM = {
			character_event = { id = treasurefleet.159 } # Inform the attacker
		}
	}
}

# Target drowned but knew you did it
character_event = {
	id = treasurefleet.159
	desc = EVTDESC_TREASURE_FLEET_159
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_159 # Good enough!
	}
}

# You managed to stay on the ship - didn't see the attacker
character_event = {
	id = treasurefleet.160
	desc = EVTDESC_TREASURE_FLEET_160
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_160 # Who was that?
		
		FROM = {
			character_event = { id = treasurefleet.161 days = 1 } # Inform the attacker
		}
	}
}

# Attempt failed, but you weren't discovered
character_event = {
	id = treasurefleet.161
	desc = EVTDESC_TREASURE_FLEET_161
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_161 # At least I wasn't seen...
	}
}

# You managed to stay on the ship - saw the attacker
character_event = {
	id = treasurefleet.162
	desc = EVTDESC_TREASURE_FLEET_162
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_162 # I saw them!
		
		opinion = {
			who = FROM
			modifier = attempted_murder
		}
		
		FROM = {
			character_event = { id = treasurefleet.163 days = 1 } # Inform the attacker
		}
	}
}

# Attempt failed, and you were discovered
character_event = {
	id = treasurefleet.163
	desc = EVTDESC_TREASURE_FLEET_163
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_163 # Curses!
	}
}

# You gained the upper hand and threw your attacker into the sea
character_event = {
	id = treasurefleet.164
	desc = EVTDESC_TREASURE_FLEET_164
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_164 # Ha!
		
		opinion = {
			who = FROM
			modifier = attempted_murder
		}
		
		FROM = {
			character_event = { id = treasurefleet.165 days = 1 }
		}
	}
}

# Thrown into the sea - discovered - try to get back
character_event = {
	id = treasurefleet.165
	desc = EVTDESC_TREASURE_FLEET_165
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_165 # That went poorly...
		
		random_list = {
			50 = {
				modifier = {
					factor = 5
					is_weak_trigger = yes
				}
				modifier = {
					factor = 5
					is_maimed_trigger = yes
				}
				modifier = {
					factor = 2
					is_dumb_trigger = yes
				}
				character_event = { id = treasurefleet.168 days = 1 } # Drowned
			}
			50 = {
				modifier = {
					factor = 5
					is_strong_trigger = yes
				}
				modifier = {
					factor = 2
					is_smart_trigger = yes
				}
				character_event = { id = treasurefleet.166 days = 1 } # Survived
			}
		}
	}
}

# Got back to safety
character_event = {
	id = treasurefleet.166
	desc = EVTDESC_TREASURE_FLEET_166
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_166 # Phew!
		
		FROMFROM = {
			character_event = { id = treasurefleet.167 } # Inform the target
		}
	}
}

# Attacker got back to safety
character_event = {
	id = treasurefleet.167
	desc = EVTDESC_TREASURE_FLEET_167
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_167 # At least I know to watch my back now...
	}
}

# Drowned
character_event = {
	id = treasurefleet.168
	desc = EVTDESC_TREASURE_FLEET_168
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_168 # No!
		
		death = {
			death_reason = death_accident_drowning # Technically correct!
		}
		
		FROMFROM = {
			character_event = { id = treasurefleet.169 } # Inform the target
		}
	}
}

# Attacker drowned
character_event = {
	id = treasurefleet.169
	desc = EVTDESC_TREASURE_FLEET_169
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_169 # Good riddance!
	}
}

### Dolphins

# Dolphins are nice
character_event = {
	id = treasurefleet.170
	desc = EVTDESC_TREASURE_FLEET_170
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_170 # Nice!
		
		prestige = 5
	}
}

### Sharks

# Sharks might be scary
character_event = {
	id = treasurefleet.171
	desc = EVTDESC_TREASURE_FLEET_171
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_171 # I really don't want to fall overboard...
		
		if = {
			limit = {
				trait = brave
			}
			random = {
				chance = 25
				remove_trait = brave
			}
		}
		else = {
			random = {
				chance = 25
				add_trait = craven
			}
		}
	}
}

### Turtles

# Turtles are nice
character_event = {
	id = treasurefleet.172
	desc = EVTDESC_TREASURE_FLEET_172
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_172 # Nice!
		
		prestige = 5
	}
}

### Drifting ship discovered

# Drifting ship - investigate?
character_event = {
	id = treasurefleet.173
	desc = EVTDESC_TREASURE_FLEET_173
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_173 # Yes!
		
		random_list = {
			1 = {
				character_event = { id = treasurefleet.174 days = 2 random = 5 } # Nothing
			}
			1 = {
				character_event = { id = treasurefleet.175 days = 2 random = 5 } # Dead crew
			}
			1 = {
				character_event = { id = treasurefleet.176 days = 2 random = 5 } # Hidden attacker
			}
		}
	}
	
	option = {
		name = EVTOPTB_TREASURE_FLEET_173 # No!
		
		prestige = -5
	}
}

# Investigated - nothing
character_event = {
	id = treasurefleet.174
	desc = EVTDESC_TREASURE_FLEET_174
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_174 # How odd...
	}
}

# Investigated - dead crew
character_event = {
	id = treasurefleet.175
	desc = EVTDESC_TREASURE_FLEET_175
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_175 # Who did this?
		
		random = {
			chance = 10
			add_trait = paranoid
		}
	}
}

# Investigated - hidden attacker
character_event = {
	id = treasurefleet.176
	desc = EVTDESC_TREASURE_FLEET_176
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_176 # I must fight!
		
		random_list = {
			25 = {
				modifier = {
					factor = 0
					NOT = {
						combat_rating = 25
					}
				}
				modifier = {
					factor = 2
					combat_rating = 50
				}
				# Unharmed
				character_event = { id = treasurefleet.177 days = 1 }
			}
			25 = {
				modifier = {
					factor = 0
					combat_rating = 75
				}
				# Wounded
				character_event = { id = treasurefleet.178 days = 1 }
			}
			25 = {
				modifier = {
					factor = 0
					combat_rating = 50
				}
				# Maimed
				character_event = { id = treasurefleet.179 days = 1 }
			}
			25 = {
				modifier = {
					factor = 0
					combat_rating = 25
				}
				# Killed
				character_event = { id = treasurefleet.180 days = 1 }
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = craven
			}
		}
	}
	
	option = {
		name = EVTOPTB_TREASURE_FLEET_176 # I must flee!
		
		if = {
			limit = {
				trait = brave
			}
			remove_trait = brave
		}
		else = {
			add_trait = craven
		}
		
		prestige = -10
		
		random_list = {
			50 = {
				modifier = {
					factor = 0
					NOT = {
						combat_rating = 25
					}
				}
				modifier = {
					factor = 2
					combat_rating = 50
				}
				# Unharmed
				character_event = { id = treasurefleet.177 days = 1 }
			}
			50 = {
				modifier = {
					factor = 0
					combat_rating = 75
				}
				# Wounded
				character_event = { id = treasurefleet.178 days = 1 }
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = brave
			}
		}
	}
}

# Unharmed
character_event = {
	id = treasurefleet.177
	desc = EVTDESC_TREASURE_FLEET_177
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_177 # We avenged the crew!
		
		prestige = 25
	}
}

# Wounded
character_event = {
	id = treasurefleet.178
	desc = EVTDESC_TREASURE_FLEET_178
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_178 # We avenged the crew!
		
		add_trait = wounded
		
		prestige = 10
	}
}

# Maimed
character_event = {
	id = treasurefleet.179
	desc = EVTDESC_TREASURE_FLEET_179
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_179 # We avenged the crew!
		
		add_maimed_trait_effect = yes
		
		prestige = 10
	}
}

# Died
character_event = {
	id = treasurefleet.180
	desc = EVTDESC_TREASURE_FLEET_180
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_180 # No!
		
		death = {
			death_reason = death_battle
		}
		
		prestige = -25
	}
}

### Deserted island

# Deserted island - investigate?
character_event = {
	id = treasurefleet.181
	desc = EVTDESC_TREASURE_FLEET_181
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_173 # Yes!
		
		random_list = {
			1 = {
				modifier = {
					factor = 0 # Only if you have the proper DLC!
					NOR = {
						has_dlc = "Mystics"
						has_dlc = "Jade Dragon"
					}
				}
				character_event = { id = treasurefleet.182 days = 2 random = 5 } # Artifact
			}
			9 = {
				character_event = { id = treasurefleet.183 days = 2 random = 5 } # Treasure map
			}
			90 = {
				character_event = { id = treasurefleet.182 days = 2 random = 5 } # Nothing
			}
		}
	}
	
	option = {
		name = EVTOPTB_TREASURE_FLEET_173 # No!
		
		prestige = -5
	}
}

# Found a minor artifact
character_event = {
	id = treasurefleet.182
	desc = EVTDESC_TREASURE_FLEET_182
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	immediate = {
		clr_character_flag = the_lily_crown
		clr_character_flag = noble_scepter
		clr_character_flag = engraved_sword
		clr_character_flag = engraved_dagger
		clr_character_flag = silver_bracelets
		clr_character_flag = collar_of_pearls
		clr_character_flag = circlet_of_twilight
		clr_character_flag = silver_staff
		clr_character_flag = iron_crown
		clr_character_flag = engraved_crown
		clr_character_flag = ceremonial_axe
		clr_character_flag = sword_tier_1_new
		clr_character_flag = scimitar_tier_1_new
		clr_character_flag = lance_tier_1_new
		clr_character_flag = axe_tier_1_new
		clr_character_flag = mace_tier_1_new
		clr_character_flag = bow_tier_1_new
		clr_character_flag = armor_tier_1
		clr_character_flag = horse_armor_tier_1
		random_list = {
			1 = {
				set_character_flag = the_lily_crown
			}
			1 = {
				set_character_flag = noble_scepter
			}
			1 = {
				set_character_flag = engraved_sword
			}
			1 = {
				set_character_flag = engraved_dagger
			}
			1 = {
				set_character_flag = silver_bracelets
			}
			1 = {
				set_character_flag = collar_of_pearls
			}
			1 = {
				set_character_flag = circlet_of_twilight
			}
			1 = {
				set_character_flag = silver_staff
			}
			1 = {
				set_character_flag = iron_crown
			}
			1 = {
				set_character_flag = engraved_crown
			}
			1 = {
				set_character_flag = ceremonial_axe
			}
			1 = {
				set_character_flag = sword_tier_1_new
			}
			1 = {
				set_character_flag = scimitar_tier_1_new
			}
			1 = {
				set_character_flag = lance_tier_1_new
			}
			1 = {
				set_character_flag = axe_tier_1_new
			}
			1 = {
				set_character_flag = mace_tier_1_new
			}
			1 = {
				set_character_flag = bow_tier_1_new
			}
			1 = {
				set_character_flag = armor_tier_1
			}
			1 = {
				set_character_flag = horse_armor_tier_1
			}
		}
	}
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_182 # I hope I can find a use for this...
		
		if = {
			limit = {
				has_character_flag = the_lily_crown
			}
			add_artifact = the_lily_crown
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		else_if = {
			limit = {
				has_character_flag = noble_scepter
			}
			add_artifact = noble_scepter
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		else_if = {
			limit = {
				has_character_flag = engraved_sword
			}
			add_artifact = engraved_sword
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		else_if = {
			limit = {
				has_character_flag = engraved_dagger
			}
			add_artifact = engraved_dagger
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		else_if = {
			limit = {
				has_character_flag = silver_bracelets
			}
			add_artifact = silver_bracelets
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		else_if = {
			limit = {
				has_character_flag = collar_of_pearls
			}
			add_artifact = collar_of_pearls
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		else_if = {
			limit = {
				has_character_flag = circlet_of_twilight
			}
			add_artifact = circlet_of_twilight
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		else_if = {
			limit = {
				has_character_flag = silver_staff
			}
			add_artifact = silver_staff
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		else_if = {
			limit = {
				has_character_flag = iron_crown
			}
			add_artifact = iron_crown
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		else_if = {
			limit = {
				has_character_flag = engraved_crown
			}
			add_artifact = engraved_crown
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		else_if = {
			limit = {
				has_character_flag = ceremonial_axe
			}
			add_artifact = ceremonial_axe
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		else_if = {
			limit = {
				has_character_flag = sword_tier_1_new
			}
			add_artifact = sword_tier_1_new
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		else_if = {
			limit = {
				has_character_flag = scimitar_tier_1_new
			}
			add_artifact = scimitar_tier_1_new
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		else_if = {
			limit = {
				has_character_flag = lance_tier_1_new
			}
			add_artifact = lance_tier_1_new
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		else_if = {
			limit = {
				has_character_flag = axe_tier_1_new
			}
			add_artifact = axe_tier_1_new
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		else_if = {
			limit = {
				has_character_flag = mace_tier_1_new
			}
			add_artifact = mace_tier_1_new
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		else_if = {
			limit = {
				has_character_flag = bow_tier_1_new
			}
			add_artifact = bow_tier_1_new
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		else_if = {
			limit = {
				has_character_flag = armor_tier_1
			}
			add_artifact = armor_tier_1
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		else_if = {
			limit = {
				has_character_flag = horse_armor_tier_1
			}
			add_artifact = horse_armor_tier_1
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
	}
}

# Found a treasure map
character_event = {
	id = treasurefleet.183
	desc = EVTDESC_TREASURE_FLEET_183
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_183 # Curious...
		
		# TODO: Add artifact treasure map
	}
}

# Nothing of note
character_event = {
	id = treasurefleet.184
	desc = EVTDESC_TREASURE_FLEET_184
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_184 # Onwards!
	}
}

### Flying Dutchman

# Flying Dutchman is spooky
character_event = {
	id = treasurefleet.185
	desc = EVTDESC_TREASURE_FLEET_185
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_185 # An ominous portent!
		
		if = {
			limit = {
				trait = brave
			}
			random = {
				chance = 25
				remove_trait = brave
			}
		}
		else = {
			random = {
				chance = 25
				add_trait = craven
			}
		}
	}
}

### Pirate attack

# Pirates attacks ship - inform commander
character_event = {
	id = treasurefleet.186
	desc = EVTDESC_TREASURE_FLEET_186
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_186 # To arms!
		if = {
			limit = {
				FROM = {
					check_variable = {
						which = treasure_fleet_ship_strength
						value = 100
					}
				}
			}
			FROM = {
				random_list = {
					1 = {
						remove_or_weaken_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
					}
					1 = {
						remove_or_weaken_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
					}
					1 = {
						remove_or_weaken_everything_permissible_effect = yes
					}
				}
			}
			e_china = {
				holder_scope = {
					any_realm_lord = {
						limit = {
							trait = treasure_fleet_voyage
						}
						random_list = {
							1 = {
								character_event = { id = treasurefleet.187 } # Your ship was attacked!
							}
							99 = {
								character_event = { id = treasurefleet.188 } # Other ship was attacked!
							}
						}
					}
				}
			}
		}
		else_if = {
			limit = {
				FROM = {
					check_variable = {
						which = treasure_fleet_ship_strength
						value = 50
					}
				}
			}
			FROM = {
				random_list = {
					1 = {
						remove_or_weaken_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
					}
					1 = {
						remove_or_weaken_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
					}
					1 = {
						remove_or_weaken_everything_permissible_effect = yes
					}
				}
			}
			e_china = {
				holder_scope = {
					any_realm_lord = {
						limit = {
							trait = treasure_fleet_voyage
						}
						random_list = {
							1 = {
								character_event = { id = treasurefleet.187 } # Your ship was attacked!
							}
							49 = {
								character_event = { id = treasurefleet.188 } # Other ship was attacked!
							}
						}
					}
				}
			}
		}
		else_if = {
			limit = {
				FROM = {
					check_variable = {
						which = treasure_fleet_ship_strength
						value = 25
					}
				}
			}
			FROM = {
				random_list = {
					1 = {
						remove_or_weaken_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
					}
					1 = {
						remove_or_weaken_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
					}
					1 = {
						remove_or_weaken_everything_permissible_effect = yes
					}
				}
			}
			e_china = {
				holder_scope = {
					any_realm_lord = {
						limit = {
							trait = treasure_fleet_voyage
						}
						random_list = {
							1 = {
								character_event = { id = treasurefleet.187 } # Your ship was attacked!
							}
							24 = {
								character_event = { id = treasurefleet.188 } # Other ship was attacked!
							}
						}
					}
				}
			}
		}
		else_if = {
			limit = {
				FROM = {
					check_variable = {
						which = treasure_fleet_ship_strength
						value = 10
					}
				}
			}
			FROM = {
				random_list = {
					1 = {
						remove_or_weaken_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
					}
					1 = {
						remove_or_weaken_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
					}
					1 = {
						remove_or_weaken_everything_permissible_effect = yes
					}
				}
				if = {
					limit = {
						NOT = {
							check_variable = {
								which = treasure_fleet_ship_strength
								value = 2
							}
						}
					}
					set_variable = {
						which = treasure_fleet_ship_strength
						value = 2
					}
				}
			}
			e_china = {
				holder_scope = {
					any_realm_lord = {
						limit = {
							trait = treasure_fleet_voyage
						}
						random_list = {
							1 = {
								character_event = { id = treasurefleet.187 } # Your ship was attacked!
							}
							9 = {
								character_event = { id = treasurefleet.188 } # Other ship was attacked!
							}
						}
					}
				}
			}
		}
		else_if = {
			limit = {
				FROM = {
					check_variable = {
						which = treasure_fleet_ship_strength
						value = 5
					}
				}
			}
			FROM = {
				random_list = {
					1 = {
						remove_or_weaken_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
					}
					1 = {
						remove_or_weaken_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
					}
					1 = {
						remove_or_weaken_everything_permissible_effect = yes
					}
				}
				if = {
					limit = {
						NOT = {
							check_variable = {
								which = treasure_fleet_ship_strength
								value = 2
							}
						}
					}
					set_variable = {
						which = treasure_fleet_ship_strength
						value = 2
					}
				}
			}
			e_china = {
				holder_scope = {
					any_realm_lord = {
						limit = {
							trait = treasure_fleet_voyage
						}
						random_list = {
							1 = {
								character_event = { id = treasurefleet.187 } # Your ship was attacked!
							}
							4 = {
								character_event = { id = treasurefleet.188 } # Other ship was attacked!
							}
						}
					}
				}
			}
		}
		else_if = {
			limit = {
				FROM = {
					check_variable = {
						which = treasure_fleet_ship_strength
						value = 4
					}
				}
			}
			FROM = {
				random_list = {
					1 = {
						remove_or_weaken_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
					}
					1 = {
						remove_or_weaken_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
					}
					1 = {
						remove_or_weaken_everything_permissible_effect = yes
					}
				}
				if = {
					limit = {
						NOT = {
							check_variable = {
								which = treasure_fleet_ship_strength
								value = 2
							}
						}
					}
					set_variable = {
						which = treasure_fleet_ship_strength
						value = 2
					}
				}
			}
			e_china = {
				holder_scope = {
					any_realm_lord = {
						limit = {
							trait = treasure_fleet_voyage
						}
						random_list = {
							1 = {
								character_event = { id = treasurefleet.187 } # Your ship was attacked!
							}
							3 = {
								character_event = { id = treasurefleet.188 } # Other ship was attacked!
							}
						}
					}
				}
			}
		}
		else_if = {
			limit = {
				FROM = {
					check_variable = {
						which = treasure_fleet_ship_strength
						value = 3
					}
				}
			}
			FROM = {
				random_list = {
					1 = {
						remove_or_weaken_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
					}
					1 = {
						remove_or_weaken_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
					}
					1 = {
						remove_or_weaken_everything_permissible_effect = yes
					}
				}
				if = {
					limit = {
						NOT = {
							check_variable = {
								which = treasure_fleet_ship_strength
								value = 2
							}
						}
					}
					set_variable = {
						which = treasure_fleet_ship_strength
						value = 2
					}
				}
			}
			e_china = {
				holder_scope = {
					any_realm_lord = {
						limit = {
							trait = treasure_fleet_voyage
						}
						random_list = {
							1 = {
								character_event = { id = treasurefleet.187 } # Your ship was attacked!
							}
							2 = {
								character_event = { id = treasurefleet.188 } # Other ship was attacked!
							}
						}
					}
				}
			}
		}
		else_if = {
			limit = {
				FROM = {
					check_variable = {
						which = treasure_fleet_ship_strength
						value = 2
					}
				}
			}
			FROM = {
				random_list = {
					1 = {
						remove_or_weaken_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
					}
					1 = {
						remove_or_weaken_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
					}
					1 = {
						remove_or_weaken_everything_permissible_effect = yes
					}
				}
				if = {
					limit = {
						NOT = {
							check_variable = {
								which = treasure_fleet_ship_strength
								value = 2
							}
						}
					}
					set_variable = {
						which = treasure_fleet_ship_strength
						value = 2
					}
				}
			}
			e_china = {
				holder_scope = {
					any_realm_lord = {
						limit = {
							trait = treasure_fleet_voyage
						}
						random_list = {
							1 = {
								character_event = { id = treasurefleet.187 } # Your ship was attacked!
							}
							1 = {
								character_event = { id = treasurefleet.188 } # Other ship was attacked!
							}
						}
					}
				}
			}
		}
		else = {
			e_china = {
				holder_scope = {
					any_realm_lord = {
						limit = {
							trait = treasure_fleet_voyage
						}
						character_event = { id = treasurefleet.187 } # Your ship was attacked!
					}
				}
			}
		}
		FROM = {
			province_event = { id = treasurefleet.189 days = 1 } # Calculate the outcome
		}
	}
}

# Pirates attacks ship - inform people on that ship
character_event = {
	id = treasurefleet.187
	desc = EVTDESC_TREASURE_FLEET_187
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_187 # To arms!
		
		set_character_flag = tf_call_to_arms
	}
}

# Pirates attacks ship - inform people on other ships
character_event = {
	id = treasurefleet.188
	desc = EVTDESC_TREASURE_FLEET_188
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_188 # How horrible!
	}
}

# Check outcome
province_event = {
	id = treasurefleet.189
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		# First, let's see how strong the TF is
		set_variable = {
			which = tf_fighting_value
			value = 0
		}
		change_variable = {
			which = tf_fighting_value
			which = treasure_fleet_army_strength
		}
		multiply_variable = {
			which = tf_fighting_value
			value = 10
		}
		divide_variable = {
			which = tf_fighting_value
			which = treasure_fleet_ship_strength
		}
		set_variable = {
			which = tf_pcs
			value = 0
		}
		if = {
			limit = {
				is_variable_equal = {
					which = treasure_fleet_ship_strength
					value = 1
				}
			}
			d_treasure_fleet = {
				holder_scope = {
					export_to_variable = {
						which = tf_pcs
						value = combat_rating
						who = PREV
					}
					ROOT = {
						change_variable = {
							which = tf_pcs
							who = PREV
						}
					}
					set_variable = {
						which = tf_pcs
						value = 0
					}
				}
			}
		}
		e_china = {
			holder_scope = {
				any_realm_lord = {
					limit = {
						trait = treasure_fleet_voyage
						has_character_flag = tf_call_to_arms
					}
					export_to_variable = {
						which = tf_pcs
						value = combat_rating
						who = PREV
					}
					ROOT = {
						change_variable = {
							which = tf_pcs
							who = PREV
						}
					}
					set_variable = {
						which = tf_pcs
						value = 0
					}
				}
			}
		}
		change_variable = {
			which = tf_fighting_value
			which = tf_pcs
		}
		
		# Then randomize the enemy
		random_list = {
			1 = {
				change_variable = {
					which = tf_fighting_value
					value = -500
				}
			}
			1 = {
				change_variable = {
					which = tf_fighting_value
					value = -250
				}
			}
			1 = {
				change_variable = {
					which = tf_fighting_value
					value = -100
				}
			}
			1 = {
				change_variable = {
					which = tf_fighting_value
					value = -50
				}
			}
		}
		
		# Now let's see what the outcome is
		if = {
			limit = {
				check_variable = {
					which = treasure_fleet_ship_strength
					value = 2
				}
			}
			if = {
				limit = {
					NOT = {
						check_variable = {
							which = tf_fighting_value
							value = 0
						}
					}
				}
				change_variable = {
					which = treasure_fleet_ship_strength
					value = -1
				}
				# Ship sinks
				d_treasure_fleet = {
					holder_scope = {
						character_event = { id = treasurefleet.193 }
					}
				}
				e_china = {
					holder_scope = {
						any_realm_lord = {
							limit = {
								trait = treasure_fleet_voyage
							}
							if = {
								limit = {
									has_character_flag = tf_call_to_arms
								}
								character_event = { id = treasurefleet.194 }
							}
							else = {
								character_event = { id = treasurefleet.195 }
							}
						}
					}
				}
			}
			else = {
				# Pirates driven off
				d_treasure_fleet = {
					holder_scope = {
						character_event = { id = treasurefleet.190 }
					}
				}
				e_china = {
					holder_scope = {
						any_realm_lord = {
							limit = {
								trait = treasure_fleet_voyage
							}
							if = {
								limit = {
									has_character_flag = tf_call_to_arms
								}
								character_event = { id = treasurefleet.191 }
							}
							else = {
								character_event = { id = treasurefleet.192 }
							}
						}
					}
				}
			}
			reduce_army_if_ships_sink_effect = yes
		}
		else = {
			# Special case: The fleet might be lost!
			if = {
				limit = {
					NOT = {
						check_variable = {
							which = tf_fighting_value
							value = 0
						}
					}
				}
				d_treasure_fleet = {
					holder_scope = {
						character_event = { id = treasurefleet.196 }
					}
				}
				e_china = {
					holder_scope = {
						any_realm_lord = {
							limit = {
								trait = treasure_fleet_voyage
							}
							character_event = { id = treasurefleet.196 }
						}
						character_event = { id = treasurefleet.197 }
					}
				}
				any_player = {
					limit = {
						NOR = {
							trait = treasure_fleet_voyage
							has_landed_title = e_china
						}
					}
					character_event = { id = treasurefleet.198 }
				}
			}
			else = {
				# Pirates driven off
				d_treasure_fleet = {
					holder_scope = {
						character_event = { id = treasurefleet.190 }
					}
				}
				e_china = {
					holder_scope = {
						any_realm_lord = {
							limit = {
								trait = treasure_fleet_voyage
							}
							if = {
								limit = {
									has_character_flag = tf_call_to_arms
								}
								character_event = { id = treasurefleet.191 }
							}
							else = {
								character_event = { id = treasurefleet.192 }
							}
						}
					}
				}
			}
		}
	}
}

# Pirates driven off - inform commander
character_event = {
	id = treasurefleet.190
	desc = EVTDESC_TREASURE_FLEET_190
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_190 # Great!
		
		prestige = 100
	}
}

# Pirates driven off - inform people on that ship
character_event = {
	id = treasurefleet.191
	desc = EVTDESC_TREASURE_FLEET_191
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_191 # Great!
		
		prestige = 100
	}
}

# Pirates driven off - inform people on other ships
character_event = {
	id = treasurefleet.192
	desc = EVTDESC_TREASURE_FLEET_192
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_192 # Great!
		
		prestige = 100
	}
}

# Ship destroyed - inform commander
character_event = {
	id = treasurefleet.193
	desc = EVTDESC_TREASURE_FLEET_193
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_193 # Oh, no!
	}
}

# Ship destroyed - inform people on that ship
character_event = {
	id = treasurefleet.194
	desc = EVTDESC_TREASURE_FLEET_194
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_194 # I must swim to safety!
		
		random_list = {
			50 = {}
			25 = {
				add_trait = wounded
			}
			25 = {
				modifier = {
					factor = 0
					combat_rating = 50
				}
				modifier = {
					factor = 0.1
					combat_rating = 25
				}
				add_maimed_trait_effect = yes
			}
		}
		
		random_list = {
			50 = {
				modifier = {
					factor = 5
					is_weak_trigger = yes
				}
				modifier = {
					factor = 5
					is_maimed_trigger = yes
				}
				modifier = {
					factor = 2
					is_dumb_trigger = yes
				}
				death = {
					death_reason = death_accident_drowning
				}
			}
			50 = {
				modifier = {
					factor = 5
					is_strong_trigger = yes
				}
				modifier = {
					factor = 2
					is_smart_trigger = yes
				}
			}
		}
	}
}

# Ship destroyed - inform people on other ships
character_event = {
	id = treasurefleet.195
	desc = EVTDESC_TREASURE_FLEET_195
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_195 # Oh, no!
	}
}

# Last ship destroyed - inform all TF people
character_event = {
	id = treasurefleet.196
	desc = EVTDESC_TREASURE_FLEET_196
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_196 # Aargh!
		
		death = {
			death_reason = death_accident_drowning
		}
	}
}

# Last ship destroyed - inform the EoC
character_event = {
	id = treasurefleet.197
	desc = EVTDESC_TREASURE_FLEET_197
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_197 # How inauspicious!
		
		prestige = -500
		
		# TODO: Grace penalty
	}
}

# Last ship destroyed - inform the world
character_event = {
	id = treasurefleet.198
	desc = EVTDESC_TREASURE_FLEET_198
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_198 # I see...
	}
}

### Supply ship lost

# Supply ship lost - lose some food
character_event = {
	id = treasurefleet.199
	desc = EVTDESC_TREASURE_FLEET_199
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_199 # I see...
		
		FROM = {
			random_list = {
				1 = {
					change_variable = {
						which = tf_supplies
						value = -1
					}
				}
				1 = {
					change_variable = {
						which = tf_supplies
						value = -2
					}
				}
				1 = {
					change_variable = {
						which = tf_supplies
						value = -3
					}
				}
				1 = {
					change_variable = {
						which = tf_supplies
						value = -4
					}
				}
				1 = {
					change_variable = {
						which = tf_supplies
						value = -5
					}
				}
			}
		}
	}
}

### Fireworks go off

# Fireworks go off
character_event = {
	id = treasurefleet.200
	desc = EVTDESC_TREASURE_FLEET_200
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	immediate = {
		FROM = {
			random_list = {
				1 = {
					remove_or_weaken_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
				}
				1 = {
					remove_or_weaken_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
				}
				1 = {
					remove_or_weaken_everything_permissible_effect = yes
				}
			}
		}
	}
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_200 # Oh no!
		if = {
			limit = {
				FROM = {
					check_variable = {
						which = treasure_fleet_ship_strength
						value = 100
					}
				}
			}
			FROM = {
				random_list = {
					1 = {
						remove_or_weaken_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
					}
					1 = {
						remove_or_weaken_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
					}
					1 = {
						remove_or_weaken_everything_permissible_effect = yes
					}
				}
			}
			e_china = {
				holder_scope = {
					any_realm_lord = {
						limit = {
							trait = treasure_fleet_voyage
						}
						random_list = {
							1 = {
								character_event = { id = treasurefleet.201 } # Your ship blew up
							}
							99 = {
								character_event = { id = treasurefleet.202 } # Other ship blew up
							}
						}
					}
				}
			}
		}
		else_if = {
			limit = {
				FROM = {
					check_variable = {
						which = treasure_fleet_ship_strength
						value = 50
					}
				}
			}
			FROM = {
				random_list = {
					1 = {
						remove_or_weaken_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
					}
					1 = {
						remove_or_weaken_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
					}
					1 = {
						remove_or_weaken_everything_permissible_effect = yes
					}
				}
			}
			e_china = {
				holder_scope = {
					any_realm_lord = {
						limit = {
							trait = treasure_fleet_voyage
						}
						random_list = {
							1 = {
								character_event = { id = treasurefleet.201 } # Your ship blew up
							}
							49 = {
								character_event = { id = treasurefleet.202 } # Other ship blew up
							}
						}
					}
				}
			}
		}
		else_if = {
			limit = {
				FROM = {
					check_variable = {
						which = treasure_fleet_ship_strength
						value = 25
					}
				}
			}
			FROM = {
				random_list = {
					1 = {
						remove_or_weaken_random_treasure_fleet_person_artifact_or_stat_from_one_allowed_category_effect = yes
					}
					1 = {
						remove_or_weaken_random_treasure_fleet_person_artifact_and_stat_from_each_allowed_category_effect = yes
					}
					1 = {
						remove_or_weaken_everything_permissible_effect = yes
					}
				}
			}
			e_china = {
				holder_scope = {
					any_realm_lord = {
						limit = {
							trait = treasure_fleet_voyage
						}
						random_list = {
							1 = {
								character_event = { id = treasurefleet.201 } # Your ship blew up
							}
							24 = {
								character_event = { id = treasurefleet.202 } # Other ship blew up
							}
						}
					}
				}
			}
		}
		else_if = {
			limit = {
				FROM = {
					check_variable = {
						which = treasure_fleet_ship_strength
						value = 10
					}
				}
			}
			e_china = {
				holder_scope = {
					any_realm_lord = {
						limit = {
							trait = treasure_fleet_voyage
						}
						random_list = {
							1 = {
								character_event = { id = treasurefleet.201 } # Your ship blew up
							}
							9 = {
								character_event = { id = treasurefleet.202 } # Other ship blew up
							}
						}
					}
				}
			}
		}
		else_if = {
			limit = {
				FROM = {
					check_variable = {
						which = treasure_fleet_ship_strength
						value = 5
					}
				}
			}
			e_china = {
				holder_scope = {
					any_realm_lord = {
						limit = {
							trait = treasure_fleet_voyage
						}
						random_list = {
							1 = {
								character_event = { id = treasurefleet.201 } # Your ship blew up
							}
							4 = {
								character_event = { id = treasurefleet.202 } # Other ship blew up
							}
						}
					}
				}
			}
		}
		else_if = {
			limit = {
				FROM = {
					check_variable = {
						which = treasure_fleet_ship_strength
						value = 4
					}
				}
			}
			e_china = {
				holder_scope = {
					any_realm_lord = {
						limit = {
							trait = treasure_fleet_voyage
						}
						random_list = {
							1 = {
								character_event = { id = treasurefleet.201 } # Your ship blew up
							}
							3 = {
								character_event = { id = treasurefleet.202 } # Other ship blew up
							}
						}
					}
				}
			}
		}
		else_if = {
			limit = {
				FROM = {
					check_variable = {
						which = treasure_fleet_ship_strength
						value = 3
					}
				}
			}
			e_china = {
				holder_scope = {
					any_realm_lord = {
						limit = {
							trait = treasure_fleet_voyage
						}
						random_list = {
							1 = {
								character_event = { id = treasurefleet.201 } # Your ship blew up
							}
							2 = {
								character_event = { id = treasurefleet.202 } # Other ship blew up
							}
						}
					}
				}
			}
		}
		else_if = {
			limit = {
				FROM = {
					check_variable = {
						which = treasure_fleet_ship_strength
						value = 2
					}
				}
			}
			e_china = {
				holder_scope = {
					any_realm_lord = {
						limit = {
							trait = treasure_fleet_voyage
						}
						random_list = {
							1 = {
								character_event = { id = treasurefleet.201 } # Your ship blew up
							}
							1 = {
								character_event = { id = treasurefleet.202 } # Other ship blew up
							}
						}
					}
				}
			}
		}
		else_if = {
			limit = {
				FROM = {
					check_variable = {
						which = treasure_fleet_ship_strength
						value = 1
					}
				}
			}
			e_china = {
				holder_scope = {
					any_realm_lord = {
						limit = {
							trait = treasure_fleet_voyage
						}
						character_event = { id = treasurefleet.201 } # Your ship blew up
					}
				}
			}
		}
		else = {
			# Special case: TF destroyed
			if = {
				limit = {
					NOT = {
						check_variable = {
							which = tf_fighting_value
							value = 0
						}
					}
				}
				d_treasure_fleet = {
					holder_scope = {
						character_event = { id = treasurefleet.204 }
					}
				}
				e_china = {
					holder_scope = {
						any_realm_lord = {
							limit = {
								trait = treasure_fleet_voyage
							}
							character_event = { id = treasurefleet.203 }
						}
						character_event = { id = treasurefleet.204 }
					}
				}
				any_player = {
					limit = {
						NOR = {
							trait = treasure_fleet_voyage
							has_landed_title = e_china
						}
					}
					character_event = { id = treasurefleet.205 }
				}
			}
		}
	}
}

# Fireworks ship catches fire - abandon ship
character_event = {
	id = treasurefleet.201
	desc = EVTDESC_TREASURE_FLEET_201
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_201 # I must swim to safety!
		
		random_list = {
			50 = {}
			25 = {
				add_trait = wounded
			}
			25 = {
				add_maimed_trait_effect = yes
			}
		}
		
		random_list = {
			50 = {
				modifier = {
					factor = 5
					is_weak_trigger = yes
				}
				modifier = {
					factor = 5
					is_maimed_trigger = yes
				}
				modifier = {
					factor = 2
					is_dumb_trigger = yes
				}
				death = {
					death_reason = death_accident_drowning
				}
			}
			50 = {
				modifier = {
					factor = 5
					is_strong_trigger = yes
				}
				modifier = {
					factor = 2
					is_smart_trigger = yes
				}
			}
		}
	}
}

# Other ship blew up
character_event = {
	id = treasurefleet.202
	desc = EVTDESC_TREASURE_FLEET_202
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_202 # Oh, no!
	}
}

# Last ship destroyed - inform all TF people
character_event = {
	id = treasurefleet.203
	desc = EVTDESC_TREASURE_FLEET_203
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_203 # Aargh!
		
		death = {
			death_reason = death_accident_drowning
		}
	}
}

# Last ship destroyed - inform the EoC
character_event = {
	id = treasurefleet.204
	desc = EVTDESC_TREASURE_FLEET_204
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_204 # How inauspicious!
		
		prestige = -500
		
		# TODO: Grace penalty
	}
}

# Last ship destroyed - inform the world
character_event = {
	id = treasurefleet.205
	desc = EVTDESC_TREASURE_FLEET_205
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_205 # I see...
	}
}

### Food shortage

# Food shortage - lose fat/become malnourished
character_event = {
	id = treasurefleet.206
	desc = EVTDESC_TREASURE_FLEET_206
	picture = GFX_evt_china_golden_age # TODO
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TREASURE_FLEET_206 # I'm hungry!
		
		random_list = {
			1 = {
				lose_weight_small_effect = yes
			}
			1 = {
				lose_weight_medium_effect = yes
			}
			1 = {
				lose_weight_large_effect = yes
			}
		}
	}
}

##### Arrival events

# Possible routes:
# - China -> Korea -> Japan -> Ryukyu -> Taiwan -> Maynilla -> Borneo -> Temasek (merge, then split)
# - China -> Champa -> Lavo -> Temasek (merge, then split)
# - Temasek -> Palembang -> Java -> SI
# - Temasek -> Lamuri (split)
# - Lamuri -> Dagon -> Bengal -> Eastern coast of India -> Lanka (merge)
# - Lamuri -> Lanka -> Western coast of India -> Sindh -> Oman (split)
# - Oman -> Persian Gulf
# - Oman -> Socotra -> Red Sea
# Return route is always shortest possible, with Japan, Ryukyu, Taiwan, and Philippines shortcutting to China

# Check where the fleet is and fire the proper arrival event
province_event = {
	id = treasurefleet.207
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				has_province_flag = treasure_fleet_going_to_korea
			}
			clr_province_flag = treasure_fleet_going_to_korea
			set_province_flag = treasure_fleet_in_korea
			d_treasure_fleet = {
				holder_scope = {
					narrative_event = { id = treasurefleet.208 }
				}
			}
		}
		else_if = {
			limit = {
				has_province_flag = treasure_fleet_going_to_japan
			}
			clr_province_flag = treasure_fleet_going_to_japan
			set_province_flag = treasure_fleet_in_japan
			d_treasure_fleet = {
				holder_scope = {
					narrative_event = { id = treasurefleet.209 }
				}
			}
		}
		else_if = {
			limit = {
				has_province_flag = treasure_fleet_going_to_ryukyu
			}
			clr_province_flag = treasure_fleet_going_to_ryukyu
			set_province_flag = treasure_fleet_in_ryukyu
			d_treasure_fleet = {
				holder_scope = {
					narrative_event = { id = treasurefleet.210 }
				}
			}
		}
		else_if = {
			limit = {
				has_province_flag = treasure_fleet_going_to_taiwan
			}
			clr_province_flag = treasure_fleet_going_to_taiwan
			set_province_flag = treasure_fleet_in_taiwan
			d_treasure_fleet = {
				holder_scope = {
					narrative_event = { id = treasurefleet.211 }
				}
			}
		}
		else_if = {
			limit = {
				has_province_flag = treasure_fleet_going_to_maynilla
			}
			clr_province_flag = treasure_fleet_going_to_maynilla
			set_province_flag = treasure_fleet_in_maynilla
			d_treasure_fleet = {
				holder_scope = {
					narrative_event = { id = treasurefleet.212 }
				}
			}
		}
		else_if = {
			limit = {
				has_province_flag = treasure_fleet_going_to_borneo
			}
			clr_province_flag = treasure_fleet_going_to_borneo
			set_province_flag = treasure_fleet_in_borneo
			d_treasure_fleet = {
				holder_scope = {
					narrative_event = { id = treasurefleet.213 }
				}
			}
		}
		else_if = {
			limit = {
				has_province_flag = treasure_fleet_going_to_champa
			}
			clr_province_flag = treasure_fleet_going_to_champa
			set_province_flag = treasure_fleet_in_champa
			d_treasure_fleet = {
				holder_scope = {
					narrative_event = { id = treasurefleet.214 }
				}
			}
		}
		else_if = {
			limit = {
				has_province_flag = treasure_fleet_going_to_lavo
			}
			clr_province_flag = treasure_fleet_going_to_lavo
			set_province_flag = treasure_fleet_in_lavo
			d_treasure_fleet = {
				holder_scope = {
					narrative_event = { id = treasurefleet.215 }
				}
			}
		}
		else_if = {
			limit = {
				has_province_flag = treasure_fleet_going_to_temasek
			}
			clr_province_flag = treasure_fleet_going_to_temasek
			set_province_flag = treasure_fleet_in_temasek
			d_treasure_fleet = {
				holder_scope = {
					narrative_event = { id = treasurefleet.216 }
				}
			}
		}
		else_if = {
			limit = {
				has_province_flag = treasure_fleet_going_to_palembang
			}
			clr_province_flag = treasure_fleet_going_to_palembang
			set_province_flag = treasure_fleet_in_palembang
			d_treasure_fleet = {
				holder_scope = {
					narrative_event = { id = treasurefleet.217 }
				}
			}
		}
		else_if = {
			limit = {
				has_province_flag = treasure_fleet_going_to_java
			}
			clr_province_flag = treasure_fleet_going_to_java
			set_province_flag = treasure_fleet_in_java
			d_treasure_fleet = {
				holder_scope = {
					narrative_event = { id = treasurefleet.218 }
				}
			}
		}
		else_if = {
			limit = {
				has_province_flag = treasure_fleet_going_to_lamuri
			}
			clr_province_flag = treasure_fleet_going_to_lamuri
			set_province_flag = treasure_fleet_in_lamuri
			d_treasure_fleet = {
				holder_scope = {
					narrative_event = { id = treasurefleet.219 }
				}
			}
		}
		else_if = {
			limit = {
				has_province_flag = treasure_fleet_going_to_dagon
			}
			clr_province_flag = treasure_fleet_going_to_dagon
			set_province_flag = treasure_fleet_in_dagon
			d_treasure_fleet = {
				holder_scope = {
					narrative_event = { id = treasurefleet.220 }
				}
			}
		}
		else_if = {
			limit = {
				has_province_flag = treasure_fleet_going_to_bengal
			}
			clr_province_flag = treasure_fleet_going_to_bengal
			set_province_flag = treasure_fleet_in_bengal
			d_treasure_fleet = {
				holder_scope = {
					narrative_event = { id = treasurefleet.221 }
				}
			}
		}
		else_if = {
			limit = {
				has_province_flag = treasure_fleet_going_to_eastern_india
			}
			clr_province_flag = treasure_fleet_going_to_eastern_india
			set_province_flag = treasure_fleet_in_eastern_india
			d_treasure_fleet = {
				holder_scope = {
					narrative_event = { id = treasurefleet.222 }
				}
			}
		}
		else_if = {
			limit = {
				has_province_flag = treasure_fleet_going_to_lanka
			}
			clr_province_flag = treasure_fleet_going_to_lanka
			set_province_flag = treasure_fleet_in_lanka
			d_treasure_fleet = {
				holder_scope = {
					narrative_event = { id = treasurefleet.223 }
				}
			}
		}
		else_if = {
			limit = {
				has_province_flag = treasure_fleet_going_to_western_india
			}
			clr_province_flag = treasure_fleet_going_to_western_india
			set_province_flag = treasure_fleet_in_western_india
			d_treasure_fleet = {
				holder_scope = {
					narrative_event = { id = treasurefleet.224 }
				}
			}
		}
		else_if = {
			limit = {
				has_province_flag = treasure_fleet_going_to_sindh
			}
			clr_province_flag = treasure_fleet_going_to_sindh
			set_province_flag = treasure_fleet_in_sindh
			d_treasure_fleet = {
				holder_scope = {
					narrative_event = { id = treasurefleet.225 }
				}
			}
		}
		else_if = {
			limit = {
				has_province_flag = treasure_fleet_going_to_oman
			}
			clr_province_flag = treasure_fleet_going_to_oman
			set_province_flag = treasure_fleet_in_oman
			d_treasure_fleet = {
				holder_scope = {
					narrative_event = { id = treasurefleet.226 }
				}
			}
		}
		else_if = {
			limit = {
				has_province_flag = treasure_fleet_going_to_persian_gulf
			}
			clr_province_flag = treasure_fleet_going_to_persian_gulf
			set_province_flag = treasure_fleet_in_persian_gulf
			d_treasure_fleet = {
				holder_scope = {
					narrative_event = { id = treasurefleet.227 }
				}
			}
		}
		else_if = {
			limit = {
				has_province_flag = treasure_fleet_going_to_socotra
			}
			clr_province_flag = treasure_fleet_going_to_socotra
			set_province_flag = treasure_fleet_in_socotra
			d_treasure_fleet = {
				holder_scope = {
					narrative_event = { id = treasurefleet.228 }
				}
			}
		}
		else_if = {
			limit = {
				has_province_flag = treasure_fleet_going_to_red_sea
			}
			clr_province_flag = treasure_fleet_going_to_red_sea
			set_province_flag = treasure_fleet_in_red_sea
			d_treasure_fleet = {
				holder_scope = {
					narrative_event = { id = treasurefleet.229 }
				}
			}
		}
		else_if = {
			limit = {
				has_province_flag = treasure_fleet_going_to_china
			}
			clr_province_flag = treasure_fleet_going_to_china
			set_province_flag = treasure_fleet_in_china
			# TODO: Homecoming
		}
		else = {
			log = "Treasure Fleet failed to find destination!"
			# Failsafe
			# TODO: Homecoming
		}
		
		# TODO: Fire end of port events event
	}
}

# Treasure Fleet arrives in Korea
narrative_event = {
	id = treasurefleet.208
	title = EVTTITLE_TREASURE_FLEET_208
	desc = EVTDESC_TREASURE_FLEET_208
	picture = GFX_evt_china_golden_age # TODO
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	
	major = yes
	
	is_triggered_only = yes
	
	# TODO: major_trigger
	
	option = {
		trigger = {
			NOT = {
				top_liege = {
					is_chinese_emperor_trigger = yes
				}
			}
		}
		name = EVTOPTA_TREASURE_FLEET_208 # Interesting...
	}
	
	option = {
		trigger = {
			trait = treasure_fleet_voyage
		}
		name = EVTOPTB_TREASURE_FLEET_208 # Interesting...
	}
	
	option = {
		trigger = {
			top_liege = {
				is_chinese_emperor_trigger = yes
				NOT = {
					trait = treasure_fleet_voyage
				}
			}
		}
		name = EVTOPTC_TREASURE_FLEET_208 # Meh...
	}
	
	# TODO: Fire events for locals
	# TODO: And fleet members
}

# Treasure Fleet arrives in Japan
narrative_event = {
	id = treasurefleet.209
	title = EVTTITLE_TREASURE_FLEET_209
	desc = EVTDESC_TREASURE_FLEET_209
	picture = GFX_evt_china_golden_age # TODO
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	
	major = yes
	
	is_triggered_only = yes
	
	# TODO: major_trigger
	
	option = {
		trigger = {
			NOT = {
				top_liege = {
					is_chinese_emperor_trigger = yes
				}
			}
		}
		name = EVTOPTA_TREASURE_FLEET_209 # Interesting...
	}
	
	option = {
		trigger = {
			trait = treasure_fleet_voyage
		}
		name = EVTOPTB_TREASURE_FLEET_209 # Interesting...
	}
	
	option = {
		trigger = {
			top_liege = {
				is_chinese_emperor_trigger = yes
				NOT = {
					trait = treasure_fleet_voyage
				}
			}
		}
		name = EVTOPTC_TREASURE_FLEET_209 # Meh...
	}
	
	# TODO: Fire events for locals
	# TODO: And fleet members
}

# Treasure Fleet arrives in Ryukyu
narrative_event = {
	id = treasurefleet.210
	title = EVTTITLE_TREASURE_FLEET_210
	desc = EVTDESC_TREASURE_FLEET_210
	picture = GFX_evt_china_golden_age # TODO
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	
	major = yes
	
	is_triggered_only = yes
	
	# TODO: major_trigger
	
	option = {
		trigger = {
			NOT = {
				top_liege = {
					is_chinese_emperor_trigger = yes
				}
			}
		}
		name = EVTOPTA_TREASURE_FLEET_210 # Interesting...
	}
	
	option = {
		trigger = {
			trait = treasure_fleet_voyage
		}
		name = EVTOPTB_TREASURE_FLEET_210 # Interesting...
	}
	
	option = {
		trigger = {
			top_liege = {
				is_chinese_emperor_trigger = yes
				NOT = {
					trait = treasure_fleet_voyage
				}
			}
		}
		name = EVTOPTC_TREASURE_FLEET_210 # Meh...
	}
	
	# TODO: Fire events for locals
	# TODO: And fleet members
}

# Treasure Fleet arrives in Taiwan
narrative_event = {
	id = treasurefleet.211
	title = EVTTITLE_TREASURE_FLEET_211
	desc = EVTDESC_TREASURE_FLEET_211
	picture = GFX_evt_china_golden_age # TODO
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	
	major = yes
	
	is_triggered_only = yes
	
	# TODO: major_trigger
	
	option = {
		trigger = {
			NOT = {
				top_liege = {
					is_chinese_emperor_trigger = yes
				}
			}
		}
		name = EVTOPTA_TREASURE_FLEET_211 # Interesting...
	}
	
	option = {
		trigger = {
			trait = treasure_fleet_voyage
		}
		name = EVTOPTB_TREASURE_FLEET_211 # Interesting...
	}
	
	option = {
		trigger = {
			top_liege = {
				is_chinese_emperor_trigger = yes
				NOT = {
					trait = treasure_fleet_voyage
				}
			}
		}
		name = EVTOPTC_TREASURE_FLEET_211 # Meh...
	}
	
	# TODO: Fire events for locals
	# TODO: And fleet members
}

# Treasure Fleet arrives in Maynilla
narrative_event = {
	id = treasurefleet.212
	title = EVTTITLE_TREASURE_FLEET_212
	desc = EVTDESC_TREASURE_FLEET_212
	picture = GFX_evt_china_golden_age # TODO
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	
	major = yes
	
	is_triggered_only = yes
	
	# TODO: major_trigger
	
	option = {
		trigger = {
			NOT = {
				top_liege = {
					is_chinese_emperor_trigger = yes
				}
			}
		}
		name = EVTOPTA_TREASURE_FLEET_212 # Interesting...
	}
	
	option = {
		trigger = {
			trait = treasure_fleet_voyage
		}
		name = EVTOPTB_TREASURE_FLEET_212 # Interesting...
	}
	
	option = {
		trigger = {
			top_liege = {
				is_chinese_emperor_trigger = yes
				NOT = {
					trait = treasure_fleet_voyage
				}
			}
		}
		name = EVTOPTC_TREASURE_FLEET_212 # Meh...
	}
	
	# TODO: Fire events for locals
	# TODO: And fleet members
}

# Treasure Fleet arrives in Borneo
narrative_event = {
	id = treasurefleet.213
	title = EVTTITLE_TREASURE_FLEET_213
	desc = EVTDESC_TREASURE_FLEET_213
	picture = GFX_evt_china_golden_age # TODO
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	
	major = yes
	
	is_triggered_only = yes
	
	# TODO: major_trigger
	
	option = {
		trigger = {
			NOT = {
				top_liege = {
					is_chinese_emperor_trigger = yes
				}
			}
		}
		name = EVTOPTA_TREASURE_FLEET_213 # Interesting...
	}
	
	option = {
		trigger = {
			trait = treasure_fleet_voyage
		}
		name = EVTOPTB_TREASURE_FLEET_213 # Interesting...
	}
	
	option = {
		trigger = {
			top_liege = {
				is_chinese_emperor_trigger = yes
				NOT = {
					trait = treasure_fleet_voyage
				}
			}
		}
		name = EVTOPTC_TREASURE_FLEET_213 # Meh...
	}
	
	# TODO: Fire events for locals
	# TODO: And fleet members
}

# Treasure Fleet arrives in Champa
narrative_event = {
	id = treasurefleet.214
	title = EVTTITLE_TREASURE_FLEET_214
	desc = EVTDESC_TREASURE_FLEET_214
	picture = GFX_evt_china_golden_age # TODO
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	
	major = yes
	
	is_triggered_only = yes
	
	# TODO: major_trigger
	
	option = {
		trigger = {
			NOT = {
				top_liege = {
					is_chinese_emperor_trigger = yes
				}
			}
		}
		name = EVTOPTA_TREASURE_FLEET_214 # Interesting...
	}
	
	option = {
		trigger = {
			trait = treasure_fleet_voyage
		}
		name = EVTOPTB_TREASURE_FLEET_214 # Interesting...
	}
	
	option = {
		trigger = {
			top_liege = {
				is_chinese_emperor_trigger = yes
				NOT = {
					trait = treasure_fleet_voyage
				}
			}
		}
		name = EVTOPTC_TREASURE_FLEET_214 # Meh...
	}
	
	# TODO: Fire events for locals
	# TODO: And fleet members
}

# Treasure Fleet arrives in Lavo
narrative_event = {
	id = treasurefleet.215
	title = EVTTITLE_TREASURE_FLEET_215
	desc = EVTDESC_TREASURE_FLEET_215
	picture = GFX_evt_china_golden_age # TODO
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	
	major = yes
	
	is_triggered_only = yes
	
	# TODO: major_trigger
	
	option = {
		trigger = {
			NOT = {
				top_liege = {
					is_chinese_emperor_trigger = yes
				}
			}
		}
		name = EVTOPTA_TREASURE_FLEET_215 # Interesting...
	}
	
	option = {
		trigger = {
			trait = treasure_fleet_voyage
		}
		name = EVTOPTB_TREASURE_FLEET_215 # Interesting...
	}
	
	option = {
		trigger = {
			top_liege = {
				is_chinese_emperor_trigger = yes
				NOT = {
					trait = treasure_fleet_voyage
				}
			}
		}
		name = EVTOPTC_TREASURE_FLEET_215 # Meh...
	}
	
	# TODO: Fire events for locals
	# TODO: And fleet members
}

# Treasure Fleet arrives in Temasek
narrative_event = {
	id = treasurefleet.216
	title = EVTTITLE_TREASURE_FLEET_216
	desc = EVTDESC_TREASURE_FLEET_216
	picture = GFX_evt_china_golden_age # TODO
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	
	major = yes
	
	is_triggered_only = yes
	
	# TODO: major_trigger
	
	option = {
		trigger = {
			NOT = {
				top_liege = {
					is_chinese_emperor_trigger = yes
				}
			}
		}
		name = EVTOPTA_TREASURE_FLEET_216 # Interesting...
	}
	
	option = {
		trigger = {
			trait = treasure_fleet_voyage
		}
		name = EVTOPTB_TREASURE_FLEET_216 # Interesting...
	}
	
	option = {
		trigger = {
			top_liege = {
				is_chinese_emperor_trigger = yes
				NOT = {
					trait = treasure_fleet_voyage
				}
			}
		}
		name = EVTOPTC_TREASURE_FLEET_216 # Meh...
	}
	
	# TODO: Fire events for locals
	# TODO: And fleet members
}

# Treasure Fleet arrives in Palembang
narrative_event = {
	id = treasurefleet.217
	title = EVTTITLE_TREASURE_FLEET_217
	desc = EVTDESC_TREASURE_FLEET_217
	picture = GFX_evt_china_golden_age # TODO
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	
	major = yes
	
	is_triggered_only = yes
	
	# TODO: major_trigger
	
	option = {
		trigger = {
			NOT = {
				top_liege = {
					is_chinese_emperor_trigger = yes
				}
			}
		}
		name = EVTOPTA_TREASURE_FLEET_217 # Interesting...
	}
	
	option = {
		trigger = {
			trait = treasure_fleet_voyage
		}
		name = EVTOPTB_TREASURE_FLEET_217 # Interesting...
	}
	
	option = {
		trigger = {
			top_liege = {
				is_chinese_emperor_trigger = yes
				NOT = {
					trait = treasure_fleet_voyage
				}
			}
		}
		name = EVTOPTC_TREASURE_FLEET_217 # Meh...
	}
	
	# TODO: Fire events for locals
	# TODO: And fleet members
}

# Treasure Fleet arrives in Java
narrative_event = {
	id = treasurefleet.218
	title = EVTTITLE_TREASURE_FLEET_218
	desc = EVTDESC_TREASURE_FLEET_218
	picture = GFX_evt_china_golden_age # TODO
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	
	major = yes
	
	is_triggered_only = yes
	
	# TODO: major_trigger
	
	option = {
		trigger = {
			NOT = {
				top_liege = {
					is_chinese_emperor_trigger = yes
				}
			}
		}
		name = EVTOPTA_TREASURE_FLEET_218 # Interesting...
	}
	
	option = {
		trigger = {
			trait = treasure_fleet_voyage
		}
		name = EVTOPTB_TREASURE_FLEET_218 # Interesting...
	}
	
	option = {
		trigger = {
			top_liege = {
				is_chinese_emperor_trigger = yes
				NOT = {
					trait = treasure_fleet_voyage
				}
			}
		}
		name = EVTOPTC_TREASURE_FLEET_218 # Meh...
	}
	
	# TODO: Fire events for locals
	# TODO: And fleet members
}

# Treasure Fleet arrives in Lamuri
narrative_event = {
	id = treasurefleet.219
	title = EVTTITLE_TREASURE_FLEET_219
	desc = EVTDESC_TREASURE_FLEET_219
	picture = GFX_evt_china_golden_age # TODO
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	
	major = yes
	
	is_triggered_only = yes
	
	# TODO: major_trigger
	
	option = {
		trigger = {
			NOT = {
				top_liege = {
					is_chinese_emperor_trigger = yes
				}
			}
		}
		name = EVTOPTA_TREASURE_FLEET_219 # Interesting...
	}
	
	option = {
		trigger = {
			trait = treasure_fleet_voyage
		}
		name = EVTOPTB_TREASURE_FLEET_219 # Interesting...
	}
	
	option = {
		trigger = {
			top_liege = {
				is_chinese_emperor_trigger = yes
				NOT = {
					trait = treasure_fleet_voyage
				}
			}
		}
		name = EVTOPTC_TREASURE_FLEET_219 # Meh...
	}
	
	# TODO: Fire events for locals
	# TODO: And fleet members
}

# Treasure Fleet arrives in Dagon
narrative_event = {
	id = treasurefleet.220
	title = EVTTITLE_TREASURE_FLEET_220
	desc = EVTDESC_TREASURE_FLEET_220
	picture = GFX_evt_china_golden_age # TODO
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	
	major = yes
	
	is_triggered_only = yes
	
	# TODO: major_trigger
	
	option = {
		trigger = {
			NOT = {
				top_liege = {
					is_chinese_emperor_trigger = yes
				}
			}
		}
		name = EVTOPTA_TREASURE_FLEET_220 # Interesting...
	}
	
	option = {
		trigger = {
			trait = treasure_fleet_voyage
		}
		name = EVTOPTB_TREASURE_FLEET_220 # Interesting...
	}
	
	option = {
		trigger = {
			top_liege = {
				is_chinese_emperor_trigger = yes
				NOT = {
					trait = treasure_fleet_voyage
				}
			}
		}
		name = EVTOPTC_TREASURE_FLEET_220 # Meh...
	}
	
	# TODO: Fire events for locals
	# TODO: And fleet members
}

# Treasure Fleet arrives in Bengal
narrative_event = {
	id = treasurefleet.221
	title = EVTTITLE_TREASURE_FLEET_221
	desc = EVTDESC_TREASURE_FLEET_221
	picture = GFX_evt_china_golden_age # TODO
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	
	major = yes
	
	is_triggered_only = yes
	
	# TODO: major_trigger
	
	option = {
		trigger = {
			NOT = {
				top_liege = {
					is_chinese_emperor_trigger = yes
				}
			}
		}
		name = EVTOPTA_TREASURE_FLEET_221 # Interesting...
	}
	
	option = {
		trigger = {
			trait = treasure_fleet_voyage
		}
		name = EVTOPTB_TREASURE_FLEET_221 # Interesting...
	}
	
	option = {
		trigger = {
			top_liege = {
				is_chinese_emperor_trigger = yes
				NOT = {
					trait = treasure_fleet_voyage
				}
			}
		}
		name = EVTOPTC_TREASURE_FLEET_221 # Meh...
	}
	
	# TODO: Fire events for locals
	# TODO: And fleet members
}

# Treasure Fleet arrives in Eastern India
narrative_event = {
	id = treasurefleet.222
	title = EVTTITLE_TREASURE_FLEET_222
	desc = EVTDESC_TREASURE_FLEET_222
	picture = GFX_evt_china_golden_age # TODO
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	
	major = yes
	
	is_triggered_only = yes
	
	# TODO: major_trigger
	
	option = {
		trigger = {
			NOT = {
				top_liege = {
					is_chinese_emperor_trigger = yes
				}
			}
		}
		name = EVTOPTA_TREASURE_FLEET_222 # Interesting...
	}
	
	option = {
		trigger = {
			trait = treasure_fleet_voyage
		}
		name = EVTOPTB_TREASURE_FLEET_222 # Interesting...
	}
	
	option = {
		trigger = {
			top_liege = {
				is_chinese_emperor_trigger = yes
				NOT = {
					trait = treasure_fleet_voyage
				}
			}
		}
		name = EVTOPTC_TREASURE_FLEET_222 # Meh...
	}
	
	# TODO: Fire events for locals
	# TODO: And fleet members
}

# Treasure Fleet arrives in Lanka
narrative_event = {
	id = treasurefleet.223
	title = EVTTITLE_TREASURE_FLEET_223
	desc = EVTDESC_TREASURE_FLEET_223
	picture = GFX_evt_china_golden_age # TODO
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	
	major = yes
	
	is_triggered_only = yes
	
	# TODO: major_trigger
	
	option = {
		trigger = {
			NOT = {
				top_liege = {
					is_chinese_emperor_trigger = yes
				}
			}
		}
		name = EVTOPTA_TREASURE_FLEET_223 # Interesting...
	}
	
	option = {
		trigger = {
			trait = treasure_fleet_voyage
		}
		name = EVTOPTB_TREASURE_FLEET_223 # Interesting...
	}
	
	option = {
		trigger = {
			top_liege = {
				is_chinese_emperor_trigger = yes
				NOT = {
					trait = treasure_fleet_voyage
				}
			}
		}
		name = EVTOPTC_TREASURE_FLEET_223 # Meh...
	}
	
	# TODO: Fire events for locals
	# TODO: And fleet members
}

# Treasure Fleet arrives in Western India
narrative_event = {
	id = treasurefleet.224
	title = EVTTITLE_TREASURE_FLEET_224
	desc = EVTDESC_TREASURE_FLEET_224
	picture = GFX_evt_china_golden_age # TODO
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	
	major = yes
	
	is_triggered_only = yes
	
	# TODO: major_trigger
	
	option = {
		trigger = {
			NOT = {
				top_liege = {
					is_chinese_emperor_trigger = yes
				}
			}
		}
		name = EVTOPTA_TREASURE_FLEET_224 # Interesting...
	}
	
	option = {
		trigger = {
			trait = treasure_fleet_voyage
		}
		name = EVTOPTB_TREASURE_FLEET_224 # Interesting...
	}
	
	option = {
		trigger = {
			top_liege = {
				is_chinese_emperor_trigger = yes
				NOT = {
					trait = treasure_fleet_voyage
				}
			}
		}
		name = EVTOPTC_TREASURE_FLEET_224 # Meh...
	}
	
	# TODO: Fire events for locals
	# TODO: And fleet members
}

# Treasure Fleet arrives in Sindh
narrative_event = {
	id = treasurefleet.225
	title = EVTTITLE_TREASURE_FLEET_225
	desc = EVTDESC_TREASURE_FLEET_225
	picture = GFX_evt_china_golden_age # TODO
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	
	major = yes
	
	is_triggered_only = yes
	
	# TODO: major_trigger
	
	option = {
		trigger = {
			NOT = {
				top_liege = {
					is_chinese_emperor_trigger = yes
				}
			}
		}
		name = EVTOPTA_TREASURE_FLEET_225 # Interesting...
	}
	
	option = {
		trigger = {
			trait = treasure_fleet_voyage
		}
		name = EVTOPTB_TREASURE_FLEET_225 # Interesting...
	}
	
	option = {
		trigger = {
			top_liege = {
				is_chinese_emperor_trigger = yes
				NOT = {
					trait = treasure_fleet_voyage
				}
			}
		}
		name = EVTOPTC_TREASURE_FLEET_225 # Meh...
	}
	
	# TODO: Fire events for locals
	# TODO: And fleet members
}

# Treasure Fleet arrives in Oman
narrative_event = {
	id = treasurefleet.226
	title = EVTTITLE_TREASURE_FLEET_226
	desc = EVTDESC_TREASURE_FLEET_226
	picture = GFX_evt_china_golden_age # TODO
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	
	major = yes
	
	is_triggered_only = yes
	
	# TODO: major_trigger
	
	option = {
		trigger = {
			NOT = {
				top_liege = {
					is_chinese_emperor_trigger = yes
				}
			}
		}
		name = EVTOPTA_TREASURE_FLEET_226 # Interesting...
	}
	
	option = {
		trigger = {
			trait = treasure_fleet_voyage
		}
		name = EVTOPTB_TREASURE_FLEET_226 # Interesting...
	}
	
	option = {
		trigger = {
			top_liege = {
				is_chinese_emperor_trigger = yes
				NOT = {
					trait = treasure_fleet_voyage
				}
			}
		}
		name = EVTOPTC_TREASURE_FLEET_226 # Meh...
	}
	
	# TODO: Fire events for locals
	# TODO: And fleet members
}

# Treasure Fleet arrives in the Persian Gulf
narrative_event = {
	id = treasurefleet.227
	title = EVTTITLE_TREASURE_FLEET_227
	desc = EVTDESC_TREASURE_FLEET_227
	picture = GFX_evt_china_golden_age # TODO
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	
	major = yes
	
	is_triggered_only = yes
	
	# TODO: major_trigger
	
	option = {
		trigger = {
			NOT = {
				top_liege = {
					is_chinese_emperor_trigger = yes
				}
			}
		}
		name = EVTOPTA_TREASURE_FLEET_227 # Interesting...
	}
	
	option = {
		trigger = {
			trait = treasure_fleet_voyage
		}
		name = EVTOPTB_TREASURE_FLEET_227 # Interesting...
	}
	
	option = {
		trigger = {
			top_liege = {
				is_chinese_emperor_trigger = yes
				NOT = {
					trait = treasure_fleet_voyage
				}
			}
		}
		name = EVTOPTC_TREASURE_FLEET_227 # Meh...
	}
	
	# TODO: Fire events for locals
	# TODO: And fleet members
}

# Treasure Fleet arrives in Socotra
narrative_event = {
	id = treasurefleet.228
	title = EVTTITLE_TREASURE_FLEET_228
	desc = EVTDESC_TREASURE_FLEET_228
	picture = GFX_evt_china_golden_age # TODO
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	
	major = yes
	
	is_triggered_only = yes
	
	# TODO: major_trigger
	
	option = {
		trigger = {
			NOT = {
				top_liege = {
					is_chinese_emperor_trigger = yes
				}
			}
		}
		name = EVTOPTA_TREASURE_FLEET_228 # Interesting...
	}
	
	option = {
		trigger = {
			trait = treasure_fleet_voyage
		}
		name = EVTOPTB_TREASURE_FLEET_228 # Interesting...
	}
	
	option = {
		trigger = {
			top_liege = {
				is_chinese_emperor_trigger = yes
				NOT = {
					trait = treasure_fleet_voyage
				}
			}
		}
		name = EVTOPTC_TREASURE_FLEET_228 # Meh...
	}
	
	# TODO: Fire events for locals
	# TODO: And fleet members
}

# Treasure Fleet arrives in the Red Sea
narrative_event = {
	id = treasurefleet.229
	title = EVTTITLE_TREASURE_FLEET_229
	desc = EVTDESC_TREASURE_FLEET_229
	picture = GFX_evt_china_golden_age # TODO
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	
	major = yes
	
	is_triggered_only = yes
	
	# TODO: major_trigger
	
	option = {
		trigger = {
			NOT = {
				top_liege = {
					is_chinese_emperor_trigger = yes
				}
			}
		}
		name = EVTOPTA_TREASURE_FLEET_229 # Interesting...
	}
	
	option = {
		trigger = {
			trait = treasure_fleet_voyage
		}
		name = EVTOPTB_TREASURE_FLEET_229 # Interesting...
	}
	
	option = {
		trigger = {
			top_liege = {
				is_chinese_emperor_trigger = yes
				NOT = {
					trait = treasure_fleet_voyage
				}
			}
		}
		name = EVTOPTC_TREASURE_FLEET_229 # Meh...
	}
	
	# TODO: Fire events for locals
	# TODO: And fleet members
}

##### Port events

### Event selection for locals

### Event selection for fleet members

### Influx of Chinese people

# Welcome settlers?

# Got a paper mill

# Got a fireworks guild

# Got dry docks

# Got an administrative outpost

# Got a blast furnace

# Rowdy newcomers - revolt risk

# Province converts religion

# Province converts culture

# Nothing of note

### Sabotage fleet?

# Sabotage the fleet?

# Sabotage fails

# Inform the fleet

# Sabotage succeeds

# Inform the fleet

# If it was the last ship, inform the EoC and the world

### Local might volunteer to become a tributary

# Local might make offer

# Offer is made

# Offer accepted

# Offer refused

### Local offers gold for Grace - can be accepted on behalf of the EoC or personally

# Local might make offer

# Offer is made

# Offer accepted

# Offer refused

### Local offers artifact for Grace - can be accepted on behalf of the EoC or personally; commander will hand over new ones to random fleet members if he's already got a certain artifact

# Select artifact as local - can only happen for the AI as we don't want to handle the weird case where the player gets a free artifact

# Offer is made - Crown of Majesty

# Offer is made - Emerald Scepter

# Offer is made - Sword of Heroes

# Offer is made - Crown of Pearls

# Offer is made - Ruby Scepter

# Offer is made - Golden Sword

# Offer is made - The Lily Crown

# Offer is made - Noble Scepter

# Offer is made - Engraved Sword

# Offer is made - Dagger of Glory

# Offer is made - Ruby Bracelets

# Offer is made - Bejeweled Dagger

# Offer is made - Golden Bracelets

# Offer is made - Engraved Dagger

# Offer is made - Silver Bracelets

# Offer is made - Celestial Necklace

# Offer is made - Necklace of Radiance

# Offer is made - Collar of Pearls

# Offer is made - Circlet of the Heavens

# Offer is made - Staff of Majesty

# Offer is made - Circlet of the Sun

# Offer is made - Golden Staff

# Offer is made - Circlet of Twilight

# Offer is made - Silver Staff

# Offer is made - Crown of Crows

# Offer is made - Crown of the Sea

# Offer is made - Iron Crown

# Offer is made - Hero's Crown

# Offer is made - Axe of the Ancestors

# Offer is made - Amber Crown

# Offer is made - Obsidian Axe

# Offer is made - Engraved Crown

# Offer is made - Ceremonial Axe

# Offer is made - Sword T1

# Offer is made - Sword T2

# Offer is made - Heartseeker

# Offer is made - Vengeance

# Offer is made - Fury

# Offer is made - Scimitar T1

# Offer is made - Scimitar T2

# Offer is made - The Golden Scimitar

# Offer is made - Scimitar of Fortune

# Offer is made - Scimitar of Conquest

# Offer is made - Lance T1

# Offer is made - Lance T2

# Offer is made - The Impaler

# Offer is made - The Trident

# Offer is made - The Piercer

# Offer is made - Axe T1

# Offer is made - Axe T2

# Offer is made - Cleaver

# Offer is made - Ravager

# Offer is made - Marauder

# Offer is made - Mace T1

# Offer is made - Mace T2

# Offer is made - Foe Hammer

# Offer is made - Bone Breaker

# Offer is made - Shatterer

# Offer is made - Bow T1

# Offer is made - Bow T2

# Offer is made - Silent Wind

# Offer is made - Lightning

# Offer is made - Eagle

# Offer is made - Chain Mail

# Offer is made - Splint Mail

# Offer is made - Guardian

# Offer is made - Champion

# Offer is made - Warden

# Offer is made - Random World Sword

# Offer is made - Random World Armor

# Offer accepted

# Offer refused

### Sympathy for local

# Gain sympathy

### Gain random Chinese courtier

# Gain courtier - young soldier

# Gain courtier - eunuch

# Gain courtier - young courtesan

# Gain courtier - old scholar

# Gain courtier - random noble

### Invite guests?

# Offer to invite guest over?

# Offer is made - guest

# Guest refused

# At least one guest accepted - let's see what happens

# Friendship with guest

# Inform guest about friendship

# Rivalry with guest

# Inform guest about rivalry

# Attractive guest - attempt to tumble?

# Guest approached

# Tumbling happened - become lovers?

# Lovers

# Not lovers

# Tumbling didn't happen

# Attractive host - guest might try to tumble

# Tumbling attempted

# Tumbling happened - become lovers?

# Lovers

# Not lovers

# Tumbling didn't happen

# Host is an embarrasment - host

# Host is an embarrasment - guests

# Guest is an embarrasment - host

# Guest is an embarrasment - guest

# Drunk guest offers free Grace - host

# Drunk guest offered free Grace - guest

# Drunk guest offers lower tributary tier - host

# Offer accepted - guest

# Offer refused - guest

# Drunk guest offers free artifact

# Drunk guest offered free artifact - guest

# Guest and courtier develop friendship - host

# Guest and courtier develop friendship - guest

# Guest and courtier develop rivalry - host

# Guest and courtier develop rivalry - guest

# Host accidentally insults China - host

# Host accidentally insults China - guest

# Host sees the opportunity to imprison guest - host

# Guest was imprisoned

# Guest successfully escaped - guest

# Guest successfully escaped - host

# Guest chokes on food - host

# Guest chokes on food - guest

# Uneventful feast - get a little prestige - host

# Uneventful feast - get a little prestige - guest

# Host gains sympathy - host

# Host gains sympathy - guest

# Guest gains sympathy - guest

# Guest gains sympathy - host

# Feast is over - host

# Feast is over - guest

### Tech spread

# Got Infantry increase

# Got Cavalry increase

# Got Skirmish increase

# Got Melee increase

# Got Siege Equipment increase

# Got Military Organization increase

# Got Castle Infrastructure increase

# Got City and Temple increase

# Got Improved Keeps increase

# Got Trade Practices increase

# Got Construction increase

# Got Shipbuilding increase

# Got Noble Customs increase

# Got Popular Customs increase

# Got Religious Customs increase

# Got Majesty increase

# Got Tolerance increase

# Got Legalism increase

### Gold for artifact?

# Make offer?

# Offer is made

# Offer accepted

# Offer accepted - got Jade Dragon

# Offer accepted - got Dragon Amulet

# Offer accepted - got Chinese Artwork

# Offer accepted - got Chinese Calligraphy

# Offer accepted - got Chinese Sculpture

# Offer accepted - got Chinese Ceremonial Robe

# Offer accepted - got Silk Shroud

# Offer accepted - got Water Clock

# Offer accepted - got Jian

# Offer accepted - got Chinese Arm Protector

# Offer accepted - got Serpent Spear

# Offer accepted - got Ji

# Offer accepted - got Chinese Crossbow

# Offer accepted - got Chinese Bronze Scupture

# Offer accepted - got Painting of Glitterhoof

# Offer accepted - got Chinese Tapestry

# Offer accepted - got Grand Tapestry

# Offer accepted - got Art of War

# Offer accepted - got Classics of Poetry

# Offer accepted - got Health Book

# Offer accepted - got Law Book

# Offer accepted - got History Book

# Offer accepted - got Economy Book

# Offer accepted - got Art of War page

# Offer accepted - got Random World Sword

# Offer accepted - got Random World Armor

# Offer refused

### Gold for Trade Contract?

# Make offer?

# Offer is made

# Offer accepted

# Got Trade Contract

# Offer refused

### Gold for Peace Deal?

# Make offer?

# Offer is made

# Offer accepted

# Got Peace Deal

# Offer refused

### Gold for Grace?

# Make offer?

# Offer is made

# Offer accepted

# Got Grace

# Offer refused

### Gold for looser tributary relationship?

# Make offer?

# Offer is made

# Offer accepted

# Got lower tributary tier

# Offer refused

### Gold for Chinese character?

# Make offer?

# Offer is made

# Offer accepted - got Strategist

# Offer accepted - got Master Engineer

# Offer accepted - got Scholar-Bureaucrat

# Offer accepted - got Siege Engineer

# Offer accepted - got Physician

# Offer refused

### Resupply

# Ask nicely or attempt to seize supplies?

# Asked nicely

# Request accepted

# Request refused - seize supplies?

# Seizing supplies - it goes well

# Seizing supplies - it goes poorly

# Seizing supplies - it goes extremely poorly

# Inform local ruler if supplies were seized

### Someone sees an opportunity to create a tributary

# Opportunity is spotted - act on it?

# Local ruler gets ultimatum

# Ultimatum accepted

# Ultimatum refused - spawn a host under a new eunuch and have them declare war

### Sympathy for TF

# Gain sympathy

### Local noble pledges themself to you

# Local noble pledges themmself to you and joins the fleet

### Offer province modifier for gold

# Make offer?

# Offer is made

# Offer accepted

# Got a paper mill

# Got a fireworks guild

# Got dry docks

# Got an administrative outpost

# Got a blast furnace

# Offer refused

### End of port events

# See if either special case is an option

# If neither tie-in is on the table

##### Empire in the West tie-in

##### Sunrise Invasion tie-in