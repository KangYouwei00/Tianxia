# Very WIP - comment out line 23 in soh_mandate_of_heaven_events.txt to activate the system

calculate_current_mandate_of_heaven_effect = {
	set_variable = {
		which = mandate_of_heaven
		value = 0
	}
	
	# Past trend - if no value exists, it is assumed to have been good
	if = {
		limit = {
			is_variable_equal = {
				which = old_mandate_of_heaven
				value = 0
			}
		}
		set_variable = {
			which = old_mandate_of_heaven
			value = 1000
		}
		set_variable = {
			which = old_mandate_of_heaven_2
			value = 500
		}
		set_variable = {
			which = old_mandate_of_heaven_3
			value = 250
		}
		set_variable = {
			which = old_mandate_of_heaven_4
			value = 100
		}
	}
	change_variable = {
		which = mandate_of_heaven
		which = old_mandate_of_heaven
	}
	change_variable = {
		which = mandate_of_heaven
		which = old_mandate_of_heaven_2
	}
	change_variable = {
		which = mandate_of_heaven
		which = old_mandate_of_heaven_3
	}
	change_variable = {
		which = mandate_of_heaven
		which = old_mandate_of_heaven_4
	}
	
	# Current Mandate level
	if = {
		limit = {
			has_character_modifier = mandate_of_heaven_5
		}
		change_variable = {
			which = mandate_of_heaven
			value = 1000
		}
	}
	else_if = {
		limit = {
			has_character_modifier = mandate_of_heaven_4
		}
		change_variable = {
			which = mandate_of_heaven
			value = 500
		}
	}
	else_if = {
		limit = {
			has_character_modifier = mandate_of_heaven_3
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	else_if = {
		limit = {
			has_character_modifier = mandate_of_heaven_2
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	else_if = {
		limit = {
			has_character_modifier = mandate_of_heaven_1
		}
		change_variable = {
			which = mandate_of_heaven
			value = -500
		}
	}
	
	# Stored yearly change from various places
	change_variable = {
		which = mandate_of_heaven
		which = stored_mandate_change
	}
	
	log = "[Root.GetTitledName]'s stored Mandate of Heaven value is [Root.stored_mandate_change.GetValue]!"

	# From holding China or the existence of pretenders
	if = {
		limit = {
			has_landed_title = e_china
		}
		change_variable = {
			which = mandate_of_heaven
			value = 1000
		}
	}
	any_independent_ruler = {
		limit = {
			NOT = {
				character = ROOT
			}
			primary_title = {
				has_title_flag = pretender_chinese_empire
			}
		}
		ROOT = {
			change_variable = {
				which = mandate_of_heaven
				value = -250
			}
		}
	}
	
	# Education trait
	if = {
		limit = {
			trait = naive_appeaser
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = underhanded_rogue
		}
		change_variable = {
			which = mandate_of_heaven
			value = 25
		}
	}
	if = {
		limit = {
			trait = charismatic_negotiator
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			trait = grey_eminence
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			trait = misguided_warrior
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = tough_soldier
		}
		change_variable = {
			which = mandate_of_heaven
			value = -25
		}
	}
	if = {
		limit = {
			trait = skilled_tactician
		}
		change_variable = {
			which = mandate_of_heaven
			value = 25
		}
	}
	if = {
		limit = {
			trait = brilliant_strategist
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			trait = indulgent_wastrel
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = thrifty_clerk
		}
		change_variable = {
			which = mandate_of_heaven
			value = 25
		}
	}
	if = {
		limit = {
			trait = fortune_builder
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			trait = midas_touched
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			trait = amateurish_plotter
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = flamboyant_schemer
		}
		change_variable = {
			which = mandate_of_heaven
			value = -25
		}
	}
	if = {
		limit = {
			trait = intricate_webweaver
		}
		change_variable = {
			which = mandate_of_heaven
			value = 25
		}
	}
	if = {
		limit = {
			trait = elusive_shadow
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			trait = detached_priest
		}
		change_variable = {
			which = mandate_of_heaven
			value = -25
		}
	}
	if = {
		limit = {
			trait = martial_cleric
		}
		change_variable = {
			which = mandate_of_heaven
			value = 25
		}
	}
	if = {
		limit = {
			trait = scholarly_theologian
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			trait = mastermind_theologian
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	
	# Genetic, health, and birth traits
	if = {
		limit = {
			trait = drunkard
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = immortal
		}
		change_variable = {
			which = mandate_of_heaven
			value = 1000
		}
	}
	if = {
		limit = {
			trait = incapable
		}
		change_variable = {
			which = mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			trait = possessed
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			trait = has_aztec_disease
		}
		change_variable = {
			which = mandate_of_heaven
			value = -25
		}
	}
	if = {
		limit = {
			trait = has_typhus
		}
		change_variable = {
			which = mandate_of_heaven
			value = -25
		}
	}
	if = {
		limit = {
			trait = cancer
		}
		change_variable = {
			which = mandate_of_heaven
			value = -25
		}
	}
	if = {
		limit = {
			trait = has_tuberculosis
		}
		change_variable = {
			which = mandate_of_heaven
			value = -25
		}
	}
	if = {
		limit = {
			trait = dancing_plague
		}
		change_variable = {
			which = mandate_of_heaven
			value = -25
		}
	}
	if = {
		limit = {
			trait = dysentery
		}
		change_variable = {
			which = mandate_of_heaven
			value = -25
		}
	}
	if = {
		limit = {
			trait = syphilitic
		}
		change_variable = {
			which = mandate_of_heaven
			value = -25
		}
	}
	if = {
		limit = {
			trait = has_typhoid_fever
		}
		change_variable = {
			which = mandate_of_heaven
			value = -25
		}
	}
	if = {
		limit = {
			trait = leper
		}
		change_variable = {
			which = mandate_of_heaven
			value = -25
		}
	}
	if = {
		limit = {
			trait = has_measles
		}
		change_variable = {
			which = mandate_of_heaven
			value = -25
		}
	}
	if = {
		limit = {
			trait = pneumonic
		}
		change_variable = {
			which = mandate_of_heaven
			value = -25
		}
	}
	if = {
		limit = {
			trait = rabies
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = has_small_pox
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = has_bubonic_plague
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			trait = disfigured
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = mangled
		}
		change_variable = {
			which = mandate_of_heaven
			value = -25
		}
	}
	if = {
		limit = {
			trait = bastard
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			trait = legit_bastard
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = fair
		}
		change_variable = {
			which = mandate_of_heaven
			value = 25
		}
	}
	if = {
		limit = {
			trait = genius
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			trait = quick
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			trait = dwarf
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = harelip
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = hunchback
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = imbecile
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			trait = inbred
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			trait = slow
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = ugly
		}
		change_variable = {
			which = mandate_of_heaven
			value = -25
		}
	}
	if = {
		limit = {
			trait = shrewd
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			trait = dull
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = groomed
		}
		change_variable = {
			which = mandate_of_heaven
			value = 25
		}
	}
	if = {
		limit = {
			trait = uncouth
		}
		change_variable = {
			which = mandate_of_heaven
			value = -25
		}
	}
	
	# Lifestyle traits + old lifestyle traits
	if = {
		limit = {
			trait = administrator
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			trait = architect
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			trait = gamer
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			trait = gardener
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			trait = hedonist
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = impaler
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			trait = schemer
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			trait = seducer
		}
		change_variable = {
			which = mandate_of_heaven
			value = -25
		}
	}
	if = {
		limit = {
			trait = seductress
		}
		change_variable = {
			which = mandate_of_heaven
			value = -25
		}
	}
	if = {
		limit = {
			trait = mystic
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			trait = scholar
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			trait = socializer
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			trait = strategist
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			trait = theologian
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			trait = poet
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	
	# Personality traits
	if = {
		limit = {
			trait = chaste
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			trait = temperate
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			trait = diligent
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			trait = patient
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			trait = kind
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			trait = humble
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			trait = lustful
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = gluttonous
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = greedy
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = slothful
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			trait = wroth
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = envious
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = proud
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			trait = ambitious
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			trait = arbitrary
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			trait = brave
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			trait = content
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			trait = craven
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = cruel
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			trait = cynical
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			trait = deceitful
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			trait = erudite
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			trait = gregarious
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			trait = honest
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			trait = just
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			trait = paranoid
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = shy
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = stubborn
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			trait = trusting
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			trait = zealous
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	
	# Kinslayer traits
	if = {
		limit = {
			trait = kinslayer
		}
		change_variable = {
			which = mandate_of_heaven
			value = -1000
		}
	}
	if = {
		limit = {
			trait = familial_kinslayer
		}
		change_variable = {
			which = mandate_of_heaven
			value = -500	}
	}
	if = {
		limit = {
			trait = dynastic_kinslayer
		}
		change_variable = {
			which = mandate_of_heaven
			value = -200
		}
	}
	if = {
		limit = {
			trait = tribal_kinslayer
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	
	# Special traits
	if = {
		limit = {
			trait = cannibal_trait
		}
		change_variable = {
			which = mandate_of_heaven
			value = -1000
		}
	}
	if = {
		limit = {
			trait = peasant_leader
		}
		change_variable = {
			which = mandate_of_heaven
			value = -500
		}
	}
	
	# Stats
	if = {
		limit = {
			NOT = {
				diplomacy = 4
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			NOT = {
				diplomacy = 8
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			diplomacy = 12
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			diplomacy = 16
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			diplomacy = 20
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			NOT = {
				martial = 4
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			NOT = {
				martial = 8
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			martial = 12
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			martial = 16
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			martial = 20
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			NOT = {
				stewardship = 4
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			NOT = {
				stewardship = 8
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			stewardship = 12
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			stewardship = 16
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			stewardship = 20
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			NOT = {
				intrigue = 4
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			NOT = {
				intrigue = 8
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			intrigue = 12
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			intrigue = 16
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			intrigue = 20
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			NOT = {
				learning = 4
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			NOT = {
				learning = 8
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			learning = 12
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			learning = 16
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			learning = 20
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	
	# Culture
	if = {
		limit = {
			NOR = {
				culture_group = chinese_group
				culture_group = koreanic
				culture = viet
				culture = ryukyuan
				culture = japanese
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			NOT = {
				culture_group = chinese_group
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			culture = han
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			religion = taoist
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			NOR = {
				religion = taoist
				religion = buddhist
				religion = chinese_pagan
				religion = chinese_pagan_reformed
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	
	# Control of China + de jure
	any_province = {
		limit = {
			county = {
				OR = {
					region = world_china
					ROOT = {
						primary_title = {
							de_jure_vassal_or_below = PREVPREV
						}
					}
				}
				holder_scope = {
					NOR = {
						character = ROOT
						any_liege = {
							OR = {
								character = ROOT
								liege_before_war = {
									character = ROOT
								}
							}
						}
						liege_before_war = {
							character = ROOT
						}
					} 
				}
			}
		}
		ROOT = {
			change_variable = {
				which = mandate_of_heaven
				value = -5
			}
		}
	}
	
	# Diseased, Depopulated, or Prospering provinces in the realm
	any_realm_province = {
		if = {
			limit = {
				has_epidemic = yes
			}
			if = {
				limit = {
					county = {
						OR = {
							region = world_china
							ROOT = {
								primary_title = {
									de_jure_vassal_or_below = PREVPREV
								}
							}
						}
					}
				}
				ROOT = {
					change_variable = {
						which = mandate_of_heaven
						value = -5
					}
				}
			}
			else = {
				ROOT = {
					change_variable = {
						which = mandate_of_heaven
						value = -2
					}
				}
			}
		}
		if = {
			limit = {
				has_province_modifier = depopulated_3
			}
			if = {
				limit = {
					county = {
						OR = {
							region = world_china
							ROOT = {
								primary_title = {
									de_jure_vassal_or_below = PREVPREV
								}
							}
						}
					}
				}
				ROOT = {
					change_variable = {
						which = mandate_of_heaven
						value = -10
					}
				}
			}
			else = {
				ROOT = {
					change_variable = {
						which = mandate_of_heaven
						value = -5
					}
				}
			}
		}
		else_if = {
			limit = {
				has_province_modifier = depopulated_2
			}
			if = {
				limit = {
					county = {
						OR = {
							region = world_china
							ROOT = {
								primary_title = {
									de_jure_vassal_or_below = PREVPREV
								}
							}
						}
					}
				}
				ROOT = {
					change_variable = {
						which = mandate_of_heaven
						value = -5
					}
				}
			}
			else = {
				ROOT = {
					change_variable = {
						which = mandate_of_heaven
						value = -2
					}
				}
			}
		}
		else_if = {
			limit = {
				has_province_modifier = depopulated_1
			}
			if = {
				limit = {
					county = {
						OR = {
							region = world_china
							ROOT = {
								primary_title = {
									de_jure_vassal_or_below = PREVPREV
								}
							}
						}
					}
				}
				ROOT = {
					change_variable = {
						which = mandate_of_heaven
						value = -2
					}
				}
			}
			else = {
				ROOT = {
					change_variable = {
						which = mandate_of_heaven
						value = -1
					}
				}
			}
		}
		else_if = {
			limit = {
				has_province_modifier = prosperity_modifier_1
			}
			if = {
				limit = {
					county = {
						OR = {
							region = world_china
							ROOT = {
								primary_title = {
									de_jure_vassal_or_below = PREVPREV
								}
							}
						}
					}
				}
				ROOT = {
					change_variable = {
						which = mandate_of_heaven
						value = 2
					}
				}
			}
			else = {
				ROOT = {
					change_variable = {
						which = mandate_of_heaven
						value = 1
					}
				}
			}
		}
		else_if = {
			limit = {
				has_province_modifier = prosperity_modifier_2
			}
			if = {
				limit = {
					county = {
						OR = {
							region = world_china
							ROOT = {
								primary_title = {
									de_jure_vassal_or_below = PREVPREV
								}
							}
						}
					}
				}
				ROOT = {
					change_variable = {
						which = mandate_of_heaven
						value = 5
					}
				}
			}
			else = {
				ROOT = {
					change_variable = {
						which = mandate_of_heaven
						value = 2
					}
				}
			}
		}
		else_if = {
			limit = {
				has_province_modifier = prosperity_modifier_3
			}
			if = {
				limit = {
					county = {
						OR = {
							region = world_china
							ROOT = {
								primary_title = {
									de_jure_vassal_or_below = PREVPREV
								}
							}
						}
					}
				}
				ROOT = {
					change_variable = {
						which = mandate_of_heaven
						value = 10
					}
				}
			}
			else = {
				ROOT = {
					change_variable = {
						which = mandate_of_heaven
						value = 5
					}
				}
			}
		}
	}
	
	# Artefacts
	if = {
		limit = {
			has_artifact = heirloom_seal_of_the_realm
		}
		change_variable = {
			which = mandate_of_heaven
			value = 500
		}
	}
	
	# Character modifiers
	if = {
		limit = {
			has_character_modifier = the_dungeon
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = the_oubliette
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = house_arrest
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = truce_breaker
		}
		change_variable = {
			which = mandate_of_heaven
			value = -1000
		}
	}
	if = {
		limit = {
			has_character_modifier = negative_money
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = the_merciful
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = the_bountiful
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = illumination
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = aspiring_poet
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = sweet_temptation
		}
		change_variable = {
			which = mandate_of_heaven
			value = -25
		}
	}
	if = {
		limit = {
			has_character_modifier = stay_strong
		}
		change_variable = {
			which = mandate_of_heaven
			value = 25
		}
	}
	if = {
		limit = {
			has_character_modifier = unrighteous_spouse
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = offended_moneylenders
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = diplomacy_advice
		}
		change_variable = {
			which = mandate_of_heaven
			value = 25
		}
	}
	if = {
		limit = {
			has_character_modifier = martial_advice
		}
		change_variable = {
			which = mandate_of_heaven
			value = 10
		}
	}
	if = {
		limit = {
			has_character_modifier = stewardship_advice
		}
		change_variable = {
			which = mandate_of_heaven
			value = 25
		}
	}
	if = {
		limit = {
			has_character_modifier = intrigue_advice
		}
		change_variable = {
			which = mandate_of_heaven
			value = 10
		}
	}
	if = {
		limit = {
			has_character_modifier = learning_advice
		}
		change_variable = {
			which = mandate_of_heaven
			value = 25
		}
	}
	if = {
		limit = {
			has_character_modifier = for_the_sake_of_love
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = chaste_learning
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = imprison_lawbreakers
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = kill_lawbreakers
		}
		change_variable = {
			which = mandate_of_heaven
			value = 25
		}
	}
	if = {
		limit = {
			has_character_modifier = modifier_witch
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = tortured_witch
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = spy_imprison
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = the_pompous
		}
		change_variable = {
			which = mandate_of_heaven
			value = 25
		}
	}
	if = {
		limit = {
			has_character_modifier = the_pitiful
		}
		change_variable = {
			which = mandate_of_heaven
			value = -25
		}
	}
	if = {
		limit = {
			has_character_modifier = the_judger
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = mod_ashamed
		}
		change_variable = {
			which = mandate_of_heaven
			value = -25
		}
	}
	if = {
		limit = {
			has_character_modifier = the_greedy
		}
		change_variable = {
			which = mandate_of_heaven
			value = -25
		}
	}
	if = {
		limit = {
			has_character_modifier = evil_rumours
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = slothful_ruler
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = the_cruel
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = the_alchemist
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = brazen_bull
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = master_impaler
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = chaste_learning
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = the_ruthless
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = gambler
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = whoremaster
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = proving_bravery
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = speaking_in_tounges
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = modifier_outfoxed
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = broken_spirit
		}
		change_variable = {
			which = mandate_of_heaven
			value = -1000
		}
	}
	if = {
		limit = {
			has_character_modifier = crushed_revolt
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = crushed_major_revolt
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = demon_child_non_pagan
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = suspected_demon_spawn
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = suspected_witch
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = known_witch
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = incestuous_adulterer
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = incestuous_adulteress
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = adulterer
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = adulteress
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = known_sodomite
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = known_sodomite_pagan
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = cradle_robber
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = wol_patriarch_1
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = wol_patriarch_2
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = wol_matriarch_1
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = wol_matriarch_2
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = wol_seducer_1
		}
		change_variable = {
			which = mandate_of_heaven
			value = -25
		}
	}
	if = {
		limit = {
			has_character_modifier = wol_seducer_2
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = wol_court_tomcat
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = wol_court_vixen
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = wol_respected_ruler
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = wol_legendary_wisdom
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = minor_disease_herpes
		}
		change_variable = {
			which = mandate_of_heaven
			value = -25
		}
	}
	if = {
		limit = {
			has_character_modifier = cannibal
		}
		change_variable = {
			which = mandate_of_heaven
			value = -1000
		}
	}
	if = {
		limit = {
			has_character_modifier = vicious_rumors
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = vicious_rumors_2
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = unfaithful_rumors
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = known_murderer
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = studying_the_stars
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = heliocentrist_scholar
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = weird_scholar
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = the_necronomicon
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = ancient_wisdom
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = merciless
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = apprentice_boardgamer
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = religious_studies
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = religious_philosopher
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = disloyal_peasantry
		}
		change_variable = {
			which = mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			has_character_modifier = out_of_patience
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = groomed_to_perfection
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = commoners_abandoned
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = alliance_breaker
		}
		change_variable = {
			which = mandate_of_heaven
			value = -1000
		}
	}
	if = {
		limit = {
			has_character_modifier = broken_non_aggression_pact_char_modifier
		}
		change_variable = {
			which = mandate_of_heaven
			value = -1000
		}
	}
	if = {
		limit = {
			has_character_modifier = crazy_cannibal
		}
		change_variable = {
			which = mandate_of_heaven
			value = -1000
		}
	}
	if = {
		limit = {
			has_character_modifier = taking_it_easy
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = skull_trophy
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = skull_trophies
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = graverobber
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = severe_illness
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = bedridden_illness
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = astounding_visions
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = uplifting_visions
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = frightening_visions
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = withdrawal_symptoms
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = foolish_behavior
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = corrupting_magic_minor
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = corrupting_magic_major
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = patron_of_the_arts
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = preserver_of_poetry
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = published_poet
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = popular_ruler
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = under_suspicion
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = highly_suspect
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = played_strategy_game
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = discussed_scripture
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = discussed_realm_management
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = caught_red_handed
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = caught_stealing_artifact_penance
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = mediator
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = apathetic
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = cheap_laboratory
		}
		change_variable = {
			which = mandate_of_heaven
			value = 25
		}
	}
	if = {
		limit = {
			has_character_modifier = normal_laboratory
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = good_laboratory
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = great_laboratory
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = best_laboratory
		}
		change_variable = {
			which = mandate_of_heaven
			value = 500
		}
	}
	if = {
		limit = {
			has_character_modifier = good_battle_omen
		}
		change_variable = {
			which = mandate_of_heaven
			value = 25
		}
	}
	if = {
		limit = {
			has_character_modifier = bad_battle_omen
		}
		change_variable = {
			which = mandate_of_heaven
			value = -25
		}
	}
	if = {
		limit = {
			has_character_modifier = good_relationship_omen
		}
		change_variable = {
			which = mandate_of_heaven
			value = 25
		}
	}
	if = {
		limit = {
			has_character_modifier = bad_relationship_omen
		}
		change_variable = {
			which = mandate_of_heaven
			value = -25
		}
	}
	if = {
		limit = {
			has_character_modifier = good_power_omen
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = bad_power_omen
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = fulfilled_vision_great
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = fulfilled_vision_ok
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = fulfilled_vision_bad
		}
		change_variable = {
			which = mandate_of_heaven
			value = 25
		}
	}
	if = {
		limit = {
			has_character_modifier = fulfilled_vision_worst
		}
		change_variable = {
			which = mandate_of_heaven
			value = -25
		}
	}
	if = {
		limit = {
			has_character_modifier = stargazer
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = theoretical_alchemist
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = experimenting_alchemist
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = alchemy_good_ste_bonus
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = alchemy_ste_bonus
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = alchemy_ste_penalty
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = alchemy_bad_ste_penalty
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = astrology_good_dip_bonus
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = astrology_dip_bonus
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = astrology_dip_penalty
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = astrology_bad_dip_penalty
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = open_mind_good_lea_bonus
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = open_mind_lea_bonus
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = open_mind_lea_penalty
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = open_mind_bad_lea_penalty
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = hidden_truth_good_int_bonus
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = hidden_truth_int_bonus
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = hidden_truth_int_penalty
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = hidden_truth_bad_int_penalty
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = divine_summoning_failed
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = divine_summoning_succeeded
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = theory_paper_heavy_investment
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = brilliant_insight
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = debater
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = horoscope_outcome_artist
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = horoscope_outcome_scatterbrain
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = horoscope_outcome_brute
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = horoscope_outcome_arrogant
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = horoscope_outcome_jittery
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = astronomical_insights_1
		}
		change_variable = {
			which = mandate_of_heaven
			value = 25
		}
	}
	if = {
		limit = {
			has_character_modifier = astronomical_insights_2
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = astronomical_insights_3
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = astronomical_insights_4
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = neglected_accounting
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = failed_to_predict_star_fall
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = published_theorem
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = tarnished_reputation
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = diplomatic_insight
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = martial_insight
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = intrigue_insight
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = learning_insight
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = stewardship_insight
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = accused_apostate
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = jd_master_engineer
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = jd_administrator
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = employing_jd_administrator
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = employing_jd_administrator_golden_age
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = jd_strategist
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = impressive_treasury
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = cowardly_infanticide
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = munificent_modifier
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = jolly_matron_modifier
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = jolly_patriarch_modifier
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = tireless_worker
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = emptied_library
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = hitting_the_books
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = antagonize_slandering_vassals
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = antagonize_slandering_relatives
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = luxurious_crown_modifier
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = popular_modifier
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = divination_crit_success
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = divination_success
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = divination_failure
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = divination_crit_failure
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = callous
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = intimidated_plotters
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = well_spoken
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = confused_by_diplomacy
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = jumbling_words
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = confused_by_warfare
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = unrespected_general
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = well_governed
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = confused_by_governing
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = good_image
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = bad_image
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = unpopular_image
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = well_written
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = terrible_writer
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = strange_mind
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = clever_planner
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = inspiring_presence
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = motivated_ruler
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = bad_image
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = charismatic_leader
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = demon_horns
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = astrology_very_good_omen
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = astrology_good_omen
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = astrology_ambiguous_omen
		}
		change_variable = {
			which = mandate_of_heaven
			value = -25
		}
	}
	if = {
		limit = {
			has_character_modifier = astrology_bad_omen
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = astrology_very_bad_omen
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = cannibal_haruspicy_sacrifice
		}
		change_variable = {
			which = mandate_of_heaven
			value = -1000
		}
	}
	if = {
		limit = {
			has_character_modifier = intrigue_def_haruspicy_sacrifice
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = intrigue_att_haruspicy_sacrifice
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = stewardship_haruspicy_sacrifice
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = exploring_local_culture
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = well_versed_in_local_culture
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = cowardly_ruler
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = forging_legend_revisiting_laws_1
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = forging_legend_revisiting_laws_2
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = forging_legend_peasant_disobedience_1
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = forging_legend_peasant_disobedience_2
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = forging_legend_family_dedication_1
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = forging_legend_family_dedication_2
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = forging_legend_family_dedication_3
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = forging_legend_religious_squabble_1
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = forging_legend_religious_squabble_2
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = forging_legend_searching_philosophers_1
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = forging_legend_searching_philosophers_1
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}

	if = {
		limit = {
			has_character_modifier = forging_legend_searching_philosophers_3
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = forging_legend_building_infrastructure_1
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = forging_legend_building_infrastructure_2
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = forging_legend_building_infrastructure_3
		}
		change_variable = {
			which = mandate_of_heaven
			value = 250
		}
	}
	if = {
		limit = {
			has_character_modifier = forging_legend_building_zealotry_1
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = forging_legend_building_zealotry_2
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = forging_legend_censoring_arts_1
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = forging_legend_censoring_arts_2
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = forging_legend_censoring_arts_3
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = forging_legend_martial_law_1
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = forging_legend_martial_law_2
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = crucible_weapon_very_bad_omen
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = crucible_weapon_caught_heretic
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	if = {
		limit = {
			has_character_modifier = superstitious_ruler
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = naive_host
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = generous_host
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = calculating_host
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			has_character_modifier = ruthless_host
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = caught_with_forgery
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = ate_beating_heart
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			has_character_modifier = weak_leader_modifier
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	if = {
		limit = {
			has_character_modifier = strong_leader_modifier
		}
		change_variable = {
			which = mandate_of_heaven
			value = 50
		}
	}
	if = {
		limit = {
			has_character_modifier = plundering_leader_modifier
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	
	# Grace modifiers
	
	if = {
		limit = {
			has_landed_title = e_china
		}
		if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_1
			}
			ROOT = {
				change_variable = {
					which = mandate_of_heaven
					value = -50
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_2
			}
			ROOT = {
				change_variable = {
					which = mandate_of_heaven
					value = -100
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_3
			}
			ROOT = {
				change_variable = {
					which = mandate_of_heaven
					value = -150
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_4
			}
			ROOT = {
				change_variable = {
					which = mandate_of_heaven
					value = -200
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_5
			}
			ROOT = {
				change_variable = {
					which = mandate_of_heaven
					value = -250
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_6
			}
			ROOT = {
				change_variable = {
					which = mandate_of_heaven
					value = -300
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_7
			}
			ROOT = {
				change_variable = {
					which = mandate_of_heaven
					value = -350
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_8
			}
			ROOT = {
				change_variable = {
					which = mandate_of_heaven
					value = -400
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_9
			}
			ROOT = {
				change_variable = {
					which = mandate_of_heaven
					value = -450
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_10
			}
			ROOT = {
				change_variable = {
					which = mandate_of_heaven
					value = -500
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_11
			}
			ROOT = {
				change_variable = {
					which = mandate_of_heaven
					value = -550
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_12
			}
			ROOT = {
				change_variable = {
					which = mandate_of_heaven
					value = -600
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_13
			}
			ROOT = {
				change_variable = {
					which = mandate_of_heaven
					value = -650
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_14
			}
			ROOT = {
				change_variable = {
					which = mandate_of_heaven
					value = -700
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_15
			}
			ROOT = {
				change_variable = {
					which = mandate_of_heaven
					value = -750
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_16
			}
			ROOT = {
				change_variable = {
					which = mandate_of_heaven
					value = -800
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_17
			}
			ROOT = {
				change_variable = {
					which = mandate_of_heaven
					value = -850
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = tribute_boon_refusal_18
			}
			ROOT = {
				change_variable = {
					which = mandate_of_heaven
					value = -900
				}
			}
		}
	}
	
	# Prestige
	if = {
		limit = {
			prestige = 25000
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			prestige = 20000
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			prestige = 15000
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			prestige = 10000
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			prestige = 5000
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			NOT = {
				prestige = 0
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			NOT = {
				prestige = -1000
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			NOT = {
				prestige = -2000
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			NOT = {
				prestige = -3000
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			NOT = {
				prestige = -4000
			}
		}
		ROOT = {
			change_variable = {
				which = mandate_of_heaven
				value = -100
			}
		}
	}
	if = {
		limit = {
			NOT = {
				prestige = -5000
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	# Piety
	if = {
		limit = {
			piety = 5000
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			piety = 4500
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			piety = 4000
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			piety = 3500
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			piety = 3000
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			piety = 2500
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			piety = 2000
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			piety = 1500
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			piety = 1000
		}
		change_variable = {
			which = mandate_of_heaven
			value = 100
		}
	}
	if = {
		limit = {
			NOT = {
				piety = 0
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			NOT = {
				piety = -500
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			NOT = {
				piety = -1000
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			NOT = {
				piety = -1500
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			NOT = {
				piety = -2000
			}
		}
		ROOT = {
			change_variable = {
				which = mandate_of_heaven
				value = -100
			}
		}
	}
	if = {
		limit = {
			NOT = {
				piety = -2500
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	
	# Tributaries - need updates for tributary tiers when that system is added
	any_tributary = {
		if = {
			limit = {
				tier = emperor
				is_nomadic = no
			}
			ROOT = {
				change_variable = {
					which = mandate_of_heaven
					value = 250
				}
			}
		}
		else_if = {
			limit = {
				OR = {
					tier = king
					AND = {
						tier = emperor
						is_nomadic = yes
					}
				}
			}
			ROOT = {
				change_variable = {
					which = mandate_of_heaven
					value = 100
				}
			}
		}
		else_if = {
			limit = {
				tier = duke
			}
			ROOT = {
				change_variable = {
					which = mandate_of_heaven
					value = 50
				}
			}
		}
		else = {
			ROOT = {
				change_variable = {
					which = mandate_of_heaven
					value = 10
				}
			}
		}
	}
	
	# Misc
	if = {
		limit = {
			war = yes
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			war = yes
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			any_war = {
				defender = {
					character = ROOT
				}
				attacker = {
					liege_before_war = {
						character = ROOT
					}
				}
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			NOT = {
				any_owned_bloodline = {
					has_bloodline_flag = real_chinese_imperial_bloodline
				}
			}
		}
		if = {
			limit = {
				NOT = {
					any_owned_bloodline = {
						has_bloodline_flag = pretender_chinese_imperial_bloodline
					}
				}
			}
			change_variable = {
				which = mandate_of_heaven
				value = -500
			}
		}
		else = {
			change_variable = {
				which = mandate_of_heaven
				value = -250
			}
		}
	}
	any_realm_province = {
		ROOT = {
			change_variable = {
				which = mandate_of_heaven
				value = 1
			}
		}
		any_neighbor_province = {
			limit = {
				has_owner = yes
				owner = {
					top_liege = {
						NOR = {
							character = ROOT
							suzerain = {
								character = ROOT
							}
						}
					}
				}
			}
			ROOT = {
				change_variable = {
					which = mandate_of_heaven
					value = -10
				}
			}
		}
	}
	if = {
		limit = {
			primary_title = {
				has_title_flag = five_dynasties_and_ten_kingdoms
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -500
		}
	}
	if = {
		limit = {
			NOT = {
				age = 4
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -500
		}
	}
	else_if = {
		limit = {
			NOT = {
				age = 10
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	else_if = {
		limit = {
			NOT = {
				age = 16
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	if = {
		limit = {
			is_female = yes
			primary_title = {
				has_law = status_of_women_0
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -500
		}
	}
	else_if = {
		limit = {
			is_female = yes
			primary_title = {
				has_law = status_of_women_1
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -250
		}
	}
	else_if = {
		limit = {
			is_female = yes
			primary_title = {
				has_law = status_of_women_2
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -100
		}
	}
	else_if = {
		limit = {
			is_female = yes
			primary_title = {
				has_law = status_of_women_3
			}
		}
		change_variable = {
			which = mandate_of_heaven
			value = -50
		}
	}
	
	# Make it harder to reach either end of the scale
	if = {
		limit = {
			has_character_modifier = mandate_of_heaven_5
		}
		if = {
			limit = {
				check_variable = {
					which = mandate_of_heaven
					value = 0
				}
			}
			divide_variable = {
				which = mandate_of_heaven
				value = 2.5
			}
		}
		else = {
			multiply_variable = {
				which = mandate_of_heaven
				value = 2.5
			}
		}
	}
	else_if = {
		limit = {
			has_character_modifier = mandate_of_heaven_4
		}
		if = {
			limit = {
				check_variable = {
					which = mandate_of_heaven
					value = 0
				}
			}
			divide_variable = {
				which = mandate_of_heaven
				value = 1.25
			}
		}
		else = {
			multiply_variable = {
				which = mandate_of_heaven
				value = 1.25
			}
		}
	}
	else_if = {
		limit = {
			has_character_modifier = mandate_of_heaven_2
		}
		if = {
			limit = {
				check_variable = {
					which = mandate_of_heaven
					value = 0
				}
			}
			multiply_variable = {
				which = mandate_of_heaven
				value = 1.25
			}
		}
		else = {
			divide_variable = {
				which = mandate_of_heaven
				value = 1.25
			}
		}
	}
	else_if = {
		limit = {
			has_character_modifier = mandate_of_heaven_1
		}
		if = {
			limit = {
				check_variable = {
					which = mandate_of_heaven
					value = 0
				}
			}
			multiply_variable = {
				which = mandate_of_heaven
				value = 2.5
			}
		}
		else = {
			divide_variable = {
				which = mandate_of_heaven
				value = 2.5
			}
		}
	}
	
	log = "[Root.GetTitledName]'s Mandate of Heaven value is [Root.mandate_of_heaven.GetValue]!"
	
	# Save the last MoH values so that a positive/negative trend can be tracked
	set_variable = {
		which = old_mandate_of_heaven_4
		which = old_mandate_of_heaven_3
	}
	divide_variable = {
		which = old_mandate_of_heaven_4
		value = 5
	}
	set_variable = {
		which = old_mandate_of_heaven_3
		which = old_mandate_of_heaven_2
	}
	divide_variable = {
		which = old_mandate_of_heaven_3
		value = 5
	}
	set_variable = {
		which = old_mandate_of_heaven_2
		which = old_mandate_of_heaven
	}
	divide_variable = {
		which = old_mandate_of_heaven_2
		value = 2
	}
	set_variable = {
		which = old_mandate_of_heaven
		which = mandate_of_heaven
	}
	divide_variable = {
		which = old_mandate_of_heaven
		value = 2
	}
	set_variable = {
		which = stored_mandate_change
		value = 0
	}
}

potentially_change_current_mandate_of_heaven_level_effect = {
	# The Mandate of Heaven will tend to move towards average, though not too harshly
	
	clr_character_flag = new_mandate_of_heaven_5
	clr_character_flag = new_mandate_of_heaven_4
	clr_character_flag = new_mandate_of_heaven_3
	clr_character_flag = new_mandate_of_heaven_2
	clr_character_flag = new_mandate_of_heaven_1
	clr_character_flag = mandate_changed_bad
	clr_character_flag = mandate_changed_good
	
	if = {
		limit = {
			has_character_modifier = mandate_of_heaven_5
		}
		random_list = {
			80 = {
				modifier = {
					factor = 1.05
					check_variable = {
						which = mandate_of_heaven
						value = 1000
					}
				}
				modifier = {
					factor = 1.05
					check_variable = {
						which = mandate_of_heaven
						value = 1500
					}
				}
				modifier = {
					factor = 1.05
					check_variable = {
						which = mandate_of_heaven
						value = 2000
					}
				}
				modifier = {
					factor = 1.05
					check_variable = {
						which = mandate_of_heaven
						value = 2500
					}
				}
				modifier = {
					factor = 1.05
					check_variable = {
						which = mandate_of_heaven
						value = 3000
					}
				}
				modifier = {
					factor = 1.05
					check_variable = {
						which = mandate_of_heaven
						value = 3500
					}
				}
				modifier = {
					factor = 1.05
					check_variable = {
						which = mandate_of_heaven
						value = 4000
					}
				}
				modifier = {
					factor = 1.05
					check_variable = {
						which = mandate_of_heaven
						value = 4500
					}
				}
				modifier = {
					factor = 1.05
					check_variable = {
						which = mandate_of_heaven
						value = 5000
					}
				}
				modifier = {
					factor = 0.01
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = 0
						}
					}
				}
				modifier = { # A pretender will never have their Mandate unquestioned
					factor = 0
					primary_title = {
						has_title_flag = pretender_chinese_empire
					}
				}
				modifier = { # If there's a pretender, the Mandate of Heaven will not remain unquestioned for most rulers
					factor = 0
					any_independent_ruler = {
						primary_title = {
							has_title_flag = pretender_chinese_empire
						}
					}
					has_landed_title = e_china
					NOT = {
						has_character_flag = new_chinese_imperial_dynasty # A new dynasty in China can be unquestioned for a while, even with a pretender around
					}
				}
				set_character_flag = new_mandate_of_heaven_5
			}
			20 = {
				modifier = {
					factor = 1.2
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = 500
						}
					}
				}
				modifier = {
					factor = 1.2
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = 0
						}
					}
				}
				modifier = {
					factor = 1.2
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -500
						}
					}
				}
				modifier = {
					factor = 1.2
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -1000
						}
					}
				}
				modifier = {
					factor = 1.2
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -1500
						}
					}
				}
				modifier = {
					factor = 1.2
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -2000
						}
					}
				}
				modifier = {
					factor = 1.2
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -2500
						}
					}
				}
				modifier = {
					factor = 1.2
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -3000
						}
					}
				}
				modifier = {
					factor = 1.2
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -3500
						}
					}
				}
				modifier = {
					factor = 1.2
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -4000
						}
					}
				}
				modifier = {
					factor = 1.2
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -4500
						}
					}
				}
				modifier = {
					factor = 1.2
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -5000
						}
					}
				}
				modifier = {
					factor = 0.01
					check_variable = {
						which = mandate_of_heaven
						value = 1000
					}
				}
				set_character_flag = new_mandate_of_heaven_4
				set_character_flag = mandate_changed_bad
			}
		}
	}
	else_if = {
		limit = {
			has_character_modifier = mandate_of_heaven_4
		}
		random_list = {
			10 = {
				modifier = {
					factor = 1.05
					check_variable = {
						which = mandate_of_heaven
						value = 1000
					}
				}
				modifier = {
					factor = 1.05
					check_variable = {
						which = mandate_of_heaven
						value = 1500
					}
				}
				modifier = {
					factor = 1.05
					check_variable = {
						which = mandate_of_heaven
						value = 2000
					}
				}
				modifier = {
					factor = 1.05
					check_variable = {
						which = mandate_of_heaven
						value = 2500
					}
				}
				modifier = {
					factor = 1.05
					check_variable = {
						which = mandate_of_heaven
						value = 3000
					}
				}
				modifier = {
					factor = 1.05
					check_variable = {
						which = mandate_of_heaven
						value = 3500
					}
				}
				modifier = {
					factor = 1.05
					check_variable = {
						which = mandate_of_heaven
						value = 4000
					}
				}
				modifier = {
					factor = 1.05
					check_variable = {
						which = mandate_of_heaven
						value = 4500
					}
				}
				modifier = {
					factor = 1.05
					check_variable = {
						which = mandate_of_heaven
						value = 5000
					}
				}
				modifier = {
					factor = 0.01
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = 0
						}
					}
				}
				modifier = { # A pretender will never have their Mandate unquestioned
					factor = 0
					primary_title = {
						has_title_flag = pretender_chinese_empire
					}
				}
				modifier = { # If there's a pretender, the Mandate of Heaven will not remain unquestioned for most rulers
					factor = 0
					any_independent_ruler = {
						primary_title = {
							has_title_flag = pretender_chinese_empire
						}
					}
					has_landed_title = e_china
					NOT = {
						has_character_flag = new_chinese_imperial_dynasty # A new dynasty in China can be unquestioned for a while, even with a pretender around
					}
				}
				modifier = {
					factor = 0.1
					has_character_modifier = recent_mandate_change_good
				}
				set_character_flag = new_mandate_of_heaven_5
				set_character_flag = mandate_changed_good
			}
			75 = {
				set_character_flag = new_mandate_of_heaven_4
			}
			15 = {
				modifier = {
					factor = 1.2
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = 500
						}
					}
				}
				modifier = {
					factor = 1.2
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = 0
						}
					}
				}
				modifier = {
					factor = 1.2
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -500
						}
					}
				}
				modifier = {
					factor = 1.2
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -1000
						}
					}
				}
				modifier = {
					factor = 1.2
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -1500
						}
					}
				}
				modifier = {
					factor = 1.2
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -2000
						}
					}
				}
				modifier = {
					factor = 1.2
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -2500
						}
					}
				}
				modifier = {
					factor = 1.2
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -3000
						}
					}
				}
				modifier = {
					factor = 1.2
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -3500
						}
					}
				}
				modifier = {
					factor = 1.2
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -4000
						}
					}
				}
				modifier = {
					factor = 1.2
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -4500
						}
					}
				}
				modifier = {
					factor = 1.2
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -5000
						}
					}
				}
				modifier = {
					factor = 0.01
					check_variable = {
						which = mandate_of_heaven
						value = 1000
					}
				}
				modifier = {
					factor = 0.5
					has_landed_title = e_china
				}
				modifier = {
					factor = 0.1
					has_character_modifier = recent_mandate_change_bad
				}
				set_character_flag = new_mandate_of_heaven_3
				set_character_flag = mandate_changed_bad
			}
		}
	}
	else_if = {
		limit = {
			has_character_modifier = mandate_of_heaven_3
		}
		random_list = {
			5 = {
				modifier = {
					factor = 1.1
					check_variable = {
						which = mandate_of_heaven
						value = 1000
					}
				}
				modifier = {
					factor = 1.1
					check_variable = {
						which = mandate_of_heaven
						value = 1500
					}
				}
				modifier = {
					factor = 1.1
					check_variable = {
						which = mandate_of_heaven
						value = 2000
					}
				}
				modifier = {
					factor = 1.1
					check_variable = {
						which = mandate_of_heaven
						value = 2500
					}
				}
				modifier = {
					factor = 1.1
					check_variable = {
						which = mandate_of_heaven
						value = 3000
					}
				}
				modifier = {
					factor = 1.1
					check_variable = {
						which = mandate_of_heaven
						value = 3500
					}
				}
				modifier = {
					factor = 1.1
					check_variable = {
						which = mandate_of_heaven
						value = 4000
					}
				}
				modifier = {
					factor = 1.1
					check_variable = {
						which = mandate_of_heaven
						value = 4500
					}
				}
				modifier = {
					factor = 1.1
					check_variable = {
						which = mandate_of_heaven
						value = 5000
					}
				}
				modifier = {
					factor = 0.01
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = 0
						}
					}
				}
				modifier = { # The FDATK emperors won't get a good Mandate value
					factor = 0
					any_independent_ruler = {
						primary_title = {
							has_title_flag = five_dynasties_and_ten_kingdoms
						}
					}
				}
				modifier = { # It is hard to have a good Mandate level if you don't rule china
					factor = 0.1
					NOT = {
						has_landed_title = e_china
					}
				}
				modifier = {
					factor = 0.1
					has_character_modifier = recent_mandate_change_good
				}
				set_character_flag = new_mandate_of_heaven_4
				set_character_flag = mandate_changed_good
			}
			90 = {
				set_character_flag = new_mandate_of_heaven_3
			}
			5 = {
				modifier = {
					factor = 1.1
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = 500
						}
					}
				}
				modifier = {
					factor = 1.1
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = 0
						}
					}
				}
				modifier = {
					factor = 1.1
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -500
						}
					}
				}
				modifier = {
					factor = 1.1
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -1000
						}
					}
				}
				modifier = {
					factor = 1.1
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -1500
						}
					}
				}
				modifier = {
					factor = 1.1
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -2000
						}
					}
				}
				modifier = {
					factor = 1.1
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -2500
						}
					}
				}
				modifier = {
					factor = 1.1
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -3000
						}
					}
				}
				modifier = {
					factor = 1.1
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -3500
						}
					}
				}
				modifier = {
					factor = 1.1
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -4000
						}
					}
				}
				modifier = {
					factor = 1.1
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -4500
						}
					}
				}
				modifier = {
					factor = 1.1
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -5000
						}
					}
				}
				modifier = {
					factor = 0.01
					check_variable = {
						which = mandate_of_heaven
						value = 1000
					}
				}
				set_character_flag = new_mandate_of_heaven_2
				set_character_flag = mandate_changed_bad
			}
		}
	}
	else_if = {
		limit = {
			has_character_modifier = mandate_of_heaven_2
		}
		random_list = {
			15 = {
				modifier = {
					factor = 1.2
					check_variable = {
						which = mandate_of_heaven
						value = 1000
					}
				}
				modifier = {
					factor = 1.2
					check_variable = {
						which = mandate_of_heaven
						value = 1500
					}
				}
				modifier = {
					factor = 1.2
					check_variable = {
						which = mandate_of_heaven
						value = 2000
					}
				}
				modifier = {
					factor = 1.2
					check_variable = {
						which = mandate_of_heaven
						value = 2500
					}
				}
				modifier = {
					factor = 1.2
					check_variable = {
						which = mandate_of_heaven
						value = 3000
					}
				}
				modifier = {
					factor = 1.2
					check_variable = {
						which = mandate_of_heaven
						value = 3500
					}
				}
				modifier = {
					factor = 1.2
					check_variable = {
						which = mandate_of_heaven
						value = 4000
					}
				}
				modifier = {
					factor = 1.2
					check_variable = {
						which = mandate_of_heaven
						value = 4500
					}
				}
				modifier = {
					factor = 1.2
					check_variable = {
						which = mandate_of_heaven
						value = 5000
					}
				}
				modifier = {
					factor = 0.01
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = 0
						}
					}
				}
				modifier = { # The FDATK emperors won't get a good Mandate value
					factor = 0.1
					any_independent_ruler = {
						primary_title = {
							has_title_flag = five_dynasties_and_ten_kingdoms
						}
					}
				}
				modifier = { # It is hard to have a good Mandate level if you don't rule china
					factor = 0.5
					NOT = {
						has_landed_title = e_china
					}
				}
				modifier = {
					factor = 0.1
					has_character_modifier = recent_mandate_change_good
				}
				set_character_flag = new_mandate_of_heaven_3
				set_character_flag = mandate_changed_good
			}
			75 = {
				set_character_flag = new_mandate_of_heaven_2
			}
			10 = {
				modifier = {
					factor = 1.05
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = 500
						}
					}
				}
				modifier = {
					factor = 1.05
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = 0
						}
					}
				}
				modifier = {
					factor = 1.05
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -500
						}
					}
				}
				modifier = {
					factor = 1.05
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -1000
						}
					}
				}
				modifier = {
					factor = 1.05
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -1500
						}
					}
				}
				modifier = {
					factor = 1.05
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -2000
						}
					}
				}
				modifier = {
					factor = 1.05
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -2500
						}
					}
				}
				modifier = {
					factor = 1.05
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -3000
						}
					}
				}
				modifier = {
					factor = 1.05
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -3500
						}
					}
				}
				modifier = {
					factor = 1.05
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -4000
						}
					}
				}
				modifier = {
					factor = 1.05
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -4500
						}
					}
				}
				modifier = {
					factor = 1.05
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -5000
						}
					}
				}
				modifier = {
					factor = 0.01
					check_variable = {
						which = mandate_of_heaven
						value = 1000
					}
				}
				modifier = {
					factor = 0.5
					has_landed_title = e_china
				}
				modifier = {
					factor = 0.1
					has_character_modifier = recent_mandate_change_bad
				}
				set_character_flag = new_mandate_of_heaven_1
				set_character_flag = mandate_changed_bad
			}
		}
	}
	else_if = {
		limit = {
			has_character_modifier = mandate_of_heaven_1
		}
		random_list = {
			20 = {
				modifier = {
					factor = 1.2
					check_variable = {
						which = mandate_of_heaven
						value = 1000
					}
				}
				modifier = {
					factor = 1.2
					check_variable = {
						which = mandate_of_heaven
						value = 1500
					}
				}
				modifier = {
					factor = 1.2
					check_variable = {
						which = mandate_of_heaven
						value = 2000
					}
				}
				modifier = {
					factor = 1.2
					check_variable = {
						which = mandate_of_heaven
						value = 2500
					}
				}
				modifier = {
					factor = 1.2
					check_variable = {
						which = mandate_of_heaven
						value = 3000
					}
				}
				modifier = {
					factor = 1.2
					check_variable = {
						which = mandate_of_heaven
						value = 3500
					}
				}
				modifier = {
					factor = 1.2
					check_variable = {
						which = mandate_of_heaven
						value = 4000
					}
				}
				modifier = {
					factor = 1.2
					check_variable = {
						which = mandate_of_heaven
						value = 4500
					}
				}
				modifier = {
					factor = 1.2
					check_variable = {
						which = mandate_of_heaven
						value = 5000
					}
				}
				modifier = {
					factor = 0.01
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = 0
						}
					}
				}
				modifier = { # The FDATK emperors won't get a good Mandate value
					factor = 0.5
					any_independent_ruler = {
						primary_title = {
							has_title_flag = five_dynasties_and_ten_kingdoms
						}
					}
				}
				modifier = { # It is hard to have a good Mandate level if you don't rule China
					factor = 0.9
					NOT = {
						has_landed_title = e_china
					}
				}
				set_character_flag = new_mandate_of_heaven_2
				set_character_flag = mandate_changed_good
			}
			80 = {
				modifier = {
					factor = 1.05
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = 500
						}
					}
				}
				modifier = {
					factor = 1.05
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = 0
						}
					}
				}
				modifier = {
					factor = 1.05
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -500
						}
					}
				}
				modifier = {
					factor = 1.05
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -1000
						}
					}
				}
				modifier = {
					factor = 1.05
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -1500
						}
					}
				}
				modifier = {
					factor = 1.05
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -2000
						}
					}
				}
				modifier = {
					factor = 1.05
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -2500
						}
					}
				}
				modifier = {
					factor = 1.05
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -3000
						}
					}
				}
				modifier = {
					factor = 1.05
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -3500
						}
					}
				}
				modifier = {
					factor = 1.05
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -4000
						}
					}
				}
				modifier = {
					factor = 1.05
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -4500
						}
					}
				}
				modifier = {
					factor = 1.05
					NOT = {
						check_variable = {
							which = mandate_of_heaven
							value = -5000
						}
					}
				}
				modifier = {
					factor = 0.01
					check_variable = {
						which = mandate_of_heaven
						value = 1000
					}
				}
				set_character_flag = new_mandate_of_heaven_1
			}
		}
	}
	else = { # Shouldn't happen a lot, but best to be certain it isn't frequent...
		if = {
			limit = {
				OR = {
					has_character_flag = new_chinese_imperial_dynasty
					has_landed_title = e_china
				}
				primary_title = {
					NOR = {
						has_title_flag = pretender_chinese_empire
						has_title_flag = five_dynasties_and_ten_kingdoms
					}
				}
			}
			set_character_flag = new_mandate_of_heaven_4
		}
		else = {
			set_character_flag = new_mandate_of_heaven_3
		}
		log = "[Root.GetTitledName]'s Mandate of Heaven calculation used the fallback option!"
	}
}


update_mandate_of_heaven_law_and_modifier_effect = {
	remove_character_modifier = mandate_of_heaven_5
	remove_character_modifier = mandate_of_heaven_4
	remove_character_modifier = mandate_of_heaven_3
	remove_character_modifier = mandate_of_heaven_2
	remove_character_modifier = mandate_of_heaven_1
	if = {
		limit = {
			NOT = {
				has_global_flag = no_mandate_of_heaven
			}
		}
		if = {
			limit = {
				has_character_flag = new_mandate_of_heaven_5
			}
			add_character_modifier = {
				modifier = mandate_of_heaven_5
				duration = -1
			}
			log = "[Root.GetTitledName]'s Mandate of Heaven is Unquestioned!"
			#primary_title = {
			#	add_law = mandate_of_heaven_law_5
			#}
		}
		else_if = {
			limit = {
				has_character_flag = new_mandate_of_heaven_4
			}
			add_character_modifier = {
				modifier = mandate_of_heaven_4
				duration = -1
			}
			log = "[Root.GetTitledName]'s Mandate of Heaven is Good!"
			#primary_title = {
			#	add_law = mandate_of_heaven_law_4
			#}
		}
		else_if = {
			limit = {
				has_character_flag = new_mandate_of_heaven_3
			}
			add_character_modifier = {
				modifier = mandate_of_heaven_3
				duration = -1
			}
			log = "[Root.GetTitledName]'s Mandate of Heaven is Average!"
			#primary_title = {
			#	add_law = mandate_of_heaven_law_3
			#}
		}
		else_if = {
			limit = {
				has_character_flag = new_mandate_of_heaven_2
			}
			add_character_modifier = {
				modifier = mandate_of_heaven_2
				duration = -1
			}
			log = "[Root.GetTitledName]'s Mandate of Heaven is Poor!"
			#primary_title = {
			#	add_law = mandate_of_heaven_law_2
			#}
		}
		else = {
			add_character_modifier = {
				modifier = mandate_of_heaven_1
				duration = -1
			}
			log = "[Root.GetTitledName]'s Mandate of Heaven is Lost!"
			#primary_title = {
			#	add_law = mandate_of_heaven_law_1
			#}
		}
		
		if = {
			limit =  {
				has_character_flag = mandate_changed_good
			}
			remove_character_modifier = recent_mandate_change_good
			remove_character_modifier = recent_mandate_change_bad
			add_character_modifier = {
				modifier = recent_mandate_change_good
				duration = 3650
			}
			character_event = { id = mandate_of_heaven.7 }
		}
		else_if = {
			limit =  {
				has_character_flag = mandate_changed_bad
			}
			remove_character_modifier = recent_mandate_change_good
			remove_character_modifier = recent_mandate_change_bad
			add_character_modifier = {
				modifier = recent_mandate_change_bad
				duration = 3650
			}
			character_event = { id = mandate_of_heaven.8 }
		}
	}
	else = {
		add_character_modifier = {
			modifier = mandate_of_heaven_3
			duration = -1
		}
		log = "The Mandate of Heaven is disabled!"
	}
}